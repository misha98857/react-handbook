[{"key": "\u5b89\u88dd", "values": [{"key": "\u958b\u59cb", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u672c\u7ae0\u7bc0\u662f React \u6587\u4ef6\u8207\u76f8\u95dc\u8cc7\u8a0a\u7684\u6982\u89bd\u3002</p>\n<p><strong>React</strong> \u662f\u4e00\u500b\u5be6\u4f5c\u4f7f\u7528\u8005\u4ecb\u9762\u7684 JavaScript \u51fd\u5f0f\u5eab\u3002\u8acb\u5230\u6211\u5011\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//\">\u4e3b\u9801</a>\u6216<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//tutorial/tutorial.html\">\u6559\u5b78</a>\u4e2d\u5b78\u7fd2\u4ec0\u9ebc\u662f React\u3002</p>\n\n<ul>\n<li><a href=\"/react/getting-started#try-react\">\u5617\u8a66 React</a></li>\n<li><a href=\"/react/getting-started#learn-react\">\u5b78\u7fd2 React</a></li>\n<li><a href=\"/react/getting-started#staying-informed\">\u4e86\u89e3\u6700\u65b0\u6d88\u606f</a></li>\n<li><a href=\"/react/getting-started#versioned-documentation\">\u7248\u672c\u5316\u6587\u4ef6</a></li>\n<li><a href=\"/react/getting-started#something-missing\">\u627e\u4e0d\u5230\u76f8\u95dc\u8cc7\u8a0a\uff1f</a></li>\n</ul>\n<h2 id=\"try-react\"><a class=\"anchor\" href=\"/react/getting-started#try-react\"></a>\u5617\u8a66 React </h2>\n<p>React \u5728\u525b\u63a8\u51fa\u7684\u6642\u5019\u5c31\u5bb9\u8a31\u88ab\u9010\u6b65\u63a1\u7528\uff0c<strong>\u4f60\u53ef\u4ee5\u6309\u81ea\u5df1\u6240\u9700\u53ef\u591a\u53ef\u5c11\u7684</strong>\u63a1\u7528 React\u3002\u4e0d\u7ba1\u4f60\u662f\u60f3\u521d\u6b65\u5617\u8a66 React\u3001\u5728\u7c21\u55ae\u7684 HTML \u7db2\u9801\u4e0a\u52a0\u5165\u4e92\u52d5\u6027\uff0c\u6216\u662f\u5be6\u4f5c\u4e00\u500b\u4f7f\u7528 React \u9a45\u52d5\u7684\u8907\u96dc\u61c9\u7528\u7a0b\u5f0f\uff0c\u9019\u7ae0\u7bc0\u88cf\u7684\u9023\u7d50\u6703\u5e6b\u52a9\u4f60\u958b\u59cb\u3002</p>\n<h3 id=\"online-playgrounds\"><a class=\"anchor\" href=\"/react/getting-started#online-playgrounds\"></a>\u7dda\u4e0a\u9ad4\u9a57 </h3>\n<p>\u5982\u679c\u4f60\u6709\u8208\u8da3\u5617\u8a66 React\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u7dda\u4e0a\u7de8\u8f2f\u5668\u3002\u5728 <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//redirect-to-codepen/hello-world\">CodePen</a>\u3001<a class=\"external-link\" href=\"https://codesandbox.io/s/new\">CodeSandbox</a>\uff0c\u6216\u662f <a class=\"external-link\" href=\"https://stackblitz.com/fork/react\">Stackblitz</a> \u5be6\u4f5c\u4e00\u500b Hello World \u7684\u7bc4\u4f8b\u3002</p>\n<p>\u5982\u679c\u4f60\u504f\u5411\u4f7f\u7528\u81ea\u5df1\u7684\u7de8\u8f2f\u5668\uff0c\u4f60\u53ef\u4ee5<a class=\"external-link\" href=\"https://raw.githubusercontent.com/reactjs/reactjs.org/main/static/html/single-file-example.html\">\u4e0b\u8f09\u6b64 HTML \u6587\u4ef6</a>\u9032\u884c\u4fee\u6539\uff0c\u4e26\u5f9e\u672c\u6a5f\u6587\u4ef6\u7cfb\u7d71\u88e1\u628a\u5b83\u6253\u958b\u5230\u700f\u89bd\u5668\u3002\u9019\u6703\u9032\u884c\u4e00\u500b\u7de9\u6162\u7684 runtime \u7a0b\u5f0f\u78bc\u8f49\u63db\uff0c\u56e0\u6b64\u6211\u5011\u5efa\u8b70\u53ea\u628a\u9019\u6587\u4ef6\u7528\u4f5c\u7c21\u55ae\u7684\u793a\u7bc4\u3002</p>\n<h3 id=\"add-react-to-a-website\"><a class=\"anchor\" href=\"/react/getting-started#add-react-to-a-website\"></a>\u5c07 React \u52a0\u5165\u5230\u7db2\u9801 </h3>\n<p>\u4f60\u53ef\u4ee5<a href=\"/react/add-react-to-a-website\">\u5728\u4e00\u5206\u9418\u5167\u5c07 React \u52a0\u5165\u5230\u4e00\u500b HTML \u7db2\u9801\u4e0a</a>\u3002\u4f60\u53ef\u4ee5\u9078\u64c7\u9010\u6b65\u64f4\u5927\u5b83\u7684\u61c9\u7528\u7bc4\u570d\uff0c\u6216\u662f\u53ea\u4f7f\u7528\u5728\u5c11\u90e8\u5206\u7684\u53ef\u8b8a widget \u4e0a\u3002</p>\n<h3 id=\"create-a-new-react-app\"><a class=\"anchor\" href=\"/react/getting-started#create-a-new-react-app\"></a>\u5be6\u4f5c\u5168\u65b0\u7684 React \u61c9\u7528\u7a0b\u5f0f </h3>\n<p>\u7576\u4f60\u525b\u5be6\u4f5c\u5168\u65b0\u7684 React \u61c9\u7528\u7a0b\u5f0f\u6642\uff0c\u4e00\u500b<a href=\"/react/add-react-to-a-website\">\u7c21\u55ae\u7684 HTML \u7db2\u9801\u914d\u4e0a script \u6a19\u7c64</a>\u6216\u8a31\u4f9d\u7136\u662f\u6700\u597d\u7684\u9078\u64c7\u3002\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u4e00\u5206\u9418\u5167\u8a2d\u5b9a\u597d\u3002</p>\n<p>\u7576\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u9010\u6f38\u64f4\u5927\uff0c\u4f60\u6216\u8a31\u8981\u8003\u616e\u4f7f\u7528\u4e00\u500b\u6bd4\u8f03\u7d9c\u5408\u7684\u8a2d\u5b9a\u65b9\u6cd5\u3002\u6211\u5011\u63a8\u85a6\u4f7f\u7528\u4e00\u4e9b JavaScript toolchain \u4f86\u8a2d\u5b9a\u5927\u578b\u7684\u61c9\u7528\u7a0b\u5f0f\u3002\u5b83\u5011\u53ea\u9700\u8981\u4e00\u4e9b\u8a2d\u5b9a\uff0c\u751a\u81f3\u4e0d\u9700\u8981\uff0c\u5c31\u80fd\u8b93\u6211\u5011\u5145\u4efd\u4f7f\u7528\u8c50\u5bcc\u7684 React ecosystem\u3002<a href=\"/react/create-a-new-react-app\">\u5b78\u7fd2\u5982\u4f55\u8a2d\u5b9a</a></p>\n<h2 id=\"learn-react\"><a class=\"anchor\" href=\"/react/getting-started#learn-react\"></a>\u5b78\u7fd2 React </h2>\n<p>\u5b78\u7fd2 React \u7684\u4eba\u4f86\u81f3\u65bc\u4e0d\u540c\u7684\u80cc\u666f\uff0c\u4ee5\u53ca\u4e0d\u540c\u7684\u5b78\u7fd2\u65b9\u5f0f\u3002\u7121\u8ad6\u4f60\u662f\u504f\u5411\u7406\u8ad6\u5316\uff0c\u6216\u662f\u5be6\u8e10\u5316\u7684\u65b9\u5f0f\uff0c\u6211\u5011\u5e0c\u671b\u672c\u7ae0\u7bc0\u6703\u5c0d\u4f60\u6709\u6240\u5e6b\u52a9\u3002</p>\n<ul>\n<li>\u5982\u679c\u4f60\u559c\u6b61<strong>\u52d5\u624b\u505a</strong>\uff0c\u8acb\u5f9e\u6211\u5011\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//tutorial/tutorial.html\">\u5be6\u7528\u6307\u5357</a>\u958b\u59cb\u3002</li>\n<li>\u5982\u679c\u4f60\u559c\u6b61<strong>\u6309\u90e8\u5c31\u73ed\u5b78\u7fd2\u6982\u5ff5</strong>\uff0c\u8acb\u5f9e\u6211\u5011\u7684<a href=\"/react/hello-world\">\u4e3b\u8981\u6982\u5ff5\u6307\u5357</a>\u958b\u59cb\u3002</li>\n</ul>\n<p>\u8207\u5b78\u7fd2\u5176\u4ed6\u5168\u65b0\u7684\u79d1\u6280\u4e00\u6a23\uff0c\u5b78\u7fd2 React \u6703\u6709\u4e00\u5b9a\u7684\u96e3\u5ea6\u3002\u6211\u5011\u76f8\u4fe1\u53ea\u8981\u591a\u7df4\u7fd2\u548c\u6dfb\u52a0\u591a\u4e00\u4efd\u8010\u5fc3\uff0c\u4f60<em>\u4e00\u5b9a\u6703</em>\u638c\u63e1\u5230 React\u3002</p>\n<h3 id=\"first-examples\"><a class=\"anchor\" href=\"/react/getting-started#first-examples\"></a>\u7b2c\u4e00\u500b\u7bc4\u4f8b </h3>\n<p><a class=\"external-link\" href=\"https://zh-hant.reactjs.org//\">React \u9996\u9801</a>\u5305\u542b\u4e86\u5e7e\u500b\u5c0f\u578b\u7684 React \u7bc4\u4f8b\u8207\u5be6\u6642\u7de8\u8f2f\u5668\u3002\u5373\u4f7f\u4f60\u9084\u6c92\u5b8c\u5168\u4e86\u89e3 React\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5617\u8a66\u8b8a\u66f4\u5b83\u5011\u7684\u7a0b\u5f0f\u78bc\uff0c\u770b\u770b\u7d50\u679c\u6703\u600e\u6a23\u3002</p>\n<h3 id=\"react-for-beginners\"><a class=\"anchor\" href=\"/react/getting-started#react-for-beginners\"></a>\u521d\u5b78\u8005\u7684 React </h3>\n<p>\u5982\u679c\u4f60\u89ba\u5f97 React \u5b98\u65b9\u6587\u4ef6\u5b78\u7fd2\u7684\u7bc0\u594f\u6bd4\u8f03\u5feb\uff0c\u4e0d\u592a\u9069\u61c9\uff0c\u8acb\u5148\u770b\u770b <a class=\"external-link\" href=\"https://www.taniarascia.com/getting-started-with-react/\">Tania Rascia \u6240\u7de8\u5beb\u7684 React \u6982\u89bd</a>\u3002\u5979\u6703\u4ee5\u521d\u5b78\u8005\u7684\u89d2\u5ea6\uff0c\u4ecb\u7d39 React \u7684\u4e3b\u8981\u6982\u5ff5\u3002\u7576\u4f60\u770b\u5b8c\u4e86\uff0c\u5617\u8a66\u518d\u56de\u4f86\u7e7c\u7e8c\u5b78\u7fd2\u5427\uff01</p>\n<h3 id=\"react-for-designers\"><a class=\"anchor\" href=\"/react/getting-started#react-for-designers\"></a>\u8a2d\u8a08\u5e2b\u7684 React </h3>\n<p>\u5982\u679c\u4f60\u662f\u4f86\u81f3\u65bc\u8a2d\u8a08\u80cc\u666f\u7684\uff0c<a class=\"external-link\" href=\"https://reactfordesigners.com/\">\u9019\u4e9b\u8cc7\u6e90</a>\u6703\u662f\u4e00\u500b\u5f88\u597d\u7684\u8d77\u9ede\u3002</p>\n<h3 id=\"javascript-resources\"><a class=\"anchor\" href=\"/react/getting-started#javascript-resources\"></a>JavaScript \u7684\u8cc7\u6e90 </h3>\n<p>\u6211\u5011\u5047\u8a2d\u4f60\u6709\u4e00\u4e9b JavaScript \u7684\u57fa\u790e\u77e5\u8b58\u3002\u4f60\u4e0d\u9700\u8981\u662f JavaScript \u7684\u5c08\u5bb6\uff0c\u53ea\u662f\u540c\u6642\u5b78\u7fd2 React \u548c JavaScript \u6703\u6bd4\u8f03\u56f0\u96e3\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u5148\u770b<a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/A_re-introduction_to_JavaScript\">\u9019\u88cf\u7684 JavaScript \u6982\u89bd</a>\u4f86\u6e2c\u8a66\u81ea\u5df1\u7684\u8a8d\u8b58\u7a0b\u5ea6\u3002\u9019\u9700\u8981\u82b1\u8cbb\u5927\u6982 30 \u5206\u9418\u5230 1 \u5c0f\u6642\uff0c\u4f46\u9019\u6703\u589e\u52a0\u4f60\u5b78\u7fd2 React \u7684\u4fe1\u5fc3\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u7576\u4f60\u9047\u5230 JavaScript \u7684\u56f0\u96e3\u6642\uff0c<a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript\">MDN</a> \u548c <a class=\"external-link\" href=\"https://javascript.info/\">javascript.info</a> \u6703\u662f\u975e\u5e38\u597d\u7684\u67e5\u95b1\u8cc7\u6e90\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//community/support.html\">\u793e\u7fa4\u652f\u63f4\u8ad6\u58c7</a>\u4e0a\u5c0b\u627e\u5e6b\u52a9\u3002</p>\n</div>\n<h3 id=\"practical-tutorial\"><a class=\"anchor\" href=\"/react/getting-started#practical-tutorial\"></a>\u5be6\u7528\u6307\u5357 </h3>\n<p>\u5982\u679c\u4f60\u559c\u6b61<strong>\u52d5\u624b\u505a</strong>\uff0c\u8acb\u53c3\u8003\u6211\u5011\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//tutorial/tutorial.html\">\u5be6\u7528\u6307\u5357</a>\u3002\u6211\u5011\u6703\u5229\u7528 React \u5be6\u4f5c\u4e00\u500b\u4e95\u5b57\u904a\u6232\u3002\u4f60\u53ef\u80fd\u5c0d\u904a\u6232\u958b\u767c\u4e0d\u611f\u8208\u8da3\uff0c\u56e0\u800c\u5f88\u60f3\u8df3\u904e\u9019\u500b\u90e8\u4efd\uff0c\u4f46\u8acb\u7d66\u5b83\u4e00\u500b\u6a5f\u6703\u3002\u5728\u9019\u6307\u5357\u6240\u5b78\u7fd2\u7684\u6280\u5de7\uff0c\u5c07\u6703\u662f\u5be6\u4f5c<em>\u4efb\u4f55</em> React \u61c9\u7528\u7a0b\u5f0f\u7684\u91cd\u8981\u57fa\u790e\uff0c\u638c\u63e1\u5230\u5b83\u5011\u6703\u8b93\u4f60\u66f4\u4e86\u89e3 React\u3002</p>\n<h3 id=\"step-by-step-guide\"><a class=\"anchor\" href=\"/react/getting-started#step-by-step-guide\"></a>\u6309\u90e8\u5c31\u73ed\u5b78\u7fd2\u6307\u5357 </h3>\n<p>\u5982\u679c\u4f60\u559c\u6b61<strong>\u6309\u90e8\u5c31\u73ed\u5b78\u7fd2\u6982\u5ff5</strong>\uff0c\u6211\u5011\u7684<a href=\"/react/hello-world\">\u4e3b\u8981\u6982\u5ff5\u6307\u5357</a>\u6703\u662f\u4e00\u500b\u5f88\u597d\u7684\u8d77\u9ede\u3002\u6307\u5357\u88cf\u6bcf\u500b\u7ae0\u7bc0\u90fd\u662f\u5efa\u57fa\u65bc\u4e0a\u4e00\u500b\u7ae0\u7bc0\u7684\u5b78\u7fd2\u5167\u5bb9\uff0c\u9019\u6a23\u4f60\u5c31\u4e0d\u6703\u932f\u904e\u4efb\u4f55\u5167\u5bb9\u3002</p>\n<h3 id=\"thinking-in-react\"><a class=\"anchor\" href=\"/react/getting-started#thinking-in-react\"></a>\u7528 React \u601d\u8003 </h3>\n<p>\u8a31\u591a React \u4f7f\u7528\u8005\u90fd\u8868\u793a\u5728\u95b1\u8b80\u4e86<a href=\"/react/thinking-in-react\">\u7528 React \u601d\u8003</a>\u5f8c\u5c0d React \u604d\u7136\u5927\u609f\u3002\u5b83\u53ef\u80fd\u662f\u6700\u6e90\u9060\u6d41\u9577\u7684 React \u6307\u5357\uff0c\u81f3\u4eca\u4f9d\u7136\u6975\u5177\u50f9\u503c\u3002</p>\n<h3 id=\"recommended-courses\"><a class=\"anchor\" href=\"/react/getting-started#recommended-courses\"></a>\u8ab2\u7a0b\u63a8\u85a6 </h3>\n<p>\u76f8\u6bd4\u5b98\u65b9\u6587\u4ef6\uff0c\u6709\u6642\u5019\u5927\u5bb6\u6703\u89ba\u5f97\u7b2c\u4e09\u65b9\u7684\u66f8\u7c4d\u548c\u5f71\u7247\u6559\u5b78\u5c0d\u5b78\u7fd2\u66f4\u6709\u5e6b\u52a9\u3002\u56e0\u6b64\u6211\u5011\u6574\u5408\u4e86\u4e00\u7cfb\u5217\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//community/courses.html\">\u8ab2\u7a0b\u63a8\u85a6</a>\uff0c\u6709\u4e9b\u8ab2\u7a0b\u66f4\u662f\u514d\u8cbb\u7684\u3002</p>\n<h3 id=\"advanced-concepts\"><a class=\"anchor\" href=\"/react/getting-started#advanced-concepts\"></a>\u9032\u968e\u6982\u5ff5 </h3>\n<p>\u7576\u4f60\u5c0d<a href=\"/react/hello-world\">\u4e3b\u8981\u6982\u5ff5</a>\u6709\u6240\u638c\u63e1\uff0c\u4e26\u5617\u8a66\u4f7f\u7528\u4e86\u4e00\u9ede React\uff0c\u4f60\u53ef\u80fd\u6703\u5c0d\u6bd4\u8f03\u9032\u968e\u7684\u8ab2\u984c\u611f\u8208\u8da3\u3002\u9032\u968e\u6307\u5357\u6703\u4ecb\u7d39\u4e00\u4e9b\u5f37\u5927\u4f46\u4e0d\u5e38\u7528\u7684 React \u7279\u9ede\uff0c\u4f8b\u5982 <a href=\"/react/context\">context</a> \u548c <a href=\"/react/refs-and-the-dom\">refs</a>\u3002</p>\n<h3 id=\"api-reference\"><a class=\"anchor\" href=\"/react/getting-started#api-reference\"></a>API \u53c3\u8003 </h3>\n<p>\u7576\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u6709\u95dc\u7279\u5b9a React API \u7684\u8cc7\u8a0a\u6642\uff0c\u9019\u7ae0\u7bc0\u6703\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982 <a href=\"/react/react-component\"><code class=\"language-javascript\">React.Component</code> API \u53c3\u8003</a>\u6703\u89e3\u69cb <code class=\"language-javascript\">setState()</code> \u662f\u600e\u6a23\u904b\u4f5c\uff0c\u4ee5\u53ca\u4ecb\u7d39\u4e0d\u540c\u751f\u547d\u9031\u671f\u65b9\u6cd5\u7684\u4f7f\u7528\u65b9\u6cd5\u3002</p>\n<h3 id=\"glossary-and-faq\"><a class=\"anchor\" href=\"/react/getting-started#glossary-and-faq\"></a>\u8853\u8a9e\u8868\u8207\u5e38\u898b\u554f\u984c </h3>\n<p><a href=\"/react/glossary\">\u8853\u8a9e\u8868</a>\u5305\u542b\u4e86 React \u6587\u4ef6\u88cf\u6700\u5e38\u898b\u7684\u8853\u8a9e\u3002\u70ba\u4e86\u89e3\u7b54\u5927\u5bb6\u5c0d\u65bc\u4e00\u4e9b\u5e38\u898b\u8ab2\u984c\u7684\u7591\u554f\uff0c\u5305\u62ec <a href=\"/react/faq-ajax\">\u767c\u9001 AJAX \u8acb\u6c42</a>\u3001<a href=\"/react/faq-state\">component state</a> \u548c<a href=\"/react/faq-structure\">\u6587\u4ef6\u7d50\u69cb</a>\uff0c\u6211\u5011\u56e0\u6b64\u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b\u5e38\u898b\u554f\u984c\u7684\u7ae0\u7bc0\u3002</p>\n<h2 id=\"staying-informed\"><a class=\"anchor\" href=\"/react/getting-started#staying-informed\"></a>\u4e86\u89e3\u6700\u65b0\u6d88\u606f </h2>\n<p><a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/\">React \u90e8\u843d\u683c</a>\u662f React \u5718\u968a\u767c\u4f48\u66f4\u65b0\u6d88\u606f\u7684\u5b98\u65b9\u6e20\u9053\u3002\u4efb\u4f55\u91cd\u8981\u6d88\u606f\uff0c\u5305\u62ec\u66f4\u65b0\u65e5\u8a8c\u6216\u68c4\u7528\u901a\u77e5\uff0c\u90fd\u6703\u5728\u9019\u88cf\u5148\u767c\u4f48\u3002</p>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u5728 Twitter \u8ffd\u8e64 <a class=\"external-link\" href=\"https://twitter.com/reactjs\">@reactjs \u5e33\u865f</a>\uff0c\u53ea\u95b1\u8b80\u5b98\u65b9\u90e8\u843d\u683c\u4e5f\u4e0d\u6703\u4ee4\u4f60\u932f\u904e\u91cd\u8981\u6d88\u606f\u3002</p>\n<p>\u4e26\u975e\u6240\u6709 React \u7248\u672c\u767c\u4f48\u503c\u5f97\u6211\u5011\u5728\u90e8\u843d\u683c\u88e1\u767c\u4f48\u6587\u7ae0\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728 <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/main/CHANGELOG.md\">React \u7684\u7a0b\u5f0f\u78bc\u5009\u5eab\u4e2d\u7684 <code class=\"language-javascript\">CHANGELOG.md</code> \u6587\u4ef6</a>\u6216 <a class=\"external-link\" href=\"https://github.com/facebook/react/releases\">Release</a> \u9801\u9762\uff0c\u627e\u5230\u6bcf\u500b\u7248\u672c\u767c\u4f48\u7684\u8a73\u7d30\u66f4\u65b0\u65e5\u8a8c\u3002</p>\n<h2 id=\"versioned-documentation\"><a class=\"anchor\" href=\"/react/getting-started#versioned-documentation\"></a>\u7248\u672c\u5316\u6587\u4ef6 </h2>\n<p>\u5b98\u65b9\u6587\u4ef6\u6703\u4e00\u76f4\u8207\u6700\u65b0\u7a69\u5b9a\u7248\u672c\u7684 React \u4fdd\u6301\u540c\u6b65\u3002\u81f3 React 16 \u4ee5\u4f86\uff0c\u4f60\u53ef\u4ee5\u5728\u9019<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//versions\">\u53e6\u4e00\u9801</a>\u627e\u5230\u820a\u7248\u672c\u7684 React \u6587\u4ef6\u3002\u6ce8\u610f\uff0c\u820a\u7248\u672c\u7684\u6587\u4ef6\u662f\u53d6\u81f3\u8a72\u7248\u672c\u767c\u4f48\u6642\u7684\u72c0\u614b\uff0c\u4e26\u4e0d\u6703\u6709\u6301\u7e8c\u7684\u66f4\u65b0\u3002</p>\n<h2 id=\"something-missing\"><a class=\"anchor\" href=\"/react/getting-started#something-missing\"></a>\u627e\u4e0d\u5230\u76f8\u95dc\u8cc7\u8a0a\uff1f </h2>\n<p>\u5982\u679c\u4f60\u627e\u4e0d\u5230\u76f8\u95dc\u7684\u8cc7\u8a0a\uff0c\u6216\u662f\u5c0d\u90e8\u4efd\u7684\u5167\u5bb9\u6709\u7591\u60d1\uff0c\u8acb\u9023\u540c\u4f60\u7684\u5efa\u8b70\uff0c\u5728<a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/issues/new\">\u6b64\u6587\u4ef6\u5009\u5eab\u63d0\u51fa issue</a> \u6216\u662f\u5728 Twitter \u4e0a\u63d0\u53ca <a class=\"external-link\" href=\"https://twitter.com/reactjs\">@reactjs \u5e33\u865f</a>\u3002\u6211\u5011\u6a02\u610f\u8046\u807d\u4f60\u7684\u610f\u898b\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/getting-started.md\">Edit this page</a></p></div></article>", "path": "/react/getting-started", "nav": ["/react", "/react/add-react-to-a-website"]}, {"key": "\u5c07 React \u52a0\u5165\u5230\u7db2\u9801", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u6309\u81ea\u5df1\u6240\u9700\u53ef\u591a\u53ef\u5c11\u7684\u63a1\u7528 React\u3002</p>\n<p>React \u5728\u525b\u63a8\u51fa\u7684\u6642\u5019\u5c31\u5bb9\u8a31\u88ab\u9010\u6b65\u63a1\u7528\uff0c<strong>\u4f60\u53ef\u4ee5\u6309\u81ea\u5df1\u6240\u9700\u53ef\u591a\u53ef\u5c11\u7684</strong>\u63a1\u7528 React\u3002 \u6216\u8a31\u4f60\u53ea\u60f3\u5728\u73fe\u5b58\u7684\u7db2\u9801\u4e0a\u589e\u52a0\u5c11\u91cf\u7684\u4e92\u52d5\u6027\u3002\u63a1\u7528 React component \u6703\u662f\u500b\u975e\u5e38\u597d\u7684\u9078\u64c7\u3002</p>\n<p>\u5927\u90e8\u5206\u7684\u7db2\u9801\u4e0d\u662f\uff0c\u4e5f\u4e0d\u9700\u8981\u662f single-page \u7684\u61c9\u7528\u7a0b\u5f0f\u3002\u4f60\u53ea\u9700\u8981<strong>\u5e7e\u884c\u7684\u7a0b\u5f0f\u78bc\uff0c\u4e26\u4e14\u4e0d\u9700\u8981\u4efb\u4f55\u5efa\u7acb\u5de5\u5177</strong>\uff0c\u5c31\u53ef\u4ee5\u5728\u4f60\u4e00\u5c11\u90e8\u5206\u7684\u7db2\u9801\u4e0a\u5617\u8a66\u63a1\u7528 React\u3002\u4f60\u53ef\u4ee5\u9078\u64c7\u9010\u6b65\u64f4\u5927\u5b83\u7684\u61c9\u7528\u7bc4\u570d\uff0c\u6216\u662f\u53ea\u4f7f\u7528\u5728\u5c11\u90e8\u5206\u7684\u53ef\u8b8a widget \u4e0a\u3002</p>\n\n<ul>\n<li><a href=\"/react/add-react-to-a-website#add-react-in-one-minute\">\u4e00\u5206\u9418\u5167\u52a0\u5165 React</a></li>\n<li><a href=\"/react/add-react-to-a-website#optional-try-react-with-jsx\">\u53ef\u9078\uff1a\u5617\u8a66 React \u8207 JSX</a>\uff08\u4e0d\u9700\u8981 bundler\uff01\uff09</li>\n</ul>\n<h2 id=\"add-react-in-one-minute\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#add-react-in-one-minute\"></a>\u4e00\u5206\u9418\u5167\u52a0\u5165 React </h2>\n<p>\u5728\u672c\u7ae0\u7bc0\u88e1\uff0c\u6211\u5011\u6703\u793a\u7bc4\u5982\u4f55\u5728 HTML \u7db2\u9801\u4e0a\u52a0\u5165\u4e00\u500b React component\u3002\u4f60\u53ef\u4ee5\u5229\u7528\u81ea\u5df1\u7684\u7db2\u9801\uff0c\u6216\u5efa\u7acb\u4e00\u500b\u7a7a\u767d\u7684 HTML \u6587\u4ef6\u4f86\u8ddf\u96a8\u7740\u6211\u5011\u7df4\u7fd2\u3002</p>\n<p>\u6211\u5011\u4e0d\u9700\u8981\u4efb\u4f55\u8907\u96dc\u7684\u5de5\u5177\u6216\u5b89\u88dd\u9700\u6c42 \u2014\u2014 <strong>\u4f60\u53ea\u9700\u8981\u9023\u63a5\u5230\u7db2\u8def\u548c\u4e00\u5206\u9418\u7684\u6642\u9593\uff0c\u5c31\u80fd\u5b8c\u6210\u672c\u7ae0\u7bc0\u3002</strong></p>\n<p>\u53ef\u9078\uff1a<a class=\"external-link\" href=\"https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605/archive/87f0b6f34238595b44308acfb86df6ea43669c08.zip\">\u4e0b\u8f09\u5b8c\u6574\u7bc4\u4f8b (2KB zipped)</a></p>\n<h3 id=\"step-1-add-a-dom-container-to-the-html\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#step-1-add-a-dom-container-to-the-html\"></a>\u7b2c\u4e00\u6b65\uff1a\u5728 HTML \u4e0a\u52a0\u5165\u4e00\u500b DOM Container </h3>\n<p>\u9996\u5148\uff0c\u6253\u958b\u4f60\u60f3\u7de8\u8f2f\u7684 HTML \u7db2\u9801\u3002\u5728\u4f60\u60f3\u5229\u7528 React \u4f86\u5c55\u793a\u5167\u5bb9\u7684\u4f4d\u7f6e\u4e0a\uff0c\u52a0\u4e0a\u4e00\u500b\u7a7a\u767d\u7684 <code class=\"language-javascript\">&lt;div&gt;</code> \u6a19\u7c64\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token comment\">&lt;!-- ... \u73fe\u5b58 HTML ... --&gt;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>like_button_container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span>\n<span class=\"token comment\">&lt;!-- ... \u73fe\u5b58 HTML ... --&gt;</span></code></pre></div>\n<p>\u6211\u5011\u7d66\u9019\u500b <code class=\"language-javascript\">&lt;div&gt;</code> \u52a0\u4e0a\u4e00\u500b\u7368\u4e00\u7121\u4e8c\u7684 <code class=\"language-javascript\">id</code> HTML attribute\u3002\u9019\u6703\u5bb9\u8a31\u6211\u5011\u7a0d\u5f8c\u5728 JavaScript \u7a0b\u5f0f\u78bc\u88e1\u627e\u5230\u5b83\uff0c\u4e26\u4e14\u5728\u88e1\u9762\u5c55\u793a\u4e00\u500b React component\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u4f60\u53ef\u4ee5\u653e\u7f6e\u50cf\u9019\u6a23\u7684\u300ccontainer\u300d<code class=\"language-javascript\">&lt;div&gt;</code> \u5728 <code class=\"language-javascript\">&lt;body&gt;</code> \u6a19\u7c64\u88e1\u7684<strong>\u4efb\u4f55\u5730\u65b9</strong>\u3002\u4f60\u4e5f\u53ef\u4ee5\u6309\u9700\u8981\uff0c\u5728\u4e00\u9801\u88e1\u653e\u7f6e\u591a\u500b\u7368\u7acb\u7684 DOM container\u3002\u5b83\u5011\u901a\u5e38\u90fd\u662f\u7a7a\u767d\u7684 \u2014\u2014 React \u6703\u66ff\u63db DOM container \u88e1\u4efb\u4f55\u73fe\u5b58\u7684\u5167\u5bb9\u3002</p>\n</div>\n<h3 id=\"step-2-add-the-script-tags\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#step-2-add-the-script-tags\"></a>\u7b2c\u4e8c\u6b65\uff1a\u52a0\u4e0a Script \u6a19\u7c64 </h3>\n<p>\u4e0b\u4e00\u6b65\uff0c\u5728 HTML \u7db2\u9801\u7684 <code class=\"language-javascript\">&lt;/body&gt;</code> \u7d50\u675f\u6a19\u7c64\u524d\uff0c\u52a0\u4e0a\u4e09\u500b <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\">  <span class=\"token comment\">&lt;!-- ... \u5176\u4ed6 HTML ... --&gt;</span>\n\n  <span class=\"token comment\">&lt;!-- \u8f09\u5165 React\u3002 --&gt;</span>\n  <span class=\"token comment\">&lt;!-- \u6ce8\u610f\uff1a\u5728\u767c\u4f48\u61c9\u7528\u7a0b\u5f0f\u524d\uff0c\u8acb\u628a\u300cdevelopment.js\u300d\u66ff\u63db\u6210\u300cproduction.min.js\u300d\u3002 --&gt;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react@18/umd/react.development.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react-dom@18/umd/react-dom.development.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></span>\n  <span class=\"token comment\">&lt;!-- \u8f09\u5165\u6211\u5011\u7684 React component\u3002--&gt;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>like_button.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u524d\u5169\u500b\u7684\u6a19\u7c64\u6703\u8f09\u5165 React\u3002\u7b2c\u4e09\u500b\u6703\u8f09\u5165\u4f60\u7684 component \u7a0b\u5f0f\u78bc\u3002</p>\n<h3 id=\"step-3-create-a-react-component\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#step-3-create-a-react-component\"></a>\u7b2c\u4e09\u6b65\uff1a\u5efa\u7acb\u4e00\u500b React Component </h3>\n<p>\u5728\u4f60\u7684 HTML \u7db2\u9801\u65c1\u908a\uff0c\u5efa\u7acb\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">like_button.js</code> \u7684\u6587\u4ef6</p>\n<p>\u6253\u958b<strong><a class=\"external-link\" href=\"https://gist.github.com/gaearon/0b180827c190fe4fd98b4c7f570ea4a8/raw/b9157ce933c79a4559d2aa9ff3372668cce48de7/LikeButton.js\">\u9019\u500b starter code</a></strong>\uff0c\u7136\u5f8c\u628a\u5b83\u8cbc\u4e0a\u5230\u4f60\u525b\u5efa\u7acb\u7684\u6587\u4ef6\u88e1\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u9019\u7a0b\u5f0f\u78bc\u5b9a\u7acb\u4e86\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">LikeButton</code> \u7684 React component\u3002\u8acb\u5225\u64d4\u5fc3\u5982\u679c\u4f60\u9084\u6c92\u660e\u767d\u5b83 \u2014\u2014 \u6211\u5011\u6703\u5728<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//tutorial/tutorial.html\">\u5be6\u7528\u6307\u5357</a>\u548c<a href=\"/react/hello-world\">\u4e3b\u8981\u6982\u5ff5\u6307\u5357</a>\u88e1\u89e3\u69cb React \u7684\u57fa\u790e\u3002\u76ee\u524d\uff0c\u6211\u5011\u5c31\u5148\u8b93\u5b83\u5c55\u793a\u5728\u756b\u9762\u4e0a\u5427\uff01</p>\n</div>\n<p>\u5728 <strong><a class=\"external-link\" href=\"https://gist.github.com/gaearon/0b180827c190fe4fd98b4c7f570ea4a8/raw/b9157ce933c79a4559d2aa9ff3372668cce48de7/LikeButton.js\">starter code</a></strong> \u4e4b\u5f8c\uff0c\u8acb\u5728 <code class=\"language-javascript\">like_button.js</code> \u7684\u5e95\u90e8\u52a0\u4e0a\u4ee5\u4e09\u884c\u7684\u7a0b\u5f0f\u78bc:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// ... \u4f60\u8cbc\u4e0a\u7684 starter code ...</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> domContainer <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#like_button_container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>domContainer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token function\">e</span><span class=\"token punctuation\">(</span>LikeButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>\u9019\u4e09\u884c\u7684\u7a0b\u5f0f\u78bc\u6703\u627e\u6211\u5011\u5728\u7b2c\u4e00\u6b65\u6240\u52a0\u5165\u7684 <code class=\"language-javascript\">&lt;div&gt;</code>\uff0c\u7528\u5b83\u5efa\u7acb\u4e00\u500b React app \u7136\u5f8c\u5728\u88e1\u9762\u986f\u793a\u6211\u5011\u7684\u300cLike\u300d\u6309\u9215 React component\u3002</p>\n<h3 id=\"thats-it\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#thats-it\"></a>\u5927\u529f\u544a\u6210\uff01 </h3>\n<p>\u6c92\u6709\u7b2c\u56db\u6b65\u4e86\u3002<strong>\u4f60\u525b\u525b\u5df2\u7d93\u5c07\u7b2c\u4e00\u500b React component \u52a0\u5165\u5230\u4f60\u7684\u7db2\u9801\u4e0a\u3002</strong></p>\n<p>\u67e5\u770b\u5f8c\u7e8c\u7684\u7ae0\u7bc0\u4e86\u89e3\u66f4\u591a\u6709\u95dc\u63a1\u7528 React \u7684\u63d0\u793a\u3002</p>\n<p><strong><a class=\"external-link\" href=\"https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605\">\u6309\u9019\u88e1\u770b\u5b8c\u6574\u7bc4\u4f8b\u7684\u7a0b\u5f0f\u78bc</a></strong></p>\n<p><strong><a class=\"external-link\" href=\"https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605/archive/87f0b6f34238595b44308acfb86df6ea43669c08.zip\">\u4e0b\u8f09\u5b8c\u6574\u7bc4\u4f8b (2KB zipped)</a></strong></p>\n<h3 id=\"tip-reuse-a-component\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#tip-reuse-a-component\"></a>\u63d0\u793a\uff1a\u91cd\u7528 Component </h3>\n<p>\u901a\u5e38\uff0c\u4f60\u6703\u60f3\u628a React component \u5c55\u793a\u5728 HTML \u7db2\u9801\u4e0a\u7684\u4e0d\u540c\u5730\u65b9\u3002\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u662f\u5c55\u793a\u6211\u5011\u7684\u300cLike\u300d\u6309\u9215\u4e09\u6b21\uff0c\u518d\u5404\u81ea\u50b3\u9001\u8cc7\u6599\u7d66\u5b83\u5011\uff1a</p>\n<p><a class=\"external-link\" href=\"https://gist.github.com/gaearon/faa67b76a6c47adbab04f739cba7ceda\">\u6309\u9019\u88e1\u770b\u5b8c\u6574\u7bc4\u4f8b\u7684\u7a0b\u5f0f\u78bc</a></p>\n<p><a class=\"external-link\" href=\"https://gist.github.com/gaearon/faa67b76a6c47adbab04f739cba7ceda/archive/279839cb9891bd41802ebebc5365e9dec08eeb9f.zip\">\u4e0b\u8f09\u5b8c\u6574\u7bc4\u4f8b (2KB zipped)</a></p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u7576\u7db2\u9801\u4e0a\u4ee5 React \u9a45\u52d5\u7684\u90e8\u5206\u662f\u4e92\u76f8\u7368\u7acb\u7684\u6642\u5019\uff0c\u9019\u7a2e\u7b56\u7565\u6703\u975e\u5e38\u6709\u7528\u3002\u5728 React \u7684\u7a0b\u5f0f\u78bc\u88e1\uff0c\u4f7f\u7528 <a href=\"/react/components-and-props#composing-components\">component composition</a> \u6703\u53cd\u800c\u6bd4\u8f03\u5bb9\u6613\u3002</p>\n</div>\n<h3 id=\"tip-minify-javascript-for-production\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#tip-minify-javascript-for-production\"></a>\u63d0\u793a\uff1a\u70ba\u7dda\u4e0a\u74b0\u5883\u58d3\u7e2e JavaScript  </h3>\n<p>\u5728\u90e8\u7f72\u4f60\u7684\u7db2\u9801\u5230\u7dda\u4e0a\u74b0\u5883\u4e4b\u524d\uff0c\u8981\u7559\u610f\u6c92\u58d3\u7e2e\u7684 JavaScript \u6703\u660e\u986f\u7684\u6e1b\u6162\u4f7f\u7528\u8005\u8f09\u5165\u7db2\u9801\u7684\u901f\u5ea6\u3002</p>\n<p>\u5982\u679c\u4f60\u5df2\u7d93\u58d3\u7e2e\u4e86\u61c9\u7528\u7a0b\u5f0f\u7684 scripts\uff0c\u800c\u4e14\u78ba\u4fdd\u4e86\u4f60\u767c\u4f48\u7684 HTML \u662f\u8f09\u5165\u4e86\u4ee5 <code class=\"language-javascript\">production.min.js</code> \u7d50\u5c3e\u7684 React \u7248\u672c\uff0c\u90a3\u9ebc<strong>\u4f60\u7684\u7db2\u9801\u5df2\u7d93\u767c\u4f48\u5c31\u7dd2</strong>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react@18/umd/react.production.min.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react-dom@18/umd/react-dom.production.min.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5982\u679c\u4f60\u6c92\u6709\u4e00\u500b\u70ba\u4f60\u7684 scripts \u9032\u884c\u58d3\u7e2e\u7684\u6b65\u9a5f\uff0c<a class=\"external-link\" href=\"https://gist.github.com/gaearon/42a2ffa41b8319948f9be4076286e1f3\">\u9019\u88e1\u6709\u500b\u65b9\u6cd5\u8a2d\u5b9a</a>\u3002</p>\n<h2 id=\"optional-try-react-with-jsx\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#optional-try-react-with-jsx\"></a>\u53ef\u9078\uff1a\u5617\u8a66 React \u8207 JSX </h2>\n<p>\u4e0a\u9762\u6240\u63a5\u89f8\u7684\u7bc4\u4f8b\uff0c\u6211\u5011\u53ea\u501a\u9760\u7740\u700f\u89bd\u5668\u81ea\u8eab\u6240\u652f\u63f4\u7684\u7279\u6027\u3002\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u6211\u5011\u6703\u7528\u4e00\u500b JavaScript function call \u4f86\u544a\u8a34 React \u8981\u5c55\u793a\u4ec0\u9ebc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> e <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>createElement<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// \u5c55\u793a\u4e00\u500b\u300cLike\u300d&lt;button&gt;</span>\n<span class=\"token keyword\">return</span> <span class=\"token function\">e</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'button'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token function-variable function\">onClick</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">liked</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Like'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4e0d\u904e\uff0cReact \u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b\u4f7f\u7528 <a href=\"/react/introducing-jsx\">JSX</a> \u7684\u9078\u64c7\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u5c55\u793a\u4e00\u500b\u300cLike\u300d&lt;button&gt;</span>\n<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">liked</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    Like\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u5169\u6bb5\u7684\u7a0b\u5f0f\u78bc\u662f\u7b49\u540c\u7684\u3002\u96d6\u7136 <strong>JSX \u662f<a href=\"/react/react-without-jsx\">\u5b8c\u5168\u53ef\u9078\u7684</a></strong>\uff0c\u4f46\u8a31\u591a\u4eba\u4e5f\u89ba\u5f97\u5b83\u6709\u52a9\u7de8\u5beb UI \u7a0b\u5f0f\u78bc \u2014\u2014 \u7121\u8ad6\u662f\u4f7f\u7528 React \u6216\u5176\u4ed6\u51fd\u5f0f\u5eab\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528<a class=\"external-link\" href=\"https://babeljs.io/en/repl#?babili=false&amp;browsers=&amp;build=&amp;builtIns=false&amp;spec=false&amp;loose=false&amp;code_lz=DwIwrgLhD2B2AEcDCAbAlgYwNYF4DeAFAJTw4B88EAFmgM4B0tAphAMoQCGETBe86WJgBMAXJQBOYJvAC-RGWQBQ8FfAAyaQYuAB6cFDhkgA&amp;debug=false&amp;forceAllTransforms=false&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=false&amp;fileSize=false&amp;timeTravel=false&amp;sourceType=module&amp;lineWrap=true&amp;presets=es2015%2Creact%2Cstage-2&amp;prettier=false&amp;targets=&amp;version=7.15.7\">\u9019\u500b\u7dda\u4e0a\u8f49\u63db\u5668</a> \u4f86\u5617\u8a66 JSX\u3002</p>\n<h3 id=\"quickly-try-jsx\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#quickly-try-jsx\"></a>\u5feb\u901f\u5617\u8a66 JSX </h3>\n<p>\u5728\u4f60\u7684\u9805\u76ee\u4e2d\uff0c\u5617\u8a66 JSX \u6700\u5feb\u7684\u65b9\u6cd5\u5c31\u662f\u5c07\u9019\u500b <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u52a0\u5165\u4f60\u7684\u7db2\u9801\u4e0a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/babel-standalone@6/babel.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u73fe\u5728\u4f60\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55 <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u88e1\u4f7f\u7528 JSX\uff0c\u65b9\u6cd5\u5c31\u662f\u70ba\u5b83\u5011\u52a0\u4e0a <code class=\"language-javascript\">type=\"text/babel\"</code> \u7684 attribute\u3002\u9019\u88e1\u662f\u500b <a class=\"external-link\" href=\"https://raw.githubusercontent.com/reactjs/reactjs.org/master/static/html/single-file-example.html\">HTML \u6587\u4ef6\u8207 JSX \u7684\u7bc4\u4f8b</a>\uff0c\u4f60\u53ef\u4ee5\u4e0b\u8f09\u4f86\u5617\u8a66\u4e00\u4e0b\u3002</p>\n<p>\u73fe\u5728\u4f60\u53ef\u4ee5\u900f\u904e\u52a0\u5165 <code class=\"language-javascript\">type=\"text/babel\"</code> attribute \u5728\u4efb\u4f55 <code class=\"language-javascript\">&lt;script&gt;</code> tag \u4e2d\u4f7f\u7528 JSX\u3002\u9019\u88e1\u662f<a class=\"external-link\" href=\"https://raw.githubusercontent.com/reactjs/reactjs.org/main/static/html/single-file-example.html\">\u4e00\u500b\u5e36\u6709 JSX \u7684 HTML \u7bc4\u4f8b</a>\uff0c\u4f60\u53ef\u4ee5\u4e0b\u8f09\u4e26\u4e14\u8a66\u8a66\u770b\u3002</p>\n<p>\u9019\u7a2e\u65b9\u5f0f\u6700\u9069\u5408\u7528\u4f86\u5b78\u7fd2\u548c\u5efa\u7acb\u7c21\u55ae\u7684\u793a\u7bc4\u3002\u7136\u800c\uff0c\u5b83\u6703\u4ee4\u4f60\u7684\u7db2\u9801\u8b8a\u6162\uff0c\u800c\u4e14\u4e26<strong>\u4e0d\u9069\u5408\u767c\u4f48\u5230\u7dda\u4e0a\u74b0\u5883</strong>\u3002\u7576\u4f60\u6e96\u5099\u597d\u5230\u4e0b\u4e00\u6b65\uff0c\u8acb\u79fb\u9664\u6389\u4f60\u525b\u52a0\u5165\u7684 <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u548c <code class=\"language-javascript\">type=\"text/babel\"</code> attribute\u3002\u5728\u4e0b\u4e00\u500b\u7ae0\u7bc0\uff0c\u4f60\u6703\u8a2d\u5b9a\u4e00\u500b JSX preprocessor \u4f86\u81ea\u52d5\u8f49\u63db\u6240\u6709\u7684 <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u3002</p>\n<h3 id=\"add-jsx-to-a-project\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#add-jsx-to-a-project\"></a>\u5c07 JSX \u52a0\u5165\u5230\u9805\u76ee </h3>\n<p>\u5c07 JSX \u52a0\u5165\u5230\u9805\u76ee\u88e1\u4e26\u4e0d\u9700\u8981\u8907\u96dc\u7684\u5de5\u5177\uff0c\u4f8b\u5982\u4e00\u500b bundler \u6216\u958b\u767c\u4f3a\u670d\u5668\u3002\u672c\u8cea\u4e0a\uff0c\u52a0\u5165 JSX <strong>\u5c31\u50cf\u52a0\u5165\u4e00\u500b CSS preprocessor\u3002</strong>\u9019\u53ea\u9700\u8981\u4f60\u5b89\u88dd <a class=\"external-link\" href=\"https://nodejs.org/\">Node.js</a> \u5230\u4f60\u7684\u96fb\u8166\u88e1\u3002</p>\n<p>\u5728 terminal \u8f49\u5230\u4f60\u7684\u9805\u76ee\u6587\u4ef6\u593e\u88e1\uff0c\u518d\u8cbc\u4e0a\u4ee5\u4e0b\u7684\u5169\u884c\u6307\u4ee4\uff1a</p>\n<ol>\n<li><strong>\u7b2c\u4e00\u6b65\uff1a</strong> \u57f7\u884c  <code class=\"language-javascript\">npm init -y</code>\uff08\u5982\u679c\u5931\u6557\u4e86\uff0c<a class=\"external-link\" href=\"https://gist.github.com/gaearon/246f6380610e262f8a648e3e51cad40d\">\u9019\u88e1\u6709\u65b9\u6cd5\u89e3\u6c7a</a>\uff09</li>\n<li><strong>\u7b2c\u4e8c\u6b65\uff1a</strong> \u57f7\u884c  <code class=\"language-javascript\">npm install babel-cli@6 babel-preset-react-app@3</code></li>\n</ol>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u6211\u5011<strong>\u53ea\u4f7f\u7528 npm \u4f86\u5b89\u88dd JSX preprocessor</strong>\uff0c\u4e4b\u5f8c\u4f60\u4e26\u4e0d\u518d\u9700\u8981\u5b83\u3002React \u548c\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u78bc\u90fd\u53ef\u4ee5\u7559\u5728<code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u88e1\uff0c\u4e26\u4e0d\u9700\u8981\u9032\u884c\u4fee\u6539\u3002</p>\n</div>\n<p>\u606d\u559c\u4f60\uff01\u4f60\u525b\u525b\u70ba\u4f60\u7684\u9805\u76ee\u52a0\u5165\u4e86<strong>\u767c\u4f48\u5c31\u7dd2\u7684 JSX \u8a2d\u5b9a</strong>\u4e86\u3002</p>\n<h3 id=\"run-jsx-preprocessor\"><a class=\"anchor\" href=\"/react/add-react-to-a-website#run-jsx-preprocessor\"></a>\u57f7\u884c JSX Preprocessor </h3>\n<p>\u5efa\u7acb\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">src</code> \u7684\u6587\u4ef6\u593e\uff0c\u7136\u5f8c\u57f7\u884c\u9019\u500b\u7d42\u7aef\u6307\u4ee4\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-console\"><code class=\"language-javascript\">npx babel --watch src --out-dir . --presets react-app/prod</code></pre></div>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p><code class=\"language-javascript\">npx</code> \u4e0d\u662f\u62fc\u5beb\u932f\u8aa4 \u2014\u2014 \u5b83\u662f\u4e00\u500b <a class=\"external-link\" href=\"https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b\">npm 5.2+ \u9644\u5e36\u7684 package \u57f7\u884c\u5668</a>\u3002</p>\n<p>\u5982\u679c\u4f60\u770b\u898b\u4e00\u500b\u5beb\u7740\u300cYou have mistakenly installed the <code class=\"language-javascript\">babel</code> package\u300d\u7684\u932f\u8aa4\u8a0a\u606f\uff0c\u4f60\u6216\u8a31\u8df3\u904e\u4e86<a href=\"/react/add-react-to-a-website#add-jsx-to-a-project\">\u4e0a\u4e00\u6b65</a>\u3002\u5728\u540c\u4e00\u500b\u6587\u4ef6\u593e\u88e1\u57f7\u884c\u5b83\uff0c\u7136\u5f8c\u518d\u91cd\u65b0\u5617\u8a66\u3002</p>\n</div>\n<p>\u8acb\u4e0d\u8981\u7b49\u5f85\u5b83\u5b8c\u6210 \u2014\u2014 \u9019\u500b\u6307\u4ee4\u6703\u555f\u52d5\u4e00\u500b JSX \u81ea\u52d5\u76e3\u6e2c\u5668\u3002</p>\n<p>\u5982\u679c\u4f60\u73fe\u5728\u5229\u7528\u9019\u500b <strong><a class=\"external-link\" href=\"https://gist.github.com/gaearon/c8e112dc74ac44aac4f673f2c39d19d1/raw/09b951c86c1bf1116af741fa4664511f2f179f0a/like_button.js\">JSX starter code</a></strong> \u5efa\u7acb\u4e00\u500b\u540d\u70ba\u7684 <code class=\"language-javascript\">src/like_button.js</code> \u6587\u4ef6\uff0c\u76e3\u6e2c\u5668\u6703\u5efa\u7acb\u4e00\u500b\u9810\u5148\u8655\u7406\u904e\uff0c\u7531\u666e\u901a JavaScript \u7a0b\u5f0f\u78bc\u7d44\u6210\uff0c\u4e26\u4e14\u9069\u5408\u700f\u89bd\u5668\u8f09\u5165\u7684 <code class=\"language-javascript\">like_button.js</code>\u3002\u7576\u4f60\u4f7f\u7528 JSX \u4f86\u7de8\u8f2f\u6587\u4ef6\u6642\uff0c\u8f49\u63db\u904e\u7a0b\u6703\u81ea\u52d5\u91cd\u65b0\u57f7\u884c\u3002</p>\n<p>\u518d\u8005\uff0c\u9019\u4e5f\u5bb9\u8a31\u6211\u5011\u5728\u820a\u700f\u89bd\u5668\u4e0a\uff0c\u4f7f\u7528\u73fe\u4ee3 JavaScript \u7684\u8a9e\u6cd5\u7279\u6027\uff0c\u4f8b\u5982 class\u3002\u6211\u5011\u525b\u52a0\u5165\u7684\u5de5\u5177\u53eb Babel\uff0c\u4f60\u53ef\u4ee5\u5728<a class=\"external-link\" href=\"https://babeljs.io/docs/en/babel-cli/\">\u5b83\u7684\u5b98\u65b9\u6587\u4ef6</a>\u88e1\u4e86\u89e3\u66f4\u591a\u3002</p>\n<p>\u5982\u679c\u4f60\u767c\u73fe\u81ea\u5df1\u7fd2\u6163\u4e86\u4f7f\u7528\u5404\u7a2e\u5efa\u7acb\u5de5\u5177\uff0c\u800c\u4e14\u5e0c\u671b\u5b83\u5011\u70ba\u4f60\u505a\u66f4\u591a\uff0c<a href=\"/react/create-a-new-react-app\">\u4e0b\u4e00\u500b\u7ae0\u7bc0</a>\u6703\u4ecb\u7d39\u4e00\u4e9b\u53d7\u6b61\u8fce\u548c\u5bb9\u6613\u4e0a\u624b\u7684 toolchains\u3002\u4e0d\u904e\uff0c\u53ea\u5229\u7528 script \u6a19\u7c64\u4e5f\u6e38\u5203\u6709\u9918\uff01</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/add-react-to-a-website.md\">Edit this page</a></p></div></article>", "path": "/react/add-react-to-a-website", "nav": ["/react/getting-started", "/react/create-a-new-react-app"]}, {"key": "\u5efa\u7acb\u5168\u65b0\u7684 React \u61c9\u7528\u7a0b\u5f0f", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u4f7f\u7528\u6574\u5408\u7684 toolchain \u4ee5\u5f97\u5230\u6700\u4f73\u7684\u4f7f\u7528\u8005\u548c\u958b\u767c\u8005\u9ad4\u9a57\u3002</p>\n<p>\u672c\u9801\u5c07\u4ecb\u7d39\u4e00\u4e9b\u53d7\u6b61\u8fce\u7684 React toolchain\uff0c\u5b83\u5011\u6709\u52a9\u65bc\u4ee5\u4e0b\u7684\u5de5\u4f5c\uff1a</p>\n<ul>\n<li>\u64f4\u5927\u6587\u4ef6\u548c component \u7684\u898f\u6a21\u3002</li>\n<li>\u4f7f\u7528\u4f86\u81f3 npm \u7684\u7b2c\u4e09\u65b9\u51fd\u5f0f\u5eab\u3002</li>\n<li>\u5075\u6e2c\u65e9\u671f\u5e38\u898b\u7684\u932f\u8aa4\u3002</li>\n<li>\u5be6\u6642\u5728\u958b\u767c\u74b0\u5883\u88e1\u7de8\u8f2f CSS \u548c JS\u3002</li>\n<li>\u6700\u4f73\u5316\u7dda\u4e0a\u74b0\u5883\u8f38\u51fa\u3002</li>\n</ul>\n<p>\u672c\u9801\u6240\u5efa\u8b70\u7684 toolchain \u90fd<strong>\u4e0d\u9700\u8981\u9032\u884c\u4efb\u4f55\u8a2d\u5b9a\u5c31\u80fd\u958b\u59cb\u4f7f\u7528</strong>\u3002</p>\n<h2 id=\"you-might-not-need-a-toolchain\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#you-might-not-need-a-toolchain\"></a>\u4f60\u53ef\u80fd\u4e0d\u9700\u8981 Toolchain </h2>\n<p>\u5982\u679c\u4f60\u6c92\u6709\u78b0\u5230\u4ee5\u4e0a\u6240\u63d0\u5230\u7684\u554f\u984c\uff0c\u6216\u8005\u9084\u6c92\u6709\u7fd2\u6163\u4f7f\u7528 JavaScript \u7684\u5de5\u5177\uff0c\u4f60\u53ef\u4ee5\u8003\u616e<a href=\"/react/add-react-to-a-website\">\u5728 HTML \u7db2\u9801\u88e1\u52a0\u4e0a <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u4f86\u4f7f\u7528 React</a>\uff0c\u4ee5\u53ca<a href=\"/react/add-react-to-a-website#optional-try-react-with-jsx\">\u4f7f\u7528\u53ef\u9078\u7684 JSX</a>\u3002</p>\n<p>\u9019\u4e5f\u662f<strong>\u5c07 React \u52a0\u4e0a\u5230\u73fe\u5b58\u7db2\u9801\u88e1\u6700\u7c21\u55ae\u7684\u65b9\u6cd5</strong>\u3002\u7576\u4f60\u89ba\u5f97\u4f7f\u7528\u5927\u578b\u7684 toolchain \u5c0d\u4f60\u6709\u5e6b\u52a9\uff0c\u4f60\u4e5f\u53ef\u4ee5\u96a8\u6642\u628a\u5b83\u5011\u52a0\u5165\uff01</p>\n<h2 id=\"recommended-toolchains\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#recommended-toolchains\"></a>\u63a8\u85a6\u7684 Toolchain </h2>\n<p>React \u5718\u968a\u4e3b\u8981\u63a8\u85a6\u4ee5\u4e0b\u7684\u65b9\u6848\uff1a</p>\n<ul>\n<li>\u5982\u679c\u4f60\u6b63\u5728<strong>\u5b78\u7fd2 React</strong> \u6216<strong>\u5efa\u7acb\u5168\u65b0\u7684 single-page \u61c9\u7528\u7a0b\u5f0f</strong>\uff0c\u8acb\u4f7f\u7528 <a href=\"/react/create-a-new-react-app#create-react-app\">Create React App</a>\u3002</li>\n<li>\u5982\u679c\u4f60\u6b63\u5728\u5efa\u7acb\u4e00\u500b<strong>\u4f7f\u7528 Node.js \u7684 server-rendered \u7db2\u9801</strong>\uff0c\u8acb\u4f7f\u7528 <a href=\"/react/create-a-new-react-app#nextjs\">Next.js</a>\u3002</li>\n<li>\u5982\u679c\u4f60\u6b63\u5728\u5efa\u7acb\u4e00\u500b<strong>\u975c\u614b\u5167\u5bb9\u7684\u7db2\u9801</strong>\uff0c\u8acb\u4f7f\u7528 <a href=\"/react/create-a-new-react-app#gatsby\">Gatsby</a>\u3002</li>\n<li>\u5982\u679c\u4f60\u6b63\u5728\u5efa\u7acb\u4e00\u500b <strong>component \u51fd\u5f0f\u5eab</strong>\u6216<strong>\u8207\u73fe\u5b58\u7a0b\u5f0f\u78bc\u5009\u5eab\u9032\u884c\u63a5\u8ecc</strong>\uff0c\u8acb\u4f7f\u7528<a href=\"/react/create-a-new-react-app#more-flexible-toolchains\">\u66f4\u9748\u6d3b\u7684 Toolchain</a>\u3002</li>\n</ul>\n<h3 id=\"create-react-app\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#create-react-app\"></a>Create React App </h3>\n<p><a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a> \u662f\u4e00\u500b\u9069\u5408<strong>\u5b78\u7fd2 React</strong> \u7684\u74b0\u5883\uff0c\u800c\u4e14\u4e5f\u662f\u4f7f\u7528 React \u5efa\u7acb\u4e00\u500b<strong>\u5168\u65b0\u7684 <a href=\"/react/glossary#single-page-application\">single-page</a> \u61c9\u7528\u7a0b\u5f0f</strong>\u7684\u6700\u4f73\u65b9\u6cd5\u3002</p>\n<p>\u5b83\u6703\u70ba\u4f60\u8a2d\u5b9a\u597d\u958b\u767c\u74b0\u5883\uff0c\u4ee5\u4fbf\u4f60\u80fd\u5920\u4f7f\u7528\u6700\u65b0\u7684 JavaScript \u7279\u6027\uff0c\u63d0\u4f9b\u826f\u597d\u7684\u958b\u767c\u8005\u9ad4\u9a57\uff0c\u4e26\u4e14\u70ba\u7dda\u4e0a\u74b0\u5883\u6700\u4f73\u5316\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u3002\u4f60\u9700\u8981\u5728\u4f60\u7684\u6a5f\u5668\u4e0a\u5b89\u88dd <a class=\"external-link\" href=\"https://nodejs.org/en/\">Node &gt;= 14.0.0 and npm &gt;= 5.6</a>\u3002\u8981\u5efa\u7acb\u9805\u76ee\uff0c\u8acb\u57f7\u884c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\">npx create-react-app my-app\n<span class=\"token builtin class-name\">cd</span> my-app\n<span class=\"token function\">npm</span> start</code></pre></div>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p><code class=\"language-javascript\">npx</code> \u4e0d\u662f\u62fc\u5beb\u932f\u8aa4 \u2014\u2014 \u5b83\u662f\u4e00\u500b <a class=\"external-link\" href=\"https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b\">npm 5.2+ \u9644\u5e36\u7684 package \u57f7\u884c\u5668</a>\u3002</p>\n</div>\n<p>Create React App \u4e26\u4e0d\u6703\u8655\u7406 backend \u908f\u8f2f\u6216\u8cc7\u6599\u5eab\uff1b\u5b83\u53ea\u6703\u5efa\u7acb\u4e00\u500b frontend build pipeline\uff0c\u4ee5\u4fbf\u4f60\u914d\u5408\u4efb\u4f55 backend \u4f86\u4f7f\u7528\u3002\u57fa\u672c\u4e0a\uff0c\u5b83\u662f\u4f7f\u7528 <a class=\"external-link\" href=\"https://babeljs.io/\">Babel</a> \u548c <a class=\"external-link\" href=\"https://webpack.js.org/\">webpack</a>\uff0c\u4f46\u4f60\u4e0d\u9700\u8981\u4e86\u89e3\u4efb\u4f55\u95dc\u65bc\u5b83\u5011\u7684\u7d30\u7bc0\u3002</p>\n<p>\u7576\u4f60\u6e96\u5099\u597d\u767c\u4f48\u5230\u7dda\u4e0a\u74b0\u5883\uff0c\u57f7\u884c <code class=\"language-javascript\">npm run build</code> \u6703\u5728 <code class=\"language-javascript\">build</code> \u6587\u4ef6\u593e\u88e1\u5efa\u7acb\u4e00\u500b\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u7684\u6700\u4f73\u5316\u7248\u672c\uff0c\u4f60\u53ef\u4ee5\u5f9e Create React App \u7684 <a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app#create-react-app--\">README</a> \u548c <a class=\"external-link\" href=\"https://facebook.github.io/create-react-app/\">\u4f7f\u7528\u8005\u6307\u5357</a>\u4e86\u89e3\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"nextjs\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#nextjs\"></a>Next.js </h3>\n<p><a class=\"external-link\" href=\"https://nextjs.org/\">Next.js</a> \u662f\u4e00\u500b\u53d7\u6b61\u8fce\u548c\u8f15\u91cf\u7684\u6846\u67b6\uff0c\u7528\u65bc\u4f7f\u7528 React \u6240\u5efa\u7acb\u7684<strong>\u975c\u614b\u548c server-rendered \u7684\u61c9\u7528\u7a0b\u5f0f</strong>\u3002\u5b83\u81ea\u8eab\u5df2\u5305\u62ec\u4e86 <strong>styling \u548c routing \u7684\u65b9\u6848</strong>\uff0c\u800c\u4e14\u5b83\u5047\u8a2d\u4f60\u5728\u4f7f\u7528 <a class=\"external-link\" href=\"https://nodejs.org/\">Node.js</a> \u4f5c\u70ba\u4f3a\u670d\u5668\u74b0\u5883\u3002</p>\n<p>\u5f9e <a class=\"external-link\" href=\"https://nextjs.org/learn/\">Next.js \u7684\u5b98\u65b9\u6307\u5357</a>\u4e86\u89e3\u66f4\u591a\u3002</p>\n<h3 id=\"gatsby\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#gatsby\"></a>Gatsby </h3>\n<p><a class=\"external-link\" href=\"https://www.gatsbyjs.org/\">Gatsby</a> \u662f\u4f7f\u7528 React \u5efa\u7acb<strong>\u975c\u614b\u7db2\u9801</strong>\u7684\u6700\u4f73\u65b9\u6cd5\u3002\u5b83\u8b93\u4f60\u4f7f\u7528 React component\uff0c\u4f46\u6703\u8f38\u51fa pre-rendered HTML \u548c CSS \u4f86\u4fdd\u8b49\u6700\u5feb\u7684\u8f09\u5165\u6642\u9593\u3002</p>\n<p>\u5f9e <a class=\"external-link\" href=\"https://www.gatsbyjs.org/docs/\">Gatsby \u7684\u5b98\u65b9\u6307\u5357</a>\u548c <a class=\"external-link\" href=\"https://www.gatsbyjs.org/docs/gatsby-starters/\">starter kit \u7bc4\u4f8b\u96c6</a>\u4e86\u89e3\u66f4\u591a\u3002</p>\n<h3 id=\"more-flexible-toolchains\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#more-flexible-toolchains\"></a>\u66f4\u9748\u6d3b\u7684 Toolchain </h3>\n<p>\u4ee5\u4e0b\u7684 toolchain \u6703\u63d0\u4f9b\u66f4\u591a\u7684\u9748\u6d3b\u6027\u548c\u9078\u64c7\u3002\u6211\u5011\u63a8\u85a6\u7d66\u6bd4\u8f03\u6709\u7d93\u9a57\u7684\u4f7f\u7528\u8005\uff1a</p>\n<ul>\n<li><strong><a class=\"external-link\" href=\"https://neutrinojs.org/\">Neutrino</a></strong> \u7d50\u5408\u4e86 <a class=\"external-link\" href=\"https://webpack.js.org/\">webpack</a> \u5f37\u5927\u7684\u529f\u80fd\u8207\u7c21\u55ae\u7684\u9810\u8a2d\uff0c\u4e26\u5305\u62ec\u4e86 <a class=\"external-link\" href=\"https://neutrinojs.org/packages/react/\">React \u61c9\u7528\u7a0b\u5f0f</a>\u548c <a class=\"external-link\" href=\"https://neutrinojs.org/packages/react-components/\">React component</a> \u7684\u9810\u8a2d\u3002</li>\n<li><strong><a class=\"external-link\" href=\"https://nx.dev/react\">Nx</a></strong> \u662f\u4e00\u5957\u7528\u65bc full-stack monorepo \u958b\u767c\u7684 toolkit\uff0c\u5167\u5efa\u652f\u63f4 React\u3001Next.js\u3001<a class=\"external-link\" href=\"https://expressjs.com/\">Express</a> \u4ee5\u53ca\u66f4\u591a\u3002</li>\n<li><strong><a class=\"external-link\" href=\"https://parceljs.org/\">Parcel</a></strong> \u662f\u4e00\u500b\u5feb\u901f\u3001\u96f6\u8a2d\u5b9a\u7684\u7db2\u8def\u61c9\u7528\u7a0b\u5f0f bundler\uff0c\u4e26\u4e14<a class=\"external-link\" href=\"https://parceljs.org/recipes/react/\">\u53ef\u4ee5\u914d\u5408 React</a> \u4e00\u8d77\u4f7f\u7528\u3002</li>\n<li><strong><a class=\"external-link\" href=\"https://github.com/jaredpalmer/razzle\">Razzle</a></strong> \u662f\u4e00\u500b\u4e0d\u9700\u8981\u8a2d\u5b9a\u7684 server-rendering \u6846\u67b6\uff0c\u4f46\u5b83\u6bd4 Next.js \u63d0\u4f9b\u66f4\u591a\u7684\u9748\u6d3b\u6027\u3002</li>\n</ul>\n<h2 id=\"creating-a-toolchain-from-scratch\"><a class=\"anchor\" href=\"/react/create-a-new-react-app#creating-a-toolchain-from-scratch\"></a>\u5f9e\u96f6\u958b\u59cb\u5efa\u7acb Toolchain </h2>\n<p>\u4e00\u500b JavaScript \u7684\u5efa\u7acb toolchain \u901a\u5e38\u5305\u62ec\uff1a</p>\n<ul>\n<li>\u4e00\u500b <strong>package \u7ba1\u7406\u54e1</strong>\uff0c\u4f8b\u5982 <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a> \u6216 <a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a>\u3002\u5b83\u80fd\u8b93\u4f60\u5145\u5206\u5229\u7528\u6578\u91cf\u9f90\u5927\u7684\u7b2c\u4e09\u65b9 package\uff0c\u4e26\u4e14\u8f15\u9b06\u7684\u5b89\u88dd\u6216\u66f4\u65b0\u5b83\u5011\u3002</li>\n<li>\u4e00\u500b <strong>bundler</strong>\uff0c\u4f8b\u5982 <a class=\"external-link\" href=\"https://webpack.js.org/\">webpack</a> \u6216 <a class=\"external-link\" href=\"https://parceljs.org/\">Parcel</a>\u3002\u5b83\u80fd\u8b93\u4f60\u7de8\u5beb\u6a21\u7d44\u5316\u7684\u7a0b\u5f0f\u78bc\uff0c\u4e26\u5c07\u5b83\u5011\u7d44\u5408\u6210\u5c0f\u5c0f\u7684 package \u4ee5\u6700\u4f73\u5316\u8f09\u5165\u6642\u9593\u3002</li>\n<li>\u4e00\u500b <strong>compiler</strong>\uff0c\u4f8b\u5982 <a class=\"external-link\" href=\"https://babeljs.io/\">Babel</a>\u3002\u5b83\u80fd\u8b93\u4f60\u7de8\u5beb\u73fe\u4ee3 JavaScript \u7a0b\u5f0f\u78bc\uff0c\u4e26\u53ef\u4ee5\u5728\u820a\u7248\u672c\u7684\u700f\u89bd\u5668\u88e1\u4f7f\u7528\u3002</li>\n</ul>\n<p>\u5982\u679c\u4f60\u50be\u5411\u5f9e\u96f6\u958b\u59cb\u8a2d\u5b9a\u5c6c\u65bc\u81ea\u5df1\u7684 JavaScript toolchain\uff0c\u8acb<a class=\"external-link\" href=\"https://blog.usejournal.com/creating-a-react-app-from-scratch-f3c693b84658\">\u67e5\u770b\u9019\u6307\u5357</a>\uff0c\u5b83\u6703\u91cd\u65b0\u5efa\u7acb\u4e00\u4e9b Create React App \u7684\u529f\u80fd\u3002</p>\n<p>\u5225\u5fd8\u4e86\u78ba\u4fdd\u4f60\u7684\u81ea\u8a02 toolchain \u6709<a href=\"/react/optimizing-performance#use-the-production-build\">\u70ba\u7dda\u4e0a\u74b0\u5883\u9032\u884c\u6b63\u78ba\u7684\u8a2d\u5b9a</a>\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/create-a-new-react-app.md\">Edit this page</a></p></div></article>", "path": "/react/create-a-new-react-app", "nav": ["/react/add-react-to-a-website", "/react/cdn-links"]}, {"key": "CDN \u9023\u7d50", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u901a\u904e CDN \u8f09\u5165 React \u548c React DOM\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react@18/umd/react.development.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react-dom@18/umd/react-dom.development.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4ee5\u4e0a\u7684\u7248\u672c\u53ea\u9069\u7528\u65bc\u958b\u767c\u74b0\u5883\uff0c\u4e26\u4e0d\u9069\u5408\u7528\u65bc\u7dda\u4e0a\u74b0\u5883\u3002\u4f60\u53ef\u4ee5\u5728\u4ee5\u4e0b\u627e\u5230\u5df2\u58d3\u7e2e\u548c\u6700\u4f73\u5316\u7684 React \u7dda\u4e0a\u7248\u672c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react@18/umd/react.production.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react-dom@18/umd/react-dom.production.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u8acb\u66f4\u6539\u7248\u672c\u865f\u78bc <code class=\"language-javascript\">18</code> \u4f86\u8f09\u5165\u6307\u5b9a\u7248\u672c\u7684 <code class=\"language-javascript\">react</code> \u548c <code class=\"language-javascript\">react-dom</code>\u3002</p>\n<h3 id=\"why-the-crossorigin-attribute\"><a class=\"anchor\" href=\"/react/cdn-links#why-the-crossorigin-attribute\"></a>\u70ba\u4ec0\u9ebc\u8981\u4f7f\u7528 <code class=\"language-javascript\">crossorigin</code> Attribute? </h3>\n<p>\u5982\u679c\u4f60\u901a\u904e CDN \u8f09\u5165 React\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u4fdd\u7559 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes\"><code class=\"language-javascript\">crossorigin</code></a> \u7684\u8a2d\u5b9a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>...<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u6211\u5011\u4e5f\u5efa\u8b70\u4f60\u9a57\u8b49\u4f60\u6240\u4f7f\u7528\u7684 CDN \u662f\u5426\u8a2d\u5b9a\u4e86 <code class=\"language-javascript\">Access-Control-Allow-Origin: *</code> HTTP header\uff1a</p>\n<p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/89baed0a6540f29e954065ce04661048/13ae7/cdn-cors-header.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/89baed0a6540f29e954065ce04661048/13ae7/cdn-cors-header.png\">Image link</a>\n</span>\n</span>\n</a>\n</p>\n<p>\u9019\u80fd\u70ba React 16 \u6216\u4ee5\u4e0a\u7684\u7248\u672c\u5e36\u4f86\u66f4\u597d\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2017/07/26/error-handling-in-react-16.html\">\u932f\u8aa4\u8655\u7406\u9ad4\u9a57</a>\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/cdn-links.md\">Edit this page</a></p></div></article>", "path": "/react/cdn-links", "nav": ["/react/create-a-new-react-app", "/react/release-channels"]}, {"key": "Release Channels", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React relies on a thriving open source community to file bug reports, open pull requests, and <a class=\"external-link\" href=\"https://github.com/reactjs/rfcs\">submit RFCs</a>. To encourage feedback we sometimes share special builds of React that include unreleased features.</p>\n<div class=\"blockquote\">\n<strong>This document will be most relevant to developers who work on frameworks, libraries, or developer tooling. Developers who use React primarily to build user-facing applications should not need to worry about our prerelease channels.</strong>\n</div>\n<p>Each of React\u2019s release channels is designed for a distinct use case:</p>\n<ul>\n<li><a href=\"/react/release-channels#latest-channel\"><strong>Latest</strong></a> is for stable, semver React releases. It\u2019s what you get when you install React from npm. This is the channel you\u2019re already using today. <strong>Use this for all user-facing React applications.</strong></li>\n<li><a href=\"/react/release-channels#next-channel\"><strong>Next</strong></a> tracks the main branch of the React source code repository. Think of these as release candidates for the next minor semver release. Use this for integration testing between React and third party projects.</li>\n<li><a href=\"/react/release-channels#experimental-channel\"><strong>Experimental</strong></a> includes experimental APIs and features that aren\u2019t available in the stable releases. These also track the main branch, but with additional feature flags turned on. Use this to try out upcoming features before they are released.</li>\n</ul>\n<p>All releases are published to npm, but only Latest uses <a href=\"/react/faq-versioning\">semantic versioning</a>. Prereleases (those in the Next and Experimental channels) have versions generated from a hash of their contents and the commit date, e.g. <code class=\"language-javascript\">0.0.0-68053d940-20210623</code> for Next and <code class=\"language-javascript\">0.0.0-experimental-68053d940-20210623</code> for Experimental.</p>\n<p><strong>The only officially supported release channel for user-facing applications is Latest</strong>. Next and Experimental releases are provided for testing purposes only, and we provide no guarantees that behavior won\u2019t change between releases. They do not follow the semver protocol that we use for releases from Latest.</p>\n<p>By publishing prereleases to the same registry that we use for stable releases, we are able to take advantage of the many tools that support the npm workflow, like <a class=\"external-link\" href=\"https://unpkg.com\">unpkg</a> and <a class=\"external-link\" href=\"https://codesandbox.io\">CodeSandbox</a>.</p>\n<h3 id=\"latest-channel\"><a class=\"anchor\" href=\"/react/release-channels#latest-channel\"></a>Latest Channel </h3>\n<p>Latest is the channel used for stable React releases. It corresponds to the <code class=\"language-javascript\">latest</code> tag on npm. It is the recommended channel for all React apps that are shipped to real users.</p>\n<p><strong>If you\u2019re not sure which channel you should use, it\u2019s Latest.</strong> If you\u2019re a React developer, this is what you\u2019re already using.</p>\n<p>You can expect updates to Latest to be extremely stable. Versions follow the semantic versioning scheme. Learn more about our commitment to stability and incremental migration in our <a href=\"/react/faq-versioning\">versioning policy</a>.</p>\n<h3 id=\"next-channel\"><a class=\"anchor\" href=\"/react/release-channels#next-channel\"></a>Next Channel </h3>\n<p>The Next channel is a prerelease channel that tracks the main branch of the React repository. We use prereleases in the Next channel as release candidates for the Latest channel. You can think of Next as a superset of Latest that is updated more frequently.</p>\n<p>The degree of change between the most recent Next release and the most recent Latest release is approximately the same as you would find between two minor semver releases. However, <strong>the Next channel does not conform to semantic versioning.</strong> You should expect occasional breaking changes between successive releases in the Next channel.</p>\n<p><strong>Do not use prereleases in user-facing applications.</strong></p>\n<p>Releases in Next are published with the <code class=\"language-javascript\">next</code> tag on npm. Versions are generated from a hash of the build\u2019s contents and the commit date, e.g. <code class=\"language-javascript\">0.0.0-68053d940-20210623</code>.</p>\n<h4 id=\"using-the-next-channel-for-integration-testing\"><a class=\"anchor\" href=\"/react/release-channels#using-the-next-channel-for-integration-testing\"></a>Using the Next Channel for Integration Testing </h4>\n<p>The Next channel is designed to support integration testing between React and other projects.</p>\n<p>All changes to React go through extensive internal testing before they are released to the public. However, there are a myriad of environments and configurations used throughout the React ecosystem, and it\u2019s not possible for us to test against every single one.</p>\n<p>If you\u2019re the author of a third party React framework, library, developer tool, or similar infrastructure-type project, you can help us keep React stable for your users and the entire React community by periodically running your test suite against the most recent changes. If you\u2019re interested, follow these steps:</p>\n<ul>\n<li>Set up a cron job using your preferred continuous integration platform. Cron jobs are supported by both <a class=\"external-link\" href=\"https://circleci.com/docs/2.0/triggers/#scheduled-builds\">CircleCI</a> and <a class=\"external-link\" href=\"https://docs.travis-ci.com/user/cron-jobs/\">Travis CI</a>.</li>\n<li>\n<p>In the cron job, update your React packages to the most recent React release in the Next channel, using <code class=\"language-javascript\">next</code> tag on npm. Using the npm cli:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-console\"><code class=\"language-javascript\">npm update react@next react-dom@next</code></pre></div>\n<p>Or yarn:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-console\"><code class=\"language-javascript\">yarn upgrade react@next react-dom@next</code></pre></div>\n</li>\n<li>Run your test suite against the updated packages.</li>\n<li>If everything passes, great! You can expect that your project will work with the next minor React release.</li>\n<li>If something breaks unexpectedly, please let us know by <a class=\"external-link\" href=\"https://github.com/facebook/react/issues\">filing an issue</a>.</li>\n</ul>\n<p>A project that uses this workflow is Next.js. (No pun intended! Seriously!) You can refer to their <a class=\"external-link\" href=\"https://github.com/zeit/next.js/blob/c0a1c0f93966fe33edd93fb53e5fafb0dcd80a9e/.circleci/config.yml\">CircleCI configuration</a> as an example.</p>\n<h3 id=\"experimental-channel\"><a class=\"anchor\" href=\"/react/release-channels#experimental-channel\"></a>Experimental Channel </h3>\n<p>Like Next, the Experimental channel is a prerelease channel that tracks the main branch of the React repository. Unlike Next, Experimental releases include additional features and APIs that are not ready for wider release.</p>\n<p>Usually, an update to Next is accompanied by a corresponding update to Experimental. They are based on the same source revision, but are built using a different set of feature flags.</p>\n<p>Experimental releases may be significantly different than releases to Next and Latest. <strong>Do not use Experimental releases in user-facing applications.</strong> You should expect frequent breaking changes between releases in the Experimental channel.</p>\n<p>Releases in Experimental are published with the <code class=\"language-javascript\">experimental</code> tag on npm. Versions are generated from a hash of the build\u2019s contents and the commit date, e.g. <code class=\"language-javascript\">0.0.0-experimental-68053d940-20210623</code>.</p>\n<h4 id=\"what-goes-into-an-experimental-release\"><a class=\"anchor\" href=\"/react/release-channels#what-goes-into-an-experimental-release\"></a>What Goes Into an Experimental Release? </h4>\n<p>Experimental features are ones that are not ready to be released to the wider public, and may change drastically before they are finalized. Some experiments may never be finalized \u2014 the reason we have experiments is to test the viability of proposed changes.</p>\n<p>For example, if the Experimental channel had existed when we announced Hooks, we would have released Hooks to the Experimental channel weeks before they were available in Latest.</p>\n<p>You may find it valuable to run integration tests against Experimental. This is up to you. However, be advised that Experimental is even less stable than Next. <strong>We do not guarantee any stability between Experimental releases.</strong></p>\n<h4 id=\"how-can-i-learn-more-about-experimental-features\"><a class=\"anchor\" href=\"/react/release-channels#how-can-i-learn-more-about-experimental-features\"></a>How Can I Learn More About Experimental Features? </h4>\n<p>Experimental features may or may not be documented. Usually, experiments aren\u2019t documented until they are close to shipping in Next or Latest.</p>\n<p>If a feature is not documented, they may be accompanied by an <a class=\"external-link\" href=\"https://github.com/reactjs/rfcs\">RFC</a>.</p>\n<p>We will post to the <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog\">React blog</a> when we\u2019re ready to announce new experiments, but that doesn\u2019t mean we will publicize every experiment.</p>\n<p>You can always refer to our public GitHub repository\u2019s <a class=\"external-link\" href=\"https://github.com/facebook/react/commits/main\">history</a> for a comprehensive list of changes.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/release-channels.md\">Edit this page</a></p></div></article>", "path": "/react/release-channels", "nav": ["/react/cdn-links", "/react/hello-world"]}]}, {"key": "\u4e3b\u8981\u6982\u5ff5", "values": [{"key": "1. Hello World", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React \u6700\u7c21\u55ae\u7684\u7bc4\u4f8b\u770b\u8d77\u4f86\u50cf\u662f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u9801\u9762\u4e0a\u986f\u793a\u300cHello, world!\u300d\u3002</p>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/rrpgNB?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u9ede\u64ca\u4e0a\u65b9\u9023\u7d50\u958b\u555f\u7dda\u4e0a\u7de8\u8f2f\u5668\u3002\u8acb\u96a8\u610f\u7684\u8b8a\u66f4\u7a0b\u5f0f\u78bc\u4e26\u89c0\u5bdf\u5b83\u5011\u7684\u8f38\u51fa\u8b8a\u5316\u3002\u9019\u500b\u6307\u5357\u5927\u90e8\u5206\u7684\u7bc4\u4f8b\u90fd\u53ef\u4ee5\u50cf\u9019\u6a23\u7de8\u8f2f\u3002</p>\n<h2 id=\"how-to-read-this-guide\"><a class=\"anchor\" href=\"/react/hello-world#how-to-read-this-guide\"></a>\u5982\u4f55\u95b1\u8b80\u672c\u6307\u5357 </h2>\n<p>\u5728\u9019\u4efd\u6307\u5357\u4e2d\uff0c\u6211\u5011\u6703\u7814\u7a76 React \u61c9\u7528\u7a0b\u5f0f\u7684\u57fa\u672c\u7d44\u6210\uff1a\u5143\u7d20\u8207\u7d44\u4ef6\u3002\u4e00\u65e6\u7406\u89e3\u5b83\u5011\u4e4b\u5f8c\uff0c\u4f60\u53ef\u4ee5\u5f9e\u5c0f\u5de7\u4e14\u53ef\u8986\u7528\u7684 component\uff0c\u62fc\u6e4a\u51fa\u8907\u96dc\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<div class=\"blockquote\">\n<strong>Tip</strong>\n<p>\u672c\u7bc7\u6307\u5357\u8a2d\u8a08\u7d66\u559c\u6b61<strong>\u6309\u90e8\u5c31\u73ed</strong>\u7684\u670b\u53cb\u3002\u82e5\u559c\u6b61\u52d5\u624b\u505a\u7684\u670b\u53cb\uff0c\u8acb\u53c3\u8003\u6211\u5011\u7684<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//tutorial/tutorial.html\">\u5be6\u7528\u6307\u5357</a>\u3002\u4f60\u53ef\u80fd\u6703\u767c\u73fe\u672c\u7bc7\u6307\u5357\u548c\u6559\u5b78\u8ab2\u7a0b\u5176\u5be6\u662f\u76f8\u8f14\u76f8\u6210\u7684\u3002</p>\n</div>\n<p>\u672c\u7bc7\u662f React \u4e3b\u8981\u6982\u5ff5\u7684\u7b2c\u4e00\u7ae0\u7bc0\u3002\u4f60\u53ef\u4ee5\u5728\u5074\u908a\u7684\u5c0e\u822a\u6b04\u4e2d\u627e\u5230\u6240\u6709\u7ae0\u7bc0\u7684\u5217\u8868\u3002\u5982\u679c\u4f60\u5f9e\u624b\u6a5f\u88dd\u7f6e\u4e0a\u700f\u89bd\uff0c\u53ef\u4ee5\u900f\u904e\u9ede\u64ca\u87a2\u5e55\u53f3\u4e0b\u89d2\u7684\u6309\u9215\u4f86\u700f\u89bd\u9078\u55ae\u3002</p>\n<p>\u672c\u7bc7\u6307\u5357\u7684\u6bcf\u500b\u7ae0\u7bc0\u90fd\u662f\u57fa\u65bc\u524d\u4e00\u7ae0\u7bc0\u7684\u77e5\u8b58\u3002<strong>\u4f60\u53ef\u4ee5\u6309\u7167\u5074\u908a\u6b04\u4e2d\u986f\u793a\u7684\u9806\u5e8f\u95b1\u8b80\u300c\u4e3b\u8981\u6982\u5ff5\u300d\u6307\u5357\u7ae0\u7bc0\uff0c\u4f86\u4e86\u89e3 React \u5927\u90e8\u5206\u7684\u5167\u5bb9\u3002</strong>\u8209\u4f8b\u4f86\u8aaa\uff0c\u9019\u7bc7\u7ae0\u7bc0\u7684\u4e0b\u4e00\u7ae0\u662f<a href=\"/react/introducing-jsx\">\u300cJSX \u5165\u9580\u300d</a>\u3002</p>\n<h2 id=\"knowledge-level-assumptions\"><a class=\"anchor\" href=\"/react/hello-world#knowledge-level-assumptions\"></a>\u9700\u8981\u7684\u77e5\u8b58 </h2>\n<p>React \u662f\u4e00\u500b JavaScript \u7684\u51fd\u5f0f\u5eab\uff0c\u800c\u4e14\u6211\u5011\u5047\u8a2d\u4f60\u6709\u4e00\u4e9b JavaScript \u7684\u57fa\u790e\u77e5\u8b58\u3002<strong>\u5982\u679c\u4f60\u611f\u5230\u6c92\u6709\u81ea\u4fe1\u7684\u8a71\uff0c\u6211\u5011\u63a8\u85a6<a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript\">\u8b80\u904e\u4e00\u904d\u9019\u500b JavaScript \u6559\u5b78\u8ab2\u7a0b</a></strong>\u4f86\u78ba\u8a8d\u4f60\u7684\u77e5\u8b58\u6c34\u5e73\u5982\u4f55\uff0c\u78ba\u4fdd\u4f60\u53ef\u4ee5\u8ddf\u4e0a\u672c\u7bc7\u6307\u5357\u3002\u9019\u9700\u8981\u82b1\u8cbb\u5927\u6982 30 \u5206\u9418\u5230 1 \u5c0f\u6642\uff0c\u4f46\u4f60\u4e0d\u6703\u89ba\u5f97\u4f60\u5728\u5b78\u7fd2 React\uff0c\u540c\u6642\u53c8\u5728\u5b78\u7fd2 JavaScript\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u672c\u7bc7\u6307\u5357\u5076\u723e\u6703\u4f7f\u7528\u8f03\u65b0\u7684 JavaScript \u8a9e\u6cd5\u3002\u82e5\u8fd1\u5e74\u5167\u6c92\u6709\u63a5\u89f8\u904e JavaScript\uff0c\u53ea\u8981\u770b\u4e00\u4e0b<a class=\"external-link\" href=\"https://gist.github.com/gaearon/683e676101005de0add59e8bb345340c\">\u9019\u4e09\u500b\u5fc3\u6cd5</a>\u5373\u53ef\u3002</p>\n</div>\n<h2 id=\"lets-get-started\"><a class=\"anchor\" href=\"/react/hello-world#lets-get-started\"></a>\u99ac\u4e0a\u958b\u59cb\u5427\uff01 </h2>\n<p>\u7e7c\u7e8c\u6efe\u52d5\u9801\u9762\u81f3\u5e95\u90e8\uff0c\u4f60\u6703\u5728\u7db2\u9801\u7684\u53f3\u4e0b\u89d2\u627e\u5230\u9032\u5165<a href=\"/react/introducing-jsx\">\u4e0b\u4e00\u7ae0\u7684\u9023\u7d50</a>\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hello-world.md\">Edit this page</a></p></div></article>", "path": "/react/hello-world", "nav": ["/react/release-channels", "/react/introducing-jsx"]}, {"key": "2. JSX \u4ecb\u7d39", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u8003\u616e\u4e0b\u9762\u9019\u500b\u8b8a\u6578\u5ba3\u544a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\u4f60\u597d\uff0c\u4e16\u754c\uff01</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u500b\u6709\u8da3\u7684\u6a19\u7c64\u8a9e\u6cd5\u4e0d\u662f\u4e00\u500b\u5b57\u4e32\u4e5f\u4e0d\u662f HTML\u3002</p>\n<p>\u9019\u500b\u8a9e\u6cd5\u53eb\u505a JSX\uff0c\u662f\u4e00\u500b JavaScript \u7684\u8a9e\u6cd5\u64f4\u5145\u3002\u6211\u5011\u63a8\u85a6\u4f60\u5728\u5beb React \u7684\u6642\u5019\u900f\u904e\u9019\u500b\u8a9e\u6cd5\u4f86\u63cf\u8ff0\u4f7f\u7528\u8005\u4ecb\u9762\u7684\u5916\u89c0\u3002 JSX \u53ef\u80fd\u70ba\u8b93\u4f60\u60f3\u5230\u4e00\u4e9b\u6a23\u677f\u8a9e\u8a00\uff0c\u4f46\u4e0d\u4e00\u6a23\u7684\u5730\u65b9\u662f JSX \u5141\u8a31\u4f60\u4f7f\u7528 JavaScript \u6240\u6709\u7684\u529f\u80fd\u3002</p>\n<p>\u57f7\u884c JSX \u6703\u7522\u751f React\u300celement\u300d\u3002\u6211\u5011\u6703\u5728<a href=\"/react/rendering-elements\">\u4e0b\u4e00\u500b\u7ae0\u7bc0</a>\u6df1\u5165\u5982\u4f55\u5c07\u9019\u4e9b\u8f38\u51fa render \u5230 DOM \u88e1\u982d\u3002\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u5c07\u5e36\u60a8\u4e86\u89e3 JSX \u7684\u57fa\u790e\u3002</p>\n<h3 id=\"why-jsx\"><a class=\"anchor\" href=\"/react/introducing-jsx#why-jsx\"></a>\u70ba\u4ec0\u9ebc\u8981\u7528 JSX? </h3>\n<p>React \u64c1\u62b1\u4e86 render \u908f\u8f2f\u5f9e\u6839\u672c\u4e0a\u5c31\u5f97\u8ddf\u5176\u4ed6 UI \u908f\u8f2f\u7d81\u5728\u4e00\u8d77\u7684\u4e8b\u5be6\uff1a\u4e8b\u4ef6\u8981\u600e\u9ebc\u8655\u7406\uff1f\u96a8\u8457\u6642\u9593\u7d93\u904e state \u6703\u5982\u4f55\u8b8a\u5316\uff1f\u4ee5\u53ca\u8981\u600e\u9ebc\u5c07\u8cc7\u6599\u6e96\u5099\u597d\u7528\u65bc\u986f\u793a\uff1f</p>\n<p>\u8207\u5176\u523b\u610f\u7684\u5c07<em>\u6280\u8853</em>\u62c6\u958b\uff0c\u628a\u6a19\u7c64\u8a9e\u6cd5\u8ddf\u908f\u8f2f\u62c6\u653e\u65bc\u4e0d\u540c\u6a94\u6848\u4e4b\u4e2d\uff0cReact <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Separation_of_concerns\"><em>\u95dc\u6ce8\u9ede\u5206\u96e2</em></a>\u7684\u65b9\u6cd5\u662f\u5c07\u5176\u62c6\u5206\u70ba\u5f88\u591a\u540c\u6642\u5305\u542b UI \u8207\u908f\u8f2f\u7684 component\uff0c\u800c\u5f7c\u6b64\u4e4b\u9593\u5f88\u5c11\u4e92\u76f8\u4f9d\u8cf4\u3002\u6211\u5011\u6703\u5728<a href=\"/react/components-and-props\">\u4e4b\u5f8c\u7684\u7ae0\u7bc0</a>\u4e2d\u56de\u4f86\u63a2\u8a0e component \u9019\u500b\u4e3b\u984c\uff0c\u4f46\u5982\u679c\u4f60\u9084\u6c92\u88ab\u8aaa\u670d\u63a5\u53d7\u5c07\u6a19\u7c64\u8a9e\u6cd5\u5beb\u5728 JS \u88e1\u982d\uff0c<a class=\"external-link\" href=\"https://www.youtube.com/watch?v=x7cQ3mrcKaY\">\u9019\u500b\u6f14\u8b1b</a>\u6216\u8a31\u6703\u8aaa\u670d\u4f60\u3002</p>\n<p>React <a href=\"/react/react-without-jsx\">\u4e26\u4e0d\u8981\u6c42</a>\u4f7f\u7528 JSX\uff0c\u4f46\u5927\u90e8\u5206\u4eba\u89ba\u5f97\u5728 JavaScript \u7a0b\u5f0f\u78bc\u4e2d\u64b0\u5beb\u4f7f\u7528\u8005\u4ecb\u9762\u7684\u540c\u6642\uff0c\u9019\u662f\u4e00\u500b\u5f88\u597d\u7684\u8996\u89ba\u8f14\u52a9\u3002\u9019\u4e5f\u5141\u8a31 React \u986f\u793a\u66f4\u6709\u7528\u7684\u932f\u8aa4\u53ca\u8b66\u544a\u8a0a\u606f\u3002</p>\n<p>\u597d\uff0c\u8aaa\u5b8c\u9019\u500b\u4e86\uff0c\u8b93\u6211\u5011\u958b\u59cb\u5427\uff01</p>\n<h3 id=\"embedding-expressions-in-jsx\"><a class=\"anchor\" href=\"/react/introducing-jsx#embedding-expressions-in-jsx\"></a>\u5728 JSX \u4e2d\u5d4c\u5165 Expression </h3>\n<p>\u5728\u4e0b\u9762\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u5ba3\u544a\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">name</code> \u7684\u8b8a\u6578\uff0c\u4e26\u5728 JSX \u4e2d\u900f\u904e\u5c07\u5176\u540d\u7a31\u5305\u5728\u5927\u62ec\u865f\u4e2d\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'Josh Perez'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u5728 JSX \u7684\u5927\u62ec\u865f\u4e2d\u5beb\u5165\u4efb\u4f55\u5408\u6cd5\u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#Expressions\">JavaScript expression</a>\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c<code class=\"language-javascript\">2 + 2</code>\u3001<code class=\"language-javascript\">user.firstName</code> \u4ee5\u53ca <code class=\"language-javascript\">formatName(user)</code> \u90fd\u662f\u5408\u6cd5\u7684 JavaScript expression\u3002</p>\n<p>\u63a5\u4e0b\u4f86\u7684\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07\u5d4c\u5165\u547c\u53eb JavaScript function (<code class=\"language-javascript\">formatName(user)</code>) \u7684\u56de\u50b3\u503c\u5230\u4e00\u500b <code class=\"language-javascript\">&lt;h1&gt;</code> element \u4e2d\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">formatName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> user<span class=\"token punctuation\">.</span>firstName<span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> user<span class=\"token punctuation\">.</span>lastName<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Harper'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Perez'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    Hello, </span><span class=\"token punctuation\">{</span><span class=\"token function\">formatName</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">!</span></span><span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/PGEjdG?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u70ba\u4e86\u65b9\u4fbf\u95b1\u8b80\uff0c\u6211\u5011\u5c07 JSX \u62c6\u6210\u5f88\u591a\u884c\u8868\u9054\u3002\u96d6\u7136\u9019\u4e26\u4e0d\u9700\u8981\uff0c\u6211\u5011\u5efa\u8b70\u5c07\u591a\u884c JSX \u5305\u5728\u62ec\u865f\u4e2d\u4f86\u907f\u514d\u9047\u5230<a class=\"external-link\" href=\"http://stackoverflow.com/q/2846283\">\u81ea\u52d5\u5206\u865f\u88dc\u8db3</a>\u7684\u9ebb\u7169\u3002</p>\n<h3 id=\"jsx-is-an-expression-too\"><a class=\"anchor\" href=\"/react/introducing-jsx#jsx-is-an-expression-too\"></a>JSX \u672c\u8eab\u4e5f\u662f Expression </h3>\n<p>\u5728\u7de8\u8b6f\u4e4b\u5f8c\uff0cJSX expressions \u5c31\u8b8a\u6210\u4e86\u4e00\u822c\u7684 JavaScript function \u547c\u53eb\u4e26\u56de\u50b3 JavaScript \u7269\u4ef6\u3002\n\u9019\u8868\u793a\u4f60\u4e5f\u53ef\u4ee5\u5728 <code class=\"language-javascript\">if</code> \u8ddf <code class=\"language-javascript\">for</code> \u8ff4\u5708\u4e2d\u4f7f\u7528 JSX\uff0c\u5c07\u5176\u6307\u5b9a\u5230\u4e00\u500b\u8b8a\u6578\uff0c\u4f7f\u7528 JSX \u4f5c\u70ba\u53c3\u6578\u4e26\u7531 function \u4e2d\u56de\u50b3\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getGreeting</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token function\">formatName</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, Stranger.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"specifying-attributes-with-jsx\"><a class=\"anchor\" href=\"/react/introducing-jsx#specifying-attributes-with-jsx\"></a>\u5728 JSX \u4e2d\u6307\u5b9a\u5c6c\u6027 </h3>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u5f15\u865f\u5c07\u5b57\u4e32\u8a2d\u5b9a\u70ba\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://www.reactjs.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"> link </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u5728\u5c6c\u6027\u4e2d\u4f7f\u7528\u5927\u62ec\u865f\u4f86\u5d4c\u5165\u4e00\u500b JavaScript expression\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>avatarUrl<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>img</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4e0d\u8981\u5728\u5d4c\u5165 JavaScript expression \u4f5c\u70ba\u5c6c\u6027\u7684\u6642\u5019\u540c\u6642\u4f7f\u7528\u5f15\u865f\u6216\u662f\u5927\u62ec\u865f\u3002\u4f60\u61c9\u8a72\u8981\u5728\u4f7f\u7528\u5b57\u4e32\u5c6c\u6027\u7684\u6642\u5019\u4f7f\u7528\u5f15\u865f\uff0c\u4f7f\u7528 expressions \u7684\u6642\u5019\u4f7f\u7528\u5927\u62ec\u865f\uff0c\u4f46\u4e0d\u8981\u540c\u6642\u4f7f\u7528\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u7531\u65bc JSX \u6bd4\u8f03\u63a5\u8fd1 JavaScript \u800c\u4e0d\u662f HTML\uff0cReact DOM \u4f7f\u7528 <code class=\"language-javascript\">camelCase</code> \u4f86\u547d\u540d\u5c6c\u6027\u800c\u4e0d\u662f\u4f7f\u7528\u6163\u6709\u7684 HTML \u5c6c\u6027\u540d\u7a31\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff1a\u5728 JSX \u4e4b\u4e2d\uff0c<code class=\"language-javascript\">class</code> \u8b8a\u6210\u4e86 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/className\"><code class=\"language-javascript\">className</code></a> \u800c <code class=\"language-javascript\">tabindex</code> \u8b8a\u6210\u4e86 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/tabIndex\"><code class=\"language-javascript\">tabIndex</code></a>\u3002</p>\n</div>\n<h3 id=\"specifying-children-with-jsx\"><a class=\"anchor\" href=\"/react/introducing-jsx#specifying-children-with-jsx\"></a>\u5728 JSX \u4e2d\u6307\u5b9a Children </h3>\n<p>\u5c31\u50cf\u662f\u5728 XML \u4e4b\u4e2d\uff0c\u5982\u679c\u4e00\u500b\u6a19\u7c64\u662f\u7a7a\u767d\u7684\uff0c\u4f60\u53ef\u4ee5\u7528 <code class=\"language-javascript\">/&gt;</code> \u7acb\u523b\u95dc\u9589\u9019\u500b\u6a19\u7c64\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>avatarUrl<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>JSX \u6a19\u7c64\u4e5f\u53ef\u4ee5\u5305\u542b children\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Good to see you here.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"jsx-prevents-injection-attacks\"><a class=\"anchor\" href=\"/react/introducing-jsx#jsx-prevents-injection-attacks\"></a>JSX \u9632\u7bc4\u6ce8\u5165\u653b\u64ca </h3>\n<p>\u5728 JSX \u4e4b\u4e2d\u53ef\u4ee5\u5b89\u5168\u7684\u76f4\u63a5\u5d4c\u5165\u4f7f\u7528\u8005\u8f38\u5165\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> title <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>potentiallyMaliciousInput<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// \u9019\u662f\u5b89\u5168\u7684\uff1a</span>\n<span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>React DOM \u9810\u8a2d\u6703\u5728 render \u4e4b\u524d <a class=\"external-link\" href=\"http://stackoverflow.com/questions/7381974/which-characters-need-to-be-escaped-on-html\">escape</a> \u6240\u6709\u5d4c\u5165\u5728 JSX \u4e2d\u7684\u8b8a\u6578\u3002\u9019\u4fdd\u8b49\u4f60\u6c38\u9060\u4e0d\u6703\u4e0d\u5c0f\u5fc3\u6ce8\u5165\u4efb\u4f55\u4e0d\u662f\u76f4\u63a5\u5beb\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u6771\u897f\u3002\u6240\u6709\u8b8a\u6578\u90fd\u6703\u5728 render \u4e4b\u524d\u8f49\u70ba\u5b57\u4e32\uff0c\u9019\u53ef\u4ee5\u907f\u514d <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Cross-site_scripting\">XSS\uff08\u8de8\u7db2\u7ad9\u6307\u4ee4\u78bc\uff09</a>\u653b\u64ca\u3002</p>\n<h3 id=\"jsx-represents-objects\"><a class=\"anchor\" href=\"/react/introducing-jsx#jsx-represents-objects\"></a>JSX \u8868\u793a\u7269\u4ef6 </h3>\n<p>Babel \u5c07 JSX \u7de8\u8b6f\u70ba\u547c\u53eb <code class=\"language-javascript\">React.createElement()</code> \u7684\u7a0b\u5f0f\u3002</p>\n<p>\u4e0b\u9762\u9019\u5169\u500b\u4f8b\u5b50\u5b8c\u5168\u76f8\u540c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>greeting<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    Hello, World!\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'h1'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">className</span><span class=\"token operator\">:</span> <span class=\"token string\">'greeting'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Hello, World!'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">React.createElement()</code> \u6703\u9032\u884c\u4e00\u4e9b\u6aa2\u67e5\u4ee5\u5e6b\u52a9\u4f60\u5beb\u51fa\u6c92\u6709 bug \u7684\u7a0b\u5f0f\uff0c\u4f46\u57fa\u672c\u4e0a\u5b83\u6703\u7522\u751f\u985e\u4f3c\u4e0b\u9762\u7684\u7269\u4ef6\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u6ce8\u610f\uff1a\u9019\u662f\u7c21\u5316\u904e\u7684\u7d50\u69cb</span>\n<span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'h1'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">props</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">className</span><span class=\"token operator\">:</span> <span class=\"token string\">'greeting'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello, world!'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u7a2e\u7269\u4ef6\u88ab\u7a31\u547c\u70ba\u300cReact element\u300d\u3002\u4f60\u53ef\u4ee5\u60f3\u50cf\u4ed6\u5011\u63cf\u8ff0\u7684\u662f\u4f60\u60f3\u8981\u5728\u87a2\u5e55\u4e0a\u770b\u5230\u7684\u6771\u897f\uff0cReact \u6703\u8b80\u53d6\u9019\u4e9b\u7269\u4ef6\u4e26\u7528\u9019\u4e9b\u63cf\u8ff0\u4f86\u7522\u751f DOM \u4e26\u4fdd\u6301\u4ed6\u5011\u5728\u6700\u65b0\u72c0\u614b\u3002</p>\n<p>\u6211\u5011\u6703\u5728<a href=\"/react/rendering-elements\">\u4e0b\u4e00\u500b\u7ae0\u7bc0</a>\u63a2\u8a0e\u5982\u4f55\u628a React element render \u5230 DOM \u4e4b\u4e2d\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a\uff1a</strong>\n<p>\u6211\u5011\u63a8\u85a6\u4f60\u5728\u7de8\u8f2f\u5668\u4e2d\u4f7f\u7528 <a class=\"external-link\" href=\"https://babeljs.io/docs/en/next/editors\">\u300cBabel\u300d\u8a9e\u6cd5</a>\uff0c\u9019\u6a23\u53ef\u4ee5\u78ba\u4fdd ES6 \u8ddf JSX \u90fd\u80fd\u5920\u6b63\u78ba\u7684\u88ab\u8a9e\u6cd5\u7a81\u986f\u3002</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/introducing-jsx.md\">Edit this page</a></p></div></article>", "path": "/react/introducing-jsx", "nav": ["/react/hello-world", "/react/rendering-elements"]}, {"key": "3. Rendering Element", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u5efa\u7acb React \u61c9\u7528\u7a0b\u5f0f\u6700\u5c0f\u7684\u55ae\u4f4d\u662f element\u3002</p>\n<p>\u4e00\u500b element \u63cf\u8ff0\u4f60\u60f3\u8981\u5728\u87a2\u5e55\u4e0a\u6240\u770b\u5230\u7684\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u8207\u700f\u89bd\u5668\u7684 DOM element \u4e0d\u540c\uff0cReact element \u662f\u55ae\u7d14\u7684 object\uff0c\u800c\u4e14\u5f88\u5bb9\u6613\u88ab\u5efa\u7acb\u3002React DOM \u8ca0\u8cac\u66f4\u65b0 DOM \u4f86\u7b26\u5408 React element\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5927\u5bb6\u53ef\u80fd\u6703\u5c07 element \u8207\u66f4\u5ee3\u70ba\u4eba\u77e5\u7684\u300ccomponent\u300d\u6982\u5ff5\u6df7\u6dc6\u3002\u6211\u5011\u5c07\u6703\u5728<a href=\"/react/components-and-props\">\u4e0b\u4e00\u500b\u7ae0\u7bc0</a>\u4ecb\u7d39 component\u3002Component \u662f\u7531 element \u6240\u300c\u7d44\u6210\u300d\u7684\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u5728\u958b\u59cb\u4e4b\u524d\u95b1\u8b80\u672c\u7ae0\u7bc0\u3002</p>\n</div>\n<h2 id=\"rendering-an-element-into-the-dom\"><a class=\"anchor\" href=\"/react/rendering-elements#rendering-an-element-into-the-dom\"></a>Render Element \u5230 DOM \u5167 </h2>\n<p>\u5047\u8a2d\u4f60\u7684 HTML \u6a94\u6848\u5167\u6709\u4e00\u500b <code class=\"language-javascript\">&lt;div&gt;</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u6211\u5011\u7a31\u70ba\u9019\u662f\u4e00\u500b\u300croot\u300dDOM node\uff0c\u56e0\u70ba\u6240\u6709\u5728\u5167\u7684 element \u90fd\u6703\u900f\u904e React DOM \u505a\u7ba1\u7406\u3002</p>\n<p>\u4f7f\u7528 React \u5efa\u7acb\u61c9\u7528\u7a0b\u5f0f\u6642\uff0c\u901a\u5e38\u6703\u6709\u4e00\u500b\u55ae\u4e00\u7684 root DOM node\u3002\u5982\u679c\u4f60\u60f3\u8981\u6574\u5408 React \u5230\u73fe\u6709\u7684\u61c9\u7528\u7a0b\u5f0f\u6642\uff0c\u4f60\u53ef\u4ee5\u6839\u64da\u4f60\u7684\u9700\u6c42\u7368\u7acb\u51fa\u591a\u500b root DOM node\u3002</p>\n<p>\u5982\u679c\u8981 render \u4e00\u500b React element \u5230 root DOM node\uff0c\u50b3\u5165\u5169\u8005\u5230 <a href=\"/react/react-dom-client#createroot\"><code class=\"language-javascript\">ReactDOM.createRoot()</code></a>\uff0c\u63a5\u8457\u50b3\u5165 React element \u5230 <code class=\"language-javascript\">root.render()</code>\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ZpvBNJ?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u5728\u7db2\u9801\u4e0a\u4f60\u6703\u770b\u898b\u986f\u793a\u300cHello, world\u300d\u3002</p>\n<h2 id=\"updating-the-rendered-element\"><a class=\"anchor\" href=\"/react/rendering-elements#updating-the-rendered-element\"></a>\u66f4\u65b0\u88ab Render \u7684 Element </h2>\n<p>React element \u662f <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Immutable_object\">immutable</a> \u7684\u3002\u4e00\u65e6\u4f60\u5efa\u7acb\u4e00\u500b element\uff0c\u4f60\u4e0d\u80fd\u6539\u8b8a\u5b83\u7684 children \u6216\u662f attribute\u3002Element \u5c31\u50cf\u662f\u96fb\u5f71\u4e2d\u7684\u4e00\u500b\u5e40\uff1a\u5b83\u4ee3\u8868\u7279\u5b9a\u6642\u9593\u9ede\u7684 UI\u3002</p>\n<p>\u6191\u85c9\u6211\u5011\u8fc4\u4eca\u70ba\u6b62\u5c0d React \u7684\u8a8d\u8b58\uff0c\u66f4\u65b0 UI \u552f\u4e00\u7684\u65b9\u5f0f\u662f\u5efa\u7acb\u4e00\u500b\u65b0\u7684 element\uff0c\u4e26\u4e14\u5c07\u5b83\u50b3\u5165\u5230 <code class=\"language-javascript\">root.render</code>\u3002</p>\n<p>\u601d\u8003\u4ee5\u4e0b\u9019\u500b ticking clock \u7684\u7bc4\u4f8b\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/gwoJZk?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u5b83\u5f9e <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval\"><code class=\"language-javascript\">setInterval()</code></a> callback \u6bcf\u79d2\u547c\u53eb <a href=\"/react/react-dom#render\"><code class=\"language-javascript\">root.render()</code></a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5728\u5be6\u8e10\u4e2d\uff0c\u5927\u90e8\u5206 React \u61c9\u7528\u7a0b\u5f0f\u53ea\u547c\u53eb <code class=\"language-javascript\">root.render()</code> \u4e00\u6b21\u3002\u5728\u4e0b\u4e00\u500b\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u6703\u5b78\u7fd2\u5982\u4f55\u5c07\u9019\u4e9b\u7a0b\u5f0f\u78bc\u5c01\u88dd\u5230 <a href=\"/react/state-and-lifecycle\">stateful component</a>\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u4f60\u4e0d\u8981\u8df3\u8457\u4e3b\u984c\u770b\uff0c\u56e0\u70ba\u5b83\u5011\u5f7c\u6b64\u9593\u662f\u74b0\u74b0\u76f8\u6263\u7684\u3002</p>\n</div>\n<h2 id=\"react-only-updates-whats-necessary\"><a class=\"anchor\" href=\"/react/rendering-elements#react-only-updates-whats-necessary\"></a>React \u53ea\u66f4\u65b0\u5fc5\u8981\u7684 Element </h2>\n<p>React DOM \u6703\u5c07 element \u548c\u5b83\u7684 children \u8207\u5148\u524d\u7684\u72c0\u614b\u505a\u6bd4\u8f03\uff0c\u4e26\u4e14\u53ea\u66f4\u65b0\u5fc5\u8981\u7684 DOM \u9054\u5230\u7406\u60f3\u7684\u72c0\u614b\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u900f\u904e\u700f\u89bd\u5668\u5de5\u5177\u4f86\u6aa2\u6e2c<a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/gwoJZk?editors=1010\">\u6700\u5f8c\u4e00\u500b\u7bc4\u4f8b</a>\u505a\u9a57\u8b49\uff1a</p>\n<p><a class=\"external-link\" href=\"https://zh-hant.reactjs.org//c158617ed7cc0eac8f58330e49e48224/granular-dom-updates.gif\">Image link</a></p>\n<p>\u5373\u4f7f\u6211\u5011\u5728\u6bcf\u79d2\u5efa\u7acb\u4e00\u500b element \u63cf\u8ff0\u6574\u500b UI tree\uff0c\u53ea\u6709\u5167\u5bb9\u66f4\u6539\u7684 text node \u624d\u6703\u88ab React DOM \u66f4\u65b0\u3002</p>\n<p>\u6839\u64da\u6211\u5011\u7684\u7d93\u9a57\uff0c\u61c9\u8a72\u601d\u8003 UI \u5728\u4efb\u4f55\u6642\u5019\u61c9\u8a72\u5982\u4f55\u5448\u73fe\uff0c\u800c\u4e0d\u662f\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u6539\u8b8a\u5b83\uff0c\u5c31\u53ef\u4ee5\u53bb\u6240\u6709\u6d88\u9664\u932f\u8aa4\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/rendering-elements.md\">Edit this page</a></p></div></article>", "path": "/react/rendering-elements", "nav": ["/react/introducing-jsx", "/react/components-and-props"]}, {"key": "4. Component \u8207 Prop", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Component \u4f7f\u4f60\u53ef\u4ee5\u5c07 UI \u62c6\u5206\u6210\u7368\u7acb\u4e14\u53ef\u8907\u7528\u7684\u7a0b\u5f0f\u78bc\uff0c\u4e26\u4e14\u5c08\u6ce8\u65bc\u5404\u5225\u7a0b\u5f0f\u78bc\u7684\u601d\u8003\u3002\u672c\u7ae0\u7bc0\u65e8\u5728\u4ecb\u7d39 component \u7684\u76f8\u95dc\u6982\u5ff5\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5728\u6b64\u53c3\u95b1<a href=\"/react/react-component\">\u8a73\u7d30\u7684 API \u6587\u4ef6</a>\u3002</p>\n<p>\u6982\u5ff5\u4e0a\u4f86\u8aaa\uff0ccomponent \u5c31\u50cf\u662f JavaScript \u7684 function\uff0c\u5b83\u63a5\u6536\u4efb\u610f\u7684\u53c3\u6578\uff08\u7a31\u4e4b\u70ba\u300cprops\u300d\uff09\u4e26\u4e14\u56de\u50b3\u63cf\u8ff0\u756b\u9762\u7684 React element\u3002</p>\n<h2 id=\"function-and-class-components\"><a class=\"anchor\" href=\"/react/components-and-props#function-and-class-components\"></a>Function Component \u8207 Class Component </h2>\n<p>\u5b9a\u7fa9 component \u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u5373\u662f\u64b0\u5beb\u4e00\u500b Javascript function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6b64 function \u662f\u4e00\u500b\u7b26\u5408\u898f\u7bc4\u7684 React component\uff0c\u56e0\u70ba\u5b83\u63a5\u53d7\u4e00\u500b\u300cprops\u300d\uff08\u6307\u5c6c\u6027 properties\uff09\u7269\u4ef6\u4e26\u56de\u50b3\u4e00\u500b React element\u3002\u6211\u5011\u7a31\u4e4b\u70ba function component\uff0c\u56e0\u70ba\u5b83\u672c\u8eab\u5c31\u662f\u4e00\u500b JavaScript function\u3002</p>\n<p>\u540c\u6a23\u7684\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes\">ES6 Class</a> \u4f86\u5b9a\u7fa9 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Welcome</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4e0a\u8ff0\u5169\u7a2e component \u5728 React \u4e2d\u662f\u540c\u7b49\u7684\u3002</p>\n<p>Function \u548c Class component \u5169\u8005\u90fd\u64c1\u6709\u984d\u5916\u7684\u7279\u6027\uff0c\u6211\u5011\u5c07\u6703\u5728<a href=\"/react/state-and-lifecycle\">\u4e0b\u4e00\u500b\u7ae0\u7bc0</a>\u63a2\u8a0e\u3002</p>\n<h2 id=\"rendering-a-component\"><a class=\"anchor\" href=\"/react/components-and-props#rendering-a-component\"></a>Render \u4e00\u500b Component </h2>\n<p>\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u5011\u53ea\u898b\u904e\u9019\u7a2e\u76f8\u7576\u65bc DOM \u6a19\u7c64\u7684 React element\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4e0d\u904e\uff0cReact element \u4e5f\u53ef\u4ee5\u662f\u4f7f\u7528\u8005\u81ea\u5b9a\u7fa9\u7684 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sara<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u7576 React \u770b\u5230\u7531\u4f7f\u7528\u8005\u5b9a\u7fa9 component \u7684 element \u6642\uff0c\u5b83\u5c07 JSX \u5c6c\u6027\u548c children \u4f5c\u70ba single object \u50b3\u905e\u7d66\u8a72 component\u3002\u6211\u5011\u7a31\u9019\u500b object \u70ba\u300cprops\u300d\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u9019\u6bb5\u7a0b\u5f0f\u78bc\u6703\u5728\u9801\u9762\u4e0a render \u51fa\u300cHello, Sara\u300d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sara<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/YGYmEG?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u8b93\u6211\u5011\u4f86\u8907\u7fd2\u4e00\u4e0b\u9019\u500b\u4f8b\u5b50\u767c\u751f\u4e86\u4ec0\u9ebc\u4e8b\uff1a</p>\n<ol>\n<li>\u6211\u5011\u5c0d <code class=\"language-javascript\">&lt;Welcome name=\"Sara\" /&gt;</code> \u9019\u500b element \u547c\u53eb\u4e86 <code class=\"language-javascript\">root.render()</code>\u3002</li>\n<li>React \u4ee5 <code class=\"language-javascript\">{name: 'Sara'}</code> \u4f5c\u70ba props \u50b3\u5165 <code class=\"language-javascript\">Welcome</code> component \u4e26\u547c\u53eb\u3002</li>\n<li><code class=\"language-javascript\">Welcome</code> component \u56de\u50b3\u4e86 <code class=\"language-javascript\">&lt;h1&gt;Hello, Sara&lt;/h1&gt;</code> \u9019\u500b element \u4f5c\u70ba\u8fd4\u56de\u503c\u3002</li>\n<li>React DOM \u6709\u6548\u7684\u5c07 DOM \u66f4\u65b0\u70ba <code class=\"language-javascript\">&lt;h1&gt;Hello, Sara&lt;/h1&gt;</code>\u3002</li>\n</ol>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a Component \u7684\u5b57\u9996\u9808\u70ba\u5927\u5beb\u5b57\u6bcd</strong>\n<p>React \u6703\u5c07\u5c0f\u5beb\u5b57\u6bcd\u958b\u982d\u7684\u7d44\u4ef6\u8996\u70ba\u539f\u59cb DOM \u6a19\u7c64\uff0c\u8209\u4f8b\u4f86\u8aaa\uff0c<code class=\"language-javascript\">&lt;div /&gt;</code> \u5c31\u6703\u88ab\u8996\u70ba\u662f HTML \u7684 div \u6a19\u7c64\uff0c\u4f46\u662f <code class=\"language-javascript\">&lt;Welcome /&gt;</code> \u5247\u662f\u4e00\u500b component\uff0c\u800c\u4e14\u9700\u8981\u5728\u4f5c\u7528\u57df\u4e2d\u4f7f\u7528 <code class=\"language-javascript\">Welcome</code>\u3002</p>\n<p>\u60f3\u8981\u4e86\u89e3\u66f4\u591a\u95dc\u65bc\u6b64\u6163\u4f8b\u7684\u539f\u56e0\uff0c\u8acb\u53c3\u95b1 <a href=\"/react/jsx-in-depth#user-defined-components-must-be-capitalized\">JSX In Depth</a> \u7ae0\u7bc0\u3002</p>\n</div>\n<h2 id=\"composing-components\"><a class=\"anchor\" href=\"/react/components-and-props#composing-components\"></a>\u7d44\u5408 Component </h2>\n<p>Component \u53ef\u4ee5\u5728\u8f38\u51fa\u4e2d\u5f15\u7528\u5176\u4ed6 component\u3002\u6211\u5011\u53ef\u4ee5\u5728\u4efb\u4f55\u5c64\u6b21\u4e2d\u62bd\u8c61\u5316\u76f8\u540c\u7684 component\uff0c\u6309\u9215\u3001\u8868\u55ae\u3001\u5c0d\u8a71\u6846\u3001\u751a\u81f3\u662f\u6574\u500b\u756b\u9762\uff0c\u5728 React \u61c9\u7528\u7a0b\u5f0f\u4e2d\u90fd\u5c07\u4ee5 component \u7684\u65b9\u5f0f\u5448\u73fe\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b render \u591a\u6b21 <code class=\"language-javascript\">Welcome</code> \u7684 <code class=\"language-javascript\">App</code> component\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sara<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Cahal<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Edite<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/KgQKPr?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u901a\u5e38\u4f86\u8aaa\uff0c\u6bcf\u500b React \u61c9\u7528\u7a0b\u5f0f\u90fd\u6709\u4e00\u500b\u6700\u9ad8\u5c64\u7d1a\u7684 <code class=\"language-javascript\">App</code> component\u3002\u7136\u800c\uff0c\u5982\u679c\u4f60\u5c07 React \u7d50\u5408\u81f3\u73fe\u5b58\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u50cf <code class=\"language-javascript\">Button</code> \u9019\u6a23\u7684\u5c0f\u578b component\uff0c\u4e26\u7531\u4e0b\u5f80\u4e0a\uff0c\u9010\u6b65\u61c9\u7528\u5230\u756b\u9762\u7684\u6700\u9ad8\u5c64\u7d1a\u3002</p>\n<h2 id=\"extracting-components\"><a class=\"anchor\" href=\"/react/components-and-props#extracting-components\"></a>\u62bd\u96e2 Component </h2>\n<p>\u5225\u5bb3\u6015\u5c07 component \u62c6\u5206\u6210\u66f4\u5c0f\u7684 component\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u6211\u5011\u770b\u9019\u500b <code class=\"language-javascript\">Comment</code> \u7684 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Comment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Avatar<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>avatarUrl<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">alt</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo-name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-date<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token function\">formatDate</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/VKQwEo?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u5b83\u63a5\u53d7 <code class=\"language-javascript\">author</code> (\u4e00\u500b\u7269\u4ef6)\u3001<code class=\"language-javascript\">text</code> (\u4e00\u500b\u5b57\u4e32)\u3001\u9084\u6709 <code class=\"language-javascript\">date</code> (\u4e00\u500b\u65e5\u671f) \u4f5c\u70ba\u5b83\u7684 props\u3002\u5b83\u7684\u4f5c\u7528\u662f\u5728\u4e00\u500b\u793e\u4ea4\u7db2\u7ad9\u4e0a render \u4e00\u5247\u8a55\u8ad6\u3002</p>\n<p>\u9019\u500b component \u53ef\u80fd\u56e0\u70ba\u592a\u591a\u7684\u5de2\u72c0\u95dc\u4fc2\u800c\u96e3\u4ee5\u66f4\u52d5\uff0c\u800c\u4e14\u4e5f\u96e3\u4ee5\u8907\u7528\u7368\u7acb\u7684\u90e8\u5206\u3002\u8b93\u6211\u5011\u628a\u4e00\u4e9b component \u5f9e\u4e2d\u5206\u96e2\u5427\u3002</p>\n<p>\u9996\u5148, \u6211\u5011\u5c07 <code class=\"language-javascript\">Avatar</code> \u5206\u96e2\u51fa\u4f86\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Avatar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Avatar<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>avatarUrl<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">alt</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">/&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b <code class=\"language-javascript\">Avatar</code> \u4e26\u4e0d\u9700\u77e5\u9053\u5b83\u6703\u88ab render \u5728 <code class=\"language-javascript\">Comment</code> \u4e2d\u3002\u9019\u662f\u70ba\u4ec0\u9ebc\u6211\u5011\u7d66\u4ed6\u4e00\u500b\u66f4\u70ba\u4e00\u822c\u7684\u540d\u5b57\uff1a<code class=\"language-javascript\">user</code> \u800c\u4e0d\u662f <code class=\"language-javascript\">author</code>\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u5f9e component \u7684\u89d2\u5ea6\u70ba props \u547d\u540d\uff0c\u800c\u4e0d\u662f\u5b83\u7684\u4f7f\u7528\u60c5\u5883\u3002</p>\n<p>\u73fe\u5728\u6211\u5011\u53ef\u4ee5\u7a0d\u5fae\u7c21\u5316 <code class=\"language-javascript\">Comment</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Comment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Avatar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo-name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-date<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token function\">formatDate</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u5c07 <code class=\"language-javascript\">UserInfo</code> component \u4e5f\u62bd\u96e2\u51fa\u4f86\uff0c\u5b83\u6703\u5728\u4f7f\u7528\u8005\u540d\u7a31\u65c1\u908a render <code class=\"language-javascript\">Avatar</code> component\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">UserInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Avatar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UserInfo-name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8b93\u6211\u5011\u5c07 <code class=\"language-javascript\">Comment</code> \u66f4\u52a0\u7c21\u5316\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Comment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserInfo</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>author<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Comment-date<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token function\">formatDate</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/rrJNJY?editors=1010\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</a></p>\n<p>\u5728\u4e00\u958b\u59cb\uff0c\u5c07 component \u62bd\u96e2\u51fa\u4f86\u53ef\u80fd\u662f\u4e00\u4ef6\u7e41\u91cd\u7684\u5de5\u4f5c\uff0c\u4f46\u662f\u5728\u8f03\u5927\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u5efa\u69cb\u53ef\u8907\u7528\u7684 component \u662f\u975e\u5e38\u503c\u5f97\u3002\u4ee5\u7d93\u9a57\u4f86\u8aaa\uff0c\u5982\u679c\u4e00\u500b UI \u4e2d\u6709\u4e00\u90e8\u5206\u6703\u88ab\u91cd\u8907\u4f7f\u7528\u5f88\u591a\u6b21\uff08<code class=\"language-javascript\">Button</code>\u3001<code class=\"language-javascript\">Panel</code>\u3001<code class=\"language-javascript\">Avatar</code>\uff09\uff0c\u6216\u8005\u5b83\u8db3\u5920\u8907\u96dc\uff08<code class=\"language-javascript\">App</code>\u3001<code class=\"language-javascript\">FeedStory</code>\u3001<code class=\"language-javascript\">Comment</code>\uff09\uff0c\u5247\u53ef\u4ee5\u5c07\u5b83\u63d0\u53d6\u5230\u7368\u7acb\u7684 component\u3002</p>\n<h2 id=\"props-are-read-only\"><a class=\"anchor\" href=\"/react/components-and-props#props-are-read-only\"></a>Props \u662f\u552f\u8b80\u7684 </h2>\n<p>\u4e0d\u7ba1\u4f60\u4f7f\u7528 <a href=\"/react/components-and-props#function-and-class-components\">function \u6216\u662f class \u4f86\u5ba3\u544a component</a>\uff0c\u90fd\u7d55\u4e0d\u80fd\u4fee\u6539\u81ea\u5df1\u7684 props\u3002\u4f8b\u5982\u9019\u500b sum function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u50cf\u9019\u6a23\u7684 function \u662f <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Pure_function\">Pure function</a> \u7684\uff0c\u56e0\u70ba\u4ed6\u5011\u4e26\u6c92\u6709\u6539\u8b8a\u8f38\u5165\uff0c\u800c\u4e14\u76f8\u540c\u7684\u8f38\u5165\u7e3d\u662f\u56de\u50b3\u4e00\u6a23\u7684\u7d50\u679c\u3002</p>\n<p>\u76f8\u53cd\u5730\uff0c\u9019\u500b function \u4e26\u975e Pure function\uff0c\u56e0\u70ba\u5b83\u66f4\u6539\u4e86\u5b83\u7684\u53c3\u6578\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withdraw</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">account<span class=\"token punctuation\">,</span> amount</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  account<span class=\"token punctuation\">.</span>total <span class=\"token operator\">-=</span> amount<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React \u662f\u5f88\u5f48\u6027\u7684\uff0c\u4f46\u6709\u4e00\u689d\u56b4\u683c\u7684\u898f\u5b9a\uff1a</p>\n<p><strong>\u6240\u6709\u7684 React component \u90fd\u5fc5\u9808\u50cf Pure function \u4e00\u822c\u4fdd\u8b77\u4ed6\u7684 props</strong></p>\n<p>\u7576\u7136\uff0c\u61c9\u7528\u7a0b\u5f0f\u7684 UI \u662f\u52d5\u614b\u7684\uff0c\u800c\u4e14\u7e3d\u662f\u96a8\u8457\u6642\u9593\u6539\u8b8a\u3002\u5728<a href=\"/react/state-and-lifecycle\">\u4e0b\u500b\u7ae0\u7bc0</a>\uff0c\u6211\u5011\u6703\u4ecb\u7d39\u4e00\u500b\u65b0\u7684\u6982\u5ff5\u300cstate\u300d\u3002State \u53ef\u4ee5\u5728\u4e0d\u9055\u53cd\u4e0a\u8ff0\u898f\u5247\u7684\u524d\u63d0\u4e0b\uff0c\u8b93 React component \u96a8\u4f7f\u7528\u8005\u64cd\u4f5c\u3001\u7db2\u8def\u56de\u61c9\u3001\u6216\u662f\u5176\u4ed6\u65b9\u5f0f\u6539\u8b8a\u8f38\u51fa\u5167\u5bb9\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/components-and-props.md\">Edit this page</a></p></div></article>", "path": "/react/components-and-props", "nav": ["/react/rendering-elements", "/react/state-and-lifecycle"]}, {"key": "5. State \u548c\u751f\u547d\u9031\u671f", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u9019\u500b\u7ae0\u7bc0\u6703\u4ecb\u7d39\u5728 React component \u4e2d state \u4ee5\u53ca\u751f\u547d\u9031\u671f\u7684\u6982\u5ff5\u3002\u4f60\u53ef\u4ee5\u5728<a href=\"/react/react-component\">\u9019\u88e1\u627e\u5230 component API \u8a73\u7d30\u7684\u53c3\u8003</a>\u3002</p>\n<p>\u601d\u8003<a href=\"/react/rendering-elements#updating-the-rendered-element\">\u524d\u4e00\u7ae0\u7bc0</a>\u7684 ticking clock \u7684\u7bc4\u4f8b\u3002\u5728 <a href=\"/react/rendering-elements#rendering-an-element-into-the-dom\">Rendering Elements</a> \u4e2d\uff0c\u6211\u5011\u53ea\u5b78\u7fd2\u5230\u4e00\u7a2e\u65b9\u5f0f\u4f86\u66f4\u65b0 UI\u3002 \u6211\u5011\u547c\u53eb <code class=\"language-javascript\">root.render()</code> \u4f86\u6539\u8b8a render \u7684\u8f38\u51fa\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"http://codepen.io/gaearon/pen/gwoJZk?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u5728\u9019\u500b\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u6703\u5b78\u7fd2\u5982\u4f55\u5c01\u88dd <code class=\"language-javascript\">Clock</code> component \u8b93\u5b83\u53ef\u4ee5\u771f\u6b63\u7684\u88ab\u91cd\u8907\u4f7f\u7528\u3002\u5b83\u5c07\u6703\u8a2d\u5b9a\u672c\u8eab\u7684 timer \u4e26\u4e14\u6bcf\u79d2\u66f4\u65b0\u4e00\u6b21\u3002</p>\n<p>\u6211\u5011\u53ef\u4ee5\u50cf\u9019\u6a23\u5c01\u88dd clock \u505a\u70ba\u958b\u59cb\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Clock</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token attr-name\">date</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/dpdoYR?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u7136\u800c\uff0c\u5b83\u7f3a\u5c11\u4e86\u4e00\u500b\u91cd\u8981\u7684\u9700\u6c42\uff1a<code class=\"language-javascript\">Clock</code> \u8a2d\u5b9a timer \u4e26\u5728\u6bcf\u79d2\u66f4\u65b0 UI \u61c9\u8a72\u662f <code class=\"language-javascript\">Clock</code> \u5be6\u4f5c\u7684\u7d30\u7bc0\u7684\u4e8b\u5be6\u3002</p>\n<p>\u7406\u60f3\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u60f3\u8981\u64b0\u5beb\u4e00\u6b21 <code class=\"language-javascript\">Clock</code> \u4e26\u4e14\u5b83\u6703\u81ea\u5df1\u66f4\u65b0\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u8981\u5be6\u73fe\u9019\u500b\u7406\u60f3\u60c5\u6cc1\uff0c\u6211\u5011\u9700\u8981\u52a0\u5165\u300cstate\u300d\u5230 <code class=\"language-javascript\">Clock</code> component\u3002</p>\n<p>State \u985e\u4f3c\u65bc prop\uff0c\u4f46\u5b83\u662f\u79c1\u6709\u4e14\u7531 component \u5b8c\u5168\u63a7\u5236\u7684\u3002</p>\n<p>\u6211\u5011<a href=\"/react/components-and-props#functional-and-class-components\">\u5728\u5148\u524d\u63d0\u5230\u904e</a>\uff0ccomponent \u88ab\u5b9a\u7fa9\u70ba class \u6709\u4e00\u4e9b\u984d\u5916\u7684\u7279\u6027\u3002Local state \u5c31\u662f class \u5176\u4e2d\u7684\u4e00\u500b\u7279\u6027\u3002</p>\n<h2 id=\"converting-a-function-to-a-class\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#converting-a-function-to-a-class\"></a>\u8f49\u63db Function \u6210 Class </h2>\n<p>\u4f60\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b 5 \u500b\u6b65\u9a5f\u8f49\u63db\u4e00\u500b function component \u50cf\u662f <code class=\"language-javascript\">Clock</code> \u6210\u70ba class\uff1a</p>\n<ol>\n<li>\u5efa\u7acb\u4e00\u500b\u76f8\u540c\u540d\u7a31\u4e26\u4e14\u7e7c\u627f <code class=\"language-javascript\">React.Component</code> \u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes\">ES6 class</a>\u3002</li>\n<li>\u52a0\u5165\u4e00\u500b <code class=\"language-javascript\">render()</code> \u7684\u7a7a\u65b9\u6cd5\u3002</li>\n<li>\u5c07 function \u7684\u5167\u5bb9\u642c\u5230 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u3002</li>\n<li>\u5c07 <code class=\"language-javascript\">render()</code> \u5167\u7684 <code class=\"language-javascript\">props</code> \u66ff\u63db\u6210 <code class=\"language-javascript\">this.props</code>\u3002</li>\n<li>\u522a\u9664\u5269\u4e0b\u7a7a\u7684 function \u5ba3\u544a\u3002</li>\n</ol>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/zKRGpo?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p><code class=\"language-javascript\">Clock</code> \u73fe\u5728\u88ab\u5b9a\u7fa9\u6210 class \u800c\u4e0d\u662f function\u3002</p>\n<p>\u5728\u6bcf\u6b21\u767c\u751f\u66f4\u65b0\u6642\uff0c<code class=\"language-javascript\">render</code> \u65b9\u6cd5\u90fd\u6703\u88ab\u547c\u53eb\uff0c\u4f46\u6211\u5011\u53ea\u8981 render <code class=\"language-javascript\">&lt;Clock /&gt;</code> \u5230\u76f8\u540c\u7684 DOM node \u4e2d\uff0c\u53ea\u6709 <code class=\"language-javascript\">Clock</code> class \u9019\u500b\u5be6\u4f8b\u6703\u88ab\u7528\u5230\u3002\u9019\u8b93\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u50cf\u662f local state \u548c\u751f\u547d\u9031\u671f\u65b9\u6cd5\u9019\u4e9b\u984d\u5916\u7684\u7279\u6027\u3002</p>\n<h2 id=\"adding-local-state-to-a-class\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#adding-local-state-to-a-class\"></a>\u52a0\u5165 Local State \u5230 Class </h2>\n<p>\u6211\u5011\u6703\u900f\u904e\u4ee5\u4e0b 3 \u500b\u6b65\u9a5f\u5c07 <code class=\"language-javascript\">date</code> \u5f9e\u642c\u79fb\u5230 <code class=\"language-javascript\">state</code>\uff1a</p>\n<ol>\n<li>\u5c07 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u5167\u7684 <code class=\"language-javascript\">this.props.date</code> \u66ff\u63db\u6210 <code class=\"language-javascript\">this.state.date</code>\uff1a</li>\n</ol>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol>\n<li>\u52a0\u5165\u4e00\u500b <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes#Constructor\">class constructor</a> \u4e26\u5206\u914d\u521d\u59cb\u7684 <code class=\"language-javascript\">this.state</code>\uff1a</li>\n</ol>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\uff0c\u6211\u5011\u5c07\u50b3\u9001 <code class=\"language-javascript\">props</code> \u5230\u57fa\u790e constructor\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Class component \u61c9\u8a72\u7e3d\u662f\u8981\u547c\u53eb\u57fa\u790e constructor \u548c <code class=\"language-javascript\">props</code>\u3002</p>\n<ol>\n<li>\u5f9e <code class=\"language-javascript\">&lt;Clock /&gt;</code> element \u4e2d\u79fb\u9664 <code class=\"language-javascript\">date</code> prop\uff1a</li>\n</ol>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4e4b\u5f8c\u6211\u5011\u5c07\u6703\u628a timer \u7684\u7a0b\u5f0f\u78bc\u52a0\u5165\u5230 component \u672c\u8eab\u3002</p>\n<p>\u7d50\u679c\u770b\u8d77\u4f86\u6703\u50cf\u662f\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/KgQpJd?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u6703\u8b93 <code class=\"language-javascript\">Clock</code> \u8a2d\u5b9a\u5b83\u672c\u8eab\u7684 timer \u4e26\u4e14\u6bcf\u79d2\u66f4\u65b0\u4e00\u6b21\u3002</p>\n<h2 id=\"adding-lifecycle-methods-to-a-class\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#adding-lifecycle-methods-to-a-class\"></a>\u52a0\u5165\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5230 Class </h2>\n<p>\u5728\u5177\u6709\u8a31\u591a component \u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u7576 component \u88ab destroy \u6642\uff0c\u91cb\u653e\u6240\u4f54\u7528\u7684\u8cc7\u6e90\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002</p>\n<p>\u6bcf\u7576 <code class=\"language-javascript\">Clock</code> render \u5230 DOM \u7684\u6642\u5019\uff0c\u6211\u5011\u60f3\u8981<a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval\">\u8a2d\u5b9a\u4e00\u500b timer</a>\u3002\u5728 React \u4e2d\u7a31\u70ba\u300cmount\u300d\u3002</p>\n<p>\u6bcf\u7576\u7522\u751f\u7684 <code class=\"language-javascript\">Clock</code> DOM \u88ab\u79fb\u9664\u6642\uff0c\u6211\u5011\u60f3\u8981<a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/clearInterval\">\u6e05\u9664 timer</a>\u3002\u5728 React \u4e2d\u7a31\u70ba\u300cunmount\u300d\u3002</p>\n<p>\u6bcf\u7576 component \u5728 mount \u6216\u662f unmount \u7684\u6642\u5019\uff0c\u6211\u5011\u53ef\u4ee5\u5728 component class \u4e0a\u5ba3\u544a\u4e00\u4e9b\u7279\u5225\u7684\u65b9\u6cd5\u4f86\u57f7\u884c\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u4e9b\u65b9\u6cd5\u88ab\u7a31\u70ba\u300c\u751f\u547d\u9031\u671f\u65b9\u6cd5\u300d\u3002</p>\n<p><code class=\"language-javascript\">componentDidMount()</code> \u65b9\u6cd5\u6703\u5728 component \u88ab render \u5230 DOM \u4e4b\u5f8c\u624d\u6703\u57f7\u884c\u3002\u9019\u662f\u8a2d\u5b9a timer \u7684\u597d\u5730\u65b9\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerID <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token number\">1000</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\u6211\u5011\u662f\u5982\u4f55\u6b63\u78ba\u7684\u5728 <code class=\"language-javascript\">this</code>\uff08<code class=\"language-javascript\">this.timerID</code>\uff09 \u5132\u5b58 timer ID\u3002</p>\n<p>\u96d6\u7136 <code class=\"language-javascript\">this.props</code> \u662f\u7531 React \u672c\u8eab\u8a2d\u5b9a\u7684\uff0c\u800c\u4e14 <code class=\"language-javascript\">this.state</code> \u5177\u6709\u7279\u6b8a\u7684\u610f\u7fa9\uff0c\u5982\u679c\u4f60\u9700\u8981\u5132\u5b58\u4e00\u4e9b\u4e0d\u76f8\u95dc\u65bc\u8cc7\u6599\u6d41\u7684\u5167\u5bb9\uff08\u50cf\u662f timer ID\uff09\uff0c\u4f60\u53ef\u4ee5\u81ea\u7531\u7684\u624b\u52d5\u52a0\u5165\u3002</p>\n<p>\u6211\u5011\u5c07\u6703\u5728 <code class=\"language-javascript\">componentWillUnmount()</code> \u751f\u547d\u9031\u671f\u65b9\u6cd5\u5167\u79fb\u9664 timer\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6700\u5f8c\uff0c\u6211\u5011\u5c07\u6703\u5be6\u4f5c\u4e00\u500b <code class=\"language-javascript\">tick()</code> \u7684\u65b9\u6cd5\uff0c<code class=\"language-javascript\">Clock</code> component \u5c07\u6703\u5728\u6bcf\u79d2\u57f7\u884c\u5b83\u3002</p>\n<p>\u5b83\u5c07\u6703\u4f7f\u7528 <code class=\"language-javascript\">this.setState()</code> \u4f86\u5b89\u6392 component local state \u7684\u66f4\u65b0\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerID <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token number\">1000</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/amqdNA?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u73fe\u5728\u6211\u5011\u7684 clock \u6bcf\u79d2\u9418\u90fd\u6703\u6ef4\u7b54\u4f5c\u97ff\u3002</p>\n<p>\u8b93\u6211\u5011\u5feb\u901f\u7684\u56de\u9867\u4e00\u4e0b\u767c\u751f\u4e86\u54ea\u4e9b\u4e8b\u60c5\uff0c\u4ee5\u53ca\u547c\u53eb\u9019\u4e9b\u65b9\u6cd5\u7684\u9806\u5e8f\uff1a</p>\n<ol>\n<li>\u7576 <code class=\"language-javascript\">&lt;Clock /&gt;</code> \u88ab\u50b3\u5165\u5230 <code class=\"language-javascript\">root.render()</code> \u6642\uff0cReact \u6703\u547c\u53eb <code class=\"language-javascript\">Clock</code> component \u7684constructor\u3002\u7531\u65bc <code class=\"language-javascript\">Clock</code> \u9700\u8981\u986f\u793a\u76ee\u524d\u7684\u6642\u9593\uff0c\u5b83\u4f7f\u7528\u5305\u542b\u76ee\u524d\u6642\u9593\u7684 object \u521d\u59cb\u5316 <code class=\"language-javascript\">this.state</code>\u3002\u6211\u5011\u6703\u5728\u4e4b\u5f8c\u66f4\u65b0\u9019\u500b state\u3002</li>\n<li>React \u63a5\u8457\u547c\u53eb <code class=\"language-javascript\">Clock</code> component \u7684 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u3002\u9019\u5c31\u662f React \u5982\u4f55\u4e86\u89e3\u61c9\u8a72\u8981\u5728\u87a2\u5e55\u4e0a\u986f\u793a\u4ec0\u9ebc\u5167\u5bb9\u3002React \u63a5\u8457\u66f4\u65b0 DOM \u4f86\u7b26\u5408 <code class=\"language-javascript\">Clock</code> \u7684 render \u8f38\u51fa\u3002</li>\n<li>\u6bcf\u7576 <code class=\"language-javascript\">Clock</code> \u8f38\u51fa\u88ab\u63d2\u5165\u5230 DOM \u6642\uff0cReact \u6703\u547c\u53eb <code class=\"language-javascript\">componentDidMount()</code> \u751f\u547d\u9031\u671f\u65b9\u6cd5\u3002\u5728 <code class=\"language-javascript\">Clock</code> component \u751f\u547d\u9031\u671f\u65b9\u6cd5\u5167\uff0c\u6703\u8981\u6c42\u700f\u89bd\u5668\u8a2d\u5b9a timer \u6bcf\u79d2\u53bb\u547c\u53eb component \u7684 <code class=\"language-javascript\">tick()</code> \u65b9\u6cd5\u3002</li>\n<li>\u700f\u89bd\u5668\u6bcf\u79d2\u547c\u53eb <code class=\"language-javascript\">tick()</code> \u65b9\u6cd5\u3002\u5176\u4e2d\uff0c<code class=\"language-javascript\">Clock</code> component \u900f\u904e\u5305\u542b\u76ee\u524d\u6642\u9593\u7684 object \u547c\u53eb <code class=\"language-javascript\">setState()</code> \u4f86\u8abf\u5ea6 UI \u66f4\u65b0\u3002\u611f\u8b1d <code class=\"language-javascript\">setState()</code>\uff0cReact \u73fe\u5728\u77e5\u9053 state \u6709\u6240\u6539\u8b8a\uff0c\u4e26\u4e14\u518d\u4e00\u6b21\u547c\u53eb <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u4f86\u4e86\u89e3\u54ea\u4e9b\u5167\u5bb9\u8a72\u5448\u73fe\u5728\u87a2\u5e55\u4e0a\u3002\u9019\u6642\u5019\uff0c\u5728 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u5167\u7684 <code class=\"language-javascript\">this.state.date</code> \u5c07\u6703\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u6b64 render \u8f38\u51fa\u5c07\u6703\u662f\u66f4\u65b0\u7684\u6642\u9593\u3002React \u76f8\u61c9\u5730\u66f4\u65b0 DOM\u3002</li>\n<li>\u5982\u679c <code class=\"language-javascript\">Clock</code> component \u5f9e DOM \u88ab\u79fb\u9664\u4e86\uff0cReact \u6703\u547c\u53eb <code class=\"language-javascript\">componentWillUnmount()</code> \u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u6240\u4ee5 timer \u6703\u88ab\u505c\u6b62\u3002</li>\n</ol>\n<h2 id=\"using-state-correctly\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#using-state-correctly\"></a>\u6b63\u78ba\u7684\u4f7f\u7528 State </h2>\n<p>\u6709\u4e09\u4ef6\u95dc\u65bc <code class=\"language-javascript\">setState()</code> \u7684\u4e8b\u60c5\u4f60\u61c9\u8a72\u8981\u77e5\u9053\u3002</p>\n<h3 id=\"do-not-modify-state-directly\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#do-not-modify-state-directly\"></a>\u8acb\u4e0d\u8981\u76f4\u63a5\u4fee\u6539 State </h3>\n<p>\u4f8b\u5982\uff0c\u9019\u5c07\u4e0d\u6703\u91cd\u65b0 render component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u932f\u8aa4</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>comment <span class=\"token operator\">=</span> <span class=\"token string\">'Hello'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u76f8\u53cd\u7684\uff0c\u4f7f\u7528 <code class=\"language-javascript\">setState()</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u6b63\u78ba</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">comment</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u4f60\u552f\u4e00\u53ef\u4ee5\u6307\u5b9a <code class=\"language-javascript\">this.state</code> \u503c\u7684\u5730\u65b9\u662f\u5728 constructor\u3002</p>\n<h3 id=\"state-updates-may-be-asynchronous\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#state-updates-may-be-asynchronous\"></a>State \u7684\u66f4\u65b0\u53ef\u80fd\u662f\u975e\u540c\u6b65\u7684 </h3>\n<p>React \u53ef\u4ee5\u5c07\u591a\u500b <code class=\"language-javascript\">setState()</code> \u547c\u53eb\u6279\u6b21\u8655\u7406\u70ba\u55ae\u4e00\u7684\u66f4\u65b0\uff0c\u4ee5\u63d0\u9ad8\u6548\u80fd\u3002</p>\n<p>\u56e0\u70ba <code class=\"language-javascript\">this.props</code> \u548c <code class=\"language-javascript\">this.state</code> \u53ef\u80fd\u662f\u975e\u540c\u6b65\u7684\u88ab\u66f4\u65b0\uff0c\u4f60\u4e0d\u61c9\u8a72\u4f9d\u8cf4\u5b83\u5011\u7684\u503c\u4f86\u8a08\u7b97\u65b0\u7684 state\u3002</p>\n<p>\u4f8b\u5982\uff0c\u9019\u500b\u7a0b\u5f0f\u78bc\u53ef\u80fd\u7121\u6cd5\u66f4\u65b0 counter\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u932f\u8aa4</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>increment<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u8981\u4fee\u6b63\u9019\u500b\u554f\u984c\uff0c\u4f7f\u7528\u7b2c\u4e8c\u7a2e\u5f62\u5f0f\u7684 <code class=\"language-javascript\">setState()</code>\uff0c\u5b83\u63a5\u53d7\u4e00\u500b function \u800c\u4e0d\u662f\u4e00\u500b object\u3002Function \u5c07\u63a5\u6536\u5148\u524d\u7684 state \u4f5c\u70ba\u7b2c\u4e00\u500b\u53c3\u6578\uff0c\u4e26\u4e14\u5c07\u66f4\u65b0\u7684 props \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u6b63\u78ba</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+</span> props<span class=\"token punctuation\">.</span>increment\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u6211\u5011\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions\">arrow function</a>\uff0c\u4f46\u5b83\u4e5f\u53ef\u4ee5\u9069\u7528\u65bc\u6b63\u5e38\u7684 function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u6b63\u78ba</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+</span> props<span class=\"token punctuation\">.</span>increment\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"state-updates-are-merged\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#state-updates-are-merged\"></a>State \u7684\u66f4\u65b0\u5c07\u6703\u88ab Merge </h3>\n<p>\u7576\u4f60\u547c\u53eb <code class=\"language-javascript\">setState()</code> \u6642\uff0cReact \u6703 merge \u4f60\u63d0\u4f9b\u7684 object \u5230\u76ee\u524d\u7684 state\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4f60\u7684 state \u53ef\u80fd\u5305\u542b\u5e7e\u500b\u55ae\u7368\u7684\u8b8a\u6578\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">posts</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">comments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7136\u5f8c\u4f60\u53ef\u4ee5\u55ae\u7368\u7684\u547c\u53eb <code class=\"language-javascript\">setState()</code> \u66f4\u65b0\u5b83\u5011\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">posts</span><span class=\"token operator\">:</span> response<span class=\"token punctuation\">.</span>posts</span>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">fetchComments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">comments</span><span class=\"token operator\">:</span> response<span class=\"token punctuation\">.</span>comments</span>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b merge \u662f shallow \u7684\uff0c\u6240\u4ee5 <code class=\"language-javascript\">this.setState({comments})</code> \u4fdd\u6301 <code class=\"language-javascript\">this.state.posts</code> \u7684\u5b8c\u6574\uff0c\u4f46\u5b83\u5b8c\u5168\u53d6\u4ee3\u4e86 <code class=\"language-javascript\">this.state.comments</code>\u3002</p>\n<h2 id=\"the-data-flows-down\"><a class=\"anchor\" href=\"/react/state-and-lifecycle#the-data-flows-down\"></a>\u5411\u4e0b\u8cc7\u6599\u6d41 </h2>\n<p>Parent \u548c child component \u4e0d\u6703\u77e5\u9053\u67d0\u500b component \u662f stateful \u6216 stateless \u7684 component\uff0c\u800c\u4e14\u5b83\u5011\u4e0d\u5728\u610f\u5b83\u662f\u900f\u904e function \u6216\u662f class \u88ab\u5b9a\u7fa9\u7684\u3002</p>\n<p>\u9019\u5c31\u662f state \u901a\u5e38\u88ab\u7a31\u70ba local state \u6216\u88ab\u5c01\u88dd\u7684\u539f\u56e0\u3002\u9664\u4e86\u64c1\u6709\u548c\u53ef\u4ee5\u8a2d\u5b9a\u5b83\u4e4b\u5916\u7684\u4efb\u4f55 component \u90fd\u4e0d\u80fd\u8a2a\u554f\u5b83\u3002</p>\n<p>Component \u53ef\u4ee5\u9078\u64c7\u5c07\u5b83\u7684 state \u505a\u70ba props \u5f80\u4e0b\u50b3\u905e\u5230\u5b83\u7684 child component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FormattedDate</span></span> <span class=\"token attr-name\">date</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p><code class=\"language-javascript\">FormattedDate</code> component \u6703\u5728\u5b83\u7684 props \u63a5\u6536\u5230 <code class=\"language-javascript\">date</code>\uff0c\u4f46\u4ed6\u4e0d\u77e5\u9053\u5b83\u662f\u5f9e <code class=\"language-javascript\">Clock</code> \u7684 state \u50b3\u905e\u904e\u4f86\u7684\uff0c\u5f9e <code class=\"language-javascript\">Clock</code> \u7684 props \u6216\u8005\u662f\u900f\u904e\u624b\u52d5\u8f38\u5165\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FormattedDate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">It is </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/zKRqNB?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u9019\u901a\u5e38\u88ab\u7a31\u4f5c\u70ba\u300c\u4e0a\u81f3\u4e0b\u300d\u6216\u300c\u55ae\u5411\u300d\u7684\u8cc7\u6599\u6d41\u3002\u4efb\u4f55 state \u7e3d\u662f\u7531\u67d0\u500b\u7279\u5b9a\u7684 component \u6240\u64c1\u6709\uff0c\u4efb\u4f55\u5f9e state \u5f97\u5230\u7684\u8cc7\u6599\u6216 UI\uff0cstate \u53ea\u80fd\u5f71\u97ff\u5728 tree\u300c\u4ee5\u4e0b\u300d\u7684 component\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3\u50cf\u4e00\u500b component tree \u662f\u4e00\u500b props \u7684\u7011\u5e03\uff0c\u6bcf\u500b component \u7684 state \u50cf\u662f\u4e00\u500b\u984d\u5916\u7684\u6c34\u6d41\u6e90\u982d\uff0c\u5b83\u5728\u4efb\u610f\u7684\u67d0\u500b\u5730\u65b9\u800c\u4e14\u5f80\u4e0b\u6d41\u3002</p>\n<p>\u70ba\u4e86\u8868\u793a\u6240\u6709 component \u771f\u7684\u90fd\u662f\u88ab\u7368\u7acb\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b <code class=\"language-javascript\">App</code> component \u4f86 render \u4e09\u500b <code class=\"language-javascript\">&lt;Clock&gt;</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Clock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/vXdGmd?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u6bcf\u500b <code class=\"language-javascript\">Clock</code> \u8a2d\u5b9a\u5b83\u672c\u8eab\u7684 timer \u4e26\u7368\u7acb\u7684\u66f4\u65b0\u3002</p>\n<p>\u5728 React \u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4e0d\u8ad6 component \u662f stateful \u6216 stateless \u90fd\u88ab\u8996\u70ba\u662f\u5be6\u4f5c component \u7684\u7d30\u7bc0\uff0c\u5b83\u53ef\u80fd\u96a8\u8457\u6642\u9593\u800c\u6539\u8b8a\u3002\u4f60\u53ef\u4ee5\u5728 stateful component \u5167\u4f7f\u7528 stateless component\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/state-and-lifecycle.md\">Edit this page</a></p></div></article>", "path": "/react/state-and-lifecycle", "nav": ["/react/components-and-props", "/react/handling-events"]}, {"key": "6. \u4e8b\u4ef6\u8655\u7406", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u4f7f\u7528 React element \u8655\u7406\u4e8b\u4ef6\u8ddf\u4f7f\u7528 DOM element \u8655\u7406\u4e8b\u4ef6\u662f\u5341\u5206\u76f8\u4f3c\u7684\u3002\u5b83\u5011\u6709\u4e00\u4e9b\u8a9e\u6cd5\u4e0a\u7684\u5dee\u7570\uff1a</p>\n<ul>\n<li>\u4e8b\u4ef6\u7684\u540d\u7a31\u5728 React \u4e2d\u90fd\u662f camelCase\uff0c\u800c\u5728 HTML DOM \u4e2d\u5247\u662f\u5c0f\u5beb\u3002</li>\n<li>\u4e8b\u4ef6\u7684\u503c\u5728 JSX \u4e2d\u662f\u4e00\u500b function\uff0c\u800c\u5728 HTML DOM \u4e2d\u5247\u662f\u4e00\u500b string\u3002</li>\n</ul>\n<p>\u4f8b\u5982\uff0c\u5728 HTML \u4e2d\u7684\u8a9e\u6cd5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">activateLasers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\n  Activate Lasers\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u548c\u5728 React \u4e2d\u7684\u8a9e\u6cd5\u6709\u4e9b\u5fae\u7684\u4e0d\u540c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>activateLasers<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">  Activate Lasers</span>\n<span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u53e6\u5916\u4e00\u500b\u5dee\u7570\u662f\uff0c\u5728 React \u4e2d\uff0c\u4f60\u4e0d\u80fd\u5920\u4f7f\u7528 <code class=\"language-javascript\">return false</code> \u4f86\u907f\u514d\u700f\u89bd\u5668\u9810\u8a2d\u884c\u70ba\u3002\u4f60\u5fc5\u9808\u660e\u78ba\u5730\u547c\u53eb <code class=\"language-javascript\">preventDefault</code>\u3002\u4f8b\u5982\uff0c\u5728\u7d14 HTML \u4e2d\uff0c\u82e5\u8981\u907f\u514d\u9023\u7d50\u958b\u555f\u65b0\u9801\u7684\u9810\u8a2d\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u9019\u6a23\u5beb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onsubmit</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked submit.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Submit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5728 React \u4e2d\uff0c\u4f60\u5247\u53ef\u4ee5\u9019\u6a23\u5beb\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked submit.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Submit</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u9019\u88e1\uff0c<code class=\"language-javascript\">e</code> \u662f\u4e00\u500b synthetic \u4e8b\u4ef6\uff08synthetic event\uff09\u3002React \u6839\u64da <a class=\"external-link\" href=\"https://www.w3.org/TR/DOM-Level-3-Events/\">W3C \u898f\u7bc4</a>\u4f86\u5b9a\u7fa9\u9019\u4e9b synthetic \u4e8b\u4ef6\uff0cReact event \u8207 native event \u5de5\u4f5c\u7684\u65b9\u5f0f\u4e0d\u76e1\u7136\u76f8\u540c\u3002\u82e5\u60f3\u4e86\u89e3\u66f4\u591a\u9019\u65b9\u9762\u7684\u8cc7\u8a0a\uff0c\u8acb\u53c3\u8003 <a href=\"/react/events\"><code class=\"language-javascript\">SyntheticEvent</code></a>\u3002</p>\n<p>\u7576\u4f7f\u7528 React \u6642\uff0c\u4f60\u4e0d\u9700\u8981\u5728\u5efa\u7acb\u4e00\u500b DOM element \u5f8c\u518d\u4f7f\u7528 <code class=\"language-javascript\">addEventListener</code> \u4f86\u52a0\u4e0a listener\u3002\u4f60\u53ea\u9700\u8981\u5728\u9019\u500b element \u525b\u958b\u59cb\u88ab render \u6642\u5c31\u63d0\u4f9b\u4e00\u500b listener\u3002</p>\n<p>\u7576\u4f60\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes\">ES6 class</a> \u4f86\u5b9a\u7fa9 Component \u6642\uff0c\u5e38\u898b\u7684\u6163\u4f8b\u662f\u628a event handler \u7576\u6210\u90a3\u500b class \u7684\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u9019\u500b <code class=\"language-javascript\">Toggle</code> Component \u6703 render \u4e00\u500b\u6309\u9215\uff0c\u8b93\u4f7f\u7528\u8005\u53ef\u4ee5\u8f49\u63db state \u4e2d\u7684\u300c\u958b\u300d\u8207\u300c\u95dc\u300d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Toggle</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">isToggleOn</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u70ba\u4e86\u8b93 `this` \u80fd\u5728 callback \u4e2d\u88ab\u4f7f\u7528\uff0c\u9019\u88e1\u7684\u7d81\u5b9a\u662f\u5fc5\u8981\u7684\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevState</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">isToggleOn</span><span class=\"token operator\">:</span> <span class=\"token operator\">!</span>prevState<span class=\"token punctuation\">.</span>isToggleOn</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isToggleOn <span class=\"token operator\">?</span> <span class=\"token string\">'ON'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'OFF'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/xEmzGg?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u8acb\u7279\u5225\u6ce8\u610f <code class=\"language-javascript\">this</code> \u5728 JSX callback \u4e2d\u7684\u610f\u7fa9\u3002\u5728 JavaScript \u4e2d\uff0cclass \u7684\u65b9\u6cd5\u5728\u9810\u8a2d\u4e0a\u662f\u6c92\u6709\u88ab\u7d81\u5b9a\uff08<a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_objects/Function/bind\">bound</a>\uff09\u7684\u3002\u5982\u679c\u4f60\u5fd8\u4e86\u7d81\u5b9a <code class=\"language-javascript\">this.handleClick</code> \u4e26\u628a\u5b83\u50b3\u905e\u7d66 <code class=\"language-javascript\">onClick</code> \u7684\u8a71\uff0c<code class=\"language-javascript\">this</code> \u7684\u503c\u5c07\u6703\u5728\u8a72 function \u88ab\u547c\u53eb\u6642\u8b8a\u6210 <code class=\"language-javascript\">undefined</code>\u3002</p>\n<p>\u9019\u4e26\u975e\u662f React \u624d\u6709\u7684\u884c\u70ba\uff0c\u800c\u662f <a class=\"external-link\" href=\"https://www.smashingmagazine.com/2014/01/understanding-javascript-function-prototype-bind/\">function \u5728 JavaScript \u4e2d\u7684\u904b\u4f5c\u6a21\u5f0f</a>\u3002\u7e3d\u4e4b\uff0c\u7576\u4f60\u4f7f\u7528\u4e00\u500b\u65b9\u6cd5\uff0c\u537b\u6c92\u6709\u5728\u5f8c\u9762\u52a0\u4e0a <code class=\"language-javascript\">()</code> \u4e4b\u6642\uff08\u4f8b\u5982\u7576\u4f60\u4f7f\u7528 <code class=\"language-javascript\">onClick={this.handleClick}</code> \u6642\uff09\uff0c\u4f60\u61c9\u8a72\u8981\u7d81\u5b9a\u9019\u500b\u65b9\u6cd5\u3002</p>\n<p>\u5982\u679c\u547c\u53eb <code class=\"language-javascript\">bind</code> \u5c0d\u4f60\u4f86\u8aaa\u5f88\u9ebb\u7169\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u7528\u5225\u7684\u65b9\u5f0f\u3002\u4f60\u53ef\u4ee5\u7528 public class field \u4f86\u6b63\u78ba\u7684\u7d81\u5b9a callback\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">LoggingButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u9019\u500b\u8a9e\u6cd5\u78ba\u4fdd `this` \u662f\u5728 handleClick \u4e2d\u88ab\u7d81\u5b9a\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'this is:'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u8a9e\u6cd5\u5728 <a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a> \u4e2d\u662f\u9810\u8a2d\u6210\u53ef\u884c\u7684\u3002</p>\n<p>\u5982\u679c\u4f60\u4e26\u6c92\u6709\u4f7f\u7528 class field \u7684\u8a9e\u6cd5\u7684\u8a71\uff0c\u4f60\u5247\u53ef\u4ee5\u5728 callback \u4e2d\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions\">arrow function</a>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">LoggingButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'this is:'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u9019\u500b\u8a9e\u6cd5\u78ba\u4fdd `this` \u662f\u5728 handleClick \u4e2d\u88ab\u7d81\u5b9a\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u8a9e\u6cd5\u7684\u554f\u984c\u662f\u6bcf\u4e00\u6b21 <code class=\"language-javascript\">LoggingButton</code> render \u7684\u6642\u5019\uff0c\u5c31\u6703\u5efa\u7acb\u4e00\u500b\u4e0d\u540c\u7684 callback\u3002\u5927\u591a\u6642\u5019\uff0c\u9019\u662f\u7121\u6240\u8b02\u7684\u3002\u7136\u800c\uff0c\u5982\u679c\u9019\u500b callback \u88ab\u7576\u4f5c\u4e00\u500b prop \u50b3\u7d66\u4e0b\u5c64\u7684 component \u7684\u8a71\uff0c\u5176\u4ed6\u7684 component \u4e5f\u8a31\u6703\u505a\u4e9b\u591a\u9918\u7684 re-render\u3002\u539f\u5247\u4e0a\u4f86\u8aaa\uff0c\u6211\u5011\u5efa\u8b70\u5728 constructor \u5167\u7d81\u5b9a\uff0c\u6216\u4f7f\u7528 class field \u8a9e\u6cd5\uff0c\u4ee5\u907f\u514d\u9019\u985e\u7684\u6027\u80fd\u554f\u984c\u3002</p>\n<h2 id=\"passing-arguments-to-event-handlers\"><a class=\"anchor\" href=\"/react/handling-events#passing-arguments-to-event-handlers\"></a>\u5c07\u53c3\u6578\u50b3\u7d66 Event Handler </h2>\n<p>\u5728\u4e00\u500b\u8ff4\u5708\u4e2d\uff0c\u6211\u5011\u5e38\u5e38\u6703\u9700\u8981\u50b3\u905e\u4e00\u500b\u984d\u5916\u7684\u53c3\u6578\u7d66 event handler\u3002\u4f8b\u5982\uff0c\u5982\u679c <code class=\"language-javascript\">id</code> \u662f\u6bcf\u4e00\u884c\u7684 ID \u7684\u8a71\uff0c\u4e0b\u9762\u5169\u7a2e\u8a9e\u6cd5\u90fd\u53ef\u884c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">deleteRow</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Delete Row</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">deleteRow</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Delete Row</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4ee5\u4e0a\u9019\u5169\u884c\u7a0b\u5f0f\u662f\u76f8\u540c\u7684\u3002\u4e00\u500b\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Functions/Arrow_functions\">arrow functions</a>\uff0c\u53e6\u4e00\u500b\u5247\u4f7f\u7528\u4e86<a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_objects/Function/bind\"><code class=\"language-javascript\">Function.prototype.bind</code></a>\u3002</p>\n<p>\u4ee5\u9019\u5169\u500b\u4f8b\u5b50\u4f86\u8aaa\uff0c<code class=\"language-javascript\">e</code> \u9019\u500b\u53c3\u6578\u6240\u4ee3\u8868\u7684 React \u4e8b\u4ef6\u5c07\u6703\u88ab\u7576\u4f5c ID \u4e4b\u5f8c\u7684\u7b2c\u4e8c\u500b\u53c3\u6578\u88ab\u50b3\u905e\u4e0b\u53bb\u3002\u5728\u4f7f\u7528 arrow function \u6642\uff0c\u6211\u5011\u5fc5\u9808\u660e\u78ba\u5730\u5c07\u5b83\u50b3\u905e\u4e0b\u53bb\uff0c\u4f46\u82e5\u4f7f\u7528 <code class=\"language-javascript\">bind</code> \u8a9e\u6cd5\uff0c\u672a\u4f86\u4efb\u4f55\u7684\u53c3\u6578\u90fd\u5c07\u6703\u81ea\u52d5\u88ab\u50b3\u905e\u4e0b\u53bb\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/handling-events.md\">Edit this page</a></p></div></article>", "path": "/react/handling-events", "nav": ["/react/state-and-lifecycle", "/react/conditional-rendering"]}, {"key": "7. \u689d\u4ef6 Render", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u5728 React \u4e2d\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u4e0d\u540c\u7684 component \u4f86\u5c01\u88dd\u4f60\u9700\u8981\u7684\u884c\u70ba\u3002\u63a5\u8457\uff0c\u4f60\u53ef\u4ee5\u6839\u64da\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u7684 state\uff0c\u4f86 render \u5176\u4e2d\u7684\u4e00\u90e8\u4efd\u3002</p>\n<p>React \u4e2d\u7684\u689d\u4ef6 rendering \u8ddf JavaScript \u4e00\u81f4\u3002\u4f7f\u7528 JavaScript \u4e2d\u7684\u904b\u7b97\u5b50\u5982 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/if...else\"><code class=\"language-javascript\">if</code></a> \u6216\u8005 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Conditional_Operator\">\u4e09\u5143\u904b\u7b97\u5b50</a> \u4f86\u5efa\u7acb\u8868\u793a\u76ee\u524d state \u7684 element\uff0c\u7136\u5f8c\u8b93 React \u6839\u64da\u5b83\u5011\u4f86\u66f4\u65b0 UI\u3002</p>\n<p>\u5148\u770b\u4ee5\u4e0b\u5169\u500b component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">UserGreeting</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Welcome back!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">GuestGreeting</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Please sign up.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u5c07\u6703\u5efa\u7acb\u4e00\u500b <code class=\"language-javascript\">Greeting</code> component\uff0c\u5b83\u6703\u6839\u64da\u4f7f\u7528\u8005\u662f\u5426\u5df2\u767b\u5165\u4f86\u986f\u793a\u5176\u4e2d\u4e4b\u4e00\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Greeting</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isLoggedIn <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>isLoggedIn<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoggedIn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserGreeting</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">GuestGreeting</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// \u8a66\u6539\u70ba isLoggedIn={true}:</span>\n<span class=\"gatsby-highlight-code-line\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Greeting</span></span> <span class=\"token attr-name\">isLoggedIn</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ZpVxNq?editors=0011\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u9019\u7bc4\u4f8b\u6839\u64da <code class=\"language-javascript\">isLoggedIn</code> prop \u7684\u503c\u4f86 render \u4e0d\u540c\u7684\u554f\u5019\u8a9e\u3002</p>\n<h3 id=\"element-variables\"><a class=\"anchor\" href=\"/react/conditional-rendering#element-variables\"></a>Element \u8b8a\u6578 </h3>\n<p>\u4f60\u53ef\u4ee5\u7528\u8b8a\u6578\u4f86\u5132\u5b58 element\u3002\u5b83\u53ef\u4ee5\u5e6b\u52a9\u4f60\u6709\u689d\u4ef6\u5730 render \u4e00\u90e8\u4efd\u7684 component\uff0c\u800c\u4fdd\u6301\u5176\u4ed6\u8f38\u51fa\u4e0d\u8b8a\u3002</p>\n<p>\u601d\u8003\u9019\u5169\u500b\u65b0\u7684\u767b\u5165\u548c\u767b\u51fa\u6309\u9215 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">LoginButton</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      Login\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">LogoutButton</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      Logout\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u4e0b\u5217\u7bc4\u4f8b\uff0c\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">LoginControl</code> \u7684 <a href=\"/react/state-and-lifecycle#adding-local-state-to-a-class\">stateful component</a>\u3002</p>\n<p>\u5b83\u5c07\u6839\u64da\u76ee\u524d\u7684 state \u4f86 render <code class=\"language-javascript\">&lt;LoginButton /&gt;</code> \u6216 <code class=\"language-javascript\">&lt; LogoutButton /&gt;</code>\u3002\u800c\u4e14\u4e5f\u6703 render \u524d\u9762\u7bc4\u4f8b\u7684 <code class=\"language-javascript\">&lt;Greeting /&gt;</code>\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginControl</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLoginClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleLoginClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLogoutClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleLogoutClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">isLoggedIn</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleLoginClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">isLoggedIn</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleLogoutClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">isLoggedIn</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> isLoggedIn <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isLoggedIn<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> button<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoggedIn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      button <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogoutButton</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLogoutClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      button <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginButton</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLoginClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Greeting</span></span> <span class=\"token attr-name\">isLoggedIn</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isLoggedIn<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>button<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginControl</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/QKzAgB?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u96d6\u7136\u5ba3\u544a\u8b8a\u6578\u4e26\u4f7f\u7528 <code class=\"language-javascript\">if</code> \u8a9e\u53e5\u4f86\u6709\u689d\u4ef6 render component \u662f\u4e00\u500b\u4e0d\u932f\u7684\u65b9\u5f0f\uff0c\u4f46\u6709\u6642\u4f60\u4e5f\u60f3\u4f7f\u7528\u66f4\u7c21\u6f54\u7684\u8a9e\u6cd5\u3002\u5728 JSX \u4e2d\u6709\u4ee5\u4e0b\u5e7e\u7a2e\u65b9\u6cd5\uff1a</p>\n<h3 id=\"inline-if-with-logical--operator\"><a class=\"anchor\" href=\"/react/conditional-rendering#inline-if-with-logical--operator\"></a>Inline If \u8207 &amp;&amp; \u908f\u8f2f\u904b\u7b97\u5b50 </h3>\n<p>\u4f60\u53ef\u4ee5\u900f\u904e\u5927\u62ec\u865f<a href=\"/react/introducing-jsx#embedding-expressions-in-jsx\">\u5728 JSX \u4e2d\u5d4c\u5165\u8868\u9054\u5f0f</a>\uff0c\u5305\u62ec JavaScript \u7684 <code class=\"language-javascript\">&amp;&amp;</code> \u908f\u8f2f\u904b\u7b97\u5b50\uff0c\u53ef\u4ee5\u65b9\u4fbf render \u6709\u689d\u4ef6\u7684 element\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Mailbox</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> unreadMessages <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>unreadMessages<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>unreadMessages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          You have </span><span class=\"token punctuation\">{</span>unreadMessages<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> unread messages.</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'React'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Re: React'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Re:Re: React'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mailbox</span></span> <span class=\"token attr-name\">unreadMessages</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>messages<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ozJddz?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u80fd\u5920\u9019\u6a23\u505a\u662f\u56e0\u70ba\u5728 JavaScript \u4e2d\uff0c<code class=\"language-javascript\">true &amp;&amp; expression</code> \u7e3d\u662f\u56de\u50b3 <code class=\"language-javascript\">expression</code> \uff0c\u800c <code class=\"language-javascript\">false &amp;&amp; expression</code> \u7e3d\u662f\u56de\u50b3 <code class=\"language-javascript\">false</code>\u3002</p>\n<p>\u6240\u4ee5\uff0c\u7576\u689d\u4ef6\u70ba <code class=\"language-javascript\">true</code> \u6642\uff0c<code class=\"language-javascript\">&amp;&amp;</code> \u53f3\u5074\u7684 element \u6703\u51fa\u73fe\u5728\u8f38\u51fa\u4e2d\uff0c\u5982\u679c\u662f <code class=\"language-javascript\">false</code>\uff0cReact \u6703\u5ffd\u7565\u4e26\u8df3\u904e\u5b83\u3002</p>\n<p>\u8acb\u6ce8\u610f\uff0c\u56de\u50b3 falsy expression \u4ecd\u6703\u5c0e\u81f4 <code class=\"language-javascript\">&amp;&amp;</code> \u4e4b\u5f8c\u7684 element \u88ab\u5ffd\u7565\uff0c\u4f46\u4f9d\u820a\u56de\u50b3 falsy expression\uff0c\u5728\u4e0b\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0crender \u5c07\u6703\u56de\u50b3 <code class=\"language-javascript\">&lt;div&gt;0&lt;/div&gt;</code>\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>count <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Messages: </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"inline-if-else-with-conditional-operator\"><a class=\"anchor\" href=\"/react/conditional-rendering#inline-if-else-with-conditional-operator\"></a>Inline If-Else \u8207\u4e09\u5143\u904b\u7b97\u5b50 </h3>\n<p>\u53e6\u4e00\u500b\u6709\u689d\u4ef6 render element \u7684\u65b9\u5f0f\u662f\u900f\u904e JavaScript \u7684\u4e09\u5143\u904b\u7b97\u5b50 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Conditional_Operator\"><code class=\"language-javascript\">condition ? true : false</code></a>\u3002</p>\n<p>\u5728\u4e0b\u9762\u7684\u7bc4\u4f8b\uff0c\u6211\u5011\u6703\u7528\u5b83\u4f86\u6709\u689d\u4ef6\u5730 render \u4e00\u5c0f\u6bb5\u6587\u5b57\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isLoggedIn <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isLoggedIn<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      The user is </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>b</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>isLoggedIn <span class=\"token operator\">?</span> <span class=\"token string\">'currently'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'not'</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>b</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"> logged in.</span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5b83\u4e5f\u53ef\u4ee5\u88ab\u7528\u5728\u8f03\u8907\u96dc\u7684\u8868\u9054\u5f0f\u4e0a\uff0c\u96d6\u7136\u4e0d\u662f\u592a\u660e\u986f\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isLoggedIn <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isLoggedIn<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>isLoggedIn</span>        <span class=\"token operator\">?</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogoutButton</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLogoutClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginButton</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLoginClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>      <span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5c31\u8ddf\u5728 JavaScript \u4e2d\u4e00\u6a23\uff0c\u4f60\u53ef\u4ee5\u6839\u64da\u5718\u968a\u7fd2\u6163\u4f86\u9078\u64c7\u66f4\u5408\u9069\u7684\u98a8\u683c\u3002\u9084\u8981\u8a18\u8457\u5982\u679c\u689d\u4ef6\u8b8a\u5f97\u904e\u65bc\u8907\u96dc\uff0c\u4e5f\u8a31\u662f\u500b\u597d\u6642\u6a5f\u4f86<a class=\"external-link\" href=\"docs/components-and-props.html#extracting-components\">\u62bd\u96e2 component</a> \u4e86\u3002</p>\n<h3 id=\"preventing-component-from-rendering\"><a class=\"anchor\" href=\"/react/conditional-rendering#preventing-component-from-rendering\"></a>\u9632\u6b62 Component Render </h3>\n<p>\u5728\u5c11\u6578\u7684\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b component \u96b1\u85cf\u81ea\u5df1\u672c\u8eab\uff0c\u5373\u4fbf\u5b83\u662f\u7531\u53e6\u4e00\u500b component \u88ab render\u3002\u53ef\u4ee5\u900f\u904e\u56de\u50b3 <code class=\"language-javascript\">null</code> \u800c\u4e0d\u662f\u5b83\u7684 render \u8f38\u51fa\u3002</p>\n<p>\u5728\u4e0b\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c<code class=\"language-javascript\">&lt;WarningBanner /&gt;</code> \u7684 render \u53d6\u6c7a\u65bc <code class=\"language-javascript\">warn</code> prop \u7684\u503c\u3002\u5982\u679c prop \u662f <code class=\"language-javascript\">false</code>\uff0c\u5b83\u5c31\u4e0d\u6703 render\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">WarningBanner</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>props<span class=\"token punctuation\">.</span>warn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>warning<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      Warning!</span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Page</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">showWarning</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleToggleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleToggleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleToggleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">showWarning</span><span class=\"token operator\">:</span> <span class=\"token operator\">!</span>state<span class=\"token punctuation\">.</span>showWarning\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WarningBanner</span></span> <span class=\"token attr-name\">warn</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>showWarning<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleToggleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>showWarning <span class=\"token operator\">?</span> <span class=\"token string\">'Hide'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Show'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Page</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/Xjoqwm?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u5728 component \u4e2d\u56de\u50b3 <code class=\"language-javascript\">null</code> \u4e26\u4e0d\u6703\u5f71\u97ff component \u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u3002\u4f8b\u5982 <code class=\"language-javascript\">componentDidUpdate</code> \u4f9d\u7136\u53ef\u4ee5\u88ab\u547c\u53eb\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/conditional-rendering.md\">Edit this page</a></p></div></article>", "path": "/react/conditional-rendering", "nav": ["/react/handling-events", "/react/lists-and-keys"]}, {"key": "8. \u5217\u8868\u8207 Key", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u9996\u5148\uff0c\u8b93\u6211\u5011\u8907\u7fd2\u4e00\u4e0b\u5728 JavaScript \u4e2d\u5982\u4f55\u6539\u8b8a\u5217\u8868\u3002</p>\n<p>\u5728\u4ee5\u4e0b\u7684\u7a0b\u5f0f\u78bc\u4e2d\uff0c\u6211\u5011\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code class=\"language-javascript\">map()</code></a> function \u4f86\u63a5\u6536 <code class=\"language-javascript\">numbers</code> array\uff0c\u4e26\u5c07\u5176\u4e2d\u7684\u6bcf\u500b\u503c\u4e58\u4ee5\u5169\u500d\u3002\u6211\u5011\u5c07 <code class=\"language-javascript\">map()</code> \u56de\u50b3\u7684\u65b0 array \u8a2d\u5b9a\u70ba\u8b8a\u6578 <code class=\"language-javascript\">doubled</code> \u7684\u503c\u4e26\u5370\u51fa\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> doubled <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> number <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>doubled<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u5728 console \u4e2d\u5370\u51fa <code class=\"language-javascript\">[2, 4, 6, 8, 10]</code>\u3002</p>\n<p>\u5728 React \u4e2d\uff0c\u5c07 array \u8f49\u8b8a\u6210 <a href=\"/react/rendering-elements\">element</a> \u5217\u8868\u5e7e\u4e4e\u662f\u4e00\u6a23\u7684\u65b9\u5f0f\u3002</p>\n<h3 id=\"rendering-multiple-components\"><a class=\"anchor\" href=\"/react/lists-and-keys#rendering-multiple-components\"></a>Render \u591a\u500b Component </h3>\n<p>\u4f60\u53ef\u4ee5\u5efa\u7acb\u4e00\u7cfb\u5217\u7684 element \u4e26\u7528\u5927\u62ec\u865f <code class=\"language-javascript\">{}</code> <a href=\"/react/introducing-jsx#embedding-expressions-in-jsx\">\u5c07\u5b83\u5011\u5305\u542b\u5728 JSX \u88e1\u9762</a>\u3002</p>\n<p>\u4e0b\u9762\uff0c\u6211\u5011\u6703\u7528 JavaScript \u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\"><code class=\"language-javascript\">map()</code></a> function \u8fed\u4ee3 <code class=\"language-javascript\">numbers</code> array\uff0c\u6211\u5011\u6bcf\u6b21\u90fd\u6703\u56de\u50b3\u4e00\u500b <code class=\"language-javascript\">&lt;li&gt;</code> element\u3002\u6700\u5f8c\uff0c\u6211\u5011\u6703\u628a\u7d50\u679c\u7522\u751f\u7684 element array \u8a2d\u5b9a\u70ba <code class=\"language-javascript\">listItems</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>\u63a5\u8457\uff0c\u6211\u5011\u6703\u628a\u6574\u500b <code class=\"language-javascript\">listItems</code> array \u5305\u542b\u5728\u4e00\u500b <code class=\"language-javascript\">&lt;ul&gt;</code> element \u5167\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/GjPyQr?editors=0011\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u5c55\u793a\u4e86\u4e00\u500b\u6578\u5b57\u5217\u8868\uff0c\u5f9e 1 \u5230 5\u3002</p>\n<h3 id=\"basic-list-component\"><a class=\"anchor\" href=\"/react/lists-and-keys#basic-list-component\"></a>\u57fa\u672c\u5217\u8868 Component </h3>\n<p>\u4e00\u822c\u4f86\u8aaa\uff0c\u4f60\u6703\u5728\u4e00\u500b <a href=\"/react/components-and-props\">component</a> \u5167 render \u5217\u8868\u3002</p>\n<p>\u6211\u5011\u53ef\u4ee5\u5c07\u4e0a\u9762\u7684\u7bc4\u4f8b\u6539\u5beb\u70ba\u4e00\u500b\u63a5\u6536 <code class=\"language-javascript\">numbers</code> array \u4e26\u8f38\u51fa\u4e00\u500b\u6c92\u6709\u6392\u5e8f\u7684 element \u5217\u8868\u7684 component\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NumberList</span></span> <span class=\"token attr-name\">numbers</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>numbers<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>\u7576\u4f60\u57f7\u884c\u9019\u6bb5\u7a0b\u5f0f\u78bc\u6642\uff0c\u4f60\u6703\u6536\u5230\u4e00\u500b\u95dc\u65bc\u4f60\u61c9\u8a72\u63d0\u4f9b key \u7d66\u6bcf\u4e00\u500b\u5217\u8868\u9805\u76ee\u7684\u8b66\u544a\u3002\u300ckey\u300d\u662f\u7576\u4f60\u5728\u5efa\u7acb\u4e00\u500b element \u5217\u8868\u6642\u5fc5\u9808\u4f7f\u7528\u7684\u7279\u6b8a\u7684 string attribute\u3002\u5728\u4e0b\u4e00\u500b\u6bb5\u843d\u4e2d\uff0c\u6211\u5011\u5c07\u6703\u8a0e\u8ad6\u5176\u91cd\u8981\u6027\u3002</p>\n<p>\u8b93\u6211\u5011\u70ba <code class=\"language-javascript\">numbers.map()</code> \u5217\u8868\u4e2d\u7684\u6bcf\u500b\u9805\u76ee\u5206\u914d\u4e00\u500b <code class=\"language-javascript\">key</code>\uff0c\u4e26\u4fee\u6b63\u907a\u6f0f key \u7684\u554f\u984c\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/jrXYRR?editors=0011\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<h2 id=\"keys\"><a class=\"anchor\" href=\"/react/lists-and-keys#keys\"></a>Key </h2>\n<p>Key \u5e6b\u52a9 React \u5206\u8fa8\u54ea\u4e9b\u9805\u76ee\u88ab\u6539\u8b8a\u3001\u589e\u52a0\u6216\u522a\u9664\u3002\u5728 array \u88e1\u9762\u7684\u6bcf\u500b element \u90fd\u61c9\u8a72\u8981\u6709\u4e00\u500b key\uff0c\u5982\u6b64\u624d\u80fd\u7d66\u4e88\u6bcf\u500b element \u4e00\u500b\u56fa\u5b9a\u7684\u8eab\u4efd\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9078\u64c7 key \u6700\u4f73\u7684\u65b9\u6cd5\u662f\u5728\u5217\u8868\u4e2d\u4f7f\u7528\u552f\u4e00\u8b58\u5225\u5b57\u4e32\u4f86\u5340\u5225 sibling \u9805\u76ee\u3002\u901a\u5e38\uff0c\u4f60\u6703\u4f7f\u7528\u8cc7\u6599\u7684 ID \u4f5c\u70ba key\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> todoItems <span class=\"token operator\">=</span> todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u7576\u4f60 render \u7684\u9805\u76ee\u6c92\u6709\u56fa\u5b9a\u7684 ID \u4e14\u4f60\u4e5f\u6c92\u6709\u66f4\u597d\u7684\u8fa6\u6cd5\u6642\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u9805\u76ee\u7684\u7d22\u5f15\u505a\u70ba key\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> todoItems <span class=\"token operator\">=</span> todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">todo<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u8acb\u5728\u9805\u76ee\u6c92\u6709\u56fa\u5b9a\u7684 ID \u6642\u624d\u9019\u6a23\u505a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u6211\u5011\u4e26\u4e0d\u5efa\u8b70\u4f60\u4f7f\u7528\u7d22\u5f15\u4f5c\u70ba key\uff0c\u5c24\u5176\u5982\u679c\u9805\u76ee\u7684\u9806\u5e8f\u6703\u6539\u8b8a\u7684\u8a71\u3002\u9019\u6703\u5c0d\u6548\u80fd\u7522\u751f\u4e0d\u597d\u7684\u5f71\u97ff\uff0c\u4e5f\u53ef\u80fd\u6703\u8b93 component state \u7522\u751f\u554f\u984c\u3002\u8acb\u53c3\u8003 Robin Pokorny \u9019\u7bc7<a class=\"external-link\" href=\"https://robinpokorny.com/blog/index-as-a-key-is-an-anti-pattern/\">\u6df1\u5165\u5256\u6790\u4f7f\u7528\u7d22\u5f15\u4f5c\u70ba key \u7684\u8ca0\u9762\u6548\u61c9</a>\u3127\u6587\u3002\u5982\u679c\u4f60\u9078\u64c7\u4e0d\u660e\u78ba\u5206\u914d key \u5230\u5217\u8868\u9805\u76ee\u6642\uff0cReact \u9810\u8a2d\u5c07\u6703\u4f7f\u7528\u7d22\u5f15\u4f5c\u70ba key\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\uff0c\u8acb\u53c3\u8003<a href=\"/react/reconciliation#recursing-on-children\">\u6df1\u5ea6\u5256\u6790 key \u7684\u5fc5\u8981\u6027</a>\u4e00\u6587\u3002</p>\n<h3 id=\"extracting-components-with-keys\"><a class=\"anchor\" href=\"/react/lists-and-keys#extracting-components-with-keys\"></a>\u7528 Key \u62bd\u96e2 Component </h3>\n<p>Key \u53ea\u6709\u5728\u5468\u906d\u6709 array \u7684\u60c5\u5883\u4e2d\u624d\u6709\u610f\u7fa9\u3002</p>\n<p>\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u8981<a href=\"/react/components-and-props#extracting-components\">\u62bd\u96e2</a>\u4e00\u500b <code class=\"language-javascript\">ListItem</code> component \u7684\u8a71\uff0c\u4f60\u61c9\u8a72\u628a key \u653e\u5728 array \u88e1\u7684 <code class=\"language-javascript\">&lt;ListItem /&gt;</code> element \u4e0a\uff0c\u800c\u4e0d\u662f\u628a\u5b83\u653e\u5728 <code class=\"language-javascript\">ListItem</code> \u88e1\u9762\u7684 <code class=\"language-javascript\">&lt;li&gt;</code> element \u4e0a\u3002</p>\n<p><strong>\u7bc4\u4f8b\uff1aKey \u7684\u932f\u8aa4\u4f7f\u7528\u65b9\u5f0f</strong></p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u932f\uff01\u4f60\u4e0d\u9700\u8981\u5728\u9019\u88e1\u6307\u51fa key\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u932f\uff01\u4f60\u61c9\u8a72\u8981\u5728\u9019\u88e1\u6307\u51fa key\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListItem</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u7bc4\u4f8b\uff1aKey \u7684\u6b63\u78ba\u4f7f\u7528\u65b9\u5f0f</strong></p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u6b63\u78ba\uff01\u4f60\u4e0d\u9700\u8981\u5728\u9019\u88e1\u6307\u51fa key\uff1a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u6b63\u78ba\uff01Key \u61c9\u8a72\u5728 array \u5167\u88ab\u6307\u5b9a\u3002</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ZXeOGM?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u4e00\u500b\u597d\u7684\u7d93\u9a57\u6cd5\u5247\u662f\uff0c\u5728 <code class=\"language-javascript\">map()</code> \u547c\u53eb\u4e2d\u7684\u6bcf\u500b element \u90fd\u6703\u9700\u8981 key\u3002</p>\n<h3 id=\"keys-must-only-be-unique-among-siblings\"><a class=\"anchor\" href=\"/react/lists-and-keys#keys-must-only-be-unique-among-siblings\"></a>Key \u5fc5\u9808\u5728 Sibling \u4e2d\u662f\u552f\u4e00\u7684 </h3>\n<p>\u5728 array \u4e2d\u4f7f\u7528\u7684 key \u61c9\u8a72\u8981\u662f\u552f\u4e00\u7684\u503c\u3002\u7136\u800c\uff0c\u5b83\u5011\u4e0d\u5fc5\u5728\u5168\u57df\u4e2d\u552f\u4e00\u3002\u7576\u6211\u5011\u7522\u751f\u5169\u500b\u4e0d\u540c\u7684 array \u6642\uff0c\u6211\u5011\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684 key\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Blog</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> sidebar <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span></span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>posts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>posts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>sidebar<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>content<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello World'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token string\">'Welcome to learning React!'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">'Installation'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token string\">'You can install React from npm.'</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Blog</span></span> <span class=\"token attr-name\">posts</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>posts<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/NRZYGN?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>Key \u7684\u529f\u80fd\u662f\u63d0\u793a React\uff0c\u4f46\u5b83\u5011\u4e0d\u6703\u88ab\u50b3\u905e\u5230\u4f60\u7684 component\u3002\u5982\u679c\u4f60\u5728 component \u4e2d\u9700\u8981\u540c\u6a23\u7684\u503c\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u628a\u9019\u500b\u503c\u7528\u4e00\u500b\u4e0d\u540c\u7684\u540d\u7a31\u4f5c\u70ba prop \u50b3\u4e0b\u53bb\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> posts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Post</span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span></span>    <span class=\"token attr-name\">title</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code class=\"language-javascript\">Post</code> component \u53ef\u4ee5\u8b80\u53d6 <code class=\"language-javascript\">props.id</code>\uff0c\u4f46\u4e0d\u80fd\u8b80\u53d6 <code class=\"language-javascript\">props.key</code>\u3002</p>\n<h3 id=\"embedding-map-in-jsx\"><a class=\"anchor\" href=\"/react/lists-and-keys#embedding-map-in-jsx\"></a>\u5728 JSX \u4e2d\u5d4c\u5165 map() </h3>\n<p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u5011\u5ba3\u544a\u4e86\u53e6\u4e00\u500b <code class=\"language-javascript\">listItems</code> \u8b8a\u6578\u4e26\u628a\u5b83\u5305\u542b\u5728 JSX \u4e2d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> listItems <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>listItems<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JSX \u8b93\u4f60\u5728\u5927\u62ec\u865f\u4e2d<a href=\"/react/introducing-jsx#embedding-expressions-in-jsx\">\u5d4c\u5165\u4efb\u4f55\u8868\u9054\u5f0f</a>\uff0c\u6240\u4ee5\u6211\u5011\u80fd\u5920 inline <code class=\"language-javascript\">map()</code> \u7684\u7d50\u679c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NumberList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>numbers<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>numbers<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">                  <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>number<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/BLvYrB?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u6709\u6642\u5019\u9019\u6703\u7522\u751f\u66f4\u4e7e\u6de8\u7684\u7a0b\u5f0f\u78bc\uff0c\u4f46\u9019\u7a2e\u98a8\u683c\u4e5f\u53ef\u80fd\u88ab\u6feb\u7528\u3002\u5c31\u50cf JavaScript \u4e00\u6a23\uff0c\u662f\u5426\u8981\u5c07\u8b8a\u6578\u62bd\u53d6\u51fa\u4f86\u4ee5\u589e\u52a0\u53ef\u8b80\u6027\u5b8c\u5168\u662f\u770b\u4f60\u7684\u6c7a\u5b9a\u3002\u8acb\u8a18\u5f97\uff0c\u5982\u679c <code class=\"language-javascript\">map()</code> \b\u7684\u7a0b\u5f0f\u78bc\u5c64\u7d1a\u8b8a\u5f97\u904e\u5ea6\u5de2\u72c0\uff0c\u4e5f\u8a31\u5c31\u662f\u4f7f\u7528<a href=\"/react/components-and-props#extracting-components\">\u62bd\u96e2 component</a>\u7684\u6642\u5019\u4e86\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/lists-and-keys.md\">Edit this page</a></p></div></article>", "path": "/react/lists-and-keys", "nav": ["/react/conditional-rendering", "/react/forms"]}, {"key": "9. \u8868\u55ae", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>HTML \u8868\u55ae\u7684 element \u548c React \u4e2d\u5176\u4ed6\u7684 DOM element \u4e0d\u592a\u4e00\u6a23\uff0c\u56e0\u70ba\u8868\u55ae\u7684 element \u5f88\u81ea\u7136\u5730\u6709\u4e00\u4e9b\u5167\u90e8\u7684 state\u3002\u4f8b\u5982\uff0c\u9019\u500b\u8868\u55ae\u5728\u4e0b\u9762\u7c21\u55ae\u7684 HTML \u4e2d\u63a5\u53d7\u4e00\u500b\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n    Name:\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u7576\u4f7f\u7528\u8005\u63d0\u4ea4\u8868\u55ae\u6642\uff0c\u6b64\u8868\u55ae\u5177\u6709\u700f\u89bd\u5230\u65b0\u9801\u9762\u7684\u9810\u8a2d HTML \u8868\u55ae\u884c\u70ba\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728 React \u4e2d\u4e5f\u6709\u9019\u6a23\u7684\u884c\u70ba\u7684\u8a71\uff0c\u76f4\u63a5\u7528 HTML \u662f\u53ef\u884c\u7684\u3002\u4f46\u662f\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e2d\uff0c\u6709\u4e00\u500b JavaScript function \u4f86\u8655\u7406\u63d0\u4ea4\u8868\u55ae\u7684\u529f\u80fd\u4e26\u8b80\u53d6\u4f7f\u7528\u8005\u5728\u8868\u55ae\u4e2d\u586b\u5165\u7684\u8cc7\u6599\u662f\u5f88\u65b9\u4fbf\u7684\u3002\u8981\u505a\u5230\u9019\u6a23\uff0c\u6a19\u6e96\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u300ccontrolled component\u300d\uff1a</p>\n<h2 id=\"controlled-components\"><a class=\"anchor\" href=\"/react/forms#controlled-components\"></a>Controlled Component </h2>\n<p>\u5728 HTML \u4e2d\uff0c\u8868\u55ae\u7684 element \u50cf\u662f <code class=\"language-javascript\">&lt;input&gt;</code>\u3001<code class=\"language-javascript\">&lt;textarea&gt;</code> \u548c <code class=\"language-javascript\">&lt;select&gt;</code> \u901a\u5e38\u6703\u7dad\u6301\u5b83\u5011\u81ea\u8eab\u7684 state\uff0c\u4e26\u6839\u64da\u4f7f\u7528\u8005\u7684\u8f38\u5165\u4f86\u66f4\u65b0 state\u3002\u5728 React \u4e2d\uff0c\u53ef\u8b8a\u7684 state \u901a\u5e38\u662f\u88ab\u7dad\u6301\u5728 component \u4e2d\u7684 state property\uff0c\u4e26\u53ea\u80fd\u4ee5 <a href=\"/react/react-component#setstate\"><code class=\"language-javascript\">setState()</code></a> \u4f86\u66f4\u65b0\u3002</p>\n<p>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u5c07 React \u7684 state \u8b8a\u6210\u300c\u552f\u4e00\u771f\u76f8\u4f86\u6e90\u300d\u4f86\u5c07\u9019\u5169\u8005\u7d50\u5408\u3002\u5982\u6b64\uff0crender \u8868\u55ae\u7684 React component \u540c\u6642\u4e5f\u638c\u63e1\u4e86\u5f8c\u7e8c\u4f7f\u7528\u8005\u7684\u8f38\u5165\u5c0d\u8868\u55ae\u5e36\u4f86\u7684\u6539\u8b8a\u3002\u50cf\u9019\u6a23\u4e00\u500b\u8f38\u5165\u8868\u55ae\u7684 element\uff0c\u88ab React \u7528\u9019\u6a23\u7684\u65b9\u5f0f\u4f86\u63a7\u5236\u5b83\u7684\u503c\uff0c\u5c31\u88ab\u7a31\u70ba\u300ccontrolled component\u300d\u3002</p>\n<p>\u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u8b93\u4e0a\u4e00\u500b\u7bc4\u4f8b\u5728\u4e00\u500b\u540d\u5b57\u88ab\u8f38\u5165\u8868\u55ae\u6642\u5370\u51fa\uff0c\u6211\u5011\u53ef\u4ee5\u628a\u9019\u500b\u8868\u55ae\u5beb\u6210\u4e00\u500b controlled component\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NameForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A name was submitted: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Name:</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/VmmPgp?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u7531\u65bc <code class=\"language-javascript\">value</code> attribute \u662f\u88ab\u8a2d\u5b9a\u5728\u6211\u5011\u7684\u8868\u55ae element \u4e0a\uff0c\u986f\u793a\u7684 value \u6703\u6c38\u9060\u662f <code class=\"language-javascript\">this.state.value</code>\uff0c\u9019\u4f7f\u5f97 React \u7684 state \u6210\u70ba\u4e86\u8cc7\u6599\u4f86\u6e90\u3002\u7531\u65bc <code class=\"language-javascript\">handleChange</code> \u5728\u6bcf\u4e00\u6b21\u9375\u76e4\u88ab\u6572\u64ca\u6642\u90fd\u6703\u88ab\u57f7\u884c\uff0c\u4e26\u66f4\u65b0 React \u7684 state\uff0c\u56e0\u6b64\u88ab\u986f\u793a\u7684 value \u5c07\u6703\u5728\u4f7f\u7528\u8005\u6253\u5b57\u7684\u540c\u6642\u88ab\u66f4\u65b0\u3002</p>\n<p>\u5728\u9019\u6a23\u7684 controlled component \u4e2d\uff0c\u986f\u793a\u7684 value \u59cb\u7d42\u7531 React \u7684 state \u9a45\u52d5\uff0c\u96d6\u7136\u9019\u610f\u5473\u8457\u4f60\u5fc5\u9808\u5beb\u66f4\u591a\u7684 code\uff0c\u4f46\u73fe\u5728\u4f60\u540c\u6642\u53ef\u4ee5\u5c07 value \u50b3\u905e\u7d66\u5176\u4ed6\u7684 UI element\uff0c\u6216\u662f\u5f9e\u5176\u4ed6 event handler \u91cd\u7f6e\u3002</p>\n<h2 id=\"the-textarea-tag\"><a class=\"anchor\" href=\"/react/forms#the-textarea-tag\"></a>Textarea \u6a19\u7c64 </h2>\n<p>\u5728 HTML \u4e2d\uff0c\u4e00\u500b <code class=\"language-javascript\">&lt;textarea&gt;</code> \u7684 element \u662f\u7d93\u7531\u5b83\u7684 children \u4f86\u5b9a\u7fa9\u5b83\u7684\u6587\u5b57\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span><span class=\"token punctuation\">&gt;</span></span>\n  Hello there, this is some text in a text area\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5728 React \u4e2d\uff0c<code class=\"language-javascript\">&lt;textarea&gt;</code> \u5247\u662f\u4f7f\u7528\u4e00\u500b <code class=\"language-javascript\">value</code> \u7684 attribute\u3002\u5982\u6b64\u4e00\u4f86\uff0c\u4e00\u500b\u4f7f\u7528 <code class=\"language-javascript\">&lt;textarea&gt;</code> \u7684\u8868\u55ae\u53ef\u4ee5\u4f7f\u7528\u975e\u5e38\u985e\u4f3c\u55ae\u884c\u7684 input \u65b9\u6cd5\u4f86\u5beb\u6210\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">EssayForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">'Please write an essay about your favorite DOM element.'</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'An essay was submitted: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Essay:</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8acb\u6ce8\u610f <code class=\"language-javascript\">this.state.value</code> \u662f\u5728 constructor \u5167\u88ab\u521d\u59cb\u5316\u7684\uff0c\u6240\u4ee5\u4e0a\u8ff0\u7684 text area \u4e00\u958b\u59cb\u6703\u6709\u4e00\u4e9b\u6587\u5b57\u3002</p>\n<h2 id=\"the-select-tag\"><a class=\"anchor\" href=\"/react/forms#the-select-tag\"></a>Select \u6a19\u7c64 </h2>\n<p>\u5728 HTML \u4e2d\uff0c<code class=\"language-javascript\">&lt;select&gt;</code> \u6703\u5efa\u7acb\u4e00\u500b\u4e0b\u62c9\u5f0f\u9078\u55ae\u3002\u4f8b\u5982\uff0c\u9019\u500b HTML \u6703\u5efa\u7acb\u4e00\u500b\u6709\u5404\u7a2e\u6c34\u679c\u7684\u4e0b\u62c9\u5f0f\u9078\u55ae\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>grapefruit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Grapefruit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lime<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Lime<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">selected</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>coconut<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Coconut<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mango<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Mango<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u8acb\u6ce8\u610f\u5728\u9019\u88e1\uff0c\u6930\u5b50\u7684\u9078\u9805\u662f\u4e00\u958b\u59cb\u5c31\u88ab\u9078\u5b9a\u7684\uff0c\u56e0\u70ba\u5b83\u6709\u4e00\u500b <code class=\"language-javascript\">selected</code> attribute\u3002\u4f46\u662f\u5728 React \u4e2d\u4e26\u4e0d\u662f\u7528 <code class=\"language-javascript\">selected</code> attribute\uff0c\u800c\u662f\u5728 <code class=\"language-javascript\">select</code> \u7684\u6a19\u7c64\u4e0a\u7528\u4e00\u500b <code class=\"language-javascript\">value</code> attribute\u3002\u5c0d\u4e00\u500b controlled component \u4f86\u8aaa\u9019\u662f\u6bd4\u8f03\u65b9\u4fbf\u7684\uff0c\u56e0\u70ba\u4f60\u53ea\u9700\u8981\u5728\u4e00\u500b\u5730\u65b9\u66f4\u65b0\u5b83\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">FlavorForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">'coconut'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Your favorite flavor is: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Pick your favorite flavor:</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>grapefruit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Grapefruit</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lime<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Lime</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>coconut<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Coconut</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mango<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Mango</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/JbbEzX?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u6574\u9ad4\u4f86\u8aaa\uff0c\u9019\u4f7f\u5f97 <code class=\"language-javascript\">&lt;input type=\"text\"&gt;</code>\uff0c<code class=\"language-javascript\">&lt;textarea&gt;</code> \u548c <code class=\"language-javascript\">&lt;select&gt;</code> \u4f7f\u7528\u8d77\u4f86\u90fd\u5f88\u985e\u4f3c\u3002\u5b83\u5011\u5168\u90fd\u6703\u63a5\u6536\u4e00\u500b\u4f60\u5728\u5be6\u4f5c\u4e00\u500b controlled component \u6642\u6703\u4f7f\u7528\u5230\u7684 <code class=\"language-javascript\">value</code> attribute\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f60\u53ef\u4ee5\u5c07\u4e00\u500b array \u50b3\u7d66 <code class=\"language-javascript\">value</code> \u9019\u500b attribute\uff0c\u9019\u4f7f\u5f97\u4f60\u53ef\u4ee5\u5728\u4e00\u500b <code class=\"language-javascript\">select</code> \u4e2d\u9078\u53d6\u591a\u500b\u9078\u9805\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">multiple</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span><span class=\"token string\">'B'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'C'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n</div>\n<h2 id=\"the-file-input-tag\"><a class=\"anchor\" href=\"/react/forms#the-file-input-tag\"></a>\u6a94\u6848 input \u6a19\u7c64 </h2>\n<p>\u5728 HTML \u4e2d\uff0c<code class=\"language-javascript\">&lt;input type=\"file\"&gt;</code> \u8b93\u4f7f\u7528\u8005\u5f9e\u5b83\u5011\u7684\u5132\u5b58\u88dd\u7f6e\u4e2d\u9078\u64c7\u4e00\u500b\u81f3\u591a\u500b\u6a94\u6848\uff0c\u4e26\u628a\u5b83\u5011\u4e0a\u50b3\u5230\u4f3a\u670d\u5668\u6216\u900f\u904e <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\">File API</a> \u88ab JavaScript \u8655\u7406\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u7531\u65bc\u5b83\u7684\u503c\u662f\u552f\u8b80\uff0c\u5b83\u5728 React \u4e2d\u662f\u4e00\u500b <strong>uncontrolled</strong> component\u3002<a href=\"/react/uncontrolled-components#the-file-input-tag\">\u5728\u7a0d\u5f8c\u7684\u6587\u4ef6\u4e2d</a>\u6709\u5176\u4ed6\u95dc\u65bc\u5b83\u548c\u5176\u4ed6 uncontrolled component \u7684\u8a0e\u8ad6\u3002</p>\n<h2 id=\"handling-multiple-inputs\"><a class=\"anchor\" href=\"/react/forms#handling-multiple-inputs\"></a>\u8655\u7406\u591a\u500b\u8f38\u5165 </h2>\n<p>\u7576\u4f60\u9700\u8981\u8655\u7406\u591a\u500b controlled <code class=\"language-javascript\">input</code> element\uff0c\u4f60\u53ef\u4ee5\u5728\u6bcf\u500b element \u4e2d\u52a0\u5165\u4e00\u500b <code class=\"language-javascript\">name</code> attribute\uff0c\u4e26\u8b93 handler function \u9078\u64c7\u57fa\u65bc <code class=\"language-javascript\">event.target.name</code> \u7684\u503c\u8a72\u600e\u9ebc\u505a\uff1a</p>\n<p>\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Reservation</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">isGoing</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">numberOfGuests</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleInputChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleInputChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleInputChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'checkbox'</span> <span class=\"token operator\">?</span> target<span class=\"token punctuation\">.</span>checked <span class=\"token operator\">:</span> target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> value</span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Is going:</span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n<span class=\"gatsby-highlight-code-line\">            <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>isGoing<span class=\"token punctuation\">\"</span></span></span>            <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">checked</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isGoing<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleInputChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Number of guests:</span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n<span class=\"gatsby-highlight-code-line\">            <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>numberOfGuests<span class=\"token punctuation\">\"</span></span></span>            <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>number<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>numberOfGuests<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleInputChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/wgedvV?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u6ce8\u610f\u6211\u5011\u4f7f\u7528\u4e86 ES6 \u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Object_initializer#Computed_property_names\">computed property name</a> \u8a9e\u6cd5\u4f86\u66f4\u65b0\u8207\u8f38\u5165\u4e2d\u7684 name \u76f8\u5c0d\u61c9\u7684 state key\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> value</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u548c\u4e0b\u9762\u7684 ES5 \u7a0b\u5f0f\u78bc\u662f\u4e00\u6a23\u7684\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> partialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">partialState<span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>partialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u6b64\u5916\uff0c\u7531\u65bc <code class=\"language-javascript\">setState()</code> \u81ea\u52d5 <a href=\"/react/state-and-lifecycle#state-updates-are-merged\">merge \u4e00\u90e8\u5206\u7684 state \u548c\u73fe\u5728\u7684 state</a>\uff0c\u6211\u5011\u53ea\u9700\u8981\u5728\u6709\u6539\u8b8a\u7684\u5730\u65b9\u547c\u53eb\u5b83\u5373\u53ef\u3002</p>\n<h2 id=\"controlled-input-null-value\"><a class=\"anchor\" href=\"/react/forms#controlled-input-null-value\"></a>Controlled \u8f38\u5165\u503c\u70ba Null </h2>\n<p>\u5728\u4e00\u500b <a href=\"/react/forms#controlled-components\">controlled component</a> \u4e0a\u6307\u660e value prop \u53ef\u907f\u514d\u4f7f\u7528\u8005\u6539\u8b8a\u8f38\u5165\uff0c\u9664\u975e\u4f60\u5e0c\u671b\u4f7f\u7528\u8005\u9019\u6a23\u505a\u3002\u5982\u679c\u4f60\u5df2\u7d93\u6307\u660e\u4e86 <code class=\"language-javascript\">value</code> \u4f46\u8f38\u5165\u4ecd\u7136\u662f\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\uff0c\u4f60\u5f88\u53ef\u80fd\u662f\u4e0d\u5c0f\u5fc3\u5c07 <code class=\"language-javascript\">value</code> \u7684\u503c\u8a2d\u5b9a\u70ba <code class=\"language-javascript\">undefined</code> \u6216 <code class=\"language-javascript\">null</code>\u3002</p>\n<p>\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u5c31\u662f\u4e00\u500b\u7bc4\u4f8b\u3002\uff08\u8f38\u5165\u539f\u5148\u662f\u88ab\u9396\u4f4f\u7684\uff0c\u4f46\u5728\u77ed\u66ab\u7684\u5ef6\u9072\u5f8c\uff0c\u8b8a\u5f97\u53ef\u4ee5\u88ab\u4fee\u6539\u4e86\u3002\uff09</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>mountNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hi<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>mountNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"alternatives-to-controlled-components\"><a class=\"anchor\" href=\"/react/forms#alternatives-to-controlled-components\"></a>Controlled component \u7684\u66ff\u4ee3\u65b9\u6848 </h2>\n<p>\u6709\u6642\u5019\u4f7f\u7528 controlled component \u662f\u5f88\u4e4f\u5473\u7684\uff0c\u56e0\u70ba\u4f60\u9700\u8981\u70ba\u6bcf\u4e00\u500b\u8cc7\u8a0a\u53ef\u4ee5\u6539\u8b8a\u7684\u65b9\u5f0f\u5beb\u4e00\u500b event handler\uff0c\u4e26\u5c07\u6240\u6709\u7684\u8f38\u5165 state \u900f\u904e\u4e00\u500b React component \u4f86\u50b3\u905e\u3002\u9019\u5728\u4f60\u5c07\u4e00\u500b\u820a\u7684 codebase \u6539\u5beb\u6210 React \u6642\u6216\u5c07\u4e00\u500b React \u7684\u61c9\u7528\u7a0b\u5f0f\u8207\u4e00\u500b\u975e React \u7684\u51fd\u5f0f\u5eab\u6574\u5408\u6642\u6703\u8b8a\u5f97\u7279\u5225\u9ebb\u7169\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e2d\uff0c\u4f60\u4e5f\u8a31\u6703\u60f3\u53c3\u8003 <a href=\"/react/uncontrolled-components\">uncontrolled component</a>\uff0c\u4e5f\u5c31\u662f\u53e6\u4e00\u7a2e\u53d6\u4ee3\u8f38\u5165\u8868\u683c\u7684\u65b9\u5f0f\u3002</p>\n<h2 id=\"fully-fledged-solutions\"><a class=\"anchor\" href=\"/react/forms#fully-fledged-solutions\"></a>\u6210\u719f\u7684\u89e3\u6c7a\u65b9\u6848 </h2>\n<p>\u5982\u679c\u4f60\u60f3\u627e\u51fa\u4e00\u500b\u5b8c\u6574\u7684\u3001\u5305\u542b\u9a57\u8b49\u3001\u53ef\u8ffd\u8e64\u62dc\u8a2a\u6b04\u4f4d\u4e26\u80fd\u8655\u7406\u63d0\u4ea4\u8868\u55ae\u7b49\u529f\u80fd\u7684\u89e3\u6c7a\u65b9\u6848\uff0c<a class=\"external-link\" href=\"https://jaredpalmer.com/formik\">Formik</a> \u662f\u4e00\u500b\u5f88\u71b1\u9580\u7684\u9078\u64c7\u3002\u7136\u800c\uff0c\u5b83\u662f\u5728\u8207 controlled component \u548c\u7dad\u6301 state \u76f8\u540c\u7684\u539f\u5247\u4e0a\u6240\u5efa\u7acb\u7684\uff0c\u6240\u4ee5\u5225\u5fd8\u4e86\u5b78\u7fd2\u5b83\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/forms.md\">Edit this page</a></p></div></article>", "path": "/react/forms", "nav": ["/react/lists-and-keys", "/react/lifting-state-up"]}, {"key": "10. \u63d0\u5347 State", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u901a\u5e38\u4f86\u8aaa\uff0c\u6709\u4e00\u4e9b component \u9700\u8981\u53cd\u6620\u76f8\u540c\u7684\u8cc7\u6599\u8b8a\u5316\u3002\u6211\u5011\u5efa\u8b70\u5c07\u5171\u4eab\u7684 state \u63d0\u5347\u5230\u6700\u9760\u8fd1\u5b83\u5011\u7684\u5171\u540c ancestor\u3002\u8b93\u6211\u5011\u4f86\u770b\u9019\u662f\u5982\u4f55\u904b\u4f5c\u7684\u3002</p>\n<p>\u5728\u9019\u500b\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u5efa\u7acb\u4e00\u500b\u6eab\u5ea6\u8a08\u7b97\u5668\u4f86\u8a08\u7b97\u6c34\u662f\u5426\u6703\u5728\u7d66\u5b9a\u7684\u6eab\u5ea6\u4e0b\u6cb8\u9a30\u3002</p>\n<p>\u6211\u5011\u5c07\u6703\u5efa\u7acb\u4e00\u500b component \u53eb\u505a <code class=\"language-javascript\">BoilingVerdict</code>\u3002\u5b83\u63a5\u53d7 <code class=\"language-javascript\">celsius</code> \u6eab\u5ea6\u4f5c\u70ba\u4e00\u500b prop\uff0c\u4e26\u5370\u51fa\u5b83\u662f\u5426\u8db3\u5920\u716e\u6cb8\u958b\u6c34\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">BoilingVerdict</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>celsius <span class=\"token operator\">&gt;=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The water would boil.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The water would not boil.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u5c07\u6703\u5efa\u7acb\u4e00\u500b\u53eb\u505a <code class=\"language-javascript\">Calculator</code> \u7684 component\u3002\u5b83 render \u4e00\u500b <code class=\"language-javascript\">&lt;input&gt;</code> \u8b93\u4f60\u8f38\u5165\u6eab\u5ea6\uff0c\u4e26\u4e14\u5c07\u5b83\u7684\u503c\u5132\u5b58\u5728 <code class=\"language-javascript\">this.state.temperature</code>\u3002</p>\n<p>\u6b64\u5916\uff0c\u5b83 render \u76ee\u524d\u8f38\u5165\u503c\u5728 <code class=\"language-javascript\">BoilingVerdict</code>\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Calculator</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Enter temperature in Celsius:</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>temperature<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BoilingVerdict</span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">celsius</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>temperature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ZXeOBm?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<h2 id=\"adding-a-second-input\"><a class=\"anchor\" href=\"/react/lifting-state-up#adding-a-second-input\"></a>\u52a0\u5165\u7b2c\u4e8c\u500b\u8f38\u5165 </h2>\n<p>\u9019\u662f\u6211\u5011\u7684\u65b0\u9700\u6c42\uff0c\u9664\u4e86\u651d\u6c0f\u8f38\u5165\uff0c\u6211\u5011\u63d0\u4f9b\u4e00\u500b\u83ef\u6c0f\u8f38\u5165\uff0c\u5b83\u5011\u5f7c\u6b64\u4fdd\u6301\u540c\u6b65\u3002</p>\n<p>\u6211\u5011\u6703\u5f9e <code class=\"language-javascript\">Calculartor</code> \u62bd\u96e2\u51fa\u4e00\u500b <code class=\"language-javascript\">TemperatureInput</code> component\u3002\u6211\u5011\u5c07\u6703\u52a0\u5165\u4e00\u500b\u65b0\u7684 <code class=\"language-javascript\">scale</code> prop\uff0c\u5b83\u53ef\u4ee5\u662f\u300c<code class=\"language-javascript\">c</code>\u300d\u6216\u300c<code class=\"language-javascript\">f</code>\u300d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> scaleNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">c</span><span class=\"token operator\">:</span> <span class=\"token string\">'Celsius'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">f</span><span class=\"token operator\">:</span> <span class=\"token string\">'Fahrenheit'</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TemperatureInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> scale <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Enter temperature in </span><span class=\"token punctuation\">{</span>scaleNames<span class=\"token punctuation\">[</span>scale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">:</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>temperature<span class=\"token punctuation\">}</span></span>\n               <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u73fe\u5728\u53ef\u4ee5\u6539\u8b8a <code class=\"language-javascript\">Calculator</code> \u4f86 render \u5169\u500b\u7368\u7acb\u7684\u6eab\u5ea6\u8f38\u5165\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Calculator</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TemperatureInput</span></span> <span class=\"token attr-name\">scale</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>c<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TemperatureInput</span></span> <span class=\"token attr-name\">scale</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>f<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/jGBryx?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u73fe\u5728\u6211\u5011\u6709\u5169\u500b\u8f38\u5165\uff0c\u4f46\u662f\u7576\u4f60\u8f38\u5165\u5176\u4e2d\u4e00\u500b\u6eab\u5ea6\u8f38\u5165\u6642\uff0c\u53e6\u5916\u4e00\u500b\u8f38\u5165\u4e26\u6c92\u6709\u66f4\u65b0\u3002\u9019\u548c\u6211\u5011\u7684\u9700\u6c42\u7522\u751f\u4e86\u77db\u76fe\uff1a\u6211\u5011\u5e0c\u671b\u5b83\u5011\u53ef\u4ee5\u4fdd\u6301\u540c\u6b65\u3002</p>\n<p>\u6211\u5011\u4e5f\u7121\u6cd5\u5f9e <code class=\"language-javascript\">Calculator</code> \u986f\u793a <code class=\"language-javascript\">BoilingVerdict</code>\u3002<code class=\"language-javascript\">Calculator</code> \u4e26\u4e0d\u77e5\u9053\u76ee\u524d\u7684\u6eab\u5ea6\uff0c\u56e0\u70ba\u5b83\u88ab\u96b1\u85cf\u5728 <code class=\"language-javascript\">TemperatureInput</code> \u5167\u3002</p>\n<h2 id=\"writing-conversion-functions\"><a class=\"anchor\" href=\"/react/lifting-state-up#writing-conversion-functions\"></a>\u64b0\u5beb\u8f49\u63db Function </h2>\n<p>\u9996\u5148\uff0c\u6211\u5011\u5c07\u64b0\u5beb\u5169\u500b function \u4f86\u8f49\u63db\u651d\u6c0f\u548c\u83ef\u6c0f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">toCelsius</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fahrenheit</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>fahrenheit <span class=\"token operator\">-</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">5</span> <span class=\"token operator\">/</span> <span class=\"token number\">9</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">toFahrenheit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">celsius</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>celsius <span class=\"token operator\">*</span> <span class=\"token number\">9</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u5169\u500b function \u8f49\u63db number\u3002\u6211\u5011\u5c07\u64b0\u5beb\u5176\u4ed6 function\uff0c\u5b83\u5c07 <code class=\"language-javascript\">temperature</code> string \u548c\u8f49\u63db function \u4f5c\u70ba\u53c3\u6578\uff0c\u4e26\u56de\u50b3 string\u3002\u6211\u5011\u5c07\u4f7f\u7528\u5b83\u4f86\u8a08\u7b97\u57fa\u65bc\u53e6\u4e00\u500b\u8f38\u5165\u7684\u8f38\u5165\u503c\u3002</p>\n<p>\u7576 <code class=\"language-javascript\">temperatrue</code> \u7121\u6548\u6642\uff0c\u56de\u50b3\u4e00\u500b\u7a7a\u7684 string\uff0c\u5b83\u7684\u8f38\u51fa\u6703\u56db\u6368\u4e94\u5165\u5230\u5c0f\u6578\u9ede\u5f8c\u7b2c\u4e09\u4f4d\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">tryConvert</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">temperature<span class=\"token punctuation\">,</span> convert</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> input <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>temperature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rounded <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>output <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> rounded<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f8b\u5982\uff0c<code class=\"language-javascript\">tryConvert('abc', toCelsius)</code> \u56de\u50b3\u4e00\u500b\u7a7a\u7684 string\uff0c\u800c <code class=\"language-javascript\">tryConvert('10.22', toFahrenheit)</code> \u56de\u50b3 <code class=\"language-javascript\">'50.396'</code>\u3002</p>\n<h2 id=\"lifting-state-up\"><a class=\"anchor\" href=\"/react/lifting-state-up#lifting-state-up\"></a>Lifting State Up </h2>\n<p>\u76ee\u524d\u5169\u500b <code class=\"language-javascript\">TemperatureInput</code> component \u90fd\u6709\u5b83\u5011\u5404\u81ea\u7684 local state\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TemperatureInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span></span>    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u7136\u800c\uff0c\u6211\u5011\u60f3\u8981\u9019\u5169\u500b\u8f38\u5165\u53ef\u4ee5\u5f7c\u6b64\u540c\u6b65\u3002\u7576\u6211\u5011\u66f4\u65b0\u651d\u6c0f\u8f38\u5165\u6642\uff0c\u83ef\u6c0f\u8f38\u5165\u61c9\u8a72\u53cd\u6620\u88ab\u8f49\u63db\u5f8c\u7684\u6eab\u5ea6\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p>\n<p>\u5728 React \u4e2d\uff0c\u5171\u4eab state \u662f\u900f\u904e\u5c07 state \u642c\u79fb\u5230\u9700\u8981\u5b83\u7684 component \u5171\u540c\u6700\u8fd1\u7684 ancestor \u4f86\u5b8c\u6210\u7684\u3002\u9019\u88ab\u7a31\u70ba\u300c\u63d0\u5347 state\u300d\u3002\u6211\u5011\u5c07\u5f9e <code class=\"language-javascript\">TemperatureInput</code> \u79fb\u9664 local state \u4e26\u4e14\u642c\u79fb\u5b83\u5230 <code class=\"language-javascript\">Calculator</code>\u3002</p>\n<p>\u5982\u679c <code class=\"language-javascript\">Calculator</code> \u64c1\u6709\u5171\u4eab state\uff0c\u5b83\u5c07\u6210\u70ba\u76ee\u524d\u5169\u500b\u6eab\u5ea6\u8f38\u5165\u7684\u300c\u771f\u76f8\u4f86\u6e90\u300d\u3002\u9019\u53ef\u4ee5\u8aaa\u660e\u5b83\u5011\u5169\u8005\u5177\u6709\u4e00\u81f4\u7684\u503c\u3002\u7531\u65bc\u9019\u5169\u500b <code class=\"language-javascript\">TemperatureInput</code> component \u7684 prop \u90fd\u662f\u4f86\u81ea\u76f8\u540c\u7684 <code class=\"language-javascript\">Calculator</code> parent component\uff0c\u6240\u4ee5\u9019\u5169\u500b\u8f38\u5165\u6703\u5f7c\u6b64\u540c\u6b65\u3002</p>\n<p>\u8b93\u6211\u5011\u4f86\u4e00\u6b65\u4e00\u6b65\u770b\u5b83\u662f\u5982\u4f55\u57f7\u884c\u7684\u3002</p>\n<p>\u9996\u5148\uff0c\u6211\u5011\u5c07\u6703\u628a <code class=\"language-javascript\">TemperatureInput</code> component \u7684 <code class=\"language-javascript\">this.state.temperature</code> \u66ff\u63db\u70ba <code class=\"language-javascript\">this.props.temperature</code>\u3002\u73fe\u5728\uff0c\u8b93\u6211\u5011\u5047\u8a2d <code class=\"language-javascript\">this.props.temperature</code> \u5df2\u7d93\u5b58\u5728\uff0c\u96d6\u7136\u6211\u5011\u4e4b\u5f8c\u9700\u8981\u5f9e <code class=\"language-javascript\">Calculator</code> \u50b3\u905e\u5b83\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u5148\u524d\uff1aconst temperature = this.state.temperature;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span></span>    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u6211\u5011\u77e5\u9053 <a href=\"/react/components-and-props#props-are-read-only\">prop \u662f\u552f\u8b80\u7684</a>\u3002\u7576 <code class=\"language-javascript\">temperature</code> \u5728 local state \u6642\uff0c<code class=\"language-javascript\">TemperatureInput</code> \u53ef\u4ee5\u547c\u53eb <code class=\"language-javascript\">this.setState()</code> \u4f86\u6539\u8b8a\u5b83\u3002\u7136\u800c\uff0c\u73fe\u5728 <code class=\"language-javascript\">temperature</code> prop \u662f\u4f86\u81ea\u5b83\u7684 parent\uff0c<code class=\"language-javascript\">TemperatureInput</code> \u7121\u6cd5\u63a7\u5236\u5b83\u3002</p>\n<p>\u5728 React \u4e2d\uff0c\u9019\u901a\u5e38\u900f\u904e\u8b93 component\u300c\u88ab\u63a7\u5236\u300d\u4f86\u89e3\u6c7a\u3002\u5c31\u50cf DOM <code class=\"language-javascript\">&lt;input&gt;</code> \u540c\u6642\u63a5\u53d7 <code class=\"language-javascript\">value</code> \u548c <code class=\"language-javascript\">onChange</code> prop\uff0c\u6240\u4ee5\u53ef\u4ee5\u81ea\u8a02 <code class=\"language-javascript\">TemperatureInput</code> \u540c\u6642\u63a5\u53d7\u4f86\u81ea <code class=\"language-javascript\">Calculator</code> parent component \b\u7684 <code class=\"language-javascript\">temperature</code> \u548c <code class=\"language-javascript\">onTemperatureChange</code> prop\u3002</p>\n<p>\u73fe\u5728\uff0c\u7576 <code class=\"language-javascript\">TemperatureInput</code> \u60f3\u8981\u66f4\u65b0\u6eab\u5ea6\u6642\uff0c\u5b83\u547c\u53eb <code class=\"language-javascript\">this.props.onTemperatureChange</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u5148\u524d\uff1athis.setState({temperature: e.target.value});</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onTemperatureChange</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token comment\">// ...</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>Component \u4e2d\u81ea\u8a02\u7684 <code class=\"language-javascript\">temperature</code> \u6216 <code class=\"language-javascript\">onTemperatureChange</code> prop \u540d\u7a31\u4e26\u6c92\u6709\u7279\u6b8a\u542b\u7fa9\u3002\u6211\u5011\u53ef\u4ee5\u5c07\u5b83\u5011\u547d\u540d\u70ba\u4efb\u4f55\u540d\u7a31\uff0c\u50cf\u662f <code class=\"language-javascript\">value</code> \u548c <code class=\"language-javascript\">onChange</code>\uff0c\u9019\u662f\u5e38\u898b\u7684\u6163\u4f8b\u3002</p>\n</div>\n<p><code class=\"language-javascript\">onTemperatureChange</code> prop \u8207 <code class=\"language-javascript\">temperature</code> prop \u5c07\u6703\u7531 <code class=\"language-javascript\">Calculator</code> parent component \u63d0\u4f9b\u3002\u5b83\u5c07\u900f\u904e\u4fee\u6539\u672c\u8eab\u7684 local state \u4f86\u8655\u7406\u66f4\u6539\uff0c\u56e0\u6b64\u6703\u91cd\u65b0 render \u5169\u500b\u8f38\u5165\u8207\u65b0\u7684\u503c\u3002\u6211\u5011\u5c07\u5feb\u901f\u5730\u770b\u4e00\u4e0b <code class=\"language-javascript\">Calculator</code> \u7684\u5be6\u4f5c\u3002</p>\n<p>\u5728\u6df1\u5165\u6539\u8b8a <code class=\"language-javascript\">Calculator</code> \u4e4b\u524d\uff0c\u8b93\u6211\u5011\u56de\u9867\u5148\u524d\u5c0d <code class=\"language-javascript\">TemperatureInput</code> \u7684\u4fee\u6539\u3002\u6211\u5011\u79fb\u9664\u4e86\u5b83\u7684 local state\uff0c\u4e26\u4e14\u4e0d\u8b80\u53d6 <code class=\"language-javascript\">this.state.temperature</code>\uff0c\u6211\u5011\u73fe\u5728\u8b80\u53d6 <code class=\"language-javascript\">this.props.temperature</code>\u3002\u7576\u6211\u5011\u60f3\u8981\u6539\u8b8a\u6642\u4e0d\u547c\u53eb <code class=\"language-javascript\">this.setState()</code>\uff0c\u6211\u5011\u73fe\u5728\u547c\u53eb <code class=\"language-javascript\">this.props.onTemperatureChange()</code>\uff0c\u5b83\u662f\u7531 <code class=\"language-javascript\">Calculator</code> \u63d0\u4f9b\u7684\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TemperatureInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onTemperatureChange</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">const</span> scale <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Enter temperature in </span><span class=\"token punctuation\">{</span>scaleNames<span class=\"token punctuation\">[</span>scale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">:</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>legend</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>temperature<span class=\"token punctuation\">}</span></span>\n               <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>fieldset</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\u8b93\u6211\u5011\u8f49\u56de\u5230 <code class=\"language-javascript\">Calculator</code> component\u3002</p>\n<p>\u6211\u5011\u5c07 store \u76ee\u524d\u8f38\u5165\u7684 <code class=\"language-javascript\">temperature</code> \u548c <code class=\"language-javascript\">scale</code> \u5728\u5b83\u7684 local state\u3002\u9019\u662f\u6211\u5011\u5f9e\u8f38\u5165\u300c\u63d0\u5347\u300d\u7684 state\uff0c\u800c\u4e14\u540c\u6642\u70ba\u8f38\u5165\u7684\u300c\u771f\u76f8\u4f86\u6e90\u300d\u3002\u5b83\u662f\u6211\u5011\u70ba\u4e86 render \u5169\u500b\u8f38\u5165\u800c\u9700\u8981\u77e5\u9053\u7684\u6700\u5c0f\u8868\u793a\u8cc7\u6599\u3002</p>\n<p>\u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u8f38\u5165 37 \u5230\u651d\u6c0f\u8f38\u5165\uff0c<code class=\"language-javascript\">Calculator</code> component \u7684 state \u5c07\u6703\u662f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">'37'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token string\">'c'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u6211\u5011\u4e4b\u5f8c\u66f4\u6539\u83ef\u6c0f\u6b04\u4f4d\u70ba 212\uff0c<code class=\"language-javascript\">Calculator</code> component \u7684 state \u5c07\u6703\u662f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">'212'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token string\">'f'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u53ef\u4ee5 store \u5169\u500b\u8f38\u5165\u7684\u503c\uff0c\u4f46\u4e8b\u5be6\u8b49\u660e\u5b83\u662f\u4e0d\u9700\u8981\u7684\u3002\u5b83\u53ea\u8981 store \u6700\u8fd1\u4fee\u6539\u7684\u8f38\u5165\u503c\uff0c\u4ee5\u53ca\u6eab\u5ea6\u55ae\u4f4d\u5c31\u5920\u4e86\u6211\u5011\u53ef\u4ee5\u6839\u64da\u76ee\u524d\u7684 <code class=\"language-javascript\">temperature</code> \u548c <code class=\"language-javascript\">scale</code> \u4f86\u63a8\u65b7\u5176\u4ed6\u8f38\u5165\u503c\u3002</p>\n<p>\u8f38\u5165\u503c\u6703\u4fdd\u6301\u540c\u6b65\u662f\u56e0\u70ba\u5b83\u5011\u7684\u8a08\u7b97\u90fd\u662f\u4f86\u81ea\u76f8\u540c\u7684 state\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Calculator</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleCelsiusChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleCelsiusChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleFahrenheitChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleFahrenheitChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">temperature</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleCelsiusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">temperature</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> temperature<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleFahrenheitChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">temperature</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token string\">'f'</span><span class=\"token punctuation\">,</span> temperature<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> scale <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> temperature <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> celsius <span class=\"token operator\">=</span> scale <span class=\"token operator\">===</span> <span class=\"token string\">'f'</span> <span class=\"token operator\">?</span> <span class=\"token function\">tryConvert</span><span class=\"token punctuation\">(</span>temperature<span class=\"token punctuation\">,</span> toCelsius<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> temperature<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> fahrenheit <span class=\"token operator\">=</span> scale <span class=\"token operator\">===</span> <span class=\"token string\">'c'</span> <span class=\"token operator\">?</span> <span class=\"token function\">tryConvert</span><span class=\"token punctuation\">(</span>temperature<span class=\"token punctuation\">,</span> toFahrenheit<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> temperature<span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TemperatureInput</span></span>\n          <span class=\"token attr-name\">scale</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>c<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">temperature</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>celsius<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">onTemperatureChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleCelsiusChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TemperatureInput</span></span>\n          <span class=\"token attr-name\">scale</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>f<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">temperature</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fahrenheit<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">onTemperatureChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleFahrenheitChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BoilingVerdict</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">celsius</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>celsius<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/WZpxpz?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u73fe\u5728\uff0c\u7121\u8ad6\u8f38\u5165\u5982\u4f55\u6539\u8b8a\uff0c\u5728 <code class=\"language-javascript\">Calculator</code> \u7684 <code class=\"language-javascript\">this.state.temperature</code> \u548c <code class=\"language-javascript\">this.state.scale</code> \u90fd\u6703\u88ab\u66f4\u65b0\u3002\u5176\u4e2d\u4e00\u500b\u8f38\u5165\u4fdd\u7559\u4efb\u4f55\u4f7f\u7528\u8005\u7684\u8f38\u5165\uff0c\u4e26\u4e14\u7e3d\u662f\u6839\u64da\u4f7f\u7528\u8005\u7684\u8f38\u5165\u91cd\u65b0\u8a08\u7b97\u53e6\u4e00\u500b\u8f38\u5165\u503c\u3002</p>\n<p>\u8b93\u6211\u5011\u56de\u9867\u4e00\u4e0b\u7576\u4f60\u7de8\u8f2f\u8f38\u5165\u6642\u6703\u767c\u751f\u4ec0\u9ebc\u4e8b\u60c5\uff1a</p>\n<ul>\n<li>React \u5728 DOM <code class=\"language-javascript\">&lt;input&gt;</code> \u4e0a\u547c\u53eb\u88ab\u6307\u5b9a\u70ba <code class=\"language-javascript\">onChange</code> \u7684\u51fd\u5f0f\u3002\u5728\u6211\u5011\u7684\u7bc4\u4f8b\u4e2d\uff0c\u9019\u662f\u5728 <code class=\"language-javascript\">TemperatureInput</code> component \u5167\u7684 <code class=\"language-javascript\">handleChange</code> \u65b9\u6cd5\u3002</li>\n<li>\u5728 <code class=\"language-javascript\">TemperatureInput</code> component \u7684 <code class=\"language-javascript\">handleChange</code> \u65b9\u6cd5\u547c\u53eb <code class=\"language-javascript\">this.props.onTemperatureChange()</code> \u8207\u65b0\u7684\u671f\u671b\u503c\u3002\u5b83\u7684 prop \u5305\u542b <code class=\"language-javascript\">onTemperatureChange</code>\uff0c\u662f\u7531 <code class=\"language-javascript\">Calculator</code> parent component \u6240\u63d0\u4f9b\u7684\u3002</li>\n<li>\u7576\u5b83\u88ab render \u4e4b\u524d\uff0c<code class=\"language-javascript\">Calculator</code> \u6307\u5b9a\u651d\u6c0f <code class=\"language-javascript\">TemperatureInput</code> \u7684 <code class=\"language-javascript\">onTemperatureChange</code> \u662f <code class=\"language-javascript\">Calculator</code> \u7684 <code class=\"language-javascript\">handleCelsiusChange</code> \u65b9\u6cd5\uff0c\u800c\u83ef\u6c0f\u6eab\u5ea6\u7684 <code class=\"language-javascript\">TemperatureInput</code> \u7684 <code class=\"language-javascript\">onTemperatureChange</code> \u65b9\u6cd5\u662f <code class=\"language-javascript\">Calculator</code> \u7684 <code class=\"language-javascript\">handleFahrenheitChange</code> \u65b9\u6cd5\u3002\u56e0\u6b64\u6839\u64da\u6211\u5011\u7de8\u8f2f\u7684\u8f38\u5165\u547c\u53eb\u9019\u5169\u500b <code class=\"language-javascript\">Calculator</code> \u65b9\u6cd5\u4e2d\u7684\u5176\u4e2d\u4e00\u500b\u3002</li>\n<li>\u5728\u9019\u4e9b\u65b9\u6cd5\u4e2d\uff0c<code class=\"language-javascript\">Calculator</code> component \u8981\u6c42 React \u6839\u64da\u6211\u5011\u7de8\u8f2f\u7684\u65b0\u8f38\u5165\u503c\u548c\u76ee\u524d\u7684\u6eab\u5ea6\u55ae\u4f4d\u7684\u8f38\u5165\u547c\u53eb <code class=\"language-javascript\">this.setState()</code> \u4f86\u91cd\u65b0 render \u672c\u8eab\u3002</li>\n<li>React \u547c\u53eb <code class=\"language-javascript\">Calculator</code> component \u7684 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\u4f86\u4e86\u89e3 UI \u61c9\u8a72\u662f\u600e\u9ebc\u6a23\u5b50\u3002\u6839\u64da\u76ee\u524d\u6eab\u5ea6\u548c\u6eab\u5ea6\u55ae\u4f4d\u91cd\u65b0\u8a08\u7b97\u5169\u500b\u8f38\u5165\u7684\u503c\u3002\u6eab\u5ea6\u8f49\u63db\u6703\u5728\u9019\u88e1\u57f7\u884c\u3002</li>\n<li>\u900f\u904e <code class=\"language-javascript\">Calculator</code> \u6307\u5b9a\u65b0\u7684 prop\uff0cReact \u547c\u53eb\u5404\u500b <code class=\"language-javascript\">TemperatureInput</code> component \u7684 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\uff0c\u5b83\u5011\u61c9\u8a72\u4e86\u89e3 UI \u662f\u4ec0\u9ebc\u6a23\u5b50\u3002</li>\n<li>React \u547c\u53eb <code class=\"language-javascript\">BoilingVerdict</code> component \u7684 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\uff0c\u4ee5\u651d\u6c0f\u6eab\u5ea6\u505a\u70ba prop\u3002</li>\n<li>React DOM \u4f7f\u7528\u6cb8\u9a30\u5224\u5b9a\u66f4\u65b0 DOM \u4e26\u5339\u914d\u6240\u9700\u7684\u8f38\u5165\u503c\u3002\u6211\u5011\u525b\u525b\u7de8\u8f2f\u7684\u8f38\u5165\u5b83\u63a5\u6536\u76ee\u524d\u7684\u503c\uff0c\u800c\u53e6\u4e00\u500b\u8f38\u5165\u88ab\u66f4\u65b0\u6210\u8f49\u63db\u5f8c\u7684\u6eab\u5ea6\u3002</li>\n</ul>\n<p>\u6bcf\u6b21\u66f4\u65b0\u90fd\u6703\u57f7\u884c\u76f8\u540c\u7684\u6b65\u9a5f\uff0c\u4fdd\u6301\u8f38\u5165\u7684\u540c\u6b65\u3002</p>\n<h2 id=\"lessons-learned\"><a class=\"anchor\" href=\"/react/lifting-state-up#lessons-learned\"></a>\u7d93\u9a57\u5b78\u7fd2 </h2>\n<p>\u5728 React \u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u5c0d\u65bc\u8cc7\u6599\u7684\u8b8a\u5316\u53ea\u80fd\u6709\u4e00\u500b\u552f\u4e00\u7684\u300c\u771f\u76f8\u4f86\u6e90\u300d\u3002\u901a\u5e38\u4f86\u8aaa\uff0cstate \u6703\u512a\u5148\u88ab\u52a0\u5165\u5230\u9700\u8981 render \u7684 component\u3002\u63a5\u8457\uff0c\u5982\u679c\u5176\u4ed6\u7684 component \u4e5f\u9700\u8981\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u63d0\u5347 state \u5230\u5171\u540c\u6700\u9760\u8fd1\u7684 ancestor\u3002\u4f60\u61c9\u8a72\u4f9d\u8cf4<a href=\"/react/state-and-lifecycle#the-data-flows-down\">\u4e0a\u81f3\u4e0b\u7684\u8cc7\u6599\u6d41</a>\uff0c\u800c\u4e0d\u662f\u5617\u8a66\u5728\u4e0d\u540c component \u4e4b\u9593\u540c\u6b65 state\u3002</p>\n<p>\u63d0\u5347 state \u6d89\u53ca\u64b0\u5beb\u66f4\u591a\u7684\u300cboilerplate\u300d\u7a0b\u5f0f\u78bc\uff0c\u800c\u4e0d\u662f\u96d9\u5411\u7d81\u5b9a\u7684\u65b9\u6cd5\uff0c\u4f46\u5b83\u5c0d\u65bc\u9694\u96e2\u548c\u5c0b\u627e bug \u6642\u66f4\u52a0\u5bb9\u6613\u3002\u7531\u65bc\u4efb\u4f55 state\u300c\u5b58\u6d3b\u300d\u5728\u4e00\u4e9b component \u4e2d\uff0c\u800c\u4e14 component \u672c\u8eab\u53ef\u4ee5\u6539\u8b8a\u5b83\uff0cbug \u7684\u7522\u751f\u5927\u5e45\u7684\u6e1b\u5c11\u3002\u6b64\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5be6\u4f5c\u4efb\u4f55\u81ea\u8a02\u7684\u908f\u8f2f\u4f86\u62d2\u7d55\u6216\u8f49\u63db\u4f7f\u7528\u8005\u7684\u8f38\u5165\u3002</p>\n<p>\u5982\u679c\u67d0\u6a23\u6771\u897f\u53ef\u4ee5\u5f9e prop \u6216 state \u88ab\u53d6\u5f97\uff0c\u5b83\u53ef\u80fd\u4e0d\u61c9\u8a72\u5728 state\u3002\u4f8b\u5982\uff0c\u6211\u5011\u53ea store \u6700\u5f8c\u7de8\u8f2f\u7684 <code class=\"language-javascript\">temperature</code> \u548c\u5b83\u7684 <code class=\"language-javascript\">scale</code>\uff0c\u800c\u4e0d\u662f store <code class=\"language-javascript\">celsiusValue</code> \u548c <code class=\"language-javascript\">fahrenheitValue</code>\u3002\u5176\u4ed6\u8f38\u5165\u7684\u503c\u7e3d\u662f\u53ef\u4ee5\u5f9e\u5b83\u5011\u7684 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u88ab\u8a08\u7b97\u51fa\u4f86\u3002\u9019\u8b93\u6211\u5011\u53ef\u4ee5\u6e05\u9664\u6216\u5c07\u56db\u6368\u4e94\u5165\u61c9\u7528\u65bc\u53e6\u4e00\u500b\u6b04\u4f4d, \u800c\u4e0d\u6703\u5728\u4f7f\u7528\u8005\u8f38\u5165\u4e2d\u5931\u53bb\u4efb\u4f55\u7cbe\u5ea6\u3002</p>\n<p>\u7576\u4f60\u5728 UI \u4e0a\u770b\u5230\u4e00\u4e9b\u932f\u8aa4\u6642\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-devtools\">React Developer Tools</a> \u4f86\u6aa2\u67e5 prop \u4e26\u5f80 tree \u7684\u4e0a\u65b9\u5c0b\u627e\uff0c\u76f4\u5230\u627e\u5230\u8ca0\u8cac\u66f4\u65b0 state \u7684 component\u3002\u9019\u8b93\u4f60\u53ef\u4ee5\u8ffd\u8e64\u5230\u932f\u8aa4\u7684\u4f86\u6e90\uff1a</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//ef94afc3447d75cdc245c77efb0d63be/react-devtools-state.gif\">Image link</a></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/lifting-state-up.md\">Edit this page</a></p></div></article>", "path": "/react/lifting-state-up", "nav": ["/react/forms", "/react/composition-vs-inheritance"]}, {"key": "11. Composition vs \u7e7c\u627f", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React \u5177\u6709\u5f37\u5927\u7684 composition \u6a21\u578b\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u5728 component \u4e4b\u9593\u4f7f\u7528 composition \u4f86\u8907\u7528\u4f60\u7684\u7a0b\u5f0f\u78bc\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u7e7c\u627f\u3002</p>\n<p>\u5728\u9019\u500b\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u8003\u616e\u4e00\u4e9b\u65b0 React \u958b\u767c\u8005\u5e38\u5e38\u9047\u5230\u7684\u7e7c\u627f\u554f\u984c\uff0c\u4e26\u793a\u7bc4\u5982\u4f55\u900f\u904e composition \u4f86\u89e3\u6c7a\u5b83\u5011\u3002</p>\n<h2 id=\"containment\"><a class=\"anchor\" href=\"/react/composition-vs-inheritance#containment\"></a>\u5305\u542b </h2>\n<p>\u6709\u4e9b component \u4e0d\u6703\u63d0\u65e9\u77e5\u9053\u5b83\u5011\u7684 children \u6709\u4e9b\u4ec0\u9ebc\u3002\u5c0d\u65bc\u50cf\u662f <code class=\"language-javascript\">Sidebar</code> \u6216 <code class=\"language-javascript\">Dialog</code> \u9019\u985e\u901a\u7528\u7684\u300cbox\u300dcomponent \u7279\u5225\u5e38\u898b\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u9019\u4e9b component \u4f7f\u7528\u7279\u6b8a\u7684 <code class=\"language-javascript\">children</code> prop \u5c07 children element \u76f4\u63a5\u50b3\u5165\u5230\u5b83\u5011\u7684\u8f38\u51fa\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FancyBorder</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'FancyBorder FancyBorder-'</span> <span class=\"token operator\">+</span> props<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u8b93\u5176\u4ed6\u7684 component \u900f\u904e\u5de2\u72c0\u7684 JSX \u5c07\u4efb\u610f\u7684 children \u50b3\u905e\u7d66\u5b83\u5011\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">WelcomeDialog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyBorder</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        Welcome</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-message<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        Thank you for visiting our spacecraft!</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">FancyBorder</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/ozqNOV?editors=0010\">\u5728 CodePen \u8a66\u8a66\u770b\u5427\uff01</a></strong></p>\n<p>\u4efb\u4f55\u5728 <code class=\"language-javascript\">&lt;FancyBorder&gt;</code> JSX tag \u5167\u7684\u5167\u5bb9\u90fd\u88ab\u4f5c\u70ba <code class=\"language-javascript\">children</code> prop \u88ab\u50b3\u905e\u7d66 <code class=\"language-javascript\">FancyBorder</code> component\u3002\u7531\u65bc <code class=\"language-javascript\">FancyBorder</code> \u5728 <code class=\"language-javascript\">&lt;div&gt;</code> \u5167 render <code class=\"language-javascript\">{props.children}</code>\uff0c\u88ab\u50b3\u905e\u7684 element \u6703\u5728\u6700\u7d42\u7684\u8f38\u51fa\u51fa\u73fe\u3002</p>\n<p>\u96d6\u7136\u9019\u500b\u60c5\u6cc1\u4e0d\u5e38\u898b\uff0c\u4f46\u6709\u6642\u5019\u4f60\u53ef\u80fd\u9700\u8981\u5728 component \u4e2d\u4f7f\u7528\u591a\u500b\u300chole\u300d\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4f60\u6163\u7528\u7684\u65b9\u6cd5\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 <code class=\"language-javascript\">children</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">SplitPane</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>SplitPane<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>SplitPane-left<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>SplitPane-right<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SplitPane</span></span>\n      <span class=\"token attr-name\">left</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Contacts</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>      <span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">right</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Chat</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>      <span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/gwZOJp?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u5427\uff01</strong></a></p>\n<p>React \u7684 element \u50cf\u662f <code class=\"language-javascript\">&lt;Contacts /&gt;</code> \u548c <code class=\"language-javascript\">&lt;Chat /&gt;</code> \u90fd\u53ea\u662f object\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u50cf\u5176\u5b83\u4efb\u4f55\u7684\u8cc7\u6599\u4e00\u6a23\uff0c\u5c07\u5b83\u5011\u4f5c\u70ba props \u50b3\u905e\u3002\u9019\u7a2e\u65b9\u6cd5\u53ef\u80fd\u6703\u63d0\u9192\u4f60\u5176\u4ed6\u51fd\u5f0f\u5eab\u4e2d\u7684\u300cslot\u300d\uff0c\u4f46\u5c0d\u65bc\u4f60\u53ef\u4ee5\u5728 React \u4e2d\u4f5c\u70ba prop \u50b3\u905e\u7684\u5167\u5bb9\u6c92\u6709\u9650\u5236\u3002</p>\n<h2 id=\"specialization\"><a class=\"anchor\" href=\"/react/composition-vs-inheritance#specialization\"></a>\u7279\u5225\u5316 </h2>\n<p>\u6709\u6642\u5019\uff0c\u6211\u5011\u9700\u8981\u8003\u616e component \u6703\u4e0d\u6703\u662f\u5176\u4ed6 component \u7684\u300c\u7279\u5225\u60c5\u6cc1\u300d\u3002\u4f8b\u5982\uff0c\u6211\u5011\u53ef\u80fd\u6703\u8aaa <code class=\"language-javascript\">WelcomeDialog</code> \u662f <code class=\"language-javascript\">Dialog</code> \u7684\u4e00\u500b\u7279\u5b9a\u60c5\u6cc1\u3002</p>\n<p>\u5728 React \u4e2d\uff0c\u9019\u4e5f\u53ef\u4ee5\u900f\u904e composition \u88ab\u5be6\u73fe\uff0c\u5176\u4e2d\u66f4\u300c\u7279\u5225\u300d\u7684 component render \u66f4\u591a\u300c\u901a\u7528\u300d\u7684 component\uff0c\u4e26\u4f7f\u7528 prop \u5c0d\u5176\u9032\u884c\u8a2d\u5b9a\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Dialog</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyBorder</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-message<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">FancyBorder</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">WelcomeDialog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Dialog</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Welcome<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">message</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Thank you for visiting our spacecraft!<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/kkEaOZ?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>\u5c0d\u65bc\u4f7f\u7528 class \u5b9a\u7fa9\u7684 component\uff0ccomposition \u4e00\u6a23\u6709\u6548\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Dialog</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyBorder</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Dialog-message<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">FancyBorder</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">SignUpDialog</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSignUp <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSignUp</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">login</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Dialog</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Mars Exploration Program<span class=\"token punctuation\">\"</span></span>\n              <span class=\"token attr-name\">message</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>How should we refer to you?<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>login<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">               <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSignUp<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          Sign Me Up!</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Dialog</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">login</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleSignUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Welcome aboard, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>login<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/gwZbYa?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<h2 id=\"so-what-about-inheritance\"><a class=\"anchor\" href=\"/react/composition-vs-inheritance#so-what-about-inheritance\"></a>\u90a3\u9ebc\u95dc\u65bc\u7e7c\u627f\u5462\uff1f </h2>\n<p>\u5728 Facebook \u4e2d\uff0c\u6211\u5011\u4f7f\u7528 React \u5728\u6210\u5343\u4e0a\u842c\u500b component\uff0c\u6211\u5011\u627e\u4e0d\u5230\u4efb\u4f55\u4f7f\u7528\u6848\u4f8b\u4f86\u63a8\u85a6\u4f60\u5efa\u7acb\u7e7c\u627f\u7d50\u69cb\u7684 component\u3002</p>\n<p>Prop \u548c composition \u63d0\u4f9b\u4f60\u660e\u78ba\u548c\u5b89\u5168\u7684\u65b9\u5f0f\u4f86\u81ea\u8a02 component \u7684\u5916\u89c0\u548c\u884c\u70ba\u6240\u9700\u7684\u9748\u6d3b\u6027\u3002\u8acb\u8a18\u5f97\uff0ccomponent \u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7684 prop\uff0c\u5305\u542b primitive value\u3001React element\uff0c\u6216\u8005\u662f function\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3\u8981\u5728 component \u4e4b\u9593\u8907\u7528\u975e UI \u7684\u529f\u80fd\uff0c\u6211\u5011\u5efa\u8b70\u62bd\u96e2\u5b83\u5230\u4e00\u500b\u7368\u7acb\u7684 JavaScript \u6a21\u7d44\u3002Component \u53ef\u4ee5 import \u4e26\u4f7f\u7528\u5b83\u7684 function\u3001object\uff0c\u6216\u8005\u662f class\uff0c\u800c\u4e0d\u9700\u8981\u7e7c\u627f\u5b83\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/composition-vs-inheritance.md\">Edit this page</a></p></div></article>", "path": "/react/composition-vs-inheritance", "nav": ["/react/lifting-state-up", "/react/thinking-in-react"]}, {"key": "12. \u7528 React \u601d\u8003", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u5728\u6211\u5011\u7684\u610f\u898b\u4e2d\uff0cReact \u662f\u7528 JavaScript \u5efa\u7acb\u5927\u578b\u3001\u5feb\u901f\u7684\u7db2\u8def\u61c9\u7528\u7a0b\u5f0f\u6700\u9996\u8981\u7684\u65b9\u5f0f\u3002\u5b83\u5c0d\u65bc\u5728 Facebook \u548c Instagram \u7684\u6211\u5011\u4f86\u8aaa\u80fd\u5f88\u6709\u6548\u7684\u589e\u52a0\u898f\u6a21\u3002</p>\n<p>React \u773e\u591a\u7684\u512a\u9ede\u4e4b\u3127\u662f\u5b83\u8b93\u4f60\u80fd\u5728\u5beb\u7a0b\u5f0f\u7684\u540c\u6642\u53bb\u601d\u8003\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u3002\u5728\u9019\u500b\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u6703\u5e36\u9818\u4f60\u8d70\u904e\u4e00\u904d\u7528 React \u4f86\u5efa\u7acb\u4e00\u500b\u53ef\u641c\u5c0b\u7684\u7522\u54c1\u8cc7\u6599\u8868\u683c\u7684\u601d\u8003\u904e\u7a0b\u3002</p>\n<h2 id=\"start-with-a-mock\"><a class=\"anchor\" href=\"/react/thinking-in-react#start-with-a-mock\"></a>\u5f9e\u8996\u89ba\u7a3f\u958b\u59cb </h2>\n<p>\u60f3\u50cf\u4e00\u4e0b\u6211\u5011\u5df2\u7d93\u6709\u500b JSON API \u548c\u4e00\u500b\u8a2d\u8a08\u5e2b\u7d66\u6211\u5011\u7684\u7522\u54c1\u8996\u89ba\u7a3f\u3002\u9019\u500b\u8996\u89ba\u7a3f\u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a</p>\n<p>\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png\">Image link</a>\n</span>\n</span>\n</p>\n<p>\u6211\u5011\u7684 JSON API \u5247\u6703\u56de\u50b3\u4e00\u4e9b\u770b\u8d77\u4f86\u50cf\u9019\u6a23\u7684\u8cc7\u6599\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">[\n  {category: \"Sporting Goods\", price: \"$49.99\", stocked: true, name: \"Football\"},\n  {category: \"Sporting Goods\", price: \"$9.99\", stocked: true, name: \"Baseball\"},\n  {category: \"Sporting Goods\", price: \"$29.99\", stocked: false, name: \"Basketball\"},\n  {category: \"Electronics\", price: \"$99.99\", stocked: true, name: \"iPod Touch\"},\n  {category: \"Electronics\", price: \"$399.99\", stocked: false, name: \"iPhone 5\"},\n  {category: \"Electronics\", price: \"$199.99\", stocked: true, name: \"Nexus 7\"}\n];</code></pre></div>\n<h2 id=\"step-1-break-the-ui-into-a-component-hierarchy\"><a class=\"anchor\" href=\"/react/thinking-in-react#step-1-break-the-ui-into-a-component-hierarchy\"></a>\u7b2c\u4e00\u6b65\uff1a\u5c07 UI \u62c6\u89e3\u6210 component \u5c64\u7d1a </h2>\n<p>\u9996\u5148\uff0c\u4f60\u8981\u505a\u7684\u662f\u5c07\u8996\u89ba\u7a3f\u4e2d\u6bcf\u4e00\u500b component \uff08\u53ca subcomponent\uff09\u90fd\u5708\u8d77\u4f86\uff0c\u4e26\u5e6b\u5b83\u5011\u547d\u540d\u3002\u5982\u679c\u4f60\u5728\u8ddf\u8a2d\u8a08\u5e2b\u5408\u4f5c\u7684\u8a71\uff0c\u4ed6\u5011\u53ef\u80fd\u5df2\u7d93\u5e6b\u4f60\u505a\u597d\u9019\u4e00\u6b65\u4e86\uff0c\u6240\u4ee5\u8ddf\u4ed6\u5011\u804a\u804a\u5427\uff01\u4ed6\u5011\u5728 Photoshop \u4e2d\u6240\u7528\u7684\u5716\u5c64\u7684\u540d\u5b57\u53ef\u80fd\u53ef\u4ee5\u4f5c\u70ba\u4f60\u7684 React component \u7684\u540d\u5b57\uff01</p>\n<p>\u4f46\u662f\u4f60\u8981\u600e\u9ebc\u77e5\u9053\u54ea\u4e00\u500b\u6771\u897f\u61c9\u8a72\u662f\u81ea\u5df1\u7368\u7acb\u4e00\u500b component \u5462\uff1f\u4f7f\u7528\u548c\u4f60\u6c7a\u5b9a\u5efa\u7acb\u4e00\u500b\u65b0\u7684 function \u6216 object \u4e00\u6a23\u7684\u6e96\u5247\u5373\u53ef\u3002\u5176\u4e2d\u4e00\u500b\u6280\u5de7\u662f<a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\">\u55ae\u4e00\u8077\u8cac\u539f\u5247</a>\uff0c\u5b83\u7684\u610f\u601d\u662f\uff1a\u5728\u6211\u5011\u7684\u7406\u60f3\u4e2d\uff0c\u4e00\u500b component\u61c9\u8a72\u53ea\u8ca0\u8cac\u505a\u4e00\u4ef6\u4e8b\u60c5\u3002\u5982\u679c\u9019\u500b component \u6700\u5f8c\u8b8a\u5927\u4e86\uff0c\u4f60\u5c31\u9700\u8981\u518d\u5c07\u5b83\u5206\u6210\u6578\u500b\u66f4\u5c0f\u7684 subcomponent \u3002</p>\n<p>\u7531\u65bc\u4f60\u5e38\u5e38\u6703\u5c55\u793a JSON \u7684\u8cc7\u6599\u6a21\u578b\u7d66\u4f7f\u7528\u8005\uff0c\u4f60\u6703\u767c\u73fe\uff0c\u5982\u679c\u4f60\u7684\u6a21\u5f0f\u662f\u6b63\u78ba\u5730\u88ab\u5efa\u7acb\u7684\u8a71\uff0c\u4f60\u7684 UI\uff08\u4ee5\u53ca\u4f60\u7684 component \u7d50\u69cb\uff09\u6703\u5f88\u597d\u7684\u76f8\u4e92\u5c0d\u61c9\u3002\u9019\u662f\u56e0\u70ba UI \u548c\u8cc7\u6599\u6a21\u578b\u901a\u5e38\u662f\u9075\u5b88\u540c\u6a23\u7684<em>\u8cc7\u8a0a\u67b6\u69cb</em>\uff0c\u9019\u610f\u5473\u8457\u5c07\u4f60\u7684 UI \u62c6\u6210 component \u901a\u5e38\u662f\u76f8\u7576\u5bb9\u6613\u7684\u3002\u5c07 UI \u5206\u89e3\u6210\u6578\u500b component\uff0c\u6bcf\u4e00\u500b\u90fd\u660e\u78ba\u4ee3\u8868\u8457\u4f60\u7684\u8cc7\u6599\u6a21\u578b\u4e2d\u7684\u67d0\u4e00\u90e8\u4efd\u5373\u53ef\u3002</p>\n<p>\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png\">Image link</a>\n</span>\n</span>\n</p>\n<p>\u4f60\u6703\u770b\u5230\u5728\u9019\u88e1\u6211\u5011\u61c9\u7528\u7a0b\u5f0f\u4e2d\u6709 5 \u500b component\u3002\u6211\u5011\u5c07\u6bcf\u500b component \u4ee3\u8868\u7684\u8cc7\u6599\u7528\u659c\u9ad4\u8868\u793a\u3002\u5716\u7247\u4e2d\u7684\u6578\u5b57\u5c0d\u61c9\u5230\u4e0b\u9762\u7684\u6578\u5b57\u3002</p>\n<ol>\n<li><strong><code class=\"language-javascript\">FilterableProductTable</code>\uff08\u6a58\u8272\uff09\uff1a</strong> \u5305\u542b\u6574\u500b\u7bc4\u4f8b</li>\n<li><strong><code class=\"language-javascript\">SearchBar</code>\uff08\u85cd\u8272\uff09\uff1a</strong> \u63a5\u6536\u6240\u6709 <em>\u4f7f\u7528\u8005\u7684\u8f38\u5165</em></li>\n<li><strong><code class=\"language-javascript\">ProductTable</code>\uff08\u7da0\u8272\uff09\uff1a</strong> \u5c55\u793a\u4e26\u904e\u6ffe\u6839\u64da<em>\u4f7f\u7528\u8005\u8f38\u5165</em>\u7684<em>\u8cc7\u6599\u96c6</em></li>\n<li><strong><code class=\"language-javascript\">ProductCategoryRow</code>\uff08\u571f\u8033\u5176\u85cd\u8272\uff09\uff1a</strong> \u70ba\u6bcf\u500b<em>\u5217\u5225</em>\u5c55\u793a\u6a19\u984c</li>\n<li><strong><code class=\"language-javascript\">ProductRow</code>\uff08\u7d05\u8272\uff09\uff1a</strong> \u70ba\u6bcf\u500b<em>\u7522\u54c1</em>\u5c55\u793a\u4e00\u5217</li>\n</ol>\n<p>\u5982\u679c\u4f60\u770b\u770b <code class=\"language-javascript\">ProductTable</code>\uff0c\u4f60\u6703\u767c\u73fe\u8868\u683c\u7684\u6a19\u984c\u5217\uff08\u5167\u542b\u300cName\u300d\u548c\u300cPrice\u300d\u6a19\u7c64 \uff09\u4e26\u975e\u7368\u7acb\u7684 component\u3002\u8981\u4e0d\u8981\u628a\u5b83\u5011\u8b8a\u6210 component \u9019\u500b\u8b70\u984c\u5b8c\u5168\u662f\u500b\u4eba\u7684\u559c\u597d\uff0c\u6b63\u53cd\u610f\u898b\u90fd\u6709\u3002\u5728\u9019\u908a\u7684\u4f8b\u5b50\u88e1\u9762\uff0c\u6211\u5011\u628a\u5b83\u7576\u4f5c <code class=\"language-javascript\">ProductTable</code> \u7684\u4e00\u90e8\u5206\uff0c\u56e0\u70ba\u5b83\u662f rendering <em>\u8cc7\u6599\u96c6</em> \u7684\u4e00\u90e8\u5206\uff0c\u800c\u9019\u6b63\u662f <code class=\"language-javascript\">ProductTable</code> \u9019\u500b component \u7684\u8cac\u4efb\u3002\u7136\u800c\uff0c\u5982\u679c\u6a19\u984c\u6b04\u4e4b\u5f8c\u8b8a\u5f97\u8d8a\u4f86\u8d8a\u8907\u96dc\uff08\u5047\u5982\u6211\u5011\u8981\u52a0\u4e0a\u53ef\u4ee5\u5206\u985e\u7684\u76f4\u89c0\u529f\u80fd\u7684\u8a71\uff09\uff0c\u90a3\u9ebc\u5efa\u7acb\u4e00\u500b\u7368\u7acb\u7684 <code class=\"language-javascript\">ProductTableHeader</code> component \u5c31\u975e\u5e38\u5408\u7406\u3002</p>\n<p>\u65e2\u7136\u6211\u5011\u5df2\u7d93\u627e\u51fa\u8996\u89ba\u7a3f\u4e2d\u7684 component \u4e86\uff0c\u8b93\u6211\u5011\u4f86\u5b89\u6392\u5b83\u5011\u7684\u5c64\u7d1a\u3002\u5728\u8996\u89ba\u7a3f\u4e2d\uff0c\u5728\u53e6\u4e00\u500b component \u4e2d\u51fa\u73fe\u7684 component \u5c31\u61c9\u8a72\u662f child\uff1a</p>\n<ul>\n<li>\n<p><code class=\"language-javascript\">FilterableProductTable</code></p>\n<ul>\n<li><code class=\"language-javascript\">SearchBar</code></li>\n<li>\n<p><code class=\"language-javascript\">ProductTable</code></p>\n<ul>\n<li><code class=\"language-javascript\">ProductCategoryRow</code></li>\n<li><code class=\"language-javascript\">ProductRow</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"step-2-build-a-static-version-in-react\"><a class=\"anchor\" href=\"/react/thinking-in-react#step-2-build-a-static-version-in-react\"></a>\u7b2c\u4e8c\u6b65\uff1a\u5728 React \u4e2d\u5efa\u7acb\u4e00\u500b\u975c\u614b\u7248\u672c </h2>\n<p class=\"codepen\">\u5728 <a class=\"external-link\" href=\"http://codepen.io\">CodePen</a> \u4e2d\u770b<a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/BwWzwm\">\u7528 React \u601d\u8003\uff1a\u7b2c\u4e8c\u6b65</a>\u3002</p>\n<script></script>\n<p>\u5728\u4f60\u6709\u4e86 component \u5c64\u7d1a\u5f8c\uff0c\u5c31\u53ef\u4ee5\u958b\u59cb\u5be6\u4f5c\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u4e86\u3002\u6700\u7c21\u55ae\u7684\u65b9\u5f0f\u662f\u70ba\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u5efa\u7acb\u4e00\u500b\u63a5\u6536\u8cc7\u6599\u6a21\u578b\u3001render UI \u4e14\u6c92\u6709\u4e92\u52d5\u6027\u7684\u7248\u672c\u3002\u5efa\u7acb\u4e00\u500b\u975c\u614b\u7248\u672c\u9700\u8981\u6253\u5f88\u591a\u5b57\uff0c\u4f46\u4e0d\u9700\u8981\u60f3\u5f88\u591a\uff0c\u800c\u52a0\u4e0a\u4e92\u52d5\u6027\u5247\u76f8\u53cd\uff0c\u9700\u8981\u505a\u5f88\u591a\u7684\u601d\u8003\uff0c\u5f88\u5c11\u7684\u6253\u5b57\uff0c\u6240\u4ee5\u6700\u597d\u7684\u65b9\u5f0f\u662f\u628a\u9019\u5e7e\u500b\u904e\u7a0b\u90fd\u5206\u958b\u4f86\u3002\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u6703\u77e5\u9053\u70ba\u4ec0\u9ebc\u662f\u5982\u6b64\u3002</p>\n<p>\u70ba\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u5efa\u7acb\u4e00\u500b render \u8cc7\u6599\u6a21\u578b\u7684\u7248\u672c\uff0c\u4f60\u6703\u60f3\u8981\u5efa\u7acb\u53ef\u4ee5\u91cd\u8907\u4f7f\u7528\u5176\u4ed6 component \u7684 component\uff0c\u4e26\u4f7f\u7528 <em>props</em> \u50b3\u905e\u8cc7\u6599\u3002<em>Props</em> \u662f\u5c07\u8cc7\u6599\u5f9e parent \u50b3\u7d66 child \u7684\u65b9\u5f0f\u3002\u5982\u679c\u4f60\u5c0d\u65bc <em>state</em> \u7684\u6982\u5ff5\u5f88\u719f\u6089\u7684\u8a71\uff0c\u8acb<strong>\u5b8c\u5168\u4e0d\u8981\u4f7f\u7528 state</strong> \u4f86\u5efa\u7acb\u9019\u500b\u975c\u614b\u7248\u672c\u3002State \u662f\u4fdd\u7559\u7d66\u4e92\u52d5\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u6703\u96a8\u6642\u9593\u6539\u8b8a\u7684\u8cc7\u6599\u3002\u65e2\u7136\u6211\u5011\u76ee\u524d\u8981\u505a\u7684\u662f\u9019\u61c9\u7528\u7a0b\u5f0f\u7684\u975c\u614b\u7248\u672c\uff0c\u4f60\u5c31\u4e0d\u9700\u8981 state\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u5f9e\u6700\u4e0a\u5c64\u958b\u59cb\uff0c\u6216\u5f9e\u6700\u4e0b\u5c64\u958b\u59cb\u3002\u4e5f\u5c31\u662f\u8aaa\uff0c\u4f60\u53ef\u4ee5\u5148\u5f9e\u5c64\u7d1a\u8f03\u9ad8\u7684 component \u958b\u59cb\u505a\u8d77\uff08\u4e5f\u5c31\u662f\u5f9e <code class=\"language-javascript\">FilterableProductTable</code> \u958b\u59cb\uff09\uff0c\u6216\u8005\u4f60\u4e5f\u53ef\u4ee5\u5f9e\u6bd4\u5b83\u4f4e\u5c64\u7d1a\u7684\uff08<code class=\"language-javascript\">ProductRow</code>\uff09\u958b\u59cb\u3002\u5728\u6bd4\u8f03\u7c21\u55ae\u7684\u4f8b\u5b50\u4e2d\uff0c\u901a\u5e38\u5f9e\u4e0a\u5f80\u4e0b\u662f\u6bd4\u8f03\u7c21\u55ae\u7684\u3002\u4f46\u5728\u8f03\u70ba\u5927\u578b\u7684\u5c08\u6848\u4e2d\uff0c\u5f9e\u4e0b\u5f80\u4e0a\u3001\u908a\u5beb\u908a\u6e2c\u8a66\u5247\u6bd4\u8f03\u5bb9\u6613\u3002</p>\n<p>\u5728\u9019\u4e00\u6b65\u7684\u6700\u5f8c\uff0c\u4f60\u6703\u6709\u4e00\u500b\u51fd\u5f0f\u5eab\u7684\u53ef\u91cd\u8907\u4f7f\u7528\u7684 component \u4f86 render \u4f60\u7684\u8cc7\u6599\u6a21\u578b\u3002\u9019\u4e9b component \u53ea\u6703\u6709 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\uff0c\u56e0\u70ba\u9019\u662f\u4f60\u61c9\u7528\u7a0b\u5f0f\u7684\u975c\u614b\u7248\u672c\u3002\u6700\u9ad8\u5c64\u7d1a\u7684 component (<code class=\"language-javascript\">FilterableProductTable</code>) \u6703\u63a5\u6536\u4f60\u7684\u8cc7\u6599\u6a21\u578b\u4f5c\u70ba prop\u3002\u5982\u679c\u4f60\u6539\u8b8a\u5e95\u5c64\u7684\u8cc7\u6599\u6a21\u578b\u4e26\u518d\u6b21\u547c\u53eb <code class=\"language-javascript\">root.render()</code> \u7684\u8a71\uff0c\u90a3\u9ebc UI \u5c31\u6703\u88ab\u66f4\u65b0\u3002\u4f60\u53ef\u4ee5\u770b\u5230 UI \u7684\u66f4\u65b0\u65b9\u5f0f\u4ee5\u53ca\u66f4\u6539\u7684\u4f4d\u7f6e\u3002React \u7684 <strong>\u55ae\u5411\u8cc7\u6599\u6d41</strong>\uff08\u4e5f\u53ef\u7a31\u70ba<em>\u55ae\u5411\u7d81\u5b9a</em>\uff09\u78ba\u4fdd\u6240\u6709 component \u90fd\u662f\u6a21\u584a\u5316\u4e14\u5feb\u901f\u7684\u3002</p>\n<p>\u5982\u679c\u4f60\u9700\u8981\u5e6b\u52a9\u4f86\u57f7\u884c\u9019\u4e00\u6b65\u7684\u8a71\uff0c\u8acb\u53c3\u8003\u9019\u4efd <a href=\"/react/getting-started\">React \u6587\u4ef6</a>\u3002</p>\n<h3 id=\"a-brief-interlude-props-vs-state\"><a class=\"anchor\" href=\"/react/thinking-in-react#a-brief-interlude-props-vs-state\"></a>\u7c21\u77ed\u7684\u63d2\u66f2\uff1aProps \u548c State </h3>\n<p>React \u4e2d\u6709\u5169\u7a2e\u300c\u6a21\u578b\u300d\u8cc7\u6599\uff1a props and state\u3002\u7406\u89e3\u5169\u8005\u7684\u5dee\u5225\u81f3\u95dc\u91cd\u8981\u3002\u82e5\u4f60\u4e0d\u78ba\u5b9a\u5169\u8005\u7684\u5dee\u5225\uff0c\u8acb\u700f\u89bd <a href=\"/react/state-and-lifecycle\">React \u7684\u5b98\u65b9\u6587\u4ef6</a>\u4ee5\u53ca <a href=\"/react/faq-state#what-is-the-difference-between-state-and-props\">FAQ\uff1aprops \u548c state \u6709\u4f55\u4e0d\u540c\uff1f</a>\u3002</p>\n<h2 id=\"step-3-identify-the-minimal-but-complete-representation-of-ui-state\"><a class=\"anchor\" href=\"/react/thinking-in-react#step-3-identify-the-minimal-but-complete-representation-of-ui-state\"></a>\u7b2c\u4e09\u6b65\uff1a\u627e\u51fa\u6700\u5c11\uff08\u4f46\u5b8c\u6574\uff09\u7684 UI State \u7684\u4ee3\u8868 </h2>\n<p>\u70ba\u4e86\u5c07\u4f60\u7684 UI \u8b8a\u6210\u6709\u4e92\u52d5\u6027\uff0c\u4f60\u9700\u8981\u6709\u8fa6\u6cd5\u89f8\u767c\u5e95\u5c64\u7684\u8cc7\u6599\u6a21\u578b\u505a\u51fa\u6539\u8b8a\u3002React \u4f7f\u7528 <strong>state</strong> \u628a\u9019\u4ef6\u4e8b\u5be6\u73fe\u4e86\u3002</p>\n<p>\u70ba\u4e86\u6b63\u78ba\u5730\u5efa\u7acb\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\uff0c\u4f60\u9996\u5148\u9700\u8981\u601d\u8003\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6700\u5c11\u9700\u8981\u54ea\u4e9b\u53ef\u8b8a\u7684 state\u3002\u9019\u88e1\u7684\u95dc\u9375\u662f <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\">DRY\uff1a<em>\u907f\u514d\u91cd\u8907\u4ee3\u78bc\u539f\u5247</em></a>\u3002\u8acb\u627e\u51fa\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6240\u9700\u7684\u6700\u5c11\u7684\u5448\u73fe\u65b9\u5f0f\uff0c\u4e26\u5728\u4f60\u9047\u5230\u5176\u4ed6\u6771\u897f\u6642\u518d\u8a08\u7b97\u5b83\u5011\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u5728\u5efa\u7acb\u4e00\u500b\u5f85\u8fa6\u6e05\u55ae\uff0c\u4f7f\u7528\u4e00\u500b\u53ef\u4ee5\u7528\u4f86\u4ee3\u8868\u5f85\u8fa6\u4e8b\u9805\u7684 array\u3002\u4e0d\u8981\u53e6\u5916\u7528\u4e00\u500b\u7368\u7acb\u7684 state \u8b8a\u6578\u4f86\u8ffd\u8e64\u6578\u91cf\u3002\u7576\u4f60\u8981 render \u4ee3\u8fa6\u4e8b\u9805\u7684\u6578\u91cf\u6642\uff0c\u8b80\u53d6\u5f85\u8fa6\u4e8b\u9805 array \u7684\u9577\u5ea6\u5373\u53ef\u3002</p>\n<p>\u601d\u8003\u6211\u5011\u7bc4\u4f8b\u4e2d\u61c9\u7528\u7a0b\u5f0f\u7684\u6240\u6709\u8cc7\u6599\u3002\u6211\u5011\u73fe\u5728\u6709\uff1a</p>\n<ul>\n<li>\u539f\u672c\u7684\u7522\u54c1\u5217\u8868</li>\n<li>\u4f7f\u7528\u8005\u8f38\u5165\u7684\u641c\u5c0b\u95dc\u9375\u5b57</li>\n<li>checkbox \u7684\u503c</li>\n<li>\u7be9\u9078\u904e\u5f8c\u7684\u7522\u54c1\u5217\u8868</li>\n</ul>\n<p>\u8b93\u6211\u5011\u4f86\u770b\u4e00\u4e0b\u6bcf\u4e00\u500b\u8cc7\u6599\uff0c\u4e26\u627e\u51fa\u54ea\u4e00\u500b\u662f state\u3002\u5c0d\u65bc\u6bcf\u4e00\u500b\u8cc7\u6599\uff0c\u554f\u4f60\u81ea\u5df1\u9019\u4e09\u500b\u554f\u984c\uff1a</p>\n<ol>\n<li>\u9019\u500b\u8cc7\u6599\u662f\u5f9e parent \u900f\u904e props \u50b3\u4e0b\u4f86\u7684\u55ce\uff1f\u5982\u679c\u662f\u7684\u8a71\uff0c\u90a3\u5b83\u5f88\u53ef\u80fd\u4e0d\u662f state\u3002</li>\n<li>\u9019\u500b\u8cc7\u6599\u662f\u5426\u4e00\u76f4\u4fdd\u6301\u4e0d\u8b8a\u5462\uff1f\u5982\u679c\u662f\u7684\u8a71\uff0c\u90a3\u5b83\u5f88\u53ef\u80fd\u4e0d\u662f state\u3002</li>\n<li>\u4f60\u662f\u5426\u53ef\u4ee5\u6839\u64da\u4f60\u7684 component \u4e2d\u5176\u4ed6\u7684 state \u6216 prop \u4f86\u8a08\u7b97\u9019\u500b\u8cc7\u6599\u5462\uff1f\u5982\u679c\u662f\u7684\u8a71\uff0c\u90a3\u5b83\u4e00\u5b9a\u4e0d\u662f state\u3002</li>\n</ol>\n<p>\u539f\u672c\u7684\u7522\u54c1\u5217\u8868\u662f\u88ab\u7576\u4f5c prop \u5f80\u4e0b\u50b3\u7684\uff0c\u6240\u4ee5\u5b83\u4e0d\u662f state\u3002\u641c\u5c0b\u95dc\u9375\u5b57\u548c checkbox \u770b\u8d77\u4f86\u53ef\u80fd\u662f state\uff0c\u56e0\u70ba\u5b83\u5011\u6703\u96a8\u6642\u9593\u800c\u6539\u8b8a\uff0c\u4e5f\u4e0d\u80fd\u5f9e\u5176\u4ed6\u6771\u897f\u4e2d\u88ab\u8a08\u7b97\u51fa\u4f86\u3002\u6700\u5f8c\uff0c\u7be9\u9078\u904e\u5f8c\u7684\u7522\u54c1\u5217\u8868\u4e0d\u662f state\uff0c\u56e0\u70ba\u5b83\u80fd\u900f\u904e\u7d50\u5408\u539f\u672c\u7684\u7522\u54c1\u5217\u8868\u3001\u641c\u5c0b\u95dc\u9375\u5b57\u548ccheckbox \u7684\u503c\u88ab\u8a08\u7b97\u51fa\u4f86\u3002</p>\n<p>\u6240\u4ee5\uff0c\u6211\u5011\u7684 state \u662f\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u8005\u8f38\u5165\u7684\u641c\u5c0b\u95dc\u9375\u5b57</li>\n<li>checkbox \u7684\u503c</li>\n</ul>\n<h2 id=\"step-4-identify-where-your-state-should-live\"><a class=\"anchor\" href=\"/react/thinking-in-react#step-4-identify-where-your-state-should-live\"></a>\u7b2c\u56db\u6b65\uff1a\u627e\u51fa\u4f60\u7684 State \u61c9\u8a72\u5728\u54ea\u88e1 </h2>\n<p class=\"codepen\">\u5728 <a class=\"external-link\" href=\"http://codepen.io\">CodePen</a> \u4e2d\u770b<a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/qPrNQZ\">\u7528 React \u601d\u8003\uff1a\u7b2c\u56db\u6b65</a>\u3002</p>\n<p>OK\uff0c\u6240\u4ee5\u6211\u5011\u5df2\u7d93\u627e\u51fa\u9019\u500b\u61c9\u7528\u7a0b\u5f0f\u6700\u5c11\u7684 state \u662f\u54ea\u4e9b\u4e86\u3002\u4e0b\u4e00\u6b65\uff0c\u6211\u5011\u9700\u8981\u627e\u51fa\u54ea\u5e7e\u500b component \u6703 mutate\uff0c\u6216\u8005<em>\u64c1\u6709</em>\uff0c\u9019\u500b state\u3002</p>\n<p>\u8acb\u8a18\u5f97\uff0cReact \u7684\u6838\u5fc3\u7cbe\u795e\u662f\u55ae\u5411\u8cc7\u6599\u6d41\uff0c\u5f9e component \u7684\u5c64\u7d1a\u5f9e\u9ad8\u5f80\u4e0b\u6d41\u3002\u4e5f\u8a31\u54ea\u500b component \u8a72\u64c1\u6709 state \u5728\u4e00\u958b\u59cb\u4e26\u4e0d\u662f\u5f88\u660e\u986f\u3002<strong>\u5c0d\u65b0\u624b\u4f86\u8aaa\uff0c\u9019\u5f80\u5f80\u662f\u6700\u96e3\u7406\u89e3\u7684\u6982\u5ff5</strong>\uff0c\u6240\u4ee5\u8acb\u8ddf\u8457\u4ee5\u4e0b\u7684\u6b65\u9a5f\u4f86\u601d\u8003\uff1a</p>\n<p>\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u6bcf\u500b state\uff1a</p>\n<ul>\n<li>\u6307\u51fa\u6bcf\u500b\u6839\u64da state \u4f86 render \u67d0\u4e9b\u6771\u897f\u7684 component\u3002</li>\n<li>\u627e\u51fa\u4e00\u500b\u5171\u540c\u64c1\u6709\u8005 component\uff08\u5728\u5c64\u7d1a\u4e2d\u55ae\u4e00\u4e00\u500b\u9700\u8981 state \u7684\u3001\u5728\u6240\u6709\u7684 component \u4e4b\u4e0a\u7684 component\uff09\u3002</li>\n<li>\u61c9\u8a72\u64c1\u6709 state \u7684\u6703\u662f\u5171\u540c\u64c1\u6709\u8005 component \u6216\u53e6\u4e00\u500b\u66f4\u9ad8\u5c64\u7d1a\u7684 component\u3002</li>\n<li>\u5982\u679c\u4f60\u627e\u4e0d\u51fa\u4e00\u500b\u61c9\u8a72\u64c1\u6709 state \u7684 component \u7684\u8a71\uff0c\u90a3\u5c31\u5efa\u7acb\u4e00\u500b\u65b0\u7684 component \u4f86\u4fdd\u6301 state\uff0c\u4e26\u628a\u5b83\u52a0\u5230\u5c64\u7d1a\u4e2d\u5171\u540c\u64c1\u6709\u8005 component \u4e4b\u4e0a\u7684\u67d0\u8655\u3002</li>\n</ul>\n<p>\u8b93\u6211\u5011\u4f86\u8a0e\u8ad6\u4e00\u4e0b\u6211\u5011\u61c9\u7528\u7a0b\u5f0f\u7684\u9019\u500b\u7b56\u7565\uff1a</p>\n<ul>\n<li><code class=\"language-javascript\">ProductTable</code> \u9700\u8981\u6839\u64da state \u4f86\u7be9\u9078\u7522\u54c1\u5217\u8868\uff0c\u800c <code class=\"language-javascript\">SearchBar</code> \u9700\u8981\u5c55\u793a\u641c\u5c0b\u95dc\u9375\u5b57\u548c checkbox \u7684 state\u3002</li>\n<li>\u9019\u5169\u500b component \u7684\u5171\u540c\u64c1\u6709\u8005 component \u662f <code class=\"language-javascript\">FilterableProductTable</code>\u3002</li>\n<li>\u6982\u5ff5\u4e0a\u4f86\u8aaa\uff0c\u7be9\u9078\u904e\u7684\u6587\u5b57\u548c\u5fa9\u9078\u6846\u7684\u503c\u5b58\u5728\u65bc <code class=\"language-javascript\">FilterableProductTable</code> \u4e2d\u662f\u5408\u7406\u7684\u3002</li>\n</ul>\n<p>\u5f88\u597d\uff0c\u6240\u4ee5\u6211\u5011\u73fe\u5728\u5df2\u7d93\u6c7a\u5b9a\u6211\u5011\u7684 state \u6703\u5b58\u5728\u65bc <code class=\"language-javascript\">FilterableProductTable</code> \u4e4b\u4e2d\u3002\u9996\u5148\uff0c\u628a\u9019\u500b\u5be6\u4f8b\u7684 property <code class=\"language-javascript\">this.state = {filterText: '', inStockOnly: false}</code> \u52a0\u5230 <code class=\"language-javascript\">FilterableProductTable</code> \u7684 <code class=\"language-javascript\">constructor</code> \u88e1\u9762\u4ee5\u53cd\u6620\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u7684\u521d\u59cb state\u3002\u63a5\u8457\uff0c\u628a <code class=\"language-javascript\">filterText</code> \u548c <code class=\"language-javascript\">inStockOnly</code> \u4f5c\u70ba prop \u50b3\u7d66 <code class=\"language-javascript\">ProductTable</code> \u548c <code class=\"language-javascript\">SearchBar</code>\u3002\u6700\u5f8c\uff0c\u7528\u9019\u4e9b prop \u4f86\u7be9\u9078 <code class=\"language-javascript\">ProductTable</code> \u4e2d\u7684\u5217\uff0c\u4e26\u8a2d\u5b9a <code class=\"language-javascript\">SearchBar</code> \u4e2d\u7684\u8868\u683c\u6b04\u7684\u503c\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u958b\u59cb\u770b\u5230\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6703\u5982\u4f55\u904b\u4f5c\uff1a\u5c07 <code class=\"language-javascript\">filterText</code> \u8a2d\u5b9a\u70ba <code class=\"language-javascript\">\u300cball\u300d</code> \u4e26\u66f4\u65b0\u4f60\u7684\u7a0b\u5f0f\u3002\u4f60\u6703\u770b\u5230\u8cc7\u6599\u8868\u88ab\u6b63\u78ba\u5730\u66f4\u65b0\u4e86\u3002</p>\n<h2 id=\"step-5-add-inverse-data-flow\"><a class=\"anchor\" href=\"/react/thinking-in-react#step-5-add-inverse-data-flow\"></a>\u7b2c\u4e94\u6b65\uff1a\u52a0\u5165\u76f8\u53cd\u7684\u8cc7\u6599\u6d41 </h2>\n<p class=\"codepen\"> \u5728 <a class=\"external-link\" href=\"http://codepen.io\">CodePen</a> \u4e2d\u770b<a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/LzWZvb\">\u7528 React \u601d\u8003\uff1a\u7b2c\u4e94\u6b65</a>\u3002</p>\n<p>\u5230\u76ee\u524d\u70ba\u6b62\uff0c\u6211\u5011\u5df2\u7d93\u5efa\u7acb\u4e86\u4e00\u500b\u4f5c\u70ba\u542b\u6709\u5f9e\u5c64\u7d1a\u7531\u4e0a\u5f80\u4e0b\u50b3 props \u548c state \u7684\u3001\u4e14\u53ef\u4ee5\u6b63\u78ba render \u7684 function \u7684\u61c9\u7528\u7a0b\u5f0f\u3002\u73fe\u5728\u662f\u6642\u5019\u652f\u63f4\u53e6\u4e00\u7a2e\u8cc7\u6599\u6d41\u7684\u65b9\u5411\u4e86\uff1a\u5728\u5c64\u7d1a\u6df1\u8655\u7684\u8868\u683c component \u9700\u8981\u66f4\u65b0 <code class=\"language-javascript\">FilterableProductTable</code> \u7684 state\u3002</p>\n<p>React \u5c07\u9019\u7a2e\u8cc7\u6599\u6d41\u660e\u78ba\u8868\u793a\u51fa\u4f86\uff0c\u4ee5\u4fbf\u8b93\u4f60\u80fd\u66f4\u5bb9\u6613\u7406\u89e3\u4f60\u7684\u7a0b\u5f0f\u5982\u4f55\u904b\u4f5c\uff0c\u4f46\u662f\u9019\u7684\u78ba\u6bd4\u50b3\u7d71\u7684\u96d9\u5411\u8cc7\u6599\u7d81\u5b9a\u9700\u8981\u6253\u591a\u4e00\u9ede\u5b57\u3002</p>\n<p>\u5982\u679c\u4f60\u5617\u8a66\u5728\u4e0a\u4e00\u500b\u7248\u672c\u7684\u7bc4\u4f8b\uff08\u7b2c\u56db\u6b65\uff09\u4e2d\u8f38\u5165\u6216\u52fe\u9078 checkbox\uff0c\u4f60\u6703\u770b\u5230 React \u5ffd\u7565\u4f60\u7684\u8f38\u5165\u3002\u9019\u662f\u523b\u610f\u7684\uff0c\u56e0\u70ba\u6211\u5011\u628a <code class=\"language-javascript\">input</code> \u7684 <code class=\"language-javascript\">value</code> prop \u8a2d\u5b9a\u70ba\u6c38\u9060\u548c\u5f9e <code class=\"language-javascript\">FilterableProductTable</code> \u50b3\u4e0b\u4f86\u7684 <code class=\"language-javascript\">state</code> \u3127\u6a23\u3002</p>\n<p>\u8b93\u6211\u5011\u601d\u8003\u4e00\u4e0b\u6211\u5011\u60f3\u8981\u505a\u4e9b\u4ec0\u9ebc\u3002\u6211\u5011\u60f3\u78ba\u4fdd\u7576\u4f7f\u7528\u8005\u6539\u8b8a\u9019\u500b\u8868\u683c\u6642\uff0c\u6211\u5011\u6703\u66f4\u65b0 state \u4ee5\u53cd\u6620\u4f7f\u7528\u8005\u7684\u8f38\u5165\u3002\u65e2\u7136 component \u53ea\u61c9\u8a72\u66f4\u65b0\u5b83\u81ea\u5df1\u672c\u8eab\u7684 state\uff0c <code class=\"language-javascript\">FilterableProductTable</code> \u5c07\u6703\u628a callback \u50b3\u7d66 <code class=\"language-javascript\">SearchBar</code>\uff0c\u800c\u5b83\u5011\u5247\u6703\u5728 state \u8a72\u88ab\u66f4\u65b0\u7684\u6642\u5019\u88ab\u89f8\u767c\u3002\u6211\u5011\u53ef\u4ee5\u5728\u8f38\u5165\u4e0a\u4f7f\u7528 <code class=\"language-javascript\">onChange</code> \u9019\u500b event \u4f86\n\u63a5\u6536\u901a\u77e5\u3002\u88ab <code class=\"language-javascript\">FilterableProductTable</code> \u50b3\u4e0b\u4f86\u7684 callback \u5247\u6703\u547c\u53eb <code class=\"language-javascript\">setState()</code>\uff0c\u4e4b\u5f8c\u61c9\u7528\u7a0b\u5f0f\u5c31\u6703\u88ab\u66f4\u65b0\u3002</p>\n<h2 id=\"and-thats-it\"><a class=\"anchor\" href=\"/react/thinking-in-react#and-thats-it\"></a>\u5b8c\u6210 </h2>\n<p>\u5e0c\u671b\u9019\u5e6b\u52a9\u4f60\u7406\u89e3\u5982\u4f55\u7528 React \u5efa\u7acb component \u548c\u61c9\u7528\u7a0b\u5f0f\u3002\u96d6\u7136\u9019\u53ef\u80fd\u9700\u8981\u4f60\u6bd4\u4f60\u7fd2\u6163\u7684\u591a\u6253\u4e00\u4e9b\u7a0b\u5f0f\u78bc\uff0c\u8acb\u8a18\u5f97\u95b1\u8b80\u7a0b\u5f0f\u78bc\u6bd4\u8d77\u5beb\u7a0b\u5f0f\u78bc\u66f4\u5e38\u767c\u751f\uff0c\u800c\u95b1\u8b80\u9019\u7a2e\u6a21\u7d44\u5316\u3001\u6e05\u6670\u660e\u78ba\u7684\u7a0b\u5f0f\u78bc\u662f\u975e\u5e38\u5bb9\u6613\u7684\u3002\u7576\u4f60\u958b\u59cb\u5efa\u7acb\u5927\u578b\u7684 component \u51fd\u5f0f\u5eab\u6642\uff0c\u4f60\u6703\u5f88\u611f\u6fc0\u6709\u9019\u6a23\u7684\u660e\u78ba\u6027\u548c\u6a21\u7d44\u6027\uff0c\u800c\u7576\u4f60\u958b\u59cb\u91cd\u8907\u4f7f\u7528\u7a0b\u5f0f\u78bc\u6642\uff0c\u4f60\u7684\u7a0b\u5f0f\u7684\u884c\u6578\u6703\u958b\u59cb\u6e1b\u5c11\u3002:)</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/thinking-in-react.md\">Edit this page</a></p></div></article>", "path": "/react/thinking-in-react", "nav": ["/react/composition-vs-inheritance", "/react/accessibility"]}]}, {"key": "\u9032\u968e\u6307\u5357", "values": [{"key": "\u7121\u969c\u7919", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h2 id=\"why-accessibility\"><a class=\"anchor\" href=\"/react/accessibility#why-accessibility\"></a>\u70ba\u4ec0\u9ebc\u8981\u6709\u7121\u969c\u7919\u529f\u80fd\uff1f </h2>\n<p>\u7db2\u8def\u7121\u969c\u7919\u529f\u80fd\uff08\u53c8\u7a31\u70ba <a class=\"external-link\" href=\"https://en.wiktionary.org/wiki/a11y\"><strong>a11y</strong></a>\uff09\u7684\u6982\u5ff5\u662f\u8a2d\u8a08\u4e26\u6253\u9020\u6240\u6709\u4eba\u90fd\u80fd\u4f7f\u7528\u7684\u7db2\u7ad9\u3002\u6211\u5011\u5fc5\u9808\u652f\u63f4\u7121\u969c\u7919\u529f\u80fd\uff0c\u624d\u80fd\u4f7f\u7528\u8f14\u52a9\u79d1\u6280\u89e3\u8b80\u7db2\u9801\u3002</p>\n<p>React \u80fd\u5b8c\u6574\u652f\u63f4\u7121\u969c\u7919\u7db2\u7ad9\u7684\u5efa\u69cb\u3002\u9019\u4e9b\u7db2\u7ad9\u901a\u5e38\u90fd\u4f7f\u7528\u6a19\u6e96\u7684 HTML \u6280\u8853\u3002</p>\n<h2 id=\"standards-and-guidelines\"><a class=\"anchor\" href=\"/react/accessibility#standards-and-guidelines\"></a>\u6a19\u6e96\u53ca\u898f\u7bc4 </h2>\n<h3 id=\"wcag\"><a class=\"anchor\" href=\"/react/accessibility#wcag\"></a>WCAG </h3>\n<p><a class=\"external-link\" href=\"https://www.w3.org/WAI/intro/wcag\">\u7db2\u8def\u5167\u5bb9\u7121\u969c\u7919\u529f\u80fd\u6307\u5357</a>\uff08WCAG\uff09\u63d0\u4f9b\u4e86\u5efa\u7acb\u7121\u969c\u7919\u7db2\u9801\u7684\u898f\u7bc4\u3002</p>\n<p>\u4ee5\u4e0b\u7684 WCAG \u6aa2\u67e5\u6e05\u55ae\u63d0\u4f9b\u4e86\u6982\u89c0\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.wuhcag.com/wcag-checklist/\">Wuhcag \u7684 WCAG \u6aa2\u67e5\u6e05\u55ae</a></li>\n<li><a class=\"external-link\" href=\"https://webaim.org/standards/wcag/checklist\">WebAIM \u7684 WCAG \u6aa2\u67e5\u6e05\u55ae</a></li>\n<li><a class=\"external-link\" href=\"https://a11yproject.com/checklist.html\">The A11Y Project \u7684\u6aa2\u67e5\u6e05\u55ae</a></li>\n</ul>\n<h3 id=\"wai-aria\"><a class=\"anchor\" href=\"/react/accessibility#wai-aria\"></a>WAI-ARIA </h3>\n<p>\u9019\u4efd<a class=\"external-link\" href=\"https://www.w3.org/WAI/intro/aria\">\u7db2\u8def\u7121\u969c\u7919\u529f\u80fd\u5021\u8b70 - \u7121\u969c\u7919\u7db2\u8def\u61c9\u7528\u7a0b\u5f0f</a>\u6587\u4ef6\u5305\u542b\u4e86\u8a31\u591a\u67b6\u8a2d\u7121\u969c\u7919\u529f\u80fd JavaScript \u7684\u5c0f\u5de5\u5177\u3002</p>\n<p>\u8acb\u6ce8\u610f\uff0c\u6240\u6709\u7684 <code class=\"language-javascript\">aria-*</code> HTML attribute \u5728 JSX \u4e2d\u90fd\u662f\u652f\u63f4\u7684\u3002\u76f8\u8f03\u65bc React \u4e2d\u5927\u90e8\u5206\u99dd\u5cf0\u5f0f\u5927\u5c0f\u5beb\u7684 DOM property \u548c attribute\uff0c\u9019\u4e9b attribute \u5247\u61c9\u8a72\u50cf\u5728\u7d14 HTML \u4e2d\u4e00\u6a23\u4f7f\u7528\u5e36\u9023\u5b57\u7b26\u5f0f\u5beb\u6cd5\uff08\u53c8\u7a31\u70ba kebab-case\u3001lisp-case \u7b49\uff09\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token attr-name\">aria-label</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>labelText<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token attr-name\">aria-required</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span></span>  <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onchangeHandler<span class=\"token punctuation\">}</span></span>\n  <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>inputValue<span class=\"token punctuation\">}</span></span>\n  <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<h2 id=\"semantic-html\"><a class=\"anchor\" href=\"/react/accessibility#semantic-html\"></a>Semantic HTML </h2>\n<p>Semantic HTML \u662f\u7121\u969c\u7919\u7db2\u9801\u61c9\u7528\u7a0b\u5f0f\u7684\u57fa\u790e\u3002\u4f7f\u7528\u4e0d\u540c\u7684 HTML element \u4f86\u52a0\u5f37\u7db2\u7ad9\u4e2d\u8cc7\u8a0a\u7684\u610f\u7fa9\u53ef\u4ee5\u5728\u4e0d\u7528\u82b1\u8cbb\u7684\u60c5\u6cc1\u4e0b\u8b93\u6240\u6709\u4eba\u9020\u8a2a\u4f60\u7684\u7db2\u7ad9\u3002</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/HTML/Element\">MDN HTML element \u53c3\u8003</a></li>\n</ul>\n<p>\u6709\u6642\u5019\u7576\u6211\u5011\u65b0\u589e <code class=\"language-javascript\">&lt;div&gt;</code> element \u5230 JSX \u8b93 React \u7a0b\u5f0f\u53ef\u4ee5\u904b\u4f5c\u6642\uff0c\u6211\u5011\u6703\u9055\u53cd HTML \u7684\u8a9e\u7fa9\uff0c\u5c24\u7279\u5225\u662f\u5728\u7576\u6211\u5011\u8655\u7406\u5217\u8868\uff08<code class=\"language-javascript\">&lt;ol&gt;</code>\uff0c<code class=\"language-javascript\">&lt;ul&gt;</code> \u548c <code class=\"language-javascript\">&lt;dl&gt;</code>\uff09\u4ee5\u53ca HTML \u8868\u683c <code class=\"language-javascript\">&lt;table&gt;</code> \u7684\u6642\u5019\u3002\n\u5728\u9019\u4e9b\u60c5\u6cc1\u4e0b\u6211\u5011\u61c9\u8a72\u4f7f\u7528 <a href=\"/react/fragments\">React Fragment</a> \u5c07\u6578\u500b element \u7d44\u7e54\u5728\u4e00\u8d77\u3002</p>\n<p>\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Fragment <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">ListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> item <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Fragment</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>term<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Fragment</span></span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Glossary</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dl</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListItem</span></span> <span class=\"token attr-name\">item</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dl</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 map \u5c07\u4e00\u500b collection \u4e2d\u7684\u6bcf\u4e00\u500b item \u8207\u4e00\u500b fragment \u76f8\u5c0d\u61c9\uff0c\u5c31\u5982\u540c\u8655\u7406\u5176\u4ed6\u7684 element \u3127\u6a23\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Glossary</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dl</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token comment\">// \u7576\u4f60 map \u4e00\u500b collection \u6642\uff0cFragment \u4e5f\u61c9\u8a72\u8981\u6709\u4e00\u500b `key` prop</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Fragment</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>term<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Fragment</span></span><span class=\"token punctuation\">&gt;</span></span></span>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dl</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u7684 Fragment tag \u4e0d\u9700\u8981\u4efb\u4f55 prop\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528<a href=\"/react/fragments#short-syntax\">\u7c21\u5beb\u8a9e\u6cd5</a>\uff0c\u5982\u679c\u4f60\u7684\u5de5\u5177\u652f\u63f4\u9019\u500b\u8a9e\u6cd5\u7684\u8a71\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> item <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>term<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8acb\u53c3\u8003 <a href=\"/react/fragments\">Fragment \u6587\u4ef6</a>\u4e86\u89e3\u66f4\u591a\u8a73\u60c5\u3002</p>\n<h2 id=\"accessible-forms\"><a class=\"anchor\" href=\"/react/accessibility#accessible-forms\"></a>\u7121\u969c\u7919\u8868\u683c </h2>\n<h3 id=\"labeling\"><a class=\"anchor\" href=\"/react/accessibility#labeling\"></a>\u6a19\u8a18 </h3>\n<p>\u6bcf\u4e00\u500b HTML \u7684\u8868\u683c\u63a7\u5236\uff0c\u4f8b\u5982 <code class=\"language-javascript\">&lt;input&gt;</code> \u548c <code class=\"language-javascript\">&lt;textarea&gt;</code>\uff0c\u90fd\u9700\u8981\u7121\u969c\u7919\u6a19\u8a18\u3002\u6211\u5011\u9700\u8981\u63d0\u4f9b\u6558\u8ff0\u6027\u7684\u3001\u80fd\u8b93\u87a2\u5e55\u95b1\u8b80\u5668\u8b58\u5225\u7684\u6a19\u8a18\u3002</p>\n<p>\u4ee5\u4e0b\u7684\u8cc7\u6e90\u8b93\u6211\u5011\u77e5\u9053\u5982\u4f55\u6a19\u8a18\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.w3.org/WAI/tutorials/forms/labels/\">W3C \u89e3\u91cb\u5982\u4f55\u6a19\u8a18 element</a></li>\n<li><a class=\"external-link\" href=\"https://webaim.org/techniques/forms/controls\">WebAIM \u89e3\u91cb\u5982\u4f55\u6a19\u8a18 element</a></li>\n<li><a class=\"external-link\" href=\"https://www.paciellogroup.com/blog/2017/04/what-is-an-accessible-name/\">Paciello Group \u89e3\u91cb\u7121\u969c\u7919\u540d\u7a31</a></li>\n</ul>\n<p>\u96d6\u7136\u9019\u4e9b\u6a19\u6e96\u7684 HTML \u7528\u6cd5\u80fd\u76f4\u63a5\u5728 React \u4e2d\u4f7f\u7528\uff0c\u8acb\u6ce8\u610f <code class=\"language-javascript\">for</code> attribute \u5728 JSX \u4e2d\u662f\u5beb\u4f5c <code class=\"language-javascript\">htmlFor</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">htmlFor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>namedInput<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Name:</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>namedInput<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<h3 id=\"notifying-the-user-of-errors\"><a class=\"anchor\" href=\"/react/accessibility#notifying-the-user-of-errors\"></a>\u901a\u77e5\u7528\u6236\u932f\u8aa4\u8a0a\u606f </h3>\n<p>\u932f\u8aa4\u767c\u751f\u7684\u72c0\u6cc1\u9700\u8981\u88ab\u6240\u6709\u4f7f\u7528\u8005\u4e86\u89e3\u3002\u4ee5\u4e0b\u9023\u7d50\u89e3\u91cb\u5982\u4f55\u8b93\u87a2\u5e55\u95b1\u8b80\u5668\u4e5f\u80fd\u8b58\u5225\u932f\u8aa4\u8a0a\u606f\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.w3.org/WAI/tutorials/forms/notifications/\">W3C \u89e3\u91cb\u7528\u6236\u901a\u77e5</a></li>\n<li><a class=\"external-link\" href=\"https://webaim.org/techniques/formvalidation/\">WebAIM \u89e3\u91cb\u8868\u683c\u9a57\u8b49</a></li>\n</ul>\n<h2 id=\"focus-control\"><a class=\"anchor\" href=\"/react/accessibility#focus-control\"></a>\u7126\u9ede\u63a7\u5236 </h2>\n<p>\u78ba\u4fdd\u4f60\u7684\u7db2\u8def\u61c9\u7528\u7a0b\u5f0f\u80fd\u5b8c\u5168\u53ea\u7528\u9375\u76e4\u64cd\u4f5c\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/techniques/keyboard/\">WebAIM \u8ac7\u9375\u76e4\u7121\u969c\u7919\u529f\u80fd</a></li>\n</ul>\n<h3 id=\"keyboard-focus-and-focus-outline\"><a class=\"anchor\" href=\"/react/accessibility#keyboard-focus-and-focus-outline\"></a>\u9375\u76e4\u7126\u9ede\u548c\u7126\u9ede\u8f2a\u5ed3 </h3>\n<p>\u9375\u76e4\u7126\u9ede\u6307\u7684\u662f\u76ee\u524d\u5728 DOM \u4e2d\u7684 element \u88ab\u9078\u53d6\u4ee5\u63a5\u53d7\u4f86\u81ea\u9375\u76e4\u7684\u8f38\u5165\u3002\u6211\u5011\u5230\u8655\u53ef\u4ee5\u898b\u5230\u985e\u4f3c\u4e0b\u9762\u9019\u5f35\u5716\u793a\u5167\u7684\u7126\u9ede\u8f2a\u5ed3\uff1a</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/dec0e6bcc1f882baf76ebc860d4f04e5/4fcfe/keyboard-focus.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/dec0e6bcc1f882baf76ebc860d4f04e5/4fcfe/keyboard-focus.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>\u5982\u679c\u4f60\u6253\u7b97\u7528\u53e6\u4e00\u7a2e\u65b9\u5f0f\u505a\u7126\u9ede\u8f2a\u5ed3\uff0c\u8acb\u4f7f\u7528 CSS \u4f86\u79fb\u9664\u9019\u500b\u8f2a\u5ed3\uff0c\u4f8b\u5982\u8a2d\u5b9a <code class=\"language-javascript\">outline: 0</code>\u3002</p>\n<h3 id=\"mechanisms-to-skip-to-desired-content\"><a class=\"anchor\" href=\"/react/accessibility#mechanisms-to-skip-to-desired-content\"></a>\u8df3\u5230\u6307\u5b9a\u5167\u5bb9\u7684\u6a5f\u5236 </h3>\n<p>\u8acb\u63d0\u4f9b\u67d0\u7a2e\u65b9\u5f0f\u8b93\u4f7f\u7528\u8005\u53ef\u4ee5\u8df3\u904e\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u5c0e\u89bd\u90e8\u5206\uff0c\u56e0\u70ba\u9019\u6a23\u53ef\u4ee5\u5354\u52a9\u52a0\u901f\u9375\u76e4\u5c0e\u89bd\u3002</p>\n<p>\u8df3\u904e\u9023\u7d50\u6216\u8df3\u904e\u5c0e\u89bd\u9023\u7d50\u662f\u96b1\u85cf\u5f0f\u7684\u5c0e\u89bd\u9023\u7d50\uff0c\u53ea\u6709\u5728\u9375\u76e4\u4f7f\u7528\u8005\u8207\u7db2\u9801\u4e92\u52d5\u6642\u624d\u6703\u986f\u73fe\u3002\u5b83\u5011\u5341\u5206\u5bb9\u6613\u7528\u5167\u90e8\u9801\u9762\u9328\u548c\u4e00\u4e9b styling \u505a\u51fa\u4f86\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/techniques/skipnav/\">WebAIM - \u8df3\u904e\u5c0e\u89bd\u9023\u7d50</a></li>\n</ul>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u50cf <code class=\"language-javascript\">&lt;main&gt;</code> \u548c <code class=\"language-javascript\">&lt;aside&gt;</code> \u9019\u6a23\u7684 landmark element \u548c role \u4f86\u6a19\u8a18\u9801\u9762\u4e0a\u7684\u5340\u57df\uff0c\u56e0\u70ba\u8f14\u52a9\u79d1\u6280\u6703\u5feb\u901f\u5c0e\u89bd\u4f7f\u7528\u8005\u5230\u9019\u4e9b\u5340\u57df\u3002</p>\n<p>\u5728\u9019\u88e1\u4f60\u53ef\u4ee5\u95b1\u8b80\u66f4\u591a\u95dc\u65bc\u9019\u4e9b element \u589e\u52a0\u7121\u969c\u7919\u529f\u80fd\u7684\u7528\u6cd5\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.scottohara.me/blog/2018/03/03/landmarks.html\">\u7121\u969c\u7919\u7684 Landmark</a></li>\n</ul>\n<h3 id=\"programmatically-managing-focus\"><a class=\"anchor\" href=\"/react/accessibility#programmatically-managing-focus\"></a>Programmatically managing focus </h3>\n<p>Our React applications continuously modify the HTML DOM during runtime, sometimes leading to keyboard focus being lost or set to an unexpected element. In order to repair this, we need to programmatically nudge the keyboard focus in the right direction. For example, by resetting keyboard focus to a button that opened a modal window after that modal window is closed.</p>\n<p>MDN Web Docs takes a look at this and describes how we can build <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/Accessibility/Keyboard-navigable_JavaScript_widgets\">keyboard-navigable JavaScript widgets</a>.</p>\n<p>To set focus in React, we can use <a href=\"/react/refs-and-the-dom\">Refs to DOM elements</a>.</p>\n<p>Using this, we first create a ref to an element in the JSX of a component class:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomTextInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// Create a ref to store the textInput DOM element</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Use the `ref` callback to store a reference to the text input DOM</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// element in an instance field (for example, this.textInput).</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">}</span></span></span>      <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then we can focus it elsewhere in our component when needed:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Explicitly focus the text input using the raw DOM API</span>\n  <span class=\"token comment\">// Note: we're accessing \"current\" to get the DOM node</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Sometimes a parent component needs to set focus to an element in a child component. We can do this by <a href=\"/react/refs-and-the-dom#exposing-dom-refs-to-parent-components\">exposing DOM refs to parent components</a> through a special prop on the child component that forwards the parent\u2019s ref to the child\u2019s DOM node.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">CustomTextInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputElement <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomTextInput</span></span> <span class=\"token attr-name\">inputRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputElement<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Now you can set focus when required.</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputElement<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>When using a <a href=\"/react/higher-order-components\">HOC</a> to extend components, it is recommended to <a href=\"/react/forwarding-refs\">forward the ref</a> to the wrapped component using the <code class=\"language-javascript\">forwardRef</code> function of React. If a third party HOC does not implement ref forwarding, the above pattern can still be used as a fallback.</p>\n<p>A great focus management example is the <a class=\"external-link\" href=\"https://github.com/davidtheclark/react-aria-modal\">react-aria-modal</a>. This is a relatively rare example of a fully accessible modal window. Not only does it set initial focus on\nthe cancel button (preventing the keyboard user from accidentally activating the success action) and trap keyboard focus inside the modal, it also resets focus back to the element that initially triggered the modal.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>While this is a very important accessibility feature, it is also a technique that should be used judiciously. Use it to repair the keyboard focus flow when it is disturbed, not to try and anticipate how\nusers want to use applications.</p>\n</div>\n<h2 id=\"mouse-and-pointer-events\"><a class=\"anchor\" href=\"/react/accessibility#mouse-and-pointer-events\"></a>Mouse and pointer events </h2>\n<p>Ensure that all functionality exposed through a mouse or pointer event can also be accessed using the keyboard alone. Depending only on the pointer device will lead to many cases where keyboard users cannot use your application.</p>\n<p>To illustrate this, let\u2019s look at a prolific example of broken accessibility caused by click events. This is the outside click pattern, where a user can disable an opened popover by clicking outside the element.</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//5523b05b22210c5a2fa0bd1f01339cb3/outerclick-with-mouse.gif\">Image link</a>\n<p>This is typically implemented by attaching a <code class=\"language-javascript\">click</code> event to the <code class=\"language-javascript\">window</code> object that closes the popover:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">OuterClickExample</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleContainer <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onClickHandler</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickOutsideHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onClickOutsideHandler</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickOutsideHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickOutsideHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">onClickHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentState</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token operator\">!</span>currentState<span class=\"token punctuation\">.</span>isOpen\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">onClickOutsideHandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleContainer<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleContainer<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickHandler<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Select an option</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 1</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 2</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 3</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This may work fine for users with pointer devices, such as a mouse, but operating this with the keyboard alone leads to broken functionality when tabbing to the next element as the <code class=\"language-javascript\">window</code> object never receives a <code class=\"language-javascript\">click</code> event. This can lead to obscured functionality which blocks users from using your application.</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//eca0ca825c8c5e2aa609cee72ef47e27/outerclick-with-keyboard.gif\">Image link</a>\n<p>The same functionality can be achieved by using appropriate event handlers instead, such as <code class=\"language-javascript\">onBlur</code> and <code class=\"language-javascript\">onFocus</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">BlurExample</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timeOutId <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onClickHandler</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onBlurHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onBlurHandler</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onFocusHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onFocusHandler</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">onClickHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentState</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token operator\">!</span>currentState<span class=\"token punctuation\">.</span>isOpen\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// We close the popover on the next tick by using setTimeout.</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// This is necessary because we need to first check if</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// another child of the element has received focus as</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// the blur event fires prior to the new focus event.</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">onBlurHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timeOutId <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">isOpen</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// If a child receives focus, do not close the popover.</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">onFocusHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timeOutId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// React assists us by bubbling the blur and</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// focus events to the parent.</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">onBlur</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onBlurHandler<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">           <span class=\"token attr-name\">onFocus</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onFocusHandler<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClickHandler<span class=\"token punctuation\">}</span></span>\n                <span class=\"token attr-name\">aria-haspopup</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\">aria-expanded</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Select an option</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 1</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 2</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Option 3</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This code exposes the functionality to both pointer device and keyboard users. Also note the added <code class=\"language-javascript\">aria-*</code> props to support screen-reader users. For simplicity\u2019s sake the keyboard events to enable <code class=\"language-javascript\">arrow key</code> interaction of the popover options have not been implemented.</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//28ce2067489843caf05fe7ce22494542/blur-popover-close.gif\">Image link</a>\n<p>This is one example of many cases where depending on only pointer and mouse events will break functionality for keyboard users. Always testing with the keyboard will immediately highlight the problem areas which can then be fixed by using keyboard aware event handlers.</p>\n<h2 id=\"more-complex-widgets\"><a class=\"anchor\" href=\"/react/accessibility#more-complex-widgets\"></a>More Complex Widgets </h2>\n<p>A more complex user experience should not mean a less accessible one. Whereas accessibility is most easily achieved by coding as close to HTML as possible, even the most complex widget can be coded accessibly.</p>\n<p>Here we require knowledge of <a class=\"external-link\" href=\"https://www.w3.org/TR/wai-aria/#roles\">ARIA Roles</a> as well as <a class=\"external-link\" href=\"https://www.w3.org/TR/wai-aria/#states_and_properties\">ARIA States and Properties</a>.\nThese are toolboxes filled with HTML attributes that are fully supported in JSX and enable us to construct fully accessible, highly functional React components.</p>\n<p>Each type of widget has a specific design pattern and is expected to function in a certain way by users and user agents alike:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.w3.org/TR/wai-aria-practices/#aria_ex\">WAI-ARIA Authoring Practices - Design Patterns and Widgets</a></li>\n<li><a class=\"external-link\" href=\"https://heydonworks.com/article/practical-aria-examples/\">Heydon Pickering - ARIA Examples</a></li>\n<li><a class=\"external-link\" href=\"https://inclusive-components.design/\">Inclusive Components</a></li>\n</ul>\n<h2 id=\"other-points-for-consideration\"><a class=\"anchor\" href=\"/react/accessibility#other-points-for-consideration\"></a>Other Points for Consideration </h2>\n<h3 id=\"setting-the-language\"><a class=\"anchor\" href=\"/react/accessibility#setting-the-language\"></a>Setting the language </h3>\n<p>Indicate the human language of page texts as screen reader software uses this to select the correct voice settings:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/techniques/screenreader/#language\">WebAIM - Document Language</a></li>\n</ul>\n<h3 id=\"setting-the-document-title\"><a class=\"anchor\" href=\"/react/accessibility#setting-the-document-title\"></a>Setting the document title </h3>\n<p>Set the document <code class=\"language-javascript\">&lt;title&gt;</code> to correctly describe the current page content as this ensures that the user remains aware of the current page context:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.w3.org/TR/UNDERSTANDING-WCAG20/navigation-mechanisms-title.html\">WCAG - Understanding the Document Title Requirement</a></li>\n</ul>\n<p>We can set this in React using the <a class=\"external-link\" href=\"https://github.com/gaearon/react-document-title\">React Document Title Component</a>.</p>\n<h3 id=\"color-contrast\"><a class=\"anchor\" href=\"/react/accessibility#color-contrast\"></a>Color contrast </h3>\n<p>Ensure that all readable text on your website has sufficient color contrast to remain maximally readable by users with low vision:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html\">WCAG - Understanding the Color Contrast Requirement</a></li>\n<li><a class=\"external-link\" href=\"https://www.smashingmagazine.com/2014/10/color-contrast-tips-and-tools-for-accessibility/\">Everything About Color Contrast And Why You Should Rethink It</a></li>\n<li><a class=\"external-link\" href=\"https://a11yproject.com/posts/what-is-color-contrast/\">A11yProject - What is Color Contrast</a></li>\n</ul>\n<p>It can be tedious to manually calculate the proper color combinations for all cases in your website so instead, you can <a class=\"external-link\" href=\"https://colorable.jxnblk.com/\">calculate an entire accessible color palette with Colorable</a>.</p>\n<p>Both the aXe and WAVE tools mentioned below also include color contrast tests and will report on contrast errors.</p>\n<p>If you want to extend your contrast testing abilities you can use these tools:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/resources/contrastchecker/\">WebAIM - Color Contrast Checker</a></li>\n<li><a class=\"external-link\" href=\"https://www.paciellogroup.com/resources/contrastanalyser/\">The Paciello Group - Color Contrast Analyzer</a></li>\n</ul>\n<h2 id=\"development-and-testing-tools\"><a class=\"anchor\" href=\"/react/accessibility#development-and-testing-tools\"></a>Development and Testing Tools </h2>\n<p>There are a number of tools we can use to assist in the creation of accessible web applications.</p>\n<h3 id=\"the-keyboard\"><a class=\"anchor\" href=\"/react/accessibility#the-keyboard\"></a>The keyboard </h3>\n<p>By far the easiest and also one of the most important checks is to test if your entire website can be reached and used with the keyboard alone. Do this by:</p>\n<ol>\n<li>Disconnecting your mouse.</li>\n<li>Using <code class=\"language-javascript\">Tab</code> and <code class=\"language-javascript\">Shift+Tab</code> to browse.</li>\n<li>Using <code class=\"language-javascript\">Enter</code> to activate elements.</li>\n<li>Where required, using your keyboard arrow keys to interact with some elements, such as menus and dropdowns.</li>\n</ol>\n<h3 id=\"development-assistance\"><a class=\"anchor\" href=\"/react/accessibility#development-assistance\"></a>Development assistance </h3>\n<p>We can check some accessibility features directly in our JSX code. Often intellisense checks are already provided in JSX aware IDE\u2019s for the ARIA roles, states and properties. We also have access to the following tool:</p>\n<h4 id=\"eslint-plugin-jsx-a11y\"><a class=\"anchor\" href=\"/react/accessibility#eslint-plugin-jsx-a11y\"></a>eslint-plugin-jsx-a11y </h4>\n<p>The <a class=\"external-link\" href=\"https://github.com/evcohen/eslint-plugin-jsx-a11y\">eslint-plugin-jsx-a11y</a> plugin for ESLint provides AST linting feedback regarding accessibility issues in your JSX. Many IDE\u2019s allow you to integrate these findings directly into code analysis and source code windows.</p>\n<p><a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a> has this plugin with a subset of rules activated. If you want to enable even more accessibility rules, you can create an <code class=\"language-javascript\">.eslintrc</code> file in the root of your project with this content:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsxon\"><code class=\"language-javascript\">{\n  \"extends\": [\"react-app\", \"plugin:jsx-a11y/recommended\"],\n  \"plugins\": [\"jsx-a11y\"]\n}</code></pre></div>\n<h3 id=\"testing-accessibility-in-the-browser\"><a class=\"anchor\" href=\"/react/accessibility#testing-accessibility-in-the-browser\"></a>Testing accessibility in the browser </h3>\n<p>A number of tools exist that can run accessibility audits on web pages in your browser. Please use them in combination with other accessibility checks mentioned here as they can only\ntest the technical accessibility of your HTML.</p>\n<h4 id=\"axe-axe-core-and-react-axe\"><a class=\"anchor\" href=\"/react/accessibility#axe-axe-core-and-react-axe\"></a>aXe, aXe-core and react-axe </h4>\n<p>Deque Systems offers <a class=\"external-link\" href=\"https://github.com/dequelabs/axe-core\">aXe-core</a> for automated and end-to-end accessibility tests of your applications. This module includes integrations for Selenium.</p>\n<p><a class=\"external-link\" href=\"https://www.deque.com/products/axe/\">The Accessibility Engine</a> or aXe, is an accessibility inspector browser extension built on <code class=\"language-javascript\">aXe-core</code>.</p>\n<p>You can also use the <a class=\"external-link\" href=\"https://github.com/dequelabs/axe-core-npm/tree/develop/packages/react\">@axe-core/react</a> module to report these accessibility findings directly to the console while developing and debugging.</p>\n<h4 id=\"webaim-wave\"><a class=\"anchor\" href=\"/react/accessibility#webaim-wave\"></a>WebAIM WAVE </h4>\n<p>The <a class=\"external-link\" href=\"https://wave.webaim.org/extension/\">Web Accessibility Evaluation Tool</a> is another accessibility browser extension.</p>\n<h4 id=\"accessibility-inspectors-and-the-accessibility-tree\"><a class=\"anchor\" href=\"/react/accessibility#accessibility-inspectors-and-the-accessibility-tree\"></a>Accessibility inspectors and the Accessibility Tree </h4>\n<p><a class=\"external-link\" href=\"https://www.paciellogroup.com/blog/2015/01/the-browser-accessibility-tree/\">The Accessibility Tree</a> is a subset of the DOM tree that contains accessible objects for every DOM element that should be exposed\nto assistive technology, such as screen readers.</p>\n<p>In some browsers we can easily view the accessibility information for each element in the accessibility tree:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Tools/Accessibility_inspector\">Using the Accessibility Inspector in Firefox</a></li>\n<li><a class=\"external-link\" href=\"https://developers.google.com/web/tools/chrome-devtools/accessibility/reference#pane\">Using the Accessibility Inspector in Chrome</a></li>\n<li><a class=\"external-link\" href=\"https://developer.apple.com/library/content/documentation/Accessibility/Conceptual/AccessibilityMacOSX/OSXAXTestingApps.html\">Using the Accessibility Inspector in OS X Safari</a></li>\n</ul>\n<h3 id=\"screen-readers\"><a class=\"anchor\" href=\"/react/accessibility#screen-readers\"></a>Screen readers </h3>\n<p>Testing with a screen reader should form part of your accessibility tests.</p>\n<p>Please note that browser / screen reader combinations matter. It is recommended that you test your application in the browser best suited to your screen reader of choice.</p>\n<h3 id=\"commonly-used-screen-readers\"><a class=\"anchor\" href=\"/react/accessibility#commonly-used-screen-readers\"></a>Commonly Used Screen Readers </h3>\n<h4 id=\"nvda-in-firefox\"><a class=\"anchor\" href=\"/react/accessibility#nvda-in-firefox\"></a>NVDA in Firefox </h4>\n<p><a class=\"external-link\" href=\"https://www.nvaccess.org/\">NonVisual Desktop Access</a> or NVDA is an open source Windows screen reader that is widely used.</p>\n<p>Refer to the following guides on how to best use NVDA:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/articles/nvda/\">WebAIM - Using NVDA to Evaluate Web Accessibility</a></li>\n<li><a class=\"external-link\" href=\"https://dequeuniversity.com/screenreaders/nvda-keyboard-shortcuts\">Deque - NVDA Keyboard Shortcuts</a></li>\n</ul>\n<h4 id=\"voiceover-in-safari\"><a class=\"anchor\" href=\"/react/accessibility#voiceover-in-safari\"></a>VoiceOver in Safari </h4>\n<p>VoiceOver is an integrated screen reader on Apple devices.</p>\n<p>Refer to the following guides on how to activate and use VoiceOver:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/articles/voiceover/\">WebAIM - Using VoiceOver to Evaluate Web Accessibility</a></li>\n<li><a class=\"external-link\" href=\"https://dequeuniversity.com/screenreaders/voiceover-keyboard-shortcuts\">Deque - VoiceOver for OS X Keyboard Shortcuts</a></li>\n<li><a class=\"external-link\" href=\"https://dequeuniversity.com/screenreaders/voiceover-ios-shortcuts\">Deque - VoiceOver for iOS Shortcuts</a></li>\n</ul>\n<h4 id=\"jaws-in-internet-explorer\"><a class=\"anchor\" href=\"/react/accessibility#jaws-in-internet-explorer\"></a>JAWS in Internet Explorer </h4>\n<p><a class=\"external-link\" href=\"https://www.freedomscientific.com/Products/software/JAWS/\">Job Access With Speech</a> or JAWS, is a prolifically used screen reader on Windows.</p>\n<p>Refer to the following guides on how to best use JAWS:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://webaim.org/articles/jaws/\">WebAIM - Using JAWS to Evaluate Web Accessibility</a></li>\n<li><a class=\"external-link\" href=\"https://dequeuniversity.com/screenreaders/jaws-keyboard-shortcuts\">Deque - JAWS Keyboard Shortcuts</a></li>\n</ul>\n<h3 id=\"other-screen-readers\"><a class=\"anchor\" href=\"/react/accessibility#other-screen-readers\"></a>Other Screen Readers </h3>\n<h4 id=\"chromevox-in-google-chrome\"><a class=\"anchor\" href=\"/react/accessibility#chromevox-in-google-chrome\"></a>ChromeVox in Google Chrome </h4>\n<p><a class=\"external-link\" href=\"https://www.chromevox.com/\">ChromeVox</a> is an integrated screen reader on Chromebooks and is available <a class=\"external-link\" href=\"https://chrome.google.com/webstore/detail/chromevox/kgejglhpjiefppelpmljglcjbhoiplfn?hl=en\">as an extension</a> for Google Chrome.</p>\n<p>Refer to the following guides on how best to use ChromeVox:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://support.google.com/chromebook/answer/7031755?hl=en\">Google Chromebook Help - Use the Built-in Screen Reader</a></li>\n<li><a class=\"external-link\" href=\"https://www.chromevox.com/keyboard_shortcuts.html\">ChromeVox Classic Keyboard Shortcuts Reference</a></li>\n</ul></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/accessibility.md\">Edit this page</a></p></div></article>", "path": "/react/accessibility", "nav": ["/react/thinking-in-react", "/react/code-splitting"]}, {"key": "Code-Splitting", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h2 id=\"bundling\"><a class=\"anchor\" href=\"/react/code-splitting#bundling\"></a>Bundling </h2>\n<p>\u5927\u90e8\u5206 React \u61c9\u7528\u7a0b\u5f0f\u6703\u4f7f\u7528\u50cf\u662f <a class=\"external-link\" href=\"https://webpack.js.org/\">Webpack</a>\u3001<a class=\"external-link\" href=\"https://rollupjs.org/\">Rollup</a> \u6216 <a class=\"external-link\" href=\"http://browserify.org/\">Browserify</a> \u7684\u5de5\u5177\u4f86 bundle \u5b83\u5011\u7684\u6a94\u6848\u3002Bundle \u662f\u5c07 import \u7684\u6a94\u6848\u5408\u4f75\u70ba\u55ae\u4e00\u7684\u6a94\u6848\u904e\u7a0b\uff1a\u300cBundle\u300d\u3002\u7db2\u9801\u53ef\u4ee5\u5f15\u5165 bundle\uff0c\u4ee5\u4e00\u6b21\u8f09\u5165\u6574\u500b\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<p>Bundle \u662f\u5c07\u88ab import \u7684\u6a94\u6848\u5408\u4f75\u6210\u4e00\u500b\u55ae\u4e00\u7684\u6a94\u6848\uff1a\u300cbundle\u300d\u3002\u9019\u500b bundle \u6a94\u6848\u53ef\u4ee5\u88ab\u5f15\u5165\u5230\u7db2\u9801\u5167\u4f86\u8f09\u5165\u6574\u500b\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<h4 id=\"example\"><a class=\"anchor\" href=\"/react/code-splitting#example\"></a>\u7bc4\u4f8b </h4>\n<p><strong>\u61c9\u7528\u7a0b\u5f0f\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// app.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> add <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./math.js'</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 42</span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// math.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Bundle\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 42</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u4f60\u7684 bundle \u5f8c\u7684\u6700\u7d42\u7d50\u679c\u770b\u8d77\u4f86\u6703\u8207\u6b64\u4e0d\u540c\u3002</p>\n</div>\n<p>\u5982\u679c\u4f60\u4f7f\u7528 <a class=\"external-link\" href=\"https://create-react-app.dev/\">Create React App</a>\u3001<a class=\"external-link\" href=\"https://nextjs.org/\">Next.js</a>\u3001<a class=\"external-link\" href=\"https://www.gatsbyjs.org/\">Gatsby</a>\uff0c\u6216\u8005\u662f\u985e\u4f3c\u7684\u5de5\u5177\uff0c\u6703\u6709\u4e00\u500b\u5167\u5efa\u7684 Webpack \u8a2d\u5b9a\u4f86 bundle \u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<p>\u5982\u679c\u6c92\u6709\u7684\u8a71\uff0c\u4f60\u9700\u8981\u81ea\u5df1\u8a2d\u5b9a bundle\u3002\u4f8b\u5982\uff0c\u62dc\u8a2a Webpack \u6587\u4ef6\u7684 <a class=\"external-link\" href=\"https://webpack.js.org/guides/installation/\">Installation</a> \u548c <a class=\"external-link\" href=\"https://webpack.js.org/guides/getting-started/\">Getting Started</a> \u6307\u5357\u3002</p>\n<h2 id=\"code-splitting\"><a class=\"anchor\" href=\"/react/code-splitting#code-splitting\"></a>Code-Splitting </h2>\n<p>Bundle \u975e\u5e38\u68d2\uff0c\u4f46\u96a8\u8457\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6210\u9577\uff0c\u4f60\u7684 bundle \u4e5f\u5c07\u6703\u96a8\u8457\u589e\u9577\u3002\u7279\u5225\u662f\u4f60\u5f15\u5165\u4e86\u5927\u91cf\u7684\u7b2c\u4e09\u65b9\u51fd\u5f0f\u5eab\u3002\n\u4f60\u9700\u8981\u96a8\u6642\u7559\u610f bundle \u5f8c\u7684\u7a0b\u5f0f\u78bc\uff0c\u9019\u6a23\u4f60\u5c31\u4e0d\u6703\u5f97\u610f\u5916\u7684\u8b93 bundle \u6a94\u6848\u8b8a\u5f97\u592a\u5927\uff0c\u4ee5\u81f3\u65bc\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u9700\u8981\u5f88\u9577\u7684\u6642\u9593\u624d\u80fd\u88ab\u8f09\u5165\u3002</p>\n<p>\u70ba\u4e86\u907f\u514d bundle \u7684\u7d50\u679c\u904e\u5927\uff0c\u6700\u597d\u7684\u89e3\u6c7a\u554f\u984c\u7684\u65b9\u5f0f\u662f\u958b\u59cb\u300csplit\u300d\u4f60\u7684 bundle\u3002\nCode-Splitting \u662f\u900f\u904e\u7531\u50cf\u662f <a class=\"external-link\" href=\"https://webpack.js.org/guides/code-splitting/\">Webpack</a>\u3001\n<a class=\"external-link\" href=\"https://rollupjs.org/guide/en/#code-splitting\">Rollup</a> \u548c\nBrowserify\uff08\u7d93\u7531 <a class=\"external-link\" href=\"https://github.com/browserify/factor-bundle\">factor-bundle</a>\uff09\u7684 bundler \u6240\u652f\u63f4\u7684\u529f\u80fd\uff0c\n\u5b83\u6703\u5efa\u7acb\u591a\u500b bundle\uff0c\u53ef\u4ee5\u5728 runtime \u6642\u52d5\u614b\u7684\u88ab\u8f09\u5165\u3002</p>\n<p>Code-splitting \u53ef\u4ee5\u5e6b\u52a9\u4f60\u300c\u5ef6\u9072\u8f09\u5165\u300d\u76ee\u524d\u4f7f\u7528\u8005\u6240\u9700\u8981\u7684\u6771\u897f\uff0c\u9019\u53ef\u4ee5\u5927\u5e45\u63d0\u4f9b\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6548\u80fd\u3002\u96d6\u7136\u4f60\u9084\u6c92\u6709\u6e1b\u5c11\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u78bc\u7e3d\u6578\u91cf\uff0c\u4f46\u4f60\u53ef\u4ee5\u907f\u514d\u8f09\u5165\u4f7f\u7528\u8005\u76ee\u524d\u4f7f\u7528\u4e0d\u5230\u7684\u7a0b\u5f0f\u78bc\uff0c\u4f86\u6e1b\u5c11\u521d\u59cb\u8f09\u5165\u61c9\u7528\u7a0b\u5f0f\u7684\u6642\u9593\u3002</p>\n<h2 id=\"import\"><a class=\"anchor\" href=\"/react/code-splitting#import\"></a><code class=\"language-javascript\">import()</code> </h2>\n<p>\u5c07 code-splitting \u5f15\u5165\u5230\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6700\u597d\u7684\u65b9\u5f0f\u662f\u900f\u904e\u52d5\u614b <code class=\"language-javascript\">import()</code> \u8a9e\u6cd5\u3002</p>\n<p><strong>\u52a0\u5165\u524d\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> add <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./math'</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>\u52a0\u5165\u5f8c\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./math\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">math</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u7576 Webpack \u9047\u5230\u9019\u7a2e\u8a9e\u6cd5\u6642\uff0c\u5b83\u5c07\u81ea\u52d5\u7684\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u555f\u52d5 code-splitting\u3002\u5982\u679c\u4f60\u4f7f\u7528 Create React App \u7684\u8a71\uff0c\u5b83\u5df2\u7d93\u5e6b\u4f60\u8a2d\u5b9a\u597d\u4e86\uff0c\u4f60\u53ef\u4ee5\u7acb\u5373\u7684<a class=\"external-link\" href=\"https://create-react-app.dev/docs/code-splitting/\">\u4f7f\u7528\u5b83</a>\u3002\u5728 <a class=\"external-link\" href=\"https://nextjs.org/docs/advanced-features/dynamic-import\">Next.js</a> \u4e5f\u5167\u5efa\u652f\u63f4\u9019\u500b\u529f\u80fd\u3002</p>\n<p>\u5982\u679c\u4f60\u662f\u81ea\u884c\u8a2d\u5b9a Webpack\uff0c\u4f60\u53ef\u4ee5\u95b1\u8b80 Webpack \u7684 <a class=\"external-link\" href=\"https://webpack.js.org/guides/code-splitting/\">code-splitting \u6307\u5357</a>\u3002\u4f60\u7684 Webpack \u8a2d\u5b9a\u770b\u8d77\u4f86\u61c9\u8a72<a class=\"external-link\" href=\"https://gist.github.com/gaearon/ca6e803f5c604d37468b0091d9959269\">\u50cf\u9019\u6a23</a>\u3002</p>\n<p>\u7576\u4f7f\u7528 <a class=\"external-link\" href=\"https://babeljs.io/\">Babel</a> \u6642\uff0c\u4f60\u5c07\u9700\u8981\u78ba\u4fdd Babel \u53ef\u4ee5\u89e3\u6790\u52d5\u614b\u7684 import \u8a9e\u6cd5\u800c\u4e0d\u662f\u53bb\u8f49\u63db\u5b83\u3002\u4f60\u53ef\u80fd\u6703\u9700\u8981 <a class=\"external-link\" href=\"https://classic.yarnpkg.com/en/package/@babel/plugin-syntax-dynamic-import\">@babel/plugin-syntax-dynamic-import</a>\u3002</p>\n<h2 id=\"reactlazy\"><a class=\"anchor\" href=\"/react/code-splitting#reactlazy\"></a><code class=\"language-javascript\">React.lazy</code> </h2>\n<p><code class=\"language-javascript\">React.lazy</code> \u8b93\u4f60 render \u4e00\u500b\u52d5\u614b import \u7684 component \u4f5c\u70ba\u6b63\u5e38\u7684 component\u3002</p>\n<p><strong>\u52a0\u5165\u524d\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> OtherComponent <span class=\"token keyword\">from</span> <span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>\u52a0\u5165\u5f8c\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> OtherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u7576\u9996\u6b21 render \u9019\u500b component \u6642\uff0c\u5c07\u6703\u81ea\u52d5\u7684\u8f09\u5165\u5305\u542b <code class=\"language-javascript\">OtherComponent</code> \u7684 bundle\u3002</p>\n<p><code class=\"language-javascript\">React.lazy</code> \u63a5\u53d7\u4e00\u500b\u5fc5\u9808\u547c\u53eb\u4e00\u500b\u52d5\u614b <code class=\"language-javascript\">import()</code> \u7684 function\u3002\u5b83\u5fc5\u9808\u56de\u50b3\u4e00\u500b <code class=\"language-javascript\">Promise</code>\uff0cresolve \u4e00\u500b\u5305\u542b React component \u7684 <code class=\"language-javascript\">default</code> export \u7684 module\u3002</p>\n<p>lazy component \u61c9\u5728 <code class=\"language-javascript\">Suspense</code> component \u5167 render\uff0c\u9019\u4f7f\u6211\u5011\u53ef\u4ee5\u5728\u7b49\u5f85 lazy component \u8f09\u5165\u6642\uff0c\u986f\u793a\u4e00\u4e9b fallback \u5167\u5bb9\uff08\u50cf\u662f\u4e00\u500b\u8f09\u5165\u7684\u7b26\u865f\uff09\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> OtherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OtherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-javascript\">fallback</code> prop \u63a5\u53d7\u5728\u7b49\u5f85 component \u8f09\u5165\u6642\u8981 render \u7684\u4efb\u4f55 React element\u3002\u4f60\u53ef\u4ee5\u5c07 <code class=\"language-javascript\">Suspense</code> component \u653e\u5728 lazy component \u4e0a\u65b9\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002\u4f60\u751a\u81f3\u53ef\u4ee5\u5305\u8986\u591a\u500b lazy component \u5230 <code class=\"language-javascript\">Suspense</code> component \u5167\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> OtherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> AnotherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./AnotherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OtherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AnotherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"avoiding-fallbacks\"><a class=\"anchor\" href=\"/react/code-splitting#avoiding-fallbacks\"></a>\u907f\u514d Fallbacks </h3>\n<p>\u4efb\u4f55 component \u90fd\u53ef\u80fd\u56e0 render \u800c\u66ab\u505c\uff0c\u5373\u4f7f\u662f\u5df2\u7d93\u5411\u4f7f\u7528\u8005\u986f\u793a\u7684 component\u3002\u70ba\u4e86\u8b93\u87a2\u5e55\u5167\u5bb9\u59cb\u7d42\u4fdd\u6301\u4e00\u81f4\uff0c\u5982\u679c\u4e00\u500b\u5df2\u7d93\u986f\u793a\u7684 component suspend\uff0cReact \u5fc5\u9808\u5c07 tree \u96b1\u85cf\u5230\u6700\u8fd1\u7684 <code class=\"language-javascript\">&lt;Suspense&gt;</code> \u908a\u754c\u3002\u4f46\u662f\uff0c\u5f9e\u4f7f\u7528\u8005\u7684\u89d2\u5ea6\u4f86\u770b\uff0c\u9019\u53ef\u80fd\u6703\u8b93\u4eba\u8ff7\u60d1\u3002</p>\n<p>\u601d\u8003\u9019\u500b tab switcher\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Tabs <span class=\"token keyword\">from</span> <span class=\"token string\">'./Tabs'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Glimmer <span class=\"token keyword\">from</span> <span class=\"token string\">'./Glimmer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Comments <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./Comments'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Photos <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./Photos'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>tab<span class=\"token punctuation\">,</span> setTab<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'photos'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleTabSelect</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tab</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTab</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tabs</span></span> <span class=\"token attr-name\">onTabSelect</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleTabSelect<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Glimmer</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>tab <span class=\"token operator\">===</span> <span class=\"token string\">'photos'</span> <span class=\"token operator\">?</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Photos</span></span> <span class=\"token punctuation\">/&gt;</span></span> <span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Comments</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u5982\u679c tab \u5f9e <code class=\"language-javascript\">'photos'</code> \u6539\u8b8a\u70ba <code class=\"language-javascript\">'comments'</code>\uff0c\u4f46\u662f <code class=\"language-javascript\">Comments</code> \u66ab\u505c\uff0c\u4f7f\u7528\u8005\u6703\u770b\u5230\u4e00\u500b glimmer\u3002\u9019\u5f88\u5408\u7406\u56e0\u70ba\u4f7f\u7528\u8005\u4e0d\u60f3\u8981\u770b\u5230 <code class=\"language-javascript\">Photos</code>\uff0c<code class=\"language-javascript\">Comments</code> component \u9084\u6c92\u6e96\u5099 render \u4efb\u4f55\u6771\u897f\uff0cReact \u9700\u8981\u4fdd\u6301\u4f7f\u7528\u8005\u9ad4\u9a57\u4e00\u81f4\uff0c\u6240\u4ee5\u5b83\u5225\u7121\u9078\u64c7\uff0c\u53ea\u80fd\u986f\u793a\u4e0a\u9762\u7684 <code class=\"language-javascript\">Glimmer</code>\u3002</p>\n<p>\u4f46\u662f\uff0c\u6709\u6642\u5019\u9019\u6a23\u7684\u4f7f\u7528\u8005\u9ad4\u9a57\u4e26\u4e0d\u7406\u60f3\u3002\u5728\u7279\u5b9a\u5834\u666f\u4e0b\uff0c\u6709\u6642\u5019\u5728\u65b0\u7684 UI \u6e96\u5099\u597d\u4e4b\u524d\uff0c\u986f\u793a\u300c\u820a\u300d\u7684 UI \u6703\u66f4\u597d\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u65b0\u7684 <a href=\"/react/react-api#starttransition\"><code class=\"language-javascript\">startTransition</code></a> API \u4f86\u8b93 React \u57f7\u884c\u6b64\u64cd\u4f5c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">handleTabSelect</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tab</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTab</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u88e1\uff0c\u4f60\u544a\u8a34 React \u8a2d\u5b9a tab \u6210 <code class=\"language-javascript\">'comments'</code> \u4e0d\u662f\u4e00\u500b\u7dca\u6025\u66f4\u65b0\uff0c\u4f46\u5b83\u662f\u4e00\u500b <a href=\"/react/react-api#transitions\">transition</a> \u6240\u4ee5\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u6642\u9593\u3002React \u5c07\u6703\u4fdd\u6301\u820a\u7684 UI \u4ea4\u4e92\uff0c\u4e26\u4e14\u5728\u6e96\u5099\u597d\u6642\u5207\u63db\u6210\u986f\u793a <code class=\"language-javascript\">&lt;Comments /&gt;</code>\u3002\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u8003 <a href=\"/react/react-api#transitions\">Transitions</a>\u3002</p>\n<h3 id=\"error-boundaries\"><a class=\"anchor\" href=\"/react/code-splitting#error-boundaries\"></a>\u932f\u8aa4\u908a\u754c </h3>\n<p>\u5982\u679c\u5176\u4ed6\u7684 module \u8f09\u5165\u5931\u6557\uff08\u4f8b\u5982\uff0c\u56e0\u70ba\u7db2\u8def\u5931\u6557\uff09\uff0c\u5b83\u5c07\u6703\u89f8\u767c\u4e00\u500b\u932f\u8aa4\u3002\u4f60\u53ef\u4ee5\u900f\u904e<a href=\"/react/error-boundaries\">\u932f\u8aa4\u908a\u754c</a>\u8655\u7406\u9019\u4e9b\u932f\u8aa4\u4f86\u5448\u73fe\u4e00\u500b\u597d\u7684\u4f7f\u7528\u8005\u9ad4\u9a57\u548c\u7ba1\u7406\u6062\u5fa9\u3002\u4e00\u65e6\u4f60\u5efa\u7acb\u4e86\u4f60\u7684\u932f\u8aa4\u908a\u754c\uff0c\u4f60\u53ef\u4ee5\u5728\u4efb\u4f55\u7684 lazy component \u4e0a\u65b9\u4f7f\u7528\u5b83\uff0c\u7576\u7db2\u8def\u767c\u751f\u932f\u8aa4\u6642\u53ef\u4ee5\u986f\u793a\u4e00\u500b\u932f\u8aa4\u72c0\u614b\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> MyErrorBoundary <span class=\"token keyword\">from</span> <span class=\"token string\">'./MyErrorBoundary'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> OtherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> AnotherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./AnotherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MyComponent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyErrorBoundary</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OtherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AnotherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyErrorBoundary</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"route-based-code-splitting\"><a class=\"anchor\" href=\"/react/code-splitting#route-based-code-splitting\"></a>\u57fa\u65bc Route \u7684 Code-Splitting </h2>\n<p>\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u6c7a\u5b9a\u63a1\u7528 code-splitting \u53ef\u80fd\u6709\u9ede\u68d8\u624b\u3002\u4f60\u60f3\u8981\u78ba\u4fdd\u9078\u64c7\u7684\u4f4d\u7f6e\u53ef\u4ee5\u9069\u7576\u7684 split bundle\uff0c\u4f46\u4e0d\u6703\u7834\u58de\u4f7f\u7528\u8005\u7684\u9ad4\u9a57\u3002</p>\n<p>Route \u662f\u4e00\u500b\u958b\u59cb\u7684\u597d\u5730\u65b9\u3002Web \u4e0a\u5927\u591a\u6578\u7684\u4eba\u90fd\u7fd2\u6163\u82b1\u4e00\u4e9b\u6642\u9593\u4f86\u7b49\u5f85\u9801\u9762\u7684\u904e\u6e21\u3002\u4f60\u4e5f\u50be\u5411\u65bc\u91cd\u65b0 render \u4e00\u6b21\u6574\u500b\u9801\u9762\uff0c\u6240\u4ee5\u4f60\u7684\u4f7f\u7528\u8005\u4e0d\u80fd\u540c\u6642\u8207\u9801\u9762\u4e0a\u7684\u5176\u4ed6 element \u505a\u4e92\u52d5\u3002</p>\n<p>\u9019\u88e1\u662f\u5982\u4f55\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528\u50cf\u662f <a class=\"external-link\" href=\"https://reactrouter.com/\">React Router</a> \u7684\u51fd\u5f0f\u5eab\u8207 <code class=\"language-javascript\">React.lazy</code> \u4f86\u8a2d\u5b9a\u57fa\u65bc route \u7684 code-splitting\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Suspense<span class=\"token punctuation\">,</span> lazy <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> BrowserRouter <span class=\"token keyword\">as</span> Router<span class=\"token punctuation\">,</span> Routes<span class=\"token punctuation\">,</span> Route <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Home <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/Home'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> About <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./routes/About'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Router</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Home</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/about<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">About</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Router</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"named-exports\"><a class=\"anchor\" href=\"/react/code-splitting#named-exports\"></a>Named Exports </h2>\n<p><code class=\"language-javascript\">React.lazy</code> \u76ee\u524d\u53ea\u652f\u63f4 default exports\u3002\u5982\u679c\u4f60\u60f3 import \u7684 module \u4f7f\u7528 named export\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u4e2d\u4ecb module \u4f86\u91cd\u65b0 export \u5b83\u505a\u70ba\u9810\u8a2d\u3002\u9019\u53ef\u4ee5\u78ba\u4fdd tree shaking \u4e0d\u6703 pull \u7121\u7528\u7684 component\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// ManyComponents.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> MyComponent <span class=\"token operator\">=</span> <span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> MyUnusedComponent <span class=\"token operator\">=</span> <span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// MyComponent.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> MyComponent <span class=\"token keyword\">as</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ManyComponents.js\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// MyApp.js</span>\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> lazy <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> MyComponent <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./MyComponent.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/code-splitting.md\">Edit this page</a></p></div></article>", "path": "/react/code-splitting", "nav": ["/react/accessibility", "/react/context"]}, {"key": "Context", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Context provides a way to pass data through the component tree without having to pass props down manually at every level.</p>\n<p>In a typical React application, data is passed top-down (parent to child) via props, but such usage can be cumbersome for certain types of props (e.g. locale preference, UI theme) that are required by many components within an application. Context provides a way to share values like these between components without having to explicitly pass a prop through every level of the tree.</p>\n<ul>\n<li><a href=\"/react/context#when-to-use-context\">When to Use Context</a></li>\n<li><a href=\"/react/context#before-you-use-context\">Before You Use Context</a></li>\n<li>\n<p><a href=\"/react/context#api\">API</a></p>\n<ul>\n<li><a href=\"/react/context#reactcreatecontext\">React.createContext</a></li>\n<li><a href=\"/react/context#contextprovider\">Context.Provider</a></li>\n<li><a href=\"/react/context#classcontexttype\">Class.contextType</a></li>\n<li><a href=\"/react/context#contextconsumer\">Context.Consumer</a></li>\n<li><a href=\"/react/context#contextdisplayname\">Context.displayName</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/react/context#examples\">Examples</a></p>\n<ul>\n<li><a href=\"/react/context#dynamic-context\">Dynamic Context</a></li>\n<li><a href=\"/react/context#updating-context-from-a-nested-component\">Updating Context from a Nested Component</a></li>\n<li><a href=\"/react/context#consuming-multiple-contexts\">Consuming Multiple Contexts</a></li>\n</ul>\n</li>\n<li><a href=\"/react/context#caveats\">Caveats</a></li>\n<li><a href=\"/react/context#legacy-api\">Legacy API</a></li>\n</ul>\n<h2 id=\"when-to-use-context\"><a class=\"anchor\" href=\"/react/context#when-to-use-context\"></a>When to Use Context </h2>\n<p>Context is designed to share data that can be considered \u201cglobal\u201d for a tree of React components, such as the current authenticated user, theme, or preferred language. For example, in the code below we manually thread through a \u201ctheme\u201d prop in order to style the Button component:</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token attr-name\">theme</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dark<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Toolbar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// The Toolbar component must take an extra \"theme\" prop</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// and pass it to the ThemedButton. This can become painful</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// if every single button in the app needs to know the theme</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// because it would have to be passed through all components.</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemedButton</span></span> <span class=\"token attr-name\">theme</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>theme<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ThemedButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">theme</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>theme<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>Using context, we can avoid passing props through intermediate elements:</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// Context lets us pass a value deep into the component tree</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// without explicitly threading it through every component.</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// Create a context for the current theme (with \"light\" as the default).</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// Use a Provider to pass the current theme to the tree below.</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// Any component can read it, no matter how deep it is.</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// In this example, we're passing \"dark\" as the current value.</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dark<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// A component in the middle doesn't have to</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// pass the theme down explicitly anymore.</span></span><span class=\"token keyword\">function</span> <span class=\"token function\">Toolbar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemedButton</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ThemedButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Assign a contextType to read the current theme context.</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// React will find the closest theme Provider above and use its value.</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// In this example, the current theme is \"dark\".</span></span>  <span class=\"token keyword\">static</span> contextType <span class=\"token operator\">=</span> ThemeContext<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">theme</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<h2 id=\"before-you-use-context\"><a class=\"anchor\" href=\"/react/context#before-you-use-context\"></a>Before You Use Context </h2>\n<p>Context is primarily used when some data needs to be accessible by <em>many</em> components at different nesting levels. Apply it sparingly because it makes component reuse more difficult.</p>\n<p><strong>If you only want to avoid passing some props through many levels, <a href=\"/react/composition-vs-inheritance\">component composition</a> is often a simpler solution than context.</strong></p>\n<p>For example, consider a <code class=\"language-javascript\">Page</code> component that passes a <code class=\"language-javascript\">user</code> and <code class=\"language-javascript\">avatarSize</code> prop several levels down so that deeply nested <code class=\"language-javascript\">Link</code> and <code class=\"language-javascript\">Avatar</code> components can read it:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Page</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">avatarSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageLayout</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">avatarSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NavigationBar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">avatarSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>permalink<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Avatar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">size</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>It might feel redundant to pass down the <code class=\"language-javascript\">user</code> and <code class=\"language-javascript\">avatarSize</code> props through many levels if in the end only the <code class=\"language-javascript\">Avatar</code> component really needs it. It\u2019s also annoying that whenever the <code class=\"language-javascript\">Avatar</code> component needs more props from the top, you have to add them at all the intermediate levels too.</p>\n<p>One way to solve this issue <strong>without context</strong> is to <a href=\"/react/composition-vs-inheritance#containment\">pass down the <code class=\"language-javascript\">Avatar</code> component itself</a> so that the intermediate components don\u2019t need to know about the <code class=\"language-javascript\">user</code> or <code class=\"language-javascript\">avatarSize</code> props:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> userLink <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>permalink<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Avatar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">size</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageLayout</span></span> <span class=\"token attr-name\">userLink</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>userLink<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Now, we have:</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Page</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">avatarSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageLayout</span></span> <span class=\"token attr-name\">userLink</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NavigationBar</span></span> <span class=\"token attr-name\">userLink</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token comment\">// ... which renders ...</span>\n<span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>userLink<span class=\"token punctuation\">}</span></code></pre></div>\n<p>With this change, only the top-most Page component needs to know about the <code class=\"language-javascript\">Link</code> and <code class=\"language-javascript\">Avatar</code> components\u2019 use of <code class=\"language-javascript\">user</code> and <code class=\"language-javascript\">avatarSize</code>.</p>\n<p>This <em>inversion of control</em> can make your code cleaner in many cases by reducing the amount of props you need to pass through your application and giving more control to the root components. Such inversion, however, isn\u2019t the right choice in every case; moving more complexity higher in the tree makes those higher-level components more complicated and forces the lower-level components to be more flexible than you may want.</p>\n<p>You\u2019re not limited to a single child for a component. You may pass multiple children, or even have multiple separate \u201cslots\u201d for children, <a href=\"/react/composition-vs-inheritance#containment\">as documented here</a>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Feed</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> topBar <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NavigationBar</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>permalink<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Avatar</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">size</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>avatarSize<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">NavigationBar</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageLayout</span></span>\n      <span class=\"token attr-name\">topBar</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>topBar<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">content</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>content<span class=\"token punctuation\">}</span></span>\n    <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This pattern is sufficient for many cases when you need to decouple a child from its immediate parents. You can take it even further with <a href=\"/react/render-props\">render props</a> if the child needs to communicate with the parent before rendering.</p>\n<p>However, sometimes the same data needs to be accessible by many components in the tree, and at different nesting levels. Context lets you \u201cbroadcast\u201d such data, and changes to it, to all components below. Common examples where using context might be simpler than the alternatives include managing the current locale, theme, or a data cache.</p>\n<h2 id=\"api\"><a class=\"anchor\" href=\"/react/context#api\"></a>API </h2>\n<h3 id=\"reactcreatecontext\"><a class=\"anchor\" href=\"/react/context#reactcreatecontext\"></a><code class=\"language-javascript\">React.createContext</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> MyContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span>defaultValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Creates a Context object. When React renders a component that subscribes to this Context object it will read the current context value from the closest matching <code class=\"language-javascript\">Provider</code> above it in the tree.</p>\n<p>The <code class=\"language-javascript\">defaultValue</code> argument is <strong>only</strong> used when a component does not have a matching Provider above it in the tree. This default value can be helpful for testing components in isolation without wrapping them. Note: passing <code class=\"language-javascript\">undefined</code> as a Provider value does not cause consuming components to use <code class=\"language-javascript\">defaultValue</code>.</p>\n<h3 id=\"contextprovider\"><a class=\"anchor\" href=\"/react/context#contextprovider\"></a><code class=\"language-javascript\">Context.Provider</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* some value */</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>Every Context object comes with a Provider React component that allows consuming components to subscribe to context changes.</p>\n<p>The Provider component accepts a <code class=\"language-javascript\">value</code> prop to be passed to consuming components that are descendants of this Provider. One Provider can be connected to many consumers. Providers can be nested to override values deeper within the tree.</p>\n<p>All consumers that are descendants of a Provider will re-render whenever the Provider\u2019s <code class=\"language-javascript\">value</code> prop changes. The propagation from Provider to its descendant consumers (including <a href=\"/react/context#classcontexttype\"><code class=\"language-javascript\">.contextType</code></a> and <a href=\"/react/hooks-reference#usecontext\"><code class=\"language-javascript\">useContext</code></a>) is not subject to the <code class=\"language-javascript\">shouldComponentUpdate</code> method, so the consumer is updated even when an ancestor component skips an update.</p>\n<p>Changes are determined by comparing the new and old values using the same algorithm as <a href=\"//developer.mozilla.org/en-US/react/Web/JavaScript/Reference/Global_Objects/Object/is#Description\"><code class=\"language-javascript\">Object.is</code></a>.</p>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>The way changes are determined can cause some issues when passing objects as <code class=\"language-javascript\">value</code>: see <a href=\"/react/context#caveats\">Caveats</a>.</p>\n</div>\n<h3 id=\"classcontexttype\"><a class=\"anchor\" href=\"/react/context#classcontexttype\"></a><code class=\"language-javascript\">Class.contextType</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* perform a side-effect at mount using the value of MyContext */</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* ... */</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* ... */</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* render something based on the value of MyContext */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nMyClass<span class=\"token punctuation\">.</span>contextType <span class=\"token operator\">=</span> MyContext<span class=\"token punctuation\">;</span></code></pre></div>\n<p>The <code class=\"language-javascript\">contextType</code> property on a class can be assigned a Context object created by <a href=\"/react/context#reactcreatecontext\"><code class=\"language-javascript\">React.createContext()</code></a>. Using this property lets you consume the nearest current value of that Context type using <code class=\"language-javascript\">this.context</code>. You can reference this in any of the lifecycle methods including the render function.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>You can only subscribe to a single context using this API. If you need to read more than one see <a href=\"/react/context#consuming-multiple-contexts\">Consuming Multiple Contexts</a>.</p>\n<p>If you are using the experimental <a class=\"external-link\" href=\"https://babeljs.io/docs/plugins/transform-class-properties/\">public class fields syntax</a>, you can use a <strong>static</strong> class field to initialize your <code class=\"language-javascript\">contextType</code>.</p>\n</div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> contextType <span class=\"token operator\">=</span> MyContext<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* render something based on the value */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"contextconsumer\"><a class=\"anchor\" href=\"/react/context#contextconsumer\"></a><code class=\"language-javascript\">Context.Consumer</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">value</span> <span class=\"token operator\">=&gt;</span> <span class=\"token comment\">/* render something based on the context value */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>A React component that subscribes to context changes. Using this component lets you subscribe to a context within a <a href=\"/react/components-and-props#function-and-class-components\">function component</a>.</p>\n<p>Requires a <a href=\"/react/render-props#using-props-other-than-render\">function as a child</a>. The function receives the current context value and returns a React node. The <code class=\"language-javascript\">value</code> argument passed to the function will be equal to the <code class=\"language-javascript\">value</code> prop of the closest Provider for this context above in the tree. If there is no Provider for this context above, the <code class=\"language-javascript\">value</code> argument will be equal to the <code class=\"language-javascript\">defaultValue</code> that was passed to <code class=\"language-javascript\">createContext()</code>.</p>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>For more information about the \u2018function as a child\u2019 pattern, see <a href=\"/react/render-props\">render props</a>.</p>\n</div>\n<h3 id=\"contextdisplayname\"><a class=\"anchor\" href=\"/react/context#contextdisplayname\"></a><code class=\"language-javascript\">Context.displayName</code> </h3>\n<p>Context object accepts a <code class=\"language-javascript\">displayName</code> string property. React DevTools uses this string to determine what to display for the context.</p>\n<p>For example, the following component will appear as MyDisplayName in the DevTools:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> MyContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* some value */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">MyContext<span class=\"token punctuation\">.</span>displayName <span class=\"token operator\">=</span> <span class=\"token string\">'MyDisplayName'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"> // \"MyDisplayName.Provider\" in DevTools</span>\n<span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"> // \"MyDisplayName.Consumer\" in DevTools</span></code></pre></div>\n<h2 id=\"examples\"><a class=\"anchor\" href=\"/react/context#examples\"></a>Examples </h2>\n<h3 id=\"dynamic-context\"><a class=\"anchor\" href=\"/react/context#dynamic-context\"></a>Dynamic Context </h3>\n<p>A more complex example with dynamic values for the theme:</p>\n<p><strong>theme-context.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> themes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">light</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">foreground</span><span class=\"token operator\">:</span> <span class=\"token string\">'#000000'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">'#eeeeee'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">dark</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">foreground</span><span class=\"token operator\">:</span> <span class=\"token string\">'#ffffff'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">'#222222'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">  themes<span class=\"token punctuation\">.</span>dark <span class=\"token comment\">// default value</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n</div></p>\n<p><strong>themed-button.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>ThemeContext<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./theme-context'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ThemedButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> props <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">let</span> theme <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n        <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">backgroundColor</span><span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>background<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">ThemedButton<span class=\"token punctuation\">.</span>contextType <span class=\"token operator\">=</span> ThemeContext<span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ThemedButton<span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><strong>app.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>ThemeContext<span class=\"token punctuation\">,</span> themes<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./theme-context'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ThemedButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./themed-button'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// An intermediate component that uses the ThemedButton</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Toolbar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemedButton</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>changeTheme<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      Change Theme</span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemedButton</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">theme</span><span class=\"token operator\">:</span> themes<span class=\"token punctuation\">.</span>light<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">toggleTheme</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">theme</span><span class=\"token operator\">:</span>\n          state<span class=\"token punctuation\">.</span>theme <span class=\"token operator\">===</span> themes<span class=\"token punctuation\">.</span>dark\n            <span class=\"token operator\">?</span> themes<span class=\"token punctuation\">.</span>light\n            <span class=\"token operator\">:</span> themes<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// The ThemedButton button inside the ThemeProvider</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// uses the theme from state while the one outside uses</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// the default dark theme</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Page</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>theme<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token attr-name\">changeTheme</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleTheme<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Section</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemedButton</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Section</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Page</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<h3 id=\"updating-context-from-a-nested-component\"><a class=\"anchor\" href=\"/react/context#updating-context-from-a-nested-component\"></a>Updating Context from a Nested Component </h3>\n<p>It is often necessary to update the context from a component that is nested somewhere deeply in the component tree. In this case you can pass a function down through the context to allow consumers to update the context:</p>\n<p><strong>theme-context.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Make sure the shape of the default value passed to</span>\n<span class=\"token comment\">// createContext matches the shape that the consumers expect!</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">theme</span><span class=\"token operator\">:</span> themes<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function-variable function\">toggleTheme</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><strong>theme-toggler-button.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>ThemeContext<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./theme-context'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ThemeTogglerButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// The Theme Toggler Button receives not only the theme</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// but also a toggleTheme function from the context</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">,</span> toggleTheme<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span></span>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n          <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>toggleTheme<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">backgroundColor</span><span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>background<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Toggle Theme</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ThemeTogglerButton<span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><strong>app.js</strong>\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>ThemeContext<span class=\"token punctuation\">,</span> themes<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./theme-context'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ThemeTogglerButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./theme-toggler-button'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">toggleTheme</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">theme</span><span class=\"token operator\">:</span>\n          state<span class=\"token punctuation\">.</span>theme <span class=\"token operator\">===</span> themes<span class=\"token punctuation\">.</span>dark\n            <span class=\"token operator\">?</span> themes<span class=\"token punctuation\">.</span>light\n            <span class=\"token operator\">:</span> themes<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// State also contains the updater function so it will</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// be passed down into the context provider</span></span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">theme</span><span class=\"token operator\">:</span> themes<span class=\"token punctuation\">.</span>light<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">toggleTheme</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleTheme<span class=\"token punctuation\">,</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// The entire state is passed to the provider</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Content</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeTogglerButton</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<h3 id=\"consuming-multiple-contexts\"><a class=\"anchor\" href=\"/react/context#consuming-multiple-contexts\"></a>Consuming Multiple Contexts </h3>\n<p>To keep context re-rendering fast, React needs to make each context consumer a separate node in the tree.</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Theme context, default to light theme</span>\n<span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Signed-in user context</span>\n<span class=\"token keyword\">const</span> UserContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Guest'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>signedInUser<span class=\"token punctuation\">,</span> theme<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// App component that provides initial context values</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>signedInUser<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Layout</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">UserContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Layout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Sidebar</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Content</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// A component may consume multiple contexts</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">theme</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">user</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ProfilePage</span></span> <span class=\"token attr-name\">user</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">theme</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">UserContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Consumer</span></span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>If two or more context values are often used together, you might want to consider creating your own render prop component that provides both.</p>\n<h2 id=\"caveats\"><a class=\"anchor\" href=\"/react/context#caveats\"></a>Caveats </h2>\n<p>Because context uses reference identity to determine when to re-render, there are some gotchas that could trigger unintentional renders in consumers when a provider\u2019s parent re-renders. For example, the code below will re-render all consumers every time the Provider re-renders because a new object is always created for <code class=\"language-javascript\">value</code>:</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">something</span><span class=\"token operator\">:</span> <span class=\"token string\">'something'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>To get around this, lift the value into the parent\u2019s state:</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">something</span><span class=\"token operator\">:</span> <span class=\"token string\">'something'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<h2 id=\"legacy-api\"><a class=\"anchor\" href=\"/react/context#legacy-api\"></a>Legacy API </h2>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>React previously shipped with an experimental context API. The old API will be supported in all 16.x releases, but applications using it should migrate to the new version. The legacy API will be removed in a future major React version. Read the <a href=\"/react/legacy-context\">legacy context docs here</a>.</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/context.md\">Edit this page</a></p></div></article>", "path": "/react/context", "nav": ["/react/code-splitting", "/react/error-boundaries"]}, {"key": "\u932f\u8aa4\u908a\u754c", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u5728\u904e\u53bb\uff0ccomponent \u88e1 JavaScript \u7684\u932f\u8aa4\u5e38\u5e38\u6703\u7834\u58de React \u7684\u5167\u90e8 state\uff0c\u4e26\u4f7f\u5b83\u5728\u4e0b\u6b21 render \u7684\u6642\u5019<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/4026\">\u767c\u751f</a> <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/6895\">\u795e\u79d8\u7684</a> <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/8579\">\u932f\u8aa4</a>\u3002\u9019\u4e9b\u932f\u8aa4\u7e3d\u662f\u88ab\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u78bc\u88e1\u66f4\u65e9\u767c\u751f\u7684\u932f\u8aa4\u6240\u5c0e\u81f4\uff0c\u4f46 React \u4e26\u6c92\u6709\u63d0\u4f9b\u5728 component \u88e1\u512a\u96c5\u8655\u7406\u5b83\u5011\u7684\u65b9\u5f0f\uff0c\u800c\u4e14\u4e5f\u7121\u6cd5\u5f9e\u932f\u8aa4\u4e2d\u6062\u5fa9\u3002</p>\n<h2 id=\"introducing-error-boundaries\"><a class=\"anchor\" href=\"/react/error-boundaries#introducing-error-boundaries\"></a>\u5f15\u5165\u932f\u8aa4\u908a\u754c </h2>\n<p>\u4e00\u500b\u4ecb\u9762\u88e1\u7684\u67d0\u4e00\u500b JavaScript \u7684\u932f\u8aa4\u4e0d\u61c9\u8a72\u6bc0\u4e86\u6574\u500b\u61c9\u7528\u7a0b\u5f0f\u3002\u70ba\u4e86\u66ff React \u4f7f\u7528\u8005\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0cReact 16 \u5f15\u5165\u4e86\u4e00\u500b\u65b0\u7684\u6982\u5ff5\uff1a\u300c\u932f\u8aa4\u908a\u754c\u300d\u3002</p>\n<p>\u932f\u8aa4\u908a\u754c\u662f\u4e00\u500b React component\uff0c\u5b83<strong>\u6355\u6349\u4e86\u4efb\u4f55\u5728\u5b83\u7684 child component tree \u88e1\u767c\u751f\u7684 JavaScript \u7684\u932f\u8aa4\uff0c\u8a18\u9304\u90a3\u4e9b\u932f\u8aa4\uff0c\u7136\u5f8c\u986f\u793a\u5728\u4e00\u500b fallback \u7684\u4f7f\u7528\u4ecb\u9762</strong>\uff0c\u800c\u975e\u8b93\u6574\u500b component tree \u5d29\u58de\u3002\u932f\u8aa4\u908a\u754c\u6703\u5728 render \u7684\u6642\u5019\u3001\u5728\u751f\u547d\u9031\u671f\u51fd\u5f0f\u5167\u3001\u4ee5\u53ca\u5e95\u4e0b\u4e00\u6574\u500b component tree \u88e1\u7684 constructor \u5167\u6355\u6349\u932f\u8aa4\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u932f\u8aa4\u908a\u754c<strong>\u4e0d\u6703</strong>\u5728\u4ee5\u4e0b\u60c5\u6cc1\u6355\u6349\u932f\u8aa4\uff1a</p>\n<ul>\n<li>Event handlers (<a href=\"/react/error-boundaries#how-about-event-handlers\">\u5b78\u7fd2\u66f4\u591a</a>)</li>\n<li>\u975e\u540c\u6b65\u7684\u7a0b\u5f0f\u78bc (\u4f8b\u5982 <code class=\"language-javascript\">setTimeout</code> \u6216 <code class=\"language-javascript\">requestAnimationFrame</code> callback)</li>\n<li>Server side rendering</li>\n<li>\u5728\u932f\u8aa4\u908a\u754c\u88e1\u4e1f\u51fa\u7684\u932f\u8aa4\uff08\u800c\u4e0d\u662f\u5728\u5b83\u5e95\u4e0b\u7684 children\uff09</li>\n</ul>\n</div>\n<p>\u4e00\u500b class component \u5982\u679c\u5b9a\u7fa9\u4e86 <a href=\"/react/react-component#static-getderivedstatefromerror\"><code class=\"language-javascript\">static getDerivedStateFromError()</code></a> \u6216 <a href=\"/react/react-component#componentdidcatch\"><code class=\"language-javascript\">componentDidCatch()</code></a> \u5176\u4e2d\u4e00\u7a2e\uff08\u6216\u5169\u7a2e\u90fd\u6709\uff09\u751f\u547d\u9031\u671f\uff0c\u5b83\u5c31\u6703\u8b8a\u6210\u932f\u8aa4\u908a\u754c\u3002\u5728\u932f\u8aa4\u88ab\u4e1f\u51fa\u53bb\u4e4b\u5f8c\uff0c\u6211\u5011\u4f7f\u7528 <code class=\"language-javascript\">static getDerivedStateFromError()</code> \u4f86 render fallback \u7684 UI\uff0c\u4ee5\u53ca\u4f7f\u7528 <code class=\"language-javascript\">componentDidCatch()</code> \u4f86\u8a18\u9304\u932f\u8aa4\u7684\u8cc7\u8a0a\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorBoundary</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u66f4\u65b0 state \u4ee5\u81f3\u65bc\u4e0b\u4e00\u500b render \u6703\u986f\u793a fallback UI</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidCatch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> errorInfo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u4f60\u4e5f\u53ef\u4ee5\u628a\u932f\u8aa4\u8a18\u9304\u5230\u4e00\u500b\u932f\u8aa4\u56de\u5831\u7cfb\u7d71\u670d\u52d9</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">logErrorToMyService</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> errorInfo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>hasError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u4f60\u53ef\u4ee5 render \u4efb\u4f55\u5ba2\u88fd\u5316\u7684 fallback UI</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Something went wrong.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7136\u5f8c\u4f60\u5c31\u53ef\u4ee5\u628a\u5b83\u7576\u6210\u4e00\u822c\u7684 component \u4f86\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ErrorBoundary</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyWidget</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ErrorBoundary</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u932f\u8aa4\u908a\u754c\u5c31\u5982\u540c JavaScript \u7684 <code class=\"language-javascript\">catch {}</code>\uff0c\u4f46\u5b83\u662f\u7d66 component \u4f7f\u7528\u7684\u3002\u53ea\u6709 class component \u53ef\u4ee5\u6210\u70ba\u932f\u8aa4\u908a\u754c\u3002\u5be6\u52d9\u4e0a\uff0c\u5927\u90e8\u5206\u7684\u6642\u9593\u4f60\u53ea\u6703\u60f3\u8981\u5ba3\u544a\u932f\u8aa4\u908a\u754c component \u4e00\u6b21\uff0c\u7136\u5f8c\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u88e1\u91cd\u8907\u4f7f\u7528\u5b83\u3002</p>\n<p>\u8981\u6ce8\u610f<strong>\u932f\u8aa4\u908a\u754c\u53ea\u6703\u6355\u6349\u5b83\u5e95\u4e0b component tree \u88e1\u7684 component \u7684\u932f\u8aa4</strong>\u3002\u932f\u8aa4\u908a\u754c\u7121\u6cd5\u6355\u6349\u5b83\u81ea\u5df1\u672c\u8eab\u7684\u932f\u8aa4\u3002\u5982\u679c\u4e00\u500b\u932f\u8aa4\u908a\u754c\u5728 render \u932f\u8aa4\u8a0a\u606f\u7684\u6642\u5019\u5931\u6557\u4e86\uff0c\u9019\u500b\u932f\u8aa4\u6703\u88ab\u50b3\u905e\u5230\u5728\u5b83\u4e4b\u4e0a\u6700\u8fd1\u7684\u932f\u8aa4\u908a\u754c\u3002\u9019\u500b\u4e5f\u8207 JavaScript \u7684 <code class=\"language-javascript\">catch {}</code> \u7684\u904b\u4f5c\u65b9\u5f0f\u985e\u4f3c\u3002</p>\n<h2 id=\"live-demo\"><a class=\"anchor\" href=\"/react/error-boundaries#live-demo\"></a>Live Demo </h2>\n<p>\u67e5\u770b<a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/wqvxGa?editors=0010\">\u9019\u500b\u5ba3\u544a\u8207\u4f7f\u7528\u932f\u8aa4\u908a\u754c\u7684\u7bc4\u4f8b</a>\u3002</p>\n<h2 id=\"where-to-place-error-boundaries\"><a class=\"anchor\" href=\"/react/error-boundaries#where-to-place-error-boundaries\"></a>\u8a72\u628a\u932f\u8aa4\u908a\u754c\u653e\u5728\u54ea\u88e1 </h2>\n<p>\u932f\u8aa4\u908a\u754c\u7684\u7cbe\u78ba\u5ea6\u53d6\u6c7a\u65bc\u4f60\u81ea\u5df1\u3002\u4f60\u53ef\u4ee5\u628a\u5b83\u5305\u5728\u6700\u4e0a\u5c64\u7684 route component \u85c9\u4ee5\u986f\u793a\u300c\u767c\u751f\u4e86\u4e00\u4e9b\u932f\u8aa4\u300d\u7684\u8a0a\u606f\u7d66\u4f7f\u7528\u8005\uff0c\u5c31\u5982\u540c server-side framework \u88e1\u5e38\u5e38\u8655\u7406\u932f\u8aa4\u7684\u65b9\u5f0f\u3002\u4f60\u4e5f\u53ef\u4ee5\u628a\u5b83\u5305\u5728\u500b\u5225\u7684\u5c0f\u5de5\u5177\u5916\uff0c\u85c9\u4ee5\u4fdd\u8b77\u5b83\u5011\u4e0d\u53d7\u61c9\u7528\u7a0b\u5f0f\u88e1\u767c\u751f\u7684\u5176\u4ed6\u932f\u8aa4\u7684\u5f71\u97ff\u3002</p>\n<h2 id=\"new-behavior-for-uncaught-errors\"><a class=\"anchor\" href=\"/react/error-boundaries#new-behavior-for-uncaught-errors\"></a>\u5c0d\u65bc\u672a\u6355\u6349\u5230\u7684\u932f\u8aa4\u7684\u65b0\u884c\u70ba </h2>\n<p>\u9019\u500b\u6539\u8b8a\u6709\u91cd\u8981\u7684\u610f\u7fa9\u3002<strong>\u5728 React 16\uff0c\u6c92\u6709\u88ab\u932f\u8aa4\u908a\u754c\u6240\u6355\u6349\u5230\u7684\u932f\u8aa4\u6703 unmount \u6574\u500b React component tree\u3002</strong></p>\n<p>\u6211\u5011\u70ba\u4e86\u9019\u500b\u6c7a\u5b9a\u8faf\u8ad6\u904e\uff0c\u4f46\u5728\u6211\u5011\u7684\u7d93\u9a57\u88e1\uff0c\u7559\u4e0b\u58de\u6389\u7684 UI \u6bd4\u5b8c\u5168\u79fb\u9664\u5b83\u66f4\u7cdf\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5728\u50cf Messenger \u4e00\u6a23\u7684\u7522\u54c1\u88e1\uff0c\u7559\u4e0b\u58de\u6389\u7684 UI \u53ef\u80fd\u6703\u5c0e\u81f4\u67d0\u4eba\u50b3\u9001\u8a0a\u606f\u7d66\u932f\u8aa4\u7684\u5c0d\u8c61\u3002\u76f8\u4f3c\u5730\uff0c\u5728\u652f\u4ed8\u8edf\u9ad4\u88e1\uff0c\u986f\u793a\u932f\u8aa4\u7684\u91d1\u984d\u6bd4 render \u7a7a\u767d\u756b\u9762\u4f86\u5f97\u66f4\u7cdf\u3002</p>\n<p>\u9019\u500b\u6539\u8b8a\u4ee3\u8868\u8457\uff0c\u5982\u679c\u4f60\u9077\u79fb\u5230 React 16\uff0c\u4f60\u6709\u53ef\u80fd\u6703\u767c\u6398\u51fa\u61c9\u7528\u7a0b\u5f0f\u88e1\u4ee5\u524d\u6c92\u6ce8\u610f\u904e\u4f46\u5df2\u7d93\u5b58\u5728\u7684\u932f\u8aa4\u3002\u52a0\u4e0a\u932f\u8aa4\u908a\u754c\u4f7f\u4f60\u5728\u932f\u8aa4\u767c\u751f\u6642\u80fd\u5920\u63d0\u4f9b\u66f4\u597d\u7684\u4f7f\u7528\u8005\u9ad4\u9a57\u3002</p>\n<p>\u4f8b\u5982\uff0cFacebook Messenger \u7528\u5206\u958b\u7684\u932f\u8aa4\u908a\u754c\u5305\u4f4f\u4e86\u5074\u6b04\u4f4d\u7684\u5167\u5bb9\u3001\u8cc7\u8a0a\u9762\u677f\u3001\u5c0d\u8a71\u7d00\u9304\u3001\u548c\u8a0a\u606f\u8f38\u5165\u6b04\u3002\u5982\u679c\u67d0\u500b\u5728\u5176\u4e2d\u4e00\u500b UI \u88e1\u7684 component \u58de\u4e86\uff0c\u5176\u4ed6\u7684\u90e8\u5206\u4ecd\u6703\u4fdd\u6301\u80fd\u5920\u4e92\u52d5\u7684\u72c0\u614b\u3002</p>\n<p>\u6211\u5011\u4e5f\u9f13\u52f5\u4f60\u4f7f\u7528 JS \u7684\u932f\u8aa4\u56de\u5831\u670d\u52d9\uff08\u6216\u5efa\u7acb\u4e00\u500b\u4f60\u81ea\u5df1\u7684\u670d\u52d9\uff09\uff0c\u9019\u6a23\u4f60\u53ef\u4ee5\u5f9e\u4e0a\u7dda\u7684\u7a0b\u5f0f\u88e1\u5b78\u7fd2\u672a\u8655\u7406\u7684 exception \u4e26\u4fee\u7406\u5b83\u5011\u3002</p>\n<h2 id=\"component-stack-traces\"><a class=\"anchor\" href=\"/react/error-boundaries#component-stack-traces\"></a>Component Stack Traces </h2>\n<p>React 16 \u628a\u6240\u6709\u767c\u751f\u5728 render \u6642\u7684\u932f\u8aa4\u5728\u958b\u767c\u6642\u5370\u51fa\u5728 console \u88e1\uff0c\u5373\u4f7f\u61c9\u7528\u7a0b\u5f0f\u4e0d\u5c0f\u5fc3\u541e\u6389\u4e86\u9019\u4e9b\u932f\u8aa4\u3002\u9664\u4e86\u932f\u8aa4\u8a0a\u606f\u548c JavaScript \u7684 stack \u4ee5\u5916\uff0c\u5b83\u4e5f\u63d0\u4f9b\u4e86 component stack trace\u3002\u73fe\u5728\u4f60\u53ef\u4ee5\u770b\u5230\u932f\u8aa4\u5728\u54ea\u500b component \u88e1\u767c\u751f\u7684\u78ba\u5207\u4f4d\u7f6e\uff1a</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/f1276837b03821b43358d44c14072945/c3a47/error-boundaries-stack-trace.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/f1276837b03821b43358d44c14072945/1e088/error-boundaries-stack-trace.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u5728 component stack trace \u88e1\u770b\u898b\u6a94\u6848\u540d\u7a31\u548c\u884c\u6578\u3002\u9019\u500b\u5728 <a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a> \u88e1\u662f\u9810\u8a2d\u884c\u70ba\uff1a</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/45611d4fdbd152829b28ae2348d6dcba/6dd26/error-boundaries-stack-trace-line-numbers.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/45611d4fdbd152829b28ae2348d6dcba/1e088/error-boundaries-stack-trace-line-numbers.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>\u5982\u679c\u4f60\u6c92\u6709\u4f7f\u7528 Create React App, \u4f60\u53ef\u4ee5\u624b\u52d5\u5728 Babel \u8a2d\u5b9a\u52a0\u4e0a<a class=\"external-link\" href=\"https://www.npmjs.com/package/@babel/plugin-transform-react-jsx-source\">\u9019\u500b plugin</a>\u3002\u6ce8\u610f\u5b83\u662f\u88ab\u8a2d\u8a08\u7528\u4f86\u5728\u958b\u767c\u6a21\u5f0f\u4f7f\u7528\u7684\uff0c\u4e14<strong>\u5fc5\u9808\u5728\u6b63\u5f0f\u74b0\u5883\u88ab\u95dc\u6389</strong>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5728 stack trace \u88e1\u986f\u793a\u7684 component \u540d\u7a31\u662f\u7531 <a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Function/name\"><code class=\"language-javascript\">Function.name</code></a> attribute \u6240\u6c7a\u5b9a\u7684\u3002\u5982\u679c\u4f60\u652f\u63f4\u6c92\u6709\u539f\u751f\u63d0\u4f9b\u5b83\u7684\u820a\u700f\u89bd\u5668\u548c\u88dd\u7f6e\uff08\u4f8b\u5982 IE 11\uff09\uff0c\u8a66\u8457\u8003\u616e\u628a <code class=\"language-javascript\">Function.name</code> polyfill \u5230\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\uff0c\u4f8b\u5982 <a class=\"external-link\" href=\"https://github.com/JamesMGreene/Function.name\"><code class=\"language-javascript\">function.name-polyfill</code></a>\u3002\u6216\u8457\uff0c\u4f60\u53ef\u4ee5\u53e6\u5916\u5728\u4f60\u6240\u6709\u7684 component \u88e1\u8a2d\u5b9a <a href=\"/react/react-component#displayname\"><code class=\"language-javascript\">displayName</code></a> attribute\u3002</p>\n</div>\n<h2 id=\"how-about-trycatch\"><a class=\"anchor\" href=\"/react/error-boundaries#how-about-trycatch\"></a>\u90a3 try/catch \u5462\uff1f </h2>\n<p><code class=\"language-javascript\">try</code> / <code class=\"language-javascript\">catch</code> \u5f88\u68d2\uff0c\u4f46\u5b83\u53ea\u4f5c\u7528\u5728\u547d\u4ee4\u5f0f\u7a0b\u5f0f\u78bc\uff08imperative code\uff09\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">showButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7136\u800c\uff0cReact component \u662f\u5ba3\u544a\u5f0f\uff08declarative\uff09\u7684\uff0c\u4e14\u6307\u660e\u4e86<em>\u4ec0\u9ebc</em>\u5fc5\u9808\u88ab render\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u932f\u8aa4\u908a\u754c\u4fdd\u6709\u4e86 React \u5ba3\u544a\u5f0f\u7684\u5929\u6027\uff0c\u4e14\u5982\u4f60\u6240\u9810\u671f\u7684\u904b\u884c\u3002\u4f8b\u5982\uff0c\u5373\u4f7f\u5728\u67d0\u500b tree \u88e1\u5f88\u6df1\u7684\u5730\u65b9\u88ab <code class=\"language-javascript\">setState</code> \u6240\u5c0e\u81f4\u7684 <code class=\"language-javascript\">componentDidUpdate</code> \u7684\u932f\u8aa4\uff0c\u5b83\u4ecd\u7136\u6703\u6b63\u78ba\u7684\u88ab\u50b3\u905e\u5230\u6700\u8fd1\u7684\u932f\u8aa4\u908a\u754c\u3002</p>\n<h2 id=\"how-about-event-handlers\"><a class=\"anchor\" href=\"/react/error-boundaries#how-about-event-handlers\"></a>\u90a3 Event Handler \u5462\uff1f </h2>\n<p>\u932f\u8aa4\u908a\u754c<strong>\u4e0d\u6703</strong>\u6355\u6349 event handler \u88e1\u6240\u767c\u751f\u7684\u932f\u8aa4\u3002</p>\n<p>React \u4e0d\u9700\u8981\u5f9e event handler \u88e1\u767c\u751f\u7684\u932f\u8aa4\u6062\u5fa9\u3002\u4e0d\u50cf render \u548c\u5176\u4ed6\u751f\u547d\u9031\u671f\u7684\u51fd\u5f0f\u4e00\u6a23\uff0cevent handler \u4e0d\u6703\u767c\u751f\u5728 render \u7684\u6642\u5019\u3002\u6240\u4ee5\u5982\u679c\u5b83\u5011\u4e1f\u51fa\u932f\u8aa4\uff0cReact \u4ecd\u7136\u77e5\u9053\u8a72\u986f\u793a\u4ec0\u9ebc\u5728\u756b\u9762\u4e0a\u3002</p>\n<p>\u5982\u679c\u4f60\u9700\u8981\u6355\u6349\u4e00\u500b event handler \u88e1\u7684\u932f\u8aa4\uff0c\u53ea\u8981\u4f7f\u7528\u4e00\u822c JavaScript \u7684 <code class=\"language-javascript\">try</code> / <code class=\"language-javascript\">catch</code> \u5c31\u53ef\u4ee5\u4e86\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u505a\u67d0\u4e9b\u53ef\u4ee5\u62cb\u51fa\u932f\u8aa4\u7684\u4e8b\u60c5</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> error <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Caught an error.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u662f\u7528\u4f86\u793a\u7bc4\u4e00\u822c JavaScript \u7684\u884c\u70ba\uff0c\u4e26\u6c92\u6709\u7528\u5230\u932f\u8aa4\u908a\u754c\u3002</p>\n<h2 id=\"naming-changes-from-react-15\"><a class=\"anchor\" href=\"/react/error-boundaries#naming-changes-from-react-15\"></a>\u5f9e React 15 \u767c\u751f\u7684\u540d\u7a31\u6539\u8b8a </h2>\n<p>React 15 \u7528\u4e0d\u540c\u7684\u51fd\u5f0f\u540d\u7a31\u652f\u63f4\u4e86\u975e\u5e38\u6709\u9650\u7684\u932f\u8aa4\u908a\u754c\u529f\u80fd\uff1a<code class=\"language-javascript\">unstable_handleError</code>\u3002\u9019\u500b\u51fd\u5f0f\u4e0d\u80fd\u7528\u4e86\uff0c\u800c\u4e14\u5f9e 16 beta \u958b\u59cb\uff0c\u4f60\u9700\u8981\u5c07\u5b83\u6539\u6210 <code class=\"language-javascript\">componentDidCatch</code>\u3002</p>\n<p>\u6211\u5011\u70ba\u9019\u500b\u6539\u8b8a\u63d0\u4f9b\u4e86 <a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod#error-boundaries\">codemod</a> \u4f86\u81ea\u52d5\u9077\u79fb\u4f60\u7684\u7a0b\u5f0f\u78bc\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/error-boundaries.md\">Edit this page</a></p></div></article>", "path": "/react/error-boundaries", "nav": ["/react/context", "/react/forwarding-refs"]}, {"key": "Forwarding Refs", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u50b3\u9001 ref \u662f\u4e00\u7a2e\u81ea\u52d5\u628a <a href=\"/react/refs-and-the-dom\">ref</a> \u5f9e\u4e00\u500b component \u50b3\u905e\u5230\u5b83\u5e95\u4e0b\u7684\u5176\u4e2d\u4e00\u500b child \u7684\u6280\u5de7\u3002\u901a\u5e38\u4f86\u8aaa\uff0c\u61c9\u7528\u7a0b\u5f0f\u88e1\u5927\u90e8\u5206\u7684 component \u90fd\u4e0d\u9700\u8981\u7528\u5230\u5b83\u3002\u7136\u800c\uff0c\u5c0d\u67d0\u4e9b\u7a2e\u985e\u7684 component \u4f86\u8aaa\u5b83\u5f88\u6709\u7528\uff0c\u7279\u5225\u662f\u80fd\u5920\u91cd\u8907\u4f7f\u7528\u7684\u51fd\u5f0f\u5eab\u3002\u4ee5\u4e0b\u6703\u89e3\u91cb\u6700\u5e38\u898b\u7684\u60c5\u5f62\u3002</p>\n<h2 id=\"forwarding-refs-to-dom-components\"><a class=\"anchor\" href=\"/react/forwarding-refs#forwarding-refs-to-dom-components\"></a>\u50b3\u9001 ref \u5230 DOM component </h2>\n<p>\u8a66\u8457\u8003\u616e\u4e00\u500b\u53eb\u505a <code class=\"language-javascript\">FancyButton</code> \u7684 component\uff0c\u5b83\u6703 render \u4e00\u500b\u539f\u751f\u7684 <code class=\"language-javascript\">button</code> DOM element\uff1a<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FancyButton</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>FancyButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>React component \u6703\u96b1\u85cf\u5305\u542b render \u7684\u7d50\u679c\u5728\u5167\u7684\u5be6\u4f5c\u7d30\u7bc0\u3002\u5176\u4ed6\u4f7f\u7528\u5230 <code class=\"language-javascript\">FancyButton</code> \u7684 component <strong>\u901a\u5e38\u4e0d\u9700\u8981</strong>\u7372\u5f97\u5167\u90e8\u6309\u9215\u7684 DOM element \u7684 <a href=\"/react/refs-and-the-dom\">ref</a>\u3002\u9019\u6a23\u5e36\u4f86\u7684\u597d\u8655\u662f\uff0c\u6211\u5011\u80fd\u5920\u907f\u514d\u8b93\u5176\u4ed6 component \u904e\u5ea6\u4f9d\u8cf4\u5f7c\u6b64\u7684 DOM \u7684\u7d50\u69cb\u3002</p>\n<p>\u96d6\u7136\u9019\u6a23\u7684\u5c01\u88dd\u5c0d\u65bc\u61c9\u7528\u7a0b\u5f0f\u5c64\u7d1a\u7684 component\uff08\u50cf\u662f <code class=\"language-javascript\">FeedStory</code> \u6216 <code class=\"language-javascript\">Comment</code>\uff09\u4f86\u8aaa\u662f\u6211\u5011\u6240\u5e0c\u671b\u64c1\u6709\u7684\uff0c\u4f46\u5c0d\u65bc\u5e38\u7528\u7684\u300c\u672b\u7aef\u300d component\uff0c\u50cf\u662f <code class=\"language-javascript\">FancyButton</code> \u6216 <code class=\"language-javascript\">MyTextInput</code> \u4f86\u8aaa\uff0c\u53ef\u80fd\u6703\u8b8a\u5f97\u4e0d\u65b9\u4fbf\u4f7f\u7528\u3002\u9019\u4e9b\u672b\u7aef component \u901a\u5e38\u6703\u50cf\u666e\u901a\u7684 DOM <code class=\"language-javascript\">button</code> \u548c <code class=\"language-javascript\">input</code> \u4e00\u6a23\uff0c\u5728\u61c9\u7528\u7a0b\u5f0f\u7684\u5404\u500b\u5730\u65b9\u88ab\u4f7f\u7528\uff0c\u5728\u8655\u7406 focus\u3001\u9078\u53d6\u6216\u52d5\u756b\u6642\uff0c\u53d6\u5f97\u5b83\u5011\u7684 DOM \u7bc0\u9ede\u53ef\u80fd\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002</p>\n<p><strong>\u50b3\u9001 ref \u662f\u500b\u9078\u64c7\u6027\u7684\u529f\u80fd\uff0c\u5b83\u80fd\u5920\u8b93\u67d0\u4e9b component \u5229\u7528\u5b83\u5011\u6536\u5230\u7684 <code class=\"language-javascript\">ref</code> \u4f86\u50b3\u905e\u5230\u5e95\u4e0b\u7684 child component\u3002</strong></p>\n<p>\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code class=\"language-javascript\">FancyButton</code> \u85c9\u7531 <code class=\"language-javascript\">React.forwardRef</code> \u4f86\u7372\u53d6\u50b3\u905e\u5230\u5b83\u8eab\u4e0a\u7684 <code class=\"language-javascript\">ref</code>\uff0c\u7136\u5f8c\u518d\u50b3\u905e\u5230\u5b83 render \u7684 DOM <code class=\"language-javascript\">button</code> \u4e0a\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> FancyButton <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>FancyButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// You can now get a ref directly to the DOM button:</span>\n<span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyButton</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click me!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">FancyButton</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p>\u9019\u6a23\u4e00\u4f86\uff0c\u4f7f\u7528 <code class=\"language-javascript\">FancyButton</code> \u7684 component \u53ef\u4ee5\u7372\u5f97\u5b83\u5e95\u4e0b\u7684 <code class=\"language-javascript\">button</code> \u7684 DOM \u7bc0\u9ede\u7684 ref\uff0c\u4e26\u53ef\u4ee5\u5728\u9700\u8981\u7684\u6642\u5019\u7372\u53d6\u5b83 \u2014\u2014 \u5c31\u5982\u540c\u76f4\u63a5\u4f7f\u7528 <code class=\"language-javascript\">button</code> DOM \u4e00\u6a23\u3002</p>\n<p>\u4ee5\u4e0b\u4e00\u6b65\u4e00\u6b65\u7684\u89e3\u91cb\u4e0a\u9762\u7684\u4f8b\u5b50\u5230\u5e95\u767c\u751f\u4e86\u4ec0\u9ebc\u4e8b\uff1a</p>\n<ol>\n<li>\u6211\u5011\u85c9\u7531\u547c\u53eb <code class=\"language-javascript\">React.createRef</code> \u7522\u751f\u4e86\u4e00\u500b <a href=\"/react/refs-and-the-dom\">React ref</a>\uff0c\u7136\u5f8c\u5c07\u5b83\u8ce6\u503c\u65bc\u53eb\u505a <code class=\"language-javascript\">ref</code> \u7684\u8b8a\u6578\u88e1\u3002</li>\n<li>\u6211\u5011\u85c9\u7531\u628a <code class=\"language-javascript\">ref</code> \u7576\u6210\u4e00\u500b JSX attribute \u4f86\u628a\u5b83\u50b3\u905e\u5230 <code class=\"language-javascript\">&lt;FancyButton ref={ref}&gt;</code>\u3002</li>\n<li>React \u628a <code class=\"language-javascript\">ref</code> \u7576\u4f5c\u7b2c\u4e8c\u500b\u8b8a\u6578\u50b3\u5230 <code class=\"language-javascript\">forwardRef</code> \u88e1\u7684 <code class=\"language-javascript\">(props, ref) =&gt; ...</code> function\u3002</li>\n<li>\u6211\u5011\u85c9\u7531\u628a\u9019\u500b <code class=\"language-javascript\">ref</code> \u7576\u4f5c JSX attribute \u4f86\u50b3\u905e\u5230\u66f4\u4e0b\u9762\u7684 <code class=\"language-javascript\">&lt;button ref={ref}&gt;</code>\u3002</li>\n<li>\u7576 ref \u88ab\u9644\u4e0a\u4e4b\u5f8c\uff0c<code class=\"language-javascript\">ref.current</code> \u6703\u6307\u5411 <code class=\"language-javascript\">&lt;button&gt;</code> DOM \u7bc0\u9ede\u3002</li>\n</ol>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u7b2c\u4e8c\u500b <code class=\"language-javascript\">ref</code> \u8b8a\u6578\u53ea\u6703\u5728\u4f60\u7528 <code class=\"language-javascript\">React.forwardRef</code> \u547c\u53eb\u5b9a\u7fa9\u4e00\u500b component \u7684\u6642\u5019\u5b58\u5728\u3002\u4e00\u822c function \u6216 class component \u4e0d\u6703\u7372\u5f97 <code class=\"language-javascript\">ref</code> \u8b8a\u6578\uff0c\u4e14\u5728 props \u88e1 ref \u4e5f\u4e0d\u5b58\u5728\u3002\u3002</p>\n<p>\u50b3\u9001 ref \u4e0d\u4fb7\u9650\u65bc DOM \u5143\u4ef6\u3002\u4f60\u53ef\u4ee5\u4e5f\u5c07 ref \u50b3\u905e\u5230 class component\u3002</p>\n</div>\n<h2 id=\"note-for-component-library-maintainers\"><a class=\"anchor\" href=\"/react/forwarding-refs#note-for-component-library-maintainers\"></a>\u5c0d\u65bc component \u51fd\u5f0f\u5eab\u7dad\u8b77\u8005\u7684\u63d0\u9192 </h2>\n<p><strong>\u7576\u4f60\u5728\u51fd\u5f0f\u5eab\u958b\u59cb\u4f7f\u7528 <code class=\"language-javascript\">forwardRef</code> \u6642\uff0c\u4f60\u61c9\u8a72\u8981\u628a\u5b83\u7576\u4f5c\u91cd\u5927\u8b8a\u5316\uff0c\u7136\u5f8c\u70ba\u4f60\u7684\u5143\u4ef6\u5eab\u767c\u4f48\u65b0\u7684\u4e3b\u8981\u7248\u865f\u3002</strong> \u56e0\u70ba\u4f60\u7684\u51fd\u5f0f\u5eab\u53ef\u80fd\u6703\u6709\u53ef\u898b\u7684\u4e0d\u540c\u884c\u70ba\uff08\u50cf\u662f ref \u88ab\u6307\u5b9a\u5728\u54ea\uff0c\u6216\u662f\u4ec0\u9ebc\u578b\u5225\u6703\u88ab\u8f38\u51fa\uff09\uff0c\u7136\u5f8c\u5b83\u53ef\u80fd\u6703\u7834\u58de\u90a3\u4e9b\u4f9d\u8cf4\u65bc\u820a\u6709\u884c\u70ba\u7684\u61c9\u7528\u7a0b\u5f0f\u6216\u5176\u4ed6\u5957\u4ef6\u3002</p>\n<p>\u6709\u689d\u4ef6\u7684\u5728 ref \u5b58\u5728\u6642\u624d\u4f7f\u7528 <code class=\"language-javascript\">React.forwardRef</code> \u4e5f\u662f\u4e0d\u63a8\u85a6\u7684\u65b9\u5f0f\uff0c\u76f8\u540c\u7684\u539f\u56e0\uff1a\u5b83\u6539\u8b8a\u4e86\u4f60\u7684\u5957\u4ef6\u7684\u884c\u70ba\uff0c\u4e14\u7576\u4f60\u7684\u4f7f\u7528\u8005\u5347\u7d1a React \u4e4b\u5f8c\u53ef\u80fd\u6703\u7834\u58de\u4f7f\u7528\u8005\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<h2 id=\"forwarding-refs-in-higher-order-components\"><a class=\"anchor\" href=\"/react/forwarding-refs#forwarding-refs-in-higher-order-components\"></a>\u5728 Higher-Order Component \u5167\u50b3\u9001 ref </h2>\n<p>\u5728 <a href=\"/react/higher-order-components\">Higher-Order Component</a>\uff08\u4e5f\u53eb\u505a HOC\uff09\u88e1\uff0c\u9019\u6a23\u7684\u6280\u5de7\u6703\u7279\u5225\u6709\u7528\u3002\u8b93\u6211\u5011\u7528\u4e00\u500b\u6703\u628a component \u7684 prop \u8a18\u9304\u5230 console \u7684 HOC \u70ba\u4f8b\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">class</span> <span class=\"token class-name\">LogProps</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'old props:'</span><span class=\"token punctuation\">,</span> prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'new props:'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WrappedComponent</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> LogProps<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>\u9019\u500b\u300clogProps\u300dHOC \u628a\u6240\u6709\u7684 <code class=\"language-javascript\">prop</code> \u50b3\u905e\u5230\u4ed6\u6240\u5305\u88f9\u7684 component\uff0c\u6240\u4ee5\u88ab render \u51fa\u7684\u7d50\u679c\u6703\u662f\u4e00\u6a23\u7684\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u7528\u9019\u500b HOC \u4f86\u8a18\u9304\u6240\u6709\u7d93\u904e\u300cfancy button\u300d\u5143\u4ef6\u7684 prop\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">FancyButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Rather than exporting FancyButton, we export LogProps.</span>\n<span class=\"token comment\">// It will render a FancyButton though.</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span>FancyButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n</div></p>\n<p>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u6709\u500b\u8b66\u544a\uff1aref \u4e0d\u6703\u88ab\u50b3\u905e\u904e\u53bb\u3002\u56e0\u70ba <code class=\"language-javascript\">ref</code> \u4e0d\u662f\u500b prop\u3002\u5c31\u50cf <code class=\"language-javascript\">key</code> \u4e00\u6a23\uff0cReact \u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u8655\u7406\u5b83\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728 HOC \u52a0\u4e0a\u4e00\u500b ref\uff0cref \u6703\u88ab\u6307\u5b9a\u5230\u6700\u5916\u5c64\u7684 component\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u5305\u88f9\u5b83\u7684\u90a3\u500b component\u3002</p>\n<p>\u9019\u4ee3\u8868\u5c0d\u65bc <code class=\"language-javascript\">FancyButton</code> component \u6240\u7528\u7684 ref \u6703\u76f4\u63a5\u88ab\u9644\u5230 <code class=\"language-javascript\">LogProps</code> component\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> FancyButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./FancyButton'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token comment\">// The FancyButton component we imported is the LogProps HOC.</span>\n<span class=\"token comment\">// Even though the rendered output will be the same,</span>\n<span class=\"token comment\">// Our ref will point to LogProps instead of the inner FancyButton component!</span>\n<span class=\"token comment\">// This means we can't call e.g. ref.current.focus()</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyButton</span></span>\n  <span class=\"token attr-name\">label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Click Me<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">handleClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p>\u5e78\u904b\u7684\u662f\uff0c\u6211\u5011\u53ef\u4ee5\u523b\u610f\u5229\u7528 <code class=\"language-javascript\">React.forwardRef</code> API \u628a ref \u50b3\u9001\u5230\u88e1\u9762\u7684 <code class=\"language-javascript\">FancyButton</code> component\u3002<code class=\"language-javascript\">React.forwardRef</code> \u63a5\u53d7\u4e00\u500b\u7528\u5230 <code class=\"language-javascript\">props</code> \u548c <code class=\"language-javascript\">ref</code> \u53c3\u6578\u7684 render \u7684 function \u4e26\u56de\u50b3\u4e00\u500b React \u7bc0\u9ede\u3002\u4f8b\u5982\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">LogProps</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'old props:'</span><span class=\"token punctuation\">,</span> prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'new props:'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>forwardedRef<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span></span>\n      <span class=\"token comment\">// Assign the custom prop \"forwardedRef\" as a ref</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Component</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>forwardedRef<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Note the second param \"ref\" provided by React.forwardRef.</span>\n  <span class=\"token comment\">// We can pass it along to LogProps as a regular prop, e.g. \"forwardedRef\"</span>\n  <span class=\"token comment\">// And it can then be attached to the Component.</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogProps</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">forwardedRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<h2 id=\"displaying-a-custom-name-in-devtools\"><a class=\"anchor\" href=\"/react/forwarding-refs#displaying-a-custom-name-in-devtools\"></a>\u5728 DevTool \u88e1\u986f\u793a\u5ba2\u88fd\u5316\u7684\u540d\u7a31 </h2>\n<p><code class=\"language-javascript\">React.forwardRef</code> \u63a5\u53d7\u4e00\u500b render function\u3002React DevTool \u4f7f\u7528\u9019\u500b function \u4f86\u6c7a\u5b9a\u9019\u500b\u50b3\u9001 ref \u7684 component \u8a72\u986f\u793a\u4ec0\u9ebc\u3002</p>\n<p>\u4f8b\u5982\uff0c\u5728 DevTool \u88e1\uff0c\u9019\u500b\u50b3\u9001\u7684 component \u6703\u986f\u793a\u70ba \u300c<em>ForwardRef</em>\u300d\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> WrappedComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogProps</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">forwardedRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p>\u5982\u679c\u4f60\u5c0d render function \u53d6\u540d\uff0cDevTool \u6703\u5305\u542b\u5b83\u7684\u540d\u5b57\uff08\u4f8b\u5982\uff1a\u300c<em>ForwardRef(myFunction)</em>\u300d\uff09\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> WrappedComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">myFunction</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogProps</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">forwardedRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u8a2d\u5b9a function \u7684 <code class=\"language-javascript\">displayName</code> \u4f86\u5305\u88f9\u4f60\u7684 component\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">LogProps</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LogProps</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">forwardedRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Give this component a more helpful display name in DevTools.</span>\n  <span class=\"token comment\">// e.g. \"ForwardRef(logProps(MyComponent))\"</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> Component<span class=\"token punctuation\">.</span>displayName <span class=\"token operator\">||</span> Component<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  forwardRef<span class=\"token punctuation\">.</span>displayName <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">logProps(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span>forwardRef<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/forwarding-refs.md\">Edit this page</a></p></div></article>", "path": "/react/forwarding-refs", "nav": ["/react/error-boundaries", "/react/fragments"]}, {"key": "Fragment", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React \u5176\u4e2d\u4e00\u7a2e\u5e38\u898b\u7684\u4f7f\u7528\u60c5\u6cc1\u662f\u5728\u4e00\u500b component \u4e2d\u56de\u50b3\u591a\u500b element\uff0cfragment \u8b93\u4f60\u80fd\u5920\u5728\u4e0d\u7528\u589e\u52a0\u984d\u5916 DOM \u7bc0\u9ede\u7684\u60c5\u6cc1\u4e0b\uff0c\u91cd\u65b0\u7d44\u5408 child component\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ChildA</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ChildB</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ChildC</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9084\u6709\u4e00\u7a2e<a href=\"/react/fragments#short-syntax\">\u7c21\u5beb\u8a9e\u6cd5</a>\u53ef\u4ee5\u7528\u4f86\u5ba3\u544a fragment\u3002</p>\n<!-- There is also a new [short syntax](#short-syntax) for declaring them. -->\n<h2 id=\"motivation\"><a class=\"anchor\" href=\"/react/fragments#motivation\"></a>\u52d5\u6a5f </h2>\n<p>\u5e38\u898b\u7684\u60c5\u6cc1\u662f\u5728 component \u88e1\u56de\u50b3\u4e00\u9023\u4e32\u7684 child element\uff0c\u770b\u770b\u9019\u500b React \u7684\u7a0b\u5f0f\u78bc\u7247\u6bb5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Table</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Columns</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u70ba\u4e86\u4f7f render \u51fa\u4f86\u7684 HTML \u662f\u6709\u6548\u7684\uff0c<code class=\"language-javascript\">&lt;Columns /&gt;</code> \u9700\u8981\u56de\u50b3\u591a\u500b <code class=\"language-javascript\">&lt;td&gt;</code> element\u3002\u5982\u679c\u5c07 parent div \u5143\u7d20\u653e\u5728 <code class=\"language-javascript\">&lt;Columns /&gt;</code> \u4e2d\u7684 <code class=\"language-javascript\">render()</code> \u5340\u584a\uff0c\u5c07\u6703\u4f7f\u751f\u6210\u7684 HTML \u7121\u6548\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Columns</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728 <code class=\"language-javascript\">&lt;Table /&gt;</code> \u5167\u7684\u8f38\u51fa\u5982\u4e0b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u9019\u500b\u554f\u984c\u4ea4\u7d66 fragment \u89e3\u6c7a\u3002</p>\n<h2 id=\"usage\"><a class=\"anchor\" href=\"/react/fragments#usage\"></a>\u4f7f\u7528\u65b9\u5f0f </h2>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Columns</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6703\u8b93 <code class=\"language-javascript\">&lt;Table /&gt;</code> \u5f97\u5230\u4e00\u500b\u6b63\u78ba\u7684\u8f38\u51fa\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<h3 id=\"short-syntax\"><a class=\"anchor\" href=\"/react/fragments#short-syntax\"></a>\u7c21\u5beb\u8a9e\u6cd5 </h3>\n<p>\u4f60\u53ef\u4ee5\u7528\u65b0\u7684\u7c21\u5beb\u8a9e\u6cd5\u4f86\u5ba3\u544a fragment\uff0c\u5b83\u770b\u8d77\u4f86\u5c31\u50cf\u7a7a\u6a19\u7c64\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Columns</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u50cf\u4f7f\u7528\u5176\u4ed6\u5143\u7d20\u4e00\u6a23\u4f7f\u7528 <code class=\"language-javascript\">&lt;&gt;&lt;/&gt;</code>\uff0c\u4f46\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5b83\u4e26\u4e0d\u652f\u63f4 key \u548c attribute\u3002</p>\n<h3 id=\"keyed-fragments\"><a class=\"anchor\" href=\"/react/fragments#keyed-fragments\"></a>Keyed Fragments </h3>\n<p>\u900f\u904e\u660e\u78ba\u5ba3\u544a <code class=\"language-javascript\">&lt;React.Fragment&gt;</code> \u7684 fragment \u53ef\u80fd\u6703\u9047\u5230\u5e36\u6709 key \u7684\u60c5\u6cc1\u3002\u4e00\u500b\u4f7f\u7528\u6848\u4f8b\u662f\u5c07\u5b83 mapping \u5230 fragment array\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u50cf\u4e0b\u65b9\u7a0b\u5f0f\u78bc\u4e00\u6a23\u5efa\u7acb\u4e00\u500b\u6558\u8ff0\u5217\u8868\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Glossary</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dl</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token comment\">// \u5982\u679c\u7f3a\u5c11 key \uff0c React \u6703\u767c\u51fa\u4e00\u500b\u7f3a\u5c11 key \u7684\u8b66\u544a</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.Fragment</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>term<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dt</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dd</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dl</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u76ee\u524d <code class=\"language-javascript\">key</code> \u662f\u552f\u4e00\u53ef\u4ee5\u50b3\u905e\u7d66 <code class=\"language-javascript\">Fragment</code> \u7684 attribute\u3002\u4e4b\u5f8c\u6211\u5011\u53ef\u80fd\u6703\u652f\u63f4\u66f4\u591a\u7684 attribute\uff0c\u50cf\u662f event handler\u3002</p>\n<h3 id=\"live-demo\"><a class=\"anchor\" href=\"/react/fragments#live-demo\"></a>Live Demo </h3>\n<p>\u4f60\u53ef\u4ee5\u900f\u904e <a class=\"external-link\" href=\"https://codepen.io/reactjs/pen/VrEbjE?editors=1000\">CodePen</a> \u5617\u8a66\u65b0\u7684 JSX fragment \u8a9e\u6cd5\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/fragments.md\">Edit this page</a></p></div></article>", "path": "/react/fragments", "nav": ["/react/forwarding-refs", "/react/higher-order-components"]}, {"key": "Higher-Order Component", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>A higher-order component (HOC) is an advanced technique in React for reusing component logic. HOCs are not part of the React API, per se. They are a pattern that emerges from React\u2019s compositional nature.</p>\n<p>Concretely, <strong>a higher-order component is a function that takes a component and returns a new component.</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">higherOrderComponent</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Whereas a component transforms props into UI, a higher-order component transforms a component into another component.</p>\n<p>HOCs are common in third-party React libraries, such as Redux\u2019s <a class=\"external-link\" href=\"https://github.com/reduxjs/react-redux/blob/master/docs/api/connect.md#connect\"><code class=\"language-javascript\">connect</code></a> and Relay\u2019s <a class=\"external-link\" href=\"https://relay.dev/docs/v10.1.3/fragment-container/#createfragmentcontainer\"><code class=\"language-javascript\">createFragmentContainer</code></a>.</p>\n<p>In this document, we\u2019ll discuss why higher-order components are useful, and how to write your own.</p>\n<h2 id=\"use-hocs-for-cross-cutting-concerns\"><a class=\"anchor\" href=\"/react/higher-order-components#use-hocs-for-cross-cutting-concerns\"></a>Use HOCs For Cross-Cutting Concerns </h2>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>We previously recommended mixins as a way to handle cross-cutting concerns. We\u2019ve since realized that mixins create more trouble than they are worth. <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/07/13/mixins-considered-harmful.html\">Read more</a> about why we\u2019ve moved away from mixins and how you can transition your existing components.</p>\n</div>\n<p>Components are the primary unit of code reuse in React. However, you\u2019ll find that some patterns aren\u2019t a straightforward fit for traditional components.</p>\n<p>For example, say you have a <code class=\"language-javascript\">CommentList</code> component that subscribes to an external data source to render a list of comments:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CommentList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// \"DataSource\" is some global data source</span>\n      <span class=\"token literal-property property\">comments</span><span class=\"token operator\">:</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getComments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Subscribe to changes</span>\n    DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Clean up listener</span>\n    DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">removeChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Update component state whenever the data source changes</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">comments</span><span class=\"token operator\">:</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getComments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>comments<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">comment</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Comment</span></span> <span class=\"token attr-name\">comment</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>comment<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>comment<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Later, you write a component for subscribing to a single blog post, which follows a similar pattern:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">BlogPost</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">blogPost</span><span class=\"token operator\">:</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getBlogPost</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">removeChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">blogPost</span><span class=\"token operator\">:</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getBlogPost</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TextBlock</span></span> <span class=\"token attr-name\">text</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>blogPost<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-javascript\">CommentList</code> and <code class=\"language-javascript\">BlogPost</code> aren\u2019t identical \u2014 they call different methods on <code class=\"language-javascript\">DataSource</code>, and they render different output. But much of their implementation is the same:</p>\n<ul>\n<li>On mount, add a change listener to <code class=\"language-javascript\">DataSource</code>.</li>\n<li>Inside the listener, call <code class=\"language-javascript\">setState</code> whenever the data source changes.</li>\n<li>On unmount, remove the change listener.</li>\n</ul>\n<p>You can imagine that in a large app, this same pattern of subscribing to <code class=\"language-javascript\">DataSource</code> and calling <code class=\"language-javascript\">setState</code> will occur over and over again. We want an abstraction that allows us to define this logic in a single place and share it across many components. This is where higher-order components excel.</p>\n<p>We can write a function that creates components, like <code class=\"language-javascript\">CommentList</code> and <code class=\"language-javascript\">BlogPost</code>, that subscribe to <code class=\"language-javascript\">DataSource</code>. The function will accept as one of its arguments a child component that receives the subscribed data as a prop. Let\u2019s call the function <code class=\"language-javascript\">withSubscription</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CommentListWithSubscription <span class=\"token operator\">=</span> <span class=\"token function\">withSubscription</span><span class=\"token punctuation\">(</span>\n  CommentList<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">DataSource</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getComments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> BlogPostWithSubscription <span class=\"token operator\">=</span> <span class=\"token function\">withSubscription</span><span class=\"token punctuation\">(</span>\n  BlogPost<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">DataSource<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getBlogPost</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The first parameter is the wrapped component. The second parameter retrieves the data we\u2019re interested in, given a <code class=\"language-javascript\">DataSource</code> and the current props.</p>\n<p>When <code class=\"language-javascript\">CommentListWithSubscription</code> and <code class=\"language-javascript\">BlogPostWithSubscription</code> are rendered, <code class=\"language-javascript\">CommentList</code> and <code class=\"language-javascript\">BlogPost</code> will be passed a <code class=\"language-javascript\">data</code> prop with the most current data retrieved from <code class=\"language-javascript\">DataSource</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// This function takes a component...</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">withSubscription</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent<span class=\"token punctuation\">,</span> selectData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...and returns another component...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> React<span class=\"token punctuation\">.</span>Component <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token function\">selectData</span><span class=\"token punctuation\">(</span>DataSource<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ... that takes care of the subscription...</span>\n      DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      DataSource<span class=\"token punctuation\">.</span><span class=\"token function\">removeChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token function\">selectData</span><span class=\"token punctuation\">(</span>DataSource<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ... and renders the wrapped component with the fresh data!</span>\n      <span class=\"token comment\">// Notice that we pass through any additional props</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WrappedComponent</span></span> <span class=\"token attr-name\">data</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Note that a HOC doesn\u2019t modify the input component, nor does it use inheritance to copy its behavior. Rather, a HOC <em>composes</em> the original component by <em>wrapping</em> it in a container component. A HOC is a pure function with zero side-effects.</p>\n<p>And that\u2019s it! The wrapped component receives all the props of the container, along with a new prop, <code class=\"language-javascript\">data</code>, which it uses to render its output. The HOC isn\u2019t concerned with how or why the data is used, and the wrapped component isn\u2019t concerned with where the data came from.</p>\n<p>Because <code class=\"language-javascript\">withSubscription</code> is a normal function, you can add as many or as few arguments as you like. For example, you may want to make the name of the <code class=\"language-javascript\">data</code> prop configurable, to further isolate the HOC from the wrapped component. Or you could accept an argument that configures <code class=\"language-javascript\">shouldComponentUpdate</code>, or one that configures the data source. These are all possible because the HOC has full control over how the component is defined.</p>\n<p>Like components, the contract between <code class=\"language-javascript\">withSubscription</code> and the wrapped component is entirely props-based. This makes it easy to swap one HOC for a different one, as long as they provide the same props to the wrapped component. This may be useful if you change data-fetching libraries, for example.</p>\n<h2 id=\"dont-mutate-the-original-component-use-composition\"><a class=\"anchor\" href=\"/react/higher-order-components#dont-mutate-the-original-component-use-composition\"></a>Don\u2019t Mutate the Original Component. Use Composition. </h2>\n<p>Resist the temptation to modify a component\u2019s prototype (or otherwise mutate it) inside a HOC.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">InputComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">InputComponent</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">componentDidUpdate</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Current props: '</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Previous props: '</span><span class=\"token punctuation\">,</span> prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// The fact that we're returning the original input is a hint that it has</span>\n  <span class=\"token comment\">// been mutated.</span>\n  <span class=\"token keyword\">return</span> InputComponent<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// EnhancedComponent will log whenever props are received</span>\n<span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span>InputComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>There are a few problems with this. One is that the input component cannot be reused separately from the enhanced component. More crucially, if you apply another HOC to <code class=\"language-javascript\">EnhancedComponent</code> that <em>also</em> mutates <code class=\"language-javascript\">componentDidUpdate</code>, the first HOC\u2019s functionality will be overridden! This HOC also won\u2019t work with function components, which do not have lifecycle methods.</p>\n<p>Mutating HOCs are a leaky abstraction\u2014the consumer must know how they are implemented in order to avoid conflicts with other HOCs.</p>\n<p>Instead of mutation, HOCs should use composition, by wrapping the input component in a container component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">logProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> React<span class=\"token punctuation\">.</span>Component <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Current props: '</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Previous props: '</span><span class=\"token punctuation\">,</span> prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Wraps the input component in a container, without mutating it. Good!</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WrappedComponent</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This HOC has the same functionality as the mutating version while avoiding the potential for clashes. It works equally well with class and function components. And because it\u2019s a pure function, it\u2019s composable with other HOCs, or even with itself.</p>\n<p>You may have noticed similarities between HOCs and a pattern called <strong>container components</strong>. Container components are part of a strategy of separating responsibility between high-level and low-level concerns. Containers manage things like subscriptions and state, and pass props to components that handle things like rendering UI. HOCs use containers as part of their implementation. You can think of HOCs as parameterized container component definitions.</p>\n<h2 id=\"convention-pass-unrelated-props-through-to-the-wrapped-component\"><a class=\"anchor\" href=\"/react/higher-order-components#convention-pass-unrelated-props-through-to-the-wrapped-component\"></a>Convention: Pass Unrelated Props Through to the Wrapped Component </h2>\n<p>HOCs add features to a component. They shouldn\u2019t drastically alter its contract. It\u2019s expected that the component returned from a HOC has a similar interface to the wrapped component.</p>\n<p>HOCs should pass through props that are unrelated to its specific concern. Most HOCs contain a render method that looks something like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Filter out extra props that are specific to this HOC and shouldn't be</span>\n  <span class=\"token comment\">// passed through</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> extraProp<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>passThroughProps <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Inject props into the wrapped component. These are usually state values or</span>\n  <span class=\"token comment\">// instance methods.</span>\n  <span class=\"token keyword\">const</span> injectedProp <span class=\"token operator\">=</span> someStateOrInstanceMethod<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Pass props to wrapped component</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WrappedComponent</span></span>\n      <span class=\"token attr-name\">injectedProp</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>injectedProp<span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>passThroughProps<span class=\"token punctuation\">}</span></span>\n    <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This convention helps ensure that HOCs are as flexible and reusable as possible.</p>\n<h2 id=\"convention-maximizing-composability\"><a class=\"anchor\" href=\"/react/higher-order-components#convention-maximizing-composability\"></a>Convention: Maximizing Composability </h2>\n<p>Not all HOCs look the same. Sometimes they accept only a single argument, the wrapped component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> NavbarWithRouter <span class=\"token operator\">=</span> <span class=\"token function\">withRouter</span><span class=\"token punctuation\">(</span>Navbar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Usually, HOCs accept additional arguments. In this example from Relay, a config object is used to specify a component\u2019s data dependencies:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CommentWithRelay <span class=\"token operator\">=</span> Relay<span class=\"token punctuation\">.</span><span class=\"token function\">createContainer</span><span class=\"token punctuation\">(</span>Comment<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The most common signature for HOCs looks like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// React Redux's `connect`</span>\n<span class=\"token keyword\">const</span> ConnectedComment <span class=\"token operator\">=</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>commentSelector<span class=\"token punctuation\">,</span> commentActions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>CommentList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><em>What?!</em> If you break it apart, it\u2019s easier to see what\u2019s going on.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// connect is a function that returns another function</span>\n<span class=\"token keyword\">const</span> enhance <span class=\"token operator\">=</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>commentListSelector<span class=\"token punctuation\">,</span> commentListActions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// The returned function is a HOC, which returns a component that is connected</span>\n<span class=\"token comment\">// to the Redux store</span>\n<span class=\"token keyword\">const</span> ConnectedComment <span class=\"token operator\">=</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span>CommentList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In other words, <code class=\"language-javascript\">connect</code> is a higher-order function that returns a higher-order component!</p>\n<p>This form may seem confusing or unnecessary, but it has a useful property. Single-argument HOCs like the one returned by the <code class=\"language-javascript\">connect</code> function have the signature <code class=\"language-javascript\">Component =&gt; Component</code>. Functions whose output type is the same as its input type are really easy to compose together.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Instead of doing this...</span>\n<span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">withRouter</span><span class=\"token punctuation\">(</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>commentSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ... you can use a function composition utility</span>\n<span class=\"token comment\">// compose(f, g, h) is the same as (...args) =&gt; f(g(h(...args)))</span>\n<span class=\"token keyword\">const</span> enhance <span class=\"token operator\">=</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">// These are both single-argument HOCs</span>\n  withRouter<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>commentSelector<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span></code></pre></div>\n<p>(This same property also allows <code class=\"language-javascript\">connect</code> and other enhancer-style HOCs to be used as decorators, an experimental JavaScript proposal.)</p>\n<p>The <code class=\"language-javascript\">compose</code> utility function is provided by many third-party libraries including lodash (as <a class=\"external-link\" href=\"https://lodash.com/docs/#flowRight\"><code class=\"language-javascript\">lodash.flowRight</code></a>), <a class=\"external-link\" href=\"https://redux.js.org/api/compose\">Redux</a>, and <a class=\"external-link\" href=\"https://ramdajs.com/docs/#compose\">Ramda</a>.</p>\n<h2 id=\"convention-wrap-the-display-name-for-easy-debugging\"><a class=\"anchor\" href=\"/react/higher-order-components#convention-wrap-the-display-name-for-easy-debugging\"></a>Convention: Wrap the Display Name for Easy Debugging </h2>\n<p>The container components created by HOCs show up in the <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-devtools\">React Developer Tools</a> like any other component. To ease debugging, choose a display name that communicates that it\u2019s the result of a HOC.</p>\n<p>The most common technique is to wrap the display name of the wrapped component. So if your higher-order component is named <code class=\"language-javascript\">withSubscription</code>, and the wrapped component\u2019s display name is <code class=\"language-javascript\">CommentList</code>, use the display name <code class=\"language-javascript\">WithSubscription(CommentList)</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withSubscription</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">WithSubscription</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">}</span>\n  WithSubscription<span class=\"token punctuation\">.</span>displayName <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">WithSubscription(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getDisplayName</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> WithSubscription<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getDisplayName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> WrappedComponent<span class=\"token punctuation\">.</span>displayName <span class=\"token operator\">||</span> WrappedComponent<span class=\"token punctuation\">.</span>name <span class=\"token operator\">||</span> <span class=\"token string\">'Component'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"caveats\"><a class=\"anchor\" href=\"/react/higher-order-components#caveats\"></a>Caveats </h2>\n<p>Higher-order components come with a few caveats that aren\u2019t immediately obvious if you\u2019re new to React.</p>\n<h3 id=\"dont-use-hocs-inside-the-render-method\"><a class=\"anchor\" href=\"/react/higher-order-components#dont-use-hocs-inside-the-render-method\"></a>Don\u2019t Use HOCs Inside the render Method </h3>\n<p>React\u2019s diffing algorithm (called <a href=\"/react/reconciliation\">Reconciliation</a>) uses component identity to determine whether it should update the existing subtree or throw it away and mount a new one. If the component returned from <code class=\"language-javascript\">render</code> is identical (<code class=\"language-javascript\">===</code>) to the component from the previous render, React recursively updates the subtree by diffing it with the new one. If they\u2019re not equal, the previous subtree is unmounted completely.</p>\n<p>Normally, you shouldn\u2019t need to think about this. But it matters for HOCs because it means you can\u2019t apply a HOC to a component within the render method of a component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// A new version of EnhancedComponent is created on every render</span>\n  <span class=\"token comment\">// EnhancedComponent1 !== EnhancedComponent2</span>\n  <span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span>MyComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// That causes the entire subtree to unmount/remount each time!</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">EnhancedComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The problem here isn\u2019t just about performance \u2014 remounting a component causes the state of that component and all of its children to be lost.</p>\n<p>Instead, apply HOCs outside the component definition so that the resulting component is created only once. Then, its identity will be consistent across renders. This is usually what you want, anyway.</p>\n<p>In those rare cases where you need to apply a HOC dynamically, you can also do it inside a component\u2019s lifecycle methods or its constructor.</p>\n<h3 id=\"static-methods-must-be-copied-over\"><a class=\"anchor\" href=\"/react/higher-order-components#static-methods-must-be-copied-over\"></a>Static Methods Must Be Copied Over </h3>\n<p>Sometimes it\u2019s useful to define a static method on a React component. For example, Relay containers expose a static method <code class=\"language-javascript\">getFragment</code> to facilitate the composition of GraphQL fragments.</p>\n<p>When you apply a HOC to a component, though, the original component is wrapped with a container component. That means the new component does not have any of the static methods of the original component.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Define a static method</span>\nWrappedComponent<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">staticMethod</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/*...*/</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Now apply a HOC</span>\n<span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// The enhanced component has no static method</span>\n<span class=\"token keyword\">typeof</span> EnhancedComponent<span class=\"token punctuation\">.</span>staticMethod <span class=\"token operator\">===</span> <span class=\"token string\">'undefined'</span> <span class=\"token comment\">// true</span></code></pre></div>\n<p>To solve this, you could copy the methods onto the container before returning it:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">Enhance</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/*...*/</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// Must know exactly which method(s) to copy :(</span>\n  Enhance<span class=\"token punctuation\">.</span>staticMethod <span class=\"token operator\">=</span> WrappedComponent<span class=\"token punctuation\">.</span>staticMethod<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Enhance<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>However, this requires you to know exactly which methods need to be copied. You can use <a class=\"external-link\" href=\"https://github.com/mridgway/hoist-non-react-statics\">hoist-non-react-statics</a> to automatically copy all non-React static methods:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> hoistNonReactStatic <span class=\"token keyword\">from</span> <span class=\"token string\">'hoist-non-react-statics'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">enhance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">Enhance</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/*...*/</span><span class=\"token punctuation\">}</span>\n  <span class=\"token function\">hoistNonReactStatic</span><span class=\"token punctuation\">(</span>Enhance<span class=\"token punctuation\">,</span> WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Enhance<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Another possible solution is to export the static method separately from the component itself.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Instead of...</span>\nMyComponent<span class=\"token punctuation\">.</span>someFunction <span class=\"token operator\">=</span> someFunction<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> MyComponent<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...export the method separately...</span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> someFunction <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...and in the consuming module, import both</span>\n<span class=\"token keyword\">import</span> MyComponent<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> someFunction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./MyComponent.js'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"refs-arent-passed-through\"><a class=\"anchor\" href=\"/react/higher-order-components#refs-arent-passed-through\"></a>Refs Aren\u2019t Passed Through </h3>\n<p>While the convention for higher-order components is to pass through all props to the wrapped component, this does not work for refs. That\u2019s because <code class=\"language-javascript\">ref</code> is not really a prop \u2014 like <code class=\"language-javascript\">key</code>, it\u2019s handled specially by React. If you add a ref to an element whose component is the result of a HOC, the ref refers to an instance of the outermost container component, not the wrapped component.</p>\n<p>The solution for this problem is to use the <code class=\"language-javascript\">React.forwardRef</code> API (introduced with React 16.3). <a href=\"/react/forwarding-refs\">Learn more about it in the forwarding refs section</a>.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/higher-order-components.md\">Edit this page</a></p></div></article>", "path": "/react/higher-order-components", "nav": ["/react/fragments", "/react/integrating-with-other-libraries"]}, {"key": "\u6574\u5408\u5176\u4ed6\u51fd\u5f0f\u5eab", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React can be used in any web application. It can be embedded in other applications and, with a little care, other applications can be embedded in React. This guide will examine some of the more common use cases, focusing on integration with <a class=\"external-link\" href=\"https://jquery.com/\">jQuery</a> and <a class=\"external-link\" href=\"https://backbonejs.org/\">Backbone</a>, but the same ideas can be applied to integrating components with any existing code.</p>\n<h2 id=\"integrating-with-dom-manipulation-plugins\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#integrating-with-dom-manipulation-plugins\"></a>Integrating with DOM Manipulation Plugins </h2>\n<p>React is unaware of changes made to the DOM outside of React. It determines updates based on its own internal representation, and if the same DOM nodes are manipulated by another library, React gets confused and has no way to recover.</p>\n<p>This does not mean it is impossible or even necessarily difficult to combine React with other ways of affecting the DOM, you just have to be mindful of what each is doing.</p>\n<p>The easiest way to avoid conflicts is to prevent the React component from updating. You can do this by rendering elements that React has no reason to update, like an empty <code class=\"language-javascript\">&lt;div /&gt;</code>.</p>\n<h3 id=\"how-to-approach-the-problem\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#how-to-approach-the-problem\"></a>How to Approach the Problem </h3>\n<p>To demonstrate this, let\u2019s sketch out a wrapper for a generic jQuery plugin.</p>\n<p>We will attach a <a href=\"/react/refs-and-the-dom\">ref</a> to the root DOM element. Inside <code class=\"language-javascript\">componentDidMount</code>, we will get a reference to it so we can pass it to the jQuery plugin.</p>\n<p>To prevent React from touching the DOM after mounting, we will return an empty <code class=\"language-javascript\">&lt;div /&gt;</code> from the <code class=\"language-javascript\">render()</code> method. The <code class=\"language-javascript\">&lt;div /&gt;</code> element has no properties or children, so React has no reason to update it, leaving the jQuery plugin free to manage that part of the DOM:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SomePlugin</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">somePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">somePlugin</span><span class=\"token punctuation\">(</span><span class=\"token string\">'destroy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Note that we defined both <code class=\"language-javascript\">componentDidMount</code> and <code class=\"language-javascript\">componentWillUnmount</code> <a href=\"/react/react-component#the-component-lifecycle\">lifecycle methods</a>. Many jQuery plugins attach event listeners to the DOM so it\u2019s important to detach them in <code class=\"language-javascript\">componentWillUnmount</code>. If the plugin does not provide a method for cleanup, you will probably have to provide your own, remembering to remove any event listeners the plugin registered to prevent memory leaks.</p>\n<h3 id=\"integrating-with-jquery-chosen-plugin\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#integrating-with-jquery-chosen-plugin\"></a>Integrating with jQuery Chosen Plugin </h3>\n<p>For a more concrete example of these concepts, let\u2019s write a minimal wrapper for the plugin <a class=\"external-link\" href=\"https://harvesthq.github.io/chosen/\">Chosen</a>, which augments <code class=\"language-javascript\">&lt;select&gt;</code> inputs.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Just because it\u2019s possible, doesn\u2019t mean that it\u2019s the best approach for React apps. We encourage you to use React components when you can. React components are easier to reuse in React applications, and often provide more control over their behavior and appearance.</p>\n</div>\n<p>First, let\u2019s look at what Chosen does to the DOM.</p>\n<p>If you call it on a <code class=\"language-javascript\">&lt;select&gt;</code> DOM node, it reads the attributes off of the original DOM node, hides it with an inline style, and then appends a separate DOM node with its own visual representation right after the <code class=\"language-javascript\">&lt;select&gt;</code>. Then it fires jQuery events to notify us about the changes.</p>\n<p>Let\u2019s say that this is the API we\u2019re striving for with our <code class=\"language-javascript\">&lt;Chosen&gt;</code> wrapper React component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Chosen</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">value</span> <span class=\"token operator\">=&gt;</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">vanilla</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">chocolate</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">strawberry</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Chosen</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We will implement it as an <a href=\"/react/uncontrolled-components\">uncontrolled component</a> for simplicity.</p>\n<p>First, we will create an empty component with a <code class=\"language-javascript\">render()</code> method where we return <code class=\"language-javascript\">&lt;select&gt;</code> wrapped in a <code class=\"language-javascript\">&lt;div&gt;</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Chosen</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Chosen-select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Notice how we wrapped <code class=\"language-javascript\">&lt;select&gt;</code> in an extra <code class=\"language-javascript\">&lt;div&gt;</code>. This is necessary because Chosen will append another DOM element right after the <code class=\"language-javascript\">&lt;select&gt;</code> node we passed to it. However, as far as React is concerned, <code class=\"language-javascript\">&lt;div&gt;</code> always only has a single child. This is how we ensure that React updates won\u2019t conflict with the extra DOM node appended by Chosen. It is important that if you modify the DOM outside of React flow, you must ensure React doesn\u2019t have a reason to touch those DOM nodes.</p>\n<p>Next, we will implement the lifecycle methods. We need to initialize Chosen with the ref to the <code class=\"language-javascript\">&lt;select&gt;</code> node in <code class=\"language-javascript\">componentDidMount</code>, and tear it down in <code class=\"language-javascript\">componentWillUnmount</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'destroy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/qmqeQx?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<p>Note that React assigns no special meaning to the <code class=\"language-javascript\">this.el</code> field. It only works because we have previously assigned this field from a <code class=\"language-javascript\">ref</code> in the <code class=\"language-javascript\">render()</code> method:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Chosen-select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>This is enough to get our component to render, but we also want to be notified about the value changes. To do this, we will subscribe to the jQuery <code class=\"language-javascript\">change</code> event on the <code class=\"language-javascript\">&lt;select&gt;</code> managed by Chosen.</p>\n<p>We won\u2019t pass <code class=\"language-javascript\">this.props.onChange</code> directly to Chosen because component\u2019s props might change over time, and that includes event handlers. Instead, we will declare a <code class=\"language-javascript\">handleChange()</code> method that calls <code class=\"language-javascript\">this.props.onChange</code>, and subscribe it to the jQuery <code class=\"language-javascript\">change</code> event:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'destroy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/bWgbeE?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<p>Finally, there is one more thing left to do. In React, props can change over time. For example, the <code class=\"language-javascript\">&lt;Chosen&gt;</code> component can get different children if parent component\u2019s state changes. This means that at integration points it is important that we manually update the DOM in response to prop updates, since we no longer let React manage the DOM for us.</p>\n<p>Chosen\u2019s documentation suggests that we can use jQuery <code class=\"language-javascript\">trigger()</code> API to notify it about changes to the original DOM element. We will let React take care of updating <code class=\"language-javascript\">this.props.children</code> inside <code class=\"language-javascript\">&lt;select&gt;</code>, but we will also add a <code class=\"language-javascript\">componentDidUpdate()</code> lifecycle method that notifies Chosen about changes in the children list:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>children <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"chosen:updated\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This way, Chosen will know to update its DOM element when the <code class=\"language-javascript\">&lt;select&gt;</code> children managed by React change.</p>\n<p>The complete implementation of the <code class=\"language-javascript\">Chosen</code> component looks like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Chosen</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>children <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"chosen:updated\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">chosen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'destroy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Chosen-select<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/xdgKOz?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<h2 id=\"integrating-with-other-view-libraries\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#integrating-with-other-view-libraries\"></a>Integrating with Other View Libraries </h2>\n<p>React can be embedded into other applications thanks to the flexibility of <a href=\"/react/react-dom-client#createRoot\"><code class=\"language-javascript\">createRoot()</code></a>.</p>\n<p>Although React is commonly used at startup to load a single root React component into the DOM, <code class=\"language-javascript\">createRoot()</code> can also be called multiple times for independent parts of the UI which can be as small as a button, or as large as an app.</p>\n<p>In fact, this is exactly how React is used at Facebook. This lets us write applications in React piece by piece, and combine them with our existing server-generated templates and other client-side code.</p>\n<h3 id=\"replacing-string-based-rendering-with-react\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#replacing-string-based-rendering-with-react\"></a>Replacing String-Based Rendering with React </h3>\n<p>A common pattern in older web applications is to describe chunks of the DOM as a string and insert it into the DOM like so: <code class=\"language-javascript\">$el.html(htmlString)</code>. These points in a codebase are perfect for introducing React. Just rewrite the string based rendering as a React component.</p>\n<p>So the following jQuery implementation\u2026</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;button id=\"btn\"&gt;Say Hello&lt;/button&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#btn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u2026could be rewritten using a React component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Say Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#btn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>From here you could start moving more logic into the component and begin adopting more common React practices. For example, in components it is best not to rely on IDs because the same component can be rendered multiple times. Instead, we will use the <a href=\"/react/handling-events\">React event system</a> and register the click handler directly on the React <code class=\"language-javascript\">&lt;button&gt;</code> element:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Say Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HelloButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/RVKbvW?editors=1010\"><strong>Try it on CodePen</strong></a></p>\n<p>You can have as many such isolated components as you like, and use <code class=\"language-javascript\">ReactDOM.createRoot()</code> to render them to different DOM containers. Gradually, as you convert more of your app to React, you will be able to combine them into larger components, and move some of the <code class=\"language-javascript\">ReactDOM.createRoot()</code> calls up the hierarchy.</p>\n<h3 id=\"embedding-react-in-a-backbone-view\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#embedding-react-in-a-backbone-view\"></a>Embedding React in a Backbone View </h3>\n<p><a class=\"external-link\" href=\"https://backbonejs.org/\">Backbone</a> views typically use HTML strings, or string-producing template functions, to create the content for their DOM elements. This process, too, can be replaced with rendering a React component.</p>\n<p>Below, we will create a Backbone view called <code class=\"language-javascript\">ParagraphView</code>. It will override Backbone\u2019s <code class=\"language-javascript\">render()</code> function to render a React <code class=\"language-javascript\">&lt;Paragraph&gt;</code> component into the DOM element provided by Backbone (<code class=\"language-javascript\">this.el</code>). Here, too, we are using <a href=\"/react/react-dom-client#createroot\"><code class=\"language-javascript\">ReactDOM.createRoot()</code></a>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Paragraph</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> ParagraphView <span class=\"token operator\">=</span> Backbone<span class=\"token punctuation\">.</span>View<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>reactRoot <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>reactRoot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Paragraph</span></span> <span class=\"token attr-name\">text</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>reactRoot<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    Backbone<span class=\"token punctuation\">.</span><span class=\"token class-name\">View</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/gWgOYL?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<p>It is important that we also call <code class=\"language-javascript\">root.unmount()</code> in the <code class=\"language-javascript\">remove</code> method so that React unregisters event handlers and other resources associated with the component tree when it is detached.</p>\n<p>When a component is removed <em>from within</em> a React tree, the cleanup is performed automatically, but because we are removing the entire tree by hand, we must call this method.</p>\n<h2 id=\"integrating-with-model-layers\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#integrating-with-model-layers\"></a>Integrating with Model Layers </h2>\n<p>While it is generally recommended to use unidirectional data flow such as <a href=\"/react/lifting-state-up\">React state</a>, <a class=\"external-link\" href=\"https://facebook.github.io/flux/\">Flux</a>, or <a class=\"external-link\" href=\"https://redux.js.org/\">Redux</a>, React components can use a model layer from other frameworks and libraries.</p>\n<h3 id=\"using-backbone-models-in-react-components\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#using-backbone-models-in-react-components\"></a>Using Backbone Models in React Components </h3>\n<p>The simplest way to consume <a class=\"external-link\" href=\"https://backbonejs.org/\">Backbone</a> models and collections from a React component is to listen to the various change events and manually force an update.</p>\n<p>Components responsible for rendering models would listen to <code class=\"language-javascript\">'change'</code> events, while components responsible for rendering collections would listen for <code class=\"language-javascript\">'add'</code> and <code class=\"language-javascript\">'remove'</code> events. In both cases, call <a href=\"/react/react-component#forceupdate\"><code class=\"language-javascript\">this.forceUpdate()</code></a> to rerender the component with the new data.</p>\n<p>In the example below, the <code class=\"language-javascript\">List</code> component renders a Backbone collection, using the <code class=\"language-javascript\">Item</code> component to render individual items.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Item</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">List</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'add'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'remove'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'add'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'remove'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">model</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Item</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>model<span class=\"token punctuation\">.</span>cid<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">model</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>model<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/GmrREm?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<h3 id=\"extracting-data-from-backbone-models\"><a class=\"anchor\" href=\"/react/integrating-with-other-libraries#extracting-data-from-backbone-models\"></a>Extracting Data from Backbone Models </h3>\n<p>The approach above requires your React components to be aware of the Backbone models and collections. If you later plan to migrate to another data management solution, you might want to concentrate the knowledge about Backbone in as few parts of the code as possible.</p>\n<p>One solution to this is to extract the model\u2019s attributes as plain data whenever it changes, and keep this logic in a single place. The following is <a href=\"/react/higher-order-components\">a higher-order component</a> that extracts all attributes of a Backbone model into state, passing the data to the wrapped component.</p>\n<p>This way, only the higher-order component needs to know about Backbone model internals, and most components in the app can stay agnostic of Backbone.</p>\n<p>In the example below, we will make a copy of the model\u2019s attributes to form the initial state. We subscribe to the <code class=\"language-javascript\">change</code> event (and unsubscribe on unmounting), and when it happens, we update the state with the model\u2019s current attributes. Finally, we make sure that if the <code class=\"language-javascript\">model</code> prop itself changes, we don\u2019t forget to unsubscribe from the old model, and subscribe to the new one.</p>\n<p>Note that this example is not meant to be exhaustive with regards to working with Backbone, but it should give you an idea for how to approach this in a generic way:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">connectToBackboneModel</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BackboneComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentWillReceiveProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">.</span>model <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        nextProps<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">model</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">changedAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> propsExceptModel <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">delete</span> propsExceptModel<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WrappedComponent</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>propsExceptModel<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To demonstrate how to use it, we will connect a <code class=\"language-javascript\">NameInput</code> React component to a Backbone model, and update its <code class=\"language-javascript\">firstName</code> attribute every time the input changes:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NameInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>firstName<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      My name is </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>firstName<span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> BackboneNameInput <span class=\"token operator\">=</span> <span class=\"token function\">connectToBackboneModel</span><span class=\"token punctuation\">(</span>NameInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BackboneNameInput</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">model</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">}</span></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">handleChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleChange<span class=\"token punctuation\">}</span></span></span>    <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> model <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Backbone<span class=\"token punctuation\">.</span>Model</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Frodo'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Example</span></span> <span class=\"token attr-name\">model</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>model<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/PmWwwa?editors=0010\"><strong>Try it on CodePen</strong></a></p>\n<p>This technique is not limited to Backbone. You can use React with any model library by subscribing to its changes in the lifecycle methods and, optionally, copying the data into the local React state.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/integrating-with-other-libraries.md\">Edit this page</a></p></div></article>", "path": "/react/integrating-with-other-libraries", "nav": ["/react/higher-order-components", "/react/jsx-in-depth"]}, {"key": "\u6df1\u5165 JSX", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u57fa\u672c\u4e0a\uff0cJSX \u55ae\u7d14\u53ea\u662f <code class=\"language-javascript\">React.createElement(component, props, ...children)</code> function \u7684\u4e00\u500b\u8a9e\u6cd5\u7cd6\u3002\u4ee5\u4e0b JSX \u7a0b\u5f0f\u78bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyButton</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">shadowSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  Click Me\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyButton</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u6703\u7de8\u8b6f\u6210\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n  MyButton<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">shadowSize</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Click Me'</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c\u6c92\u6709 children \u7684\u8a71\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9589\u5408\u7684\u6a19\u7c64\u5f62\u5f0f\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sidebar<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u6703\u7de8\u8b6f\u6210\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">className</span><span class=\"token operator\">:</span> <span class=\"token string\">'sidebar'</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u60f3\u6e2c\u8a66\u67d0\u4e9b\u7279\u5b9a\u7684 JSX \u6703\u8f49\u63db\u6210\u4ec0\u9ebc\u6a23\u7684 JavaScript\uff0c\u4f60\u53ef\u4ee5\u5728<a class=\"external-link\" href=\"https://babeljs.io/repl/#?presets=react&amp;code_lz=GYVwdgxgLglg9mABACwKYBt1wBQEpEDeAUIogE6pQhlIA8AJjAG4B8AEhlogO5xnr0AhLQD0jVgG4iAXyJA\">\u7dda\u4e0a Babel \u7de8\u8b6f\u5668</a>\u9032\u884c\u6e2c\u8a66\u3002</p>\n<h2 id=\"specifying-the-react-element-type\"><a class=\"anchor\" href=\"/react/jsx-in-depth#specifying-the-react-element-type\"></a>\u6307\u5b9a React Element \u985e\u578b </h2>\n<p>JSX \u6a19\u7c64\u7684\u7b2c\u4e00\u500b\u90e8\u5206\u6c7a\u5b9a React element \u7684\u985e\u578b\u3002</p>\n<p>\u5927\u5beb\u5b57\u6bcd\u7684 JSX \u6a19\u7c64\u4ee3\u8868\u5b83\u5011\u662f React Component\u3002\u9019\u4e9b\u6a19\u7c64\u6703\u7de8\u8b6f\u6210\u6307\u5411\u547d\u540d\u8b8a\u6578\u7684 reference\uff0c\u6240\u4ee5\u7576\u4f60\u4f7f\u7528 JSX <code class=\"language-javascript\">&lt;Foo /&gt;</code> \u8868\u9054\u5f0f\u6642\uff0c<code class=\"language-javascript\">Foo</code> \u5c31\u5fc5\u9808\u5728\u4f5c\u7528\u57df\u5167\u3002</p>\n<h3 id=\"react-must-be-in-scope\"><a class=\"anchor\" href=\"/react/jsx-in-depth#react-must-be-in-scope\"></a>React \u5fc5\u9808\u5728\u4f5c\u7528\u57df\u5167 </h3>\n<p>\u56e0\u70ba JSX \u6703\u7de8\u8b6f\u6210\u547c\u53eb <code class=\"language-javascript\">React.createElement</code> \u7684\u5f62\u5f0f\uff0c<code class=\"language-javascript\">React</code> \u51fd\u5f0f\u5eab\u5fc5\u9808\u540c\u6642\u8207\u4f60\u7684 JSX \u7a0b\u5f0f\u78bc\u5728\u76f8\u540c\u7684\u4f5c\u7528\u57df\u5167\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u96d6\u7136 <code class=\"language-javascript\">React</code> \u8207 <code class=\"language-javascript\">CustomButton</code> \u4e26\u6c92\u6709\u5728 JavaScript \u4e2d\u88ab\u76f4\u63a5\u4f7f\u7528\uff0c\u4f46\u662f\u5728\u6b64\u7a0b\u5f0f\u78bc\u4e2d\u5b83\u5011\u5fc5\u9808\u88ab\u5c0e\u5165\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> CustomButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./CustomButton'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">WarningButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// return React.createElement(CustomButton, {color: 'red'}, null);</span></span>  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomButton</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>red<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u4e0d\u4f7f\u7528\u4efb\u4f55 JavaScript bundler \u4e26\u5f9e <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u4f86\u8f09\u5165 React\uff0c\u90a3\u9ebc\u5b83\u5c31\u5df2\u7d93\u4ee5 <code class=\"language-javascript\">React</code> \u5b58\u5728\u65bc\u4f5c\u7528\u57df\u4e2d\u4e86\u3002</p>\n<h3 id=\"using-dot-notation-for-jsx-type\"><a class=\"anchor\" href=\"/react/jsx-in-depth#using-dot-notation-for-jsx-type\"></a>\u5728 JSX \u985e\u578b\u4e2d\u4f7f\u7528\u9ede\u8a18\u6cd5 </h3>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u5728 JSX \u4e2d\u4f7f\u7528\u9ede\u8a18\u6cd5\u4f86\u6307\u5411\u4e00\u500b React Component\u3002\u9019\u5c0d\u7576\u4f60\u6709\u4e00\u500b\u6703\u5c0e\u51fa\u8a31\u591a React component \u7684 module \u4f86\u8b1b\u662f\u5341\u5206\u65b9\u4fbf\u7684\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5982\u679c <code class=\"language-javascript\">MyComponents.DatePicker</code> \u662f\u4e00\u500b component\uff0c\u90a3\u9ebc\u4f60\u53ef\u4ee5\u5728 JSX \u4e2d\u76f4\u63a5\u9019\u6a23\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> MyComponents <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">DatePicker</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">DatePicker</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Imagine a </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> datepicker here.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">BlueDatePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponents.DatePicker</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"user-defined-components-must-be-capitalized\"><a class=\"anchor\" href=\"/react/jsx-in-depth#user-defined-components-must-be-capitalized\"></a>\u4f7f\u7528\u8005\u5b9a\u7fa9\u7684 Component \u5fc5\u9808\u7531\u5927\u5beb\u5b57\u6bcd\u958b\u982d </h3>\n<p>\u7576\u4e00\u500b element \u70ba\u5c0f\u5beb\u5b57\u6bcd\u958b\u982d\u6642\uff0c\u5b83\u5c31\u6703\u6307\u5411\u5167\u5efa\u7684 component\uff0c\u4f8b\u5982 <code class=\"language-javascript\">&lt;div&gt;</code> \u6216 <code class=\"language-javascript\">&lt;span&gt;</code> \u6703\u751f\u7522\u6210\u5b57\u4e32 <code class=\"language-javascript\">'div'</code> \u6216 <code class=\"language-javascript\">'span'</code> \u4e26\u50b3\u905e\u7d66 <code class=\"language-javascript\">React.createElement</code>\u3002\u50cf <code class=\"language-javascript\">&lt;Foo /&gt;</code> \u5927\u5beb\u5b57\u6bcd\u958b\u982d\u7684 element \u6703\u7de8\u8b6f\u6210 <code class=\"language-javascript\">React.createElement(Foo)</code> \u4e26\u4e14\u5728\u4f60\u7684 JavaScript \u6a94\u6848\u88e1\u5c0d\u61c9\u81ea\u5b9a\u7fa9\u6216\u5c0e\u5165\u7684 component\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u4ee5\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u4f86\u547d\u540d component\u3002\u5982\u679c\u4f60\u6709\u4e00\u500b\u5c0f\u5beb\u5b57\u6bcd\u958b\u982d\u7684 component\uff0c\u8acb\u5728 JSX \u88e1\u4f7f\u7528\u4e4b\u524d\u628a\u5b83\u8ce6\u503c\u7d66\u4e00\u500b\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u7684\u8b8a\u6578\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u4e26\u4e0d\u6703\u6309\u7167\u9810\u671f\u904b\u884c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// \u932f\u8aa4\uff01\u9019\u662f\u4e00\u500b component \u4e26\u4e14\u61c9\u8a72\u7531\u5927\u5beb\u5b57\u6bcd\u958b\u982d\uff1a</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token comment\">// \u6b63\u78ba\uff01\u56e0\u70ba div \u662f\u4e00\u500b\u6709\u6548\u7684 HTML \u6a19\u7c64\uff0c\u6240\u4ee5\u4f7f\u7528&lt;div&gt; \u662f\u53ef\u884c\u7684\uff1a</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>toWhat<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u932f\u8aa4\uff01React \u6703\u56e0\u70ba\u975e\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u800c\u8a8d\u70ba &lt;hello /&gt; \u662f\u4e00\u500b HTML \u6a19\u7c64\uff1a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hello</span> <span class=\"token attr-name\">toWhat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>World<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u5c07\u91cd\u65b0\u547d\u540d <code class=\"language-javascript\">hello</code> \u6210 <code class=\"language-javascript\">Hello</code> \u4e26\u4e14\u4ee5 <code class=\"language-javascript\">&lt;Hello /&gt;</code> \u4f86\u4f7f\u7528\u5b83\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// \u6b63\u78ba\uff01\u9019\u662f\u4e00\u500b component \u4e26\u4e14\u61c9\u8a72\u7531\u5927\u5beb\u5b57\u6bcd\u958b\u982d\uff1a</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token comment\">// \u6b63\u78ba\uff01\u56e0\u70ba div \u662f\u4e00\u500b\u6709\u6548\u7684 HTML \u6a19\u7c64\uff0c\u6240\u4ee5\u4f7f\u7528 &lt;div&gt; \u662f\u53ef\u884c\u7684\uff1a</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>toWhat<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u6b63\u78ba\uff01React \u6703\u56e0\u70ba\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u800c\u4e86\u89e3 &lt;Hello /&gt; \u662f\u4e00\u500b component\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">toWhat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>World<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"choosing-the-type-at-runtime\"><a class=\"anchor\" href=\"/react/jsx-in-depth#choosing-the-type-at-runtime\"></a>\u5728 Runtime \u6642\u9078\u64c7\u985e\u578b </h3>\n<p>\u4f60\u4e0d\u80fd\u7528\u901a\u7528\u8868\u9054\u5f0f\u7576\u4f5c React element \u7684\u985e\u578b\u3002\u5982\u679c\u4f60\u60f3\u8981\u7528\u901a\u7528\u8868\u9054\u5f0f\u4f86\u8868\u793a element \u7684\u985e\u578b\uff0c\u4f60\u53ef\u4ee5\u5148\u628a\u5b83\u8ce6\u503c\u7d66\u4e00\u500b\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u7684\u8b8a\u6578\u3002\u9019\u662f\u5728\u7576\u4f60\u60f3\u8981\u6839\u64da\u4e00\u500b prop \u4f86\u6c7a\u5b9a render \u4e0d\u540c component \u6642\u5e38\u5e38\u767c\u751f\u7684\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PhotoStory<span class=\"token punctuation\">,</span> VideoStory <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./stories'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> components <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">photo</span><span class=\"token operator\">:</span> PhotoStory<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">video</span><span class=\"token operator\">:</span> VideoStory\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Story</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u932f\u8aa4\uff01JSX \u4e0d\u80fd\u662f\u8868\u9054\u5f0f\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>components<span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>storyType<span class=\"token punctuation\">]</span> story<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>story<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u9996\u5148\u5c07\u985e\u578b\u8ce6\u503c\u7d66\u4e00\u500b\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u7684\u8b8a\u6578\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PhotoStory<span class=\"token punctuation\">,</span> VideoStory <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./stories'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> components <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">photo</span><span class=\"token operator\">:</span> PhotoStory<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">video</span><span class=\"token operator\">:</span> VideoStory\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Story</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u6b63\u78ba\uff01JSX \u985e\u578b\u53ef\u4ee5\u662f\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u7684\u8b8a\u6578\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> SpecificStory <span class=\"token operator\">=</span> components<span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>storyType<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SpecificStory</span></span> <span class=\"token attr-name\">story</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>story<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"props-in-jsx\"><a class=\"anchor\" href=\"/react/jsx-in-depth#props-in-jsx\"></a>JSX \u4e2d\u7684 Props </h2>\n<p>\u5728 JSX \u4e2d\u6709\u4e0d\u540c\u7684\u65b9\u5f0f\u53ef\u4ee5\u6307\u5b9a props\u3002</p>\n<h3 id=\"javascript-expressions-as-props\"><a class=\"anchor\" href=\"/react/jsx-in-depth#javascript-expressions-as-props\"></a>JavaScript \u8868\u9054\u5f0f\u4f5c\u70ba Props </h3>\n<p>\u4f60\u53ef\u4ee5\u7528 <code class=\"language-javascript\">{}</code> \u5305\u4f4f\u4efb\u4f55 JavaScript \u8868\u9054\u5f0f\u4f5c\u70ba\u4e00\u500b prop \u50b3\u905e\u3002\u4f8b\u5982\uff0c\u5728\u4ee5\u4e0b JSX \u4e2d\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token attr-name\">foo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u5c0d <code class=\"language-javascript\">MyComponent</code> \u4f86\u8aaa\uff0c\u56e0\u70ba <code class=\"language-javascript\">1 + 2 + 3 + 4</code> \u6703\u88ab\u89e3\u8b80\uff0c\u6240\u4ee5 <code class=\"language-javascript\">props.foo</code> \u7684\u503c\u6703\u662f <code class=\"language-javascript\">10</code>\u3002</p>\n<p>\u56e0\u70ba <code class=\"language-javascript\">if</code> \u8a9e\u6cd5\u8207 <code class=\"language-javascript\">for</code> \u8ff4\u5708\u90fd\u4e0d\u5c6c\u65bc JavaScript \u8868\u9054\u5f0f\uff0c\u6240\u4ee5\u5b83\u5011\u4e26\u4e0d\u80fd\u5728 JSX \u4e2d\u88ab\u76f4\u63a5\u4f7f\u7528\u3002\u4e0d\u904e\uff0c\u4f60\u53ef\u4ee5\u5728\u5b83\u5468\u570d\u5916\u7684\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NumberDescriber</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> description<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>number <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    description <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">even</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    description <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>i</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">odd</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>i</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> is an </span><span class=\"token punctuation\">{</span>description<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> number</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u5728\u5c0d\u61c9\u7684\u6bb5\u843d\u4e2d\u4e86\u89e3\u66f4\u591a\u95dc\u65bc<a href=\"/react/conditional-rendering\">\u689d\u4ef6\u5f0f render</a> \u8207<a href=\"/react/lists-and-keys\">\u8ff4\u5708</a>\u3002</p>\n<h3 id=\"string-literals\"><a class=\"anchor\" href=\"/react/jsx-in-depth#string-literals\"></a>\u5b57\u4e32\u5b57\u9762\u503c </h3>\n<p>\u4f60\u53ef\u4ee5\u50b3\u905e\u4e00\u500b\u5b57\u4e32\u5b57\u9762\u503c\u4f5c\u70ba prop\u3002\u4ee5\u4e0b\u5169\u500b JSX \u8868\u9054\u5f0f\u662f\u76f8\u7b49\u7684\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token attr-name\">message</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello world<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token attr-name\">message</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'hello world'</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u7576\u4f60\u50b3\u905e\u4e00\u500b\u5b57\u4e32\u5b57\u9762\u503c\u6642\uff0c\u5b83\u7684\u503c\u662f\u672a\u7d93 HTML \u8f49\u7fa9\u7684\u3002\u6240\u4ee5\u4ee5\u4e0b\u5169\u500b JSX \u8868\u9054\u5f0f\u662f\u76f8\u7b49\u7684\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token attr-name\">message</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token entity named-entity\">&amp;lt;</span>3<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token attr-name\">message</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'&lt;3'</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u9019\u7a2e\u884c\u70ba\u901a\u5e38\u662f\u7121\u95dc\u7dca\u8981\u7684\u3002\u5728\u6b64\u53ea\u662f\u70ba\u4e86\u5b8c\u6574\u6027\u800c\u63d0\u53ca\u3002</p>\n<h3 id=\"props-default-to-true\"><a class=\"anchor\" href=\"/react/jsx-in-depth#props-default-to-true\"></a>Props \u9810\u8a2d\u70ba \u300cTrue\u300d </h3>\n<p>\u5982\u679c\u4f60\u6c92\u7d66 prop \u8ce6\u503c\uff0c\u90a3\u9ebc\u5b83\u7684\u9810\u8a2d\u503c\u5c31\u662f <code class=\"language-javascript\">true</code>\u3002\u4ee5\u4e0b\u5169\u500b JSX \u8868\u9054\u5f0f\u662f\u76f8\u7b49\u7684\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyTextBox</span></span> <span class=\"token attr-name\">autocomplete</span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyTextBox</span></span> <span class=\"token attr-name\">autocomplete</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u4e00\u822c\u4f86\u8aaa\uff0c\u6211\u5011\u4e0d\u5efa\u8b70<em>\u4e0d</em>\u50b3\u905e prop \u7684\u503c\uff0c\u56e0\u70ba\u5bb9\u6613\u628a\u5b83\u8ddf <a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Object_initializer#New_notations_in_ECMAScript_2015\">ES6 object shorthand</a> \u6df7\u6dc6\uff0c<code class=\"language-javascript\">{foo}</code> \u662f <code class=\"language-javascript\">{foo: foo}</code> \u7684\u7c21\u5beb\u800c\u4e0d\u662f <code class=\"language-javascript\">{foo: true}</code>\uff0c\u6240\u4ee5\u4e26\u4e0d\u5efa\u8b70\u9019\u6a23\u4f7f\u7528\u3002\u9019\u7a2e\u884c\u70ba\u5b58\u5728\u53ea\u662f\u70ba\u4e86\u76f8\u914d HTML \u7684\u884c\u70ba\u3002</p>\n<h3 id=\"spread-attributes\"><a class=\"anchor\" href=\"/react/jsx-in-depth#spread-attributes\"></a>\u5c55\u958b\u5c6c\u6027 </h3>\n<p>\u5982\u679c\u4f60\u5df2\u7d93\u6709\u4e86\u4e00\u500b <code class=\"language-javascript\">props</code> \u7684 object\uff0c\u4e26\u4e14\u60f3\u628a\u5b83\u50b3\u905e\u9032 JSX\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">...</code> \u4f5c\u70ba\u5c55\u958b\u904b\u7b97\u5b50\u4f86\u50b3\u905e\u6574\u500b props object\u3002\u4ee5\u4e0b\u5169\u500b component \u662f\u76f8\u7b49\u7684\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">App1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Greeting</span></span> <span class=\"token attr-name\">firstName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Ben<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lastName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Hector<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Ben'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hector'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Greeting</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5c55\u958b\u904b\u7b97\u5b50\u4f86\u5206\u958b\u4e26\u6311\u9078 component \u6240\u9700\u7684 props\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Button</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> kind<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>other <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">const</span> className <span class=\"token operator\">=</span> kind <span class=\"token operator\">===</span> <span class=\"token string\">\"primary\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"PrimaryButton\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"SecondaryButton\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>other<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">kind</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clicked!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Hello World!</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u4e2d\uff0c<code class=\"language-javascript\">kind</code> prop \u88ab\u5b89\u5168\u5730\u6311\u51fa\u4e26\u4e14<em>\u4e0d\u6703</em>\u88ab\u50b3\u905e\u9032 DOM \u4e2d\u7684 <code class=\"language-javascript\">&lt;button&gt;</code> element\u3002\n\u6240\u6709\u5176\u5b83\u7684 props \u85c9\u7531 <code class=\"language-javascript\">...other</code> object \u88ab\u50b3\u905e\uff0c\u8b93 component \u7684\u61c9\u7528\u975e\u5e38\u5177\u6709\u5f48\u6027\u3002\u4f60\u53ef\u4ee5\u770b\u898b\u5b83\u50b3\u905e\u4e00\u500b <code class=\"language-javascript\">onClick</code> \u8207 <code class=\"language-javascript\">children</code> props\u3002</p>\n<p>\u5c55\u958b\u904b\u7b97\u5b50\u4e0d\u4f46\u53ef\u4ee5\u5982\u6b64\u9748\u6d3b\u5730\u4f7f\u7528\uff0c\u5b83\u80fd\u8b93\u6211\u5011\u8f15\u6613\u6311\u9078\u51fa\u5c0d\u65bc component \u4e0d\u91cd\u8981\u4e14\u591a\u9918\u7684 props\uff0c\u4e5f\u80fd\u8b93\u6211\u5011\u50b3\u905e\u7121\u6548\u7684 HTML \u5c6c\u6027\u5230 DOM \u88e1\u3002</p>\n<h2 id=\"children-in-jsx\"><a class=\"anchor\" href=\"/react/jsx-in-depth#children-in-jsx\"></a>JSX \u4e2d\u7684 Children </h2>\n<p>\u5728 JSX \u8868\u9054\u5f0f\u6709\u5305\u542b\u958b\u59cb\u8207\u7d50\u675f\u6a19\u7c64\u7684\u60c5\u5f62\u4e0b\uff0c\u593e\u5728\u5169\u8005\u4e4b\u9593\u7684\u5167\u5bb9\u6703\u88ab\u50b3\u905e\u70ba\u7279\u5225\u7684 prop\uff1a<code class=\"language-javascript\">props.children</code>\u3002\u6709\u5e7e\u7a2e\u4e0d\u540c\u7684\u65b9\u6cd5\u4f86\u50b3\u905e children\uff1a</p>\n<h3 id=\"string-literals-1\"><a class=\"anchor\" href=\"/react/jsx-in-depth#string-literals-1\"></a>\u5b57\u4e32\u5b57\u9762\u503c </h3>\n<p>\u4f60\u53ef\u4ee5\u5728\u5169\u500b\u6a19\u7c64\u4e4b\u9593\u653e\u7f6e\u5b57\u4e32\uff0c\u800c <code class=\"language-javascript\">props.children</code> \u5c31\u6703\u662f\u90a3\u500b\u5b57\u4e32\u3002\u9019\u5c0d\u8a31\u591a\u5167\u5efa\u7684 HTML element \u662f\u5f88\u6709\u7528\u7684\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u9019\u662f\u6709\u6548\u7684 JSX\uff0c\u800c <code class=\"language-javascript\">props.children</code> \u5728 <code class=\"language-javascript\">MyComponent</code> \u4e2d\u55ae\u7d14\u5c31\u6703\u662f <code class=\"language-javascript\">\"Hello world!\"</code>\u3002HTML \u662f\u672a\u7d93\u8f49\u7fa9\u7684\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u9019\u6a23\u5982\u540c HTML \u4f86\u5beb JSX\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>This is valid HTML <span class=\"token entity named-entity\">&amp;amp;</span> JSX at the same time.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>JSX \u6703\u628a\u958b\u982d\u8207\u7d50\u5c3e\u7684\u7a7a\u767d\u53bb\u9664\uff0c\u4e5f\u6703\u53bb\u9664\u7a7a\u884c\u3002\u8207\u6a19\u7c64\u76f8\u9130\u7684\u65b0\u884c\u6703\u53bb\u9664\uff1b\u5728\u5b57\u4e32\u5b57\u9762\u503c\u4e2d\u9593\u7684\u65b0\u884c\u5247\u6703\u88ab\u58d3\u7e2e\u6210\u55ae\u4e00\u7a7a\u683c\u3002\u6240\u4ee5\u4ee5\u4e0b\u90fd\u6703 render \u540c\u6a23\u7684\u7d50\u679c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello World</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  Hello World\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  Hello\n  World\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n\n  Hello World\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<h3 id=\"jsx-children\"><a class=\"anchor\" href=\"/react/jsx-in-depth#jsx-children\"></a>JSX Children </h3>\n<p>\u4f60\u53ef\u4ee5\u63d0\u4f9b\u8a31\u591a JSX element \u4f5c\u70ba children\u3002\u9019\u5728\u986f\u793a\u5de2\u72c0 component \u6642\u662f\u975e\u5e38\u5be6\u7528\u7684\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyContainer</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyFirstComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MySecondComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyContainer</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u6df7\u5408\u4e0d\u540c\u985e\u578b\u7684 children\uff0c\u6240\u4ee5\u4f60\u4e5f\u80fd\u5920\u540c\u6642\u4f7f\u7528\u5b57\u4e32\u5b57\u9762\u503c\u8207 JSX children\u3002\u9019\u4e5f\u662f JSX \u8207 HTML \u53e6\u4e00\u76f8\u4f3c\u7684\u9ede\uff0c\u800c\u4ee5\u4e0b\u662f\u6709\u6548\u7684 JSX \u540c\u6642\u4e5f\u662f\u6709\u6548\u7684 HTML\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  Here is a list:\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Item 1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Item 2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4e00\u500b React component \u4e5f\u80fd\u5920\u56de\u50b3\u4e00\u500b\u9663\u5217 element\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u6c92\u6709\u5fc5\u8981\u628a\u591a\u9918\u7684 list items \u5305\u5728 element \u88e1\u982d\uff01</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// \u5225\u5fd8\u4e86\u52a0 keys :)</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>A<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">First item</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>B<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Second item</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>C<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Third item</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"javascript-expressions-as-children\"><a class=\"anchor\" href=\"/react/jsx-in-depth#javascript-expressions-as-children\"></a>JavaScript \u8868\u9054\u5f0f\u4f5c\u70ba Children </h3>\n<p>\u4f60\u53ef\u4ee5\u50b3\u905e\u4efb\u4f55\u5c01\u88dd\u5728 <code class=\"language-javascript\">{}</code> \u5167\u7684 JavaScript \u8868\u9054\u5f0f\u4f5c\u70ba children\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u8868\u9054\u5f0f\u7686\u76f8\u7b49\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">foo</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MyComponent</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u9019\u5728\u8981 render \u4efb\u610f\u9577\u5ea6\u7684 JSX \u8868\u9054\u5f0f\u5217\u8868\u6642\u662f\u975e\u5e38\u5be6\u7528\u7684\u3002\u4f8b\u5982\uff0c\u9019\u6703 render \u4e00\u500b HTML \u5217\u8868\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Item</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">TodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> todos <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'finish doc'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'submit pr'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nag dan to review'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Item</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">message</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JavaScript \u8868\u9054\u5f0f\u53ef\u4ee5\u8207\u4e0d\u540c\u985e\u578b\u7684 children \u6df7\u5408\u3002\u9019\u5728\u4e0d\u4f7f\u7528\u6a23\u677f\u5b57\u4e32\u6642\u975e\u5e38\u5be6\u7528\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>addressee<span class=\"token punctuation\">}</span><span class=\"token plain-text\">!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"functions-as-children\"><a class=\"anchor\" href=\"/react/jsx-in-depth#functions-as-children\"></a>Functions \u4f5c\u70ba Children </h3>\n<p>\u6b63\u5e38\u4f86\u8aaa\uff0c\u5728 JSX \u4e2d\u7684 JavaScript \u8868\u9054\u5f0f\u6703\u88ab\u8f49\u63db\u6210\u5b57\u4e32\u3001React element\u3001\u6216\u8005\u5305\u542b\u9019\u4e9b\u7684\u5217\u8868\u3002\u4e0d\u904e\uff0c<code class=\"language-javascript\">props.children</code> \u5c31\u50cf\u5176\u5b83 prop \u4e00\u6a23\u53ef\u4ee5\u50b3\u905e\u4efb\u4f55\u985e\u578b\u7684\u8cc7\u6599\uff0c\u800c\u4e26\u4e0d\u5c40\u9650\u65bc\u53ea\u6709 React \u77e5\u9053\u5982\u4f55 render \u7684\u8cc7\u6599\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5047\u5982\u4f60\u6709\u4e00\u500b\u81ea\u8a02 component\uff0c\u4f60\u53ef\u4ee5\u628a callback \u4f5c\u70ba <code class=\"language-javascript\">props.children</code> \u50b3\u905e\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// numTimes \u6b21\u547c\u53eb children callback \u4f86\u91cd\u8907\u751f\u6210 component</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Repeat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> props<span class=\"token punctuation\">.</span>numTimes<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    items<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">children</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ListOfTenThings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Repeat</span></span> <span class=\"token attr-name\">numTimes</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">10</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">This is item </span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> in the list</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Repeat</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u88ab\u50b3\u905e\u9032\u81ea\u8a02 component \u7684 children \u53ef\u4ee5\u662f\u4efb\u4f55\u6771\u897f\uff0c\u53ea\u8981 component \u80fd\u5920\u5728 render \u4e4b\u524d\u628a\u5b83\u8f49\u63db\u6210 React \u80fd\u5920\u7406\u89e3\u7684\u6771\u897f\u5c31\u53ef\u4ee5\u4e86\u3002\u9019\u7a2e\u7528\u6cd5\u4e26\u4e0d\u666e\u904d\uff0c\u4f46\u80fd\u5920\u986f\u793a\u51fa JSX \u7684\u5ef6\u4f38\u6027\u3002</p>\n<h3 id=\"booleans-null-and-undefined-are-ignored\"><a class=\"anchor\" href=\"/react/jsx-in-depth#booleans-null-and-undefined-are-ignored\"></a>Booleans, Null, \u8207 Undefined \u6703\u88ab\u5ffd\u7565 </h3>\n<p><code class=\"language-javascript\">false</code>, <code class=\"language-javascript\">null</code>, <code class=\"language-javascript\">undefined</code>, \u8207 <code class=\"language-javascript\">true</code> \u90fd\u662f\u6709\u6548\u7684 children\u3002\u5b83\u5011\u53ea\u662f\u55ae\u7d14\u4e0d\u6703\u88ab render\u3002\u4ee5\u4e0b JSX \u8868\u9054\u5f0f\u7686\u6703 render \u76f8\u540c\u7684\u7d50\u679c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u9019\u5728\u9700\u8981\u689d\u4ef6\u5f0f render \u4e0d\u540c React elements \u6642\u975e\u5e38\u65b9\u4fbf\u3002\u4ee5\u4e0b JSX \u53ea\u6703\u5728 <code class=\"language-javascript\">showHeader</code> \u70ba <code class=\"language-javascript\">true</code> \u6642 render <code class=\"language-javascript\">&lt;Header /&gt;</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">  </span><span class=\"token punctuation\">{</span>showHeader <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Header</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Content</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\u6709\u4e00\u4e9b\u50cf\u662f\u6578\u5b57 <code class=\"language-javascript\">0</code> \u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Glossary/Falsy\">\u300cfalsy\u300d\u503c</a> \u4ecd\u7136\u6703\u88ab React \u7d66 render\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u4ee5\u4e0b\u7684\u7a0b\u5f0f\u78bc\u53ef\u80fd\u4e0d\u6703\u5982\u540c\u4f60\u9810\u671f\u822c\u5730\u904b\u4f5c\uff0c\u56e0\u70ba\u7576 <code class=\"language-javascript\">props.messages</code> \u662f\u4e00\u500b\u7a7a array \u6642\uff0c <code class=\"language-javascript\">0</code> \u6703\u88ab\u5370\u51fa\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">  </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&amp;&amp;</span></span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MessageList</span></span> <span class=\"token attr-name\">messages</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u78ba\u4fdd\u5728 <code class=\"language-javascript\">&amp;&amp;</code> \u4e4b\u524d\u7684\u8868\u9054\u5f0f\u70ba boolean\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">  </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MessageList</span></span> <span class=\"token attr-name\">messages</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u76f8\u53cd\u5730\uff0c\u5982\u679c\u4f60\u60f3\u8981\u5370\u51fa <code class=\"language-javascript\">false</code>\u3001<code class=\"language-javascript\">true</code>\u3001<code class=\"language-javascript\">null</code> \u6216\u8005 <code class=\"language-javascript\">undefined</code> \u6642\uff0c\u4f60\u5fc5\u9808\u8981\u5148\u628a\u5b83<a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/String#String_conversion\">\u8f49\u63db\u6210\u4e00\u500b\u5b57\u4e32</a>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">  My JavaScript variable is </span><span class=\"token punctuation\">{</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span>myVariable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">.</span></span><span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/jsx-in-depth.md\">Edit this page</a></p></div></article>", "path": "/react/jsx-in-depth", "nav": ["/react/integrating-with-other-libraries", "/react/optimizing-performance"]}, {"key": "\u6700\u4f73\u5316\u6548\u80fd", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Internally, React uses several clever techniques to minimize the number of costly DOM operations required to update the UI. For many applications, using React will lead to a fast user interface without doing much work to specifically optimize for performance. Nevertheless, there are several ways you can speed up your React application.</p>\n<h2 id=\"use-the-production-build\"><a class=\"anchor\" href=\"/react/optimizing-performance#use-the-production-build\"></a>Use the Production Build </h2>\n<p>If you\u2019re benchmarking or experiencing performance problems in your React apps, make sure you\u2019re testing with the minified production build.</p>\n<p>By default, React includes many helpful warnings. These warnings are very useful in development. However, they make React larger and slower so you should make sure to use the production version when you deploy the app.</p>\n<p>If you aren\u2019t sure whether your build process is set up correctly, you can check it by installing <a class=\"external-link\" href=\"https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi\">React Developer Tools for Chrome</a>. If you visit a site with React in production mode, the icon will have a dark background:</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/d0f767f80866431ccdec18f200ca58f1/0a47e/devtools-prod.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/d0f767f80866431ccdec18f200ca58f1/0a47e/devtools-prod.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>If you visit a site with React in development mode, the icon will have a red background:</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/e434ce2f7e64f63e597edf03f4465694/0a47e/devtools-dev.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/e434ce2f7e64f63e597edf03f4465694/0a47e/devtools-dev.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>It is expected that you use the development mode when working on your app, and the production mode when deploying your app to the users.</p>\n<p>You can find instructions for building your app for production below.</p>\n<h3 id=\"create-react-app\"><a class=\"anchor\" href=\"/react/optimizing-performance#create-react-app\"></a>Create React App </h3>\n<p>If your project is built with <a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">npm run build</code></pre></div>\n<p>This will create a production build of your app in the <code class=\"language-javascript\">build/</code> folder of your project.</p>\n<p>Remember that this is only necessary before deploying to production. For normal development, use <code class=\"language-javascript\">npm start</code>.</p>\n<h3 id=\"single-file-builds\"><a class=\"anchor\" href=\"/react/optimizing-performance#single-file-builds\"></a>Single-File Builds </h3>\n<p>We offer production-ready versions of React and React DOM as single files:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react@18/umd/react.production.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/react-dom@18/umd/react-dom.production.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>Remember that only React files ending with <code class=\"language-javascript\">.production.min.js</code> are suitable for production.</p>\n<h3 id=\"brunch\"><a class=\"anchor\" href=\"/react/optimizing-performance#brunch\"></a>Brunch </h3>\n<p>For the most efficient Brunch production build, install the <a class=\"external-link\" href=\"https://github.com/brunch/terser-brunch\"><code class=\"language-javascript\">terser-brunch</code></a> plugin:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\"># If you use npm\nnpm install --save-dev terser-brunch\n\n# If you use Yarn\nyarn add --dev terser-brunch</code></pre></div>\n<p>Then, to create a production build, add the <code class=\"language-javascript\">-p</code> flag to the <code class=\"language-javascript\">build</code> command:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">brunch build -p</code></pre></div>\n<p>Remember that you only need to do this for production builds. You shouldn\u2019t pass the <code class=\"language-javascript\">-p</code> flag or apply this plugin in development, because it will hide useful React warnings and make the builds much slower.</p>\n<h3 id=\"browserify\"><a class=\"anchor\" href=\"/react/optimizing-performance#browserify\"></a>Browserify </h3>\n<p>For the most efficient Browserify production build, install a few plugins:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\"># If you use npm\nnpm install --save-dev envify terser uglifyify\n\n# If you use Yarn\nyarn add --dev envify terser uglifyify</code></pre></div>\n<p>To create a production build, make sure that you add these transforms <strong>(the order matters)</strong>:</p>\n<ul>\n<li>The <a class=\"external-link\" href=\"https://github.com/hughsk/envify\"><code class=\"language-javascript\">envify</code></a> transform ensures the right build environment is set. Make it global (<code class=\"language-javascript\">-g</code>).</li>\n<li>The <a class=\"external-link\" href=\"https://github.com/hughsk/uglifyify\"><code class=\"language-javascript\">uglifyify</code></a> transform removes development imports. Make it global too (<code class=\"language-javascript\">-g</code>).</li>\n<li>Finally, the resulting bundle is piped to <a class=\"external-link\" href=\"https://github.com/terser-js/terser\"><code class=\"language-javascript\">terser</code></a> for mangling (<a class=\"external-link\" href=\"https://github.com/hughsk/uglifyify#motivationusage\">read why</a>).</li>\n</ul>\n<p>For example:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">browserify ./index.js \\\n  -g [ envify --NODE_ENV production ] \\\n  -g uglifyify \\\n  | terser --compress --mangle &gt; ./bundle.js</code></pre></div>\n<p>Remember that you only need to do this for production builds. You shouldn\u2019t apply these plugins in development because they will hide useful React warnings, and make the builds much slower.</p>\n<h3 id=\"rollup\"><a class=\"anchor\" href=\"/react/optimizing-performance#rollup\"></a>Rollup </h3>\n<p>For the most efficient Rollup production build, install a few plugins:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token comment\"># If you use npm</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev rollup-plugin-commonjs rollup-plugin-replace rollup-plugin-terser\n\n<span class=\"token comment\"># If you use Yarn</span>\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev rollup-plugin-commonjs rollup-plugin-replace rollup-plugin-terser</code></pre></div>\n<p>To create a production build, make sure that you add these plugins <strong>(the order matters)</strong>:</p>\n<ul>\n<li>The <a class=\"external-link\" href=\"https://github.com/rollup/rollup-plugin-replace\"><code class=\"language-javascript\">replace</code></a> plugin ensures the right build environment is set.</li>\n<li>The <a class=\"external-link\" href=\"https://github.com/rollup/rollup-plugin-commonjs\"><code class=\"language-javascript\">commonjs</code></a> plugin provides support for CommonJS in Rollup.</li>\n<li>The <a class=\"external-link\" href=\"https://github.com/TrySound/rollup-plugin-terser\"><code class=\"language-javascript\">terser</code></a> plugin compresses and mangles the final bundle.</li>\n</ul>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rollup-plugin-replace'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">'process.env.NODE_ENV'</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token string\">'production'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rollup-plugin-commonjs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rollup-plugin-terser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>For a complete setup example <a class=\"external-link\" href=\"https://gist.github.com/Rich-Harris/cb14f4bc0670c47d00d191565be36bf0\">see this gist</a>.</p>\n<p>Remember that you only need to do this for production builds. You shouldn\u2019t apply the <code class=\"language-javascript\">terser</code> plugin or the <code class=\"language-javascript\">replace</code> plugin with <code class=\"language-javascript\">'production'</code> value in development because they will hide useful React warnings, and make the builds much slower.</p>\n<h3 id=\"webpack\"><a class=\"anchor\" href=\"/react/optimizing-performance#webpack\"></a>webpack </h3>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>If you\u2019re using Create React App, please follow <a href=\"/react/optimizing-performance#create-react-app\">the instructions above</a>.<br/>\nThis section is only relevant if you configure webpack directly.</p>\n</div>\n<p>Webpack v4+ will minify your code by default in production mode.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> TerserPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'terser-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'production'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optimization</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">minimizer</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TerserPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">/* additional options here */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can learn more about this in <a class=\"external-link\" href=\"https://webpack.js.org/guides/production/\">webpack documentation</a>.</p>\n<p>Remember that you only need to do this for production builds. You shouldn\u2019t apply <code class=\"language-javascript\">TerserPlugin</code> in development because it will hide useful React warnings, and make the builds much slower.</p>\n<h2 id=\"profiling-components-with-the-devtools-profiler\"><a class=\"anchor\" href=\"/react/optimizing-performance#profiling-components-with-the-devtools-profiler\"></a>Profiling Components with the DevTools Profiler </h2>\n<p><code class=\"language-javascript\">react-dom</code> 16.5+ and <code class=\"language-javascript\">react-native</code> 0.57+ provide enhanced profiling capabilities in DEV mode with the React DevTools Profiler.\nAn overview of the Profiler can be found in the blog post <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/09/10/introducing-the-react-profiler.html\">\u201cIntroducing the React Profiler\u201d</a>.\nA video walkthrough of the profiler is also <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=nySib7ipZdk\">available on YouTube</a>.</p>\n<p>If you haven\u2019t yet installed the React DevTools, you can find them here:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en\">Chrome Browser Extension</a></li>\n<li><a class=\"external-link\" href=\"https://addons.mozilla.org/en-GB/firefox/addon/react-devtools/\">Firefox Browser Extension</a></li>\n<li><a class=\"external-link\" href=\"https://www.npmjs.com/package/react-devtools\">Standalone Node Package</a></li>\n</ul>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>A production profiling bundle of <code class=\"language-javascript\">react-dom</code> is also available as <code class=\"language-javascript\">react-dom/profiling</code>.\nRead more about how to use this bundle at <a class=\"external-link\" href=\"https://fb.me/react-profiling\">fb.me/react-profiling</a></p>\n</div>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>Before React 17, we use the standard <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/User_Timing_API\">User Timing API</a> to profile components with the chrome performance tab.\nFor a more detailed walkthrough, check out <a class=\"external-link\" href=\"https://calibreapp.com/blog/react-performance-profiling-optimization\">this article by Ben Schwarz</a>.</p>\n</div>\n<h2 id=\"virtualize-long-lists\"><a class=\"anchor\" href=\"/react/optimizing-performance#virtualize-long-lists\"></a>Virtualize Long Lists </h2>\n<p>If your application renders long lists of data (hundreds or thousands of rows), we recommend using a technique known as \u201cwindowing\u201d. This technique only renders a small subset of your rows at any given time, and can dramatically reduce the time it takes to re-render the components as well as the number of DOM nodes created.</p>\n<p><a class=\"external-link\" href=\"https://react-window.now.sh/\">react-window</a> and <a class=\"external-link\" href=\"https://bvaughn.github.io/react-virtualized/\">react-virtualized</a> are popular windowing libraries. They provide several reusable components for displaying lists, grids, and tabular data. You can also create your own windowing component, like <a class=\"external-link\" href=\"https://medium.com/@paularmstrong/twitter-lite-and-high-performance-react-progressive-web-apps-at-scale-d28a00e780a3\">Twitter did</a>, if you want something more tailored to your application\u2019s specific use case.</p>\n<h2 id=\"avoid-reconciliation\"><a class=\"anchor\" href=\"/react/optimizing-performance#avoid-reconciliation\"></a>Avoid Reconciliation </h2>\n<p>React builds and maintains an internal representation of the rendered UI. It includes the React elements you return from your components. This representation lets React avoid creating DOM nodes and accessing existing ones beyond necessity, as that can be slower than operations on JavaScript objects. Sometimes it is referred to as a \u201cvirtual DOM\u201d, but it works the same way on React Native.</p>\n<p>When a component\u2019s props or state change, React decides whether an actual DOM update is necessary by comparing the newly returned element with the previously rendered one. When they are not equal, React will update the DOM.</p>\n<p>Even though React only updates the changed DOM nodes, re-rendering still takes some time. In many cases it\u2019s not a problem, but if the slowdown is noticeable, you can speed all of this up by overriding the lifecycle function <code class=\"language-javascript\">shouldComponentUpdate</code>, which is triggered before the re-rendering process starts. The default implementation of this function returns <code class=\"language-javascript\">true</code>, leaving React to perform the update:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you know that in some situations your component doesn\u2019t need to update, you can return <code class=\"language-javascript\">false</code> from <code class=\"language-javascript\">shouldComponentUpdate</code> instead, to skip the whole rendering process, including calling <code class=\"language-javascript\">render()</code> on this component and below.</p>\n<p>In most cases, instead of writing <code class=\"language-javascript\">shouldComponentUpdate()</code> by hand, you can inherit from <a href=\"/react/react-api#reactpurecomponent\"><code class=\"language-javascript\">React.PureComponent</code></a>. It is equivalent to implementing <code class=\"language-javascript\">shouldComponentUpdate()</code> with a shallow comparison of current and previous props and state.</p>\n<h2 id=\"shouldcomponentupdate-in-action\"><a class=\"anchor\" href=\"/react/optimizing-performance#shouldcomponentupdate-in-action\"></a>shouldComponentUpdate In Action </h2>\n<p>Here\u2019s a subtree of components. For each one, <code class=\"language-javascript\">SCU</code> indicates what <code class=\"language-javascript\">shouldComponentUpdate</code> returned, and <code class=\"language-javascript\">vDOMEq</code> indicates whether the rendered React elements were equivalent. Finally, the circle\u2019s color indicates whether the component had to be reconciled or not.</p>\n<figure>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/5ee1bdf4779af06072a17b7a0654f6db/cd039/should-component-update.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/5ee1bdf4779af06072a17b7a0654f6db/cd039/should-component-update.png\">Image link</a>\n</span>\n</span>\n</a>\n</figure>\n<p>Since <code class=\"language-javascript\">shouldComponentUpdate</code> returned <code class=\"language-javascript\">false</code> for the subtree rooted at C2, React did not attempt to render C2, and thus didn\u2019t even have to invoke <code class=\"language-javascript\">shouldComponentUpdate</code> on C4 and C5.</p>\n<p>For C1 and C3, <code class=\"language-javascript\">shouldComponentUpdate</code> returned <code class=\"language-javascript\">true</code>, so React had to go down to the leaves and check them. For C6 <code class=\"language-javascript\">shouldComponentUpdate</code> returned <code class=\"language-javascript\">true</code>, and since the rendered elements weren\u2019t equivalent React had to update the DOM.</p>\n<p>The last interesting case is C8. React had to render this component, but since the React elements it returned were equal to the previously rendered ones, it didn\u2019t have to update the DOM.</p>\n<p>Note that React only had to do DOM mutations for C6, which was inevitable. For C8, it bailed out by comparing the rendered React elements, and for C2\u2019s subtree and C7, it didn\u2019t even have to compare the elements as we bailed out on <code class=\"language-javascript\">shouldComponentUpdate</code>, and <code class=\"language-javascript\">render</code> was not called.</p>\n<h2 id=\"examples\"><a class=\"anchor\" href=\"/react/optimizing-performance#examples\"></a>Examples </h2>\n<p>If the only way your component ever changes is when the <code class=\"language-javascript\">props.color</code> or the <code class=\"language-javascript\">state.count</code> variable changes, you could have <code class=\"language-javascript\">shouldComponentUpdate</code> check that:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CounterButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>color <span class=\"token operator\">!==</span> nextProps<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">!==</span> nextState<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n        <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Count: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In this code, <code class=\"language-javascript\">shouldComponentUpdate</code> is just checking if there is any change in <code class=\"language-javascript\">props.color</code> or <code class=\"language-javascript\">state.count</code>. If those values don\u2019t change, the component doesn\u2019t update. If your component got more complex, you could use a similar pattern of doing a \u201cshallow comparison\u201d between all the fields of <code class=\"language-javascript\">props</code> and <code class=\"language-javascript\">state</code> to determine if the component should update. This pattern is common enough that React provides a helper to use this logic - just inherit from <code class=\"language-javascript\">React.PureComponent</code>. So this code is a simpler way to achieve the same thing:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CounterButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n        <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Count: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Most of the time, you can use <code class=\"language-javascript\">React.PureComponent</code> instead of writing your own <code class=\"language-javascript\">shouldComponentUpdate</code>. It only does a shallow comparison, so you can\u2019t use it if the props or state may have been mutated in a way that a shallow comparison would miss.</p>\n<p>This can be a problem with more complex data structures. For example, let\u2019s say you want a <code class=\"language-javascript\">ListOfWords</code> component to render a comma-separated list of words, with a parent <code class=\"language-javascript\">WordAdder</code> component that lets you click a button to add a word to the list. This code does <em>not</em> work correctly:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ListOfWords</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">WordAdder</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'marklar'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This section is bad style and causes a bug</span>\n    <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">;</span>\n    words<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">'marklar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> words<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ListOfWords</span></span> <span class=\"token attr-name\">words</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The problem is that <code class=\"language-javascript\">PureComponent</code> will do a simple comparison between the old and new values of <code class=\"language-javascript\">this.props.words</code>. Since this code mutates the <code class=\"language-javascript\">words</code> array in the <code class=\"language-javascript\">handleClick</code> method of <code class=\"language-javascript\">WordAdder</code>, the old and new values of <code class=\"language-javascript\">this.props.words</code> will compare as equal, even though the actual words in the array have changed. The <code class=\"language-javascript\">ListOfWords</code> will thus not update even though it has new words that should be rendered.</p>\n<h2 id=\"the-power-of-not-mutating-data\"><a class=\"anchor\" href=\"/react/optimizing-performance#the-power-of-not-mutating-data\"></a>The Power Of Not Mutating Data </h2>\n<p>The simplest way to avoid this problem is to avoid mutating values that you are using as props or state. For example, the <code class=\"language-javascript\">handleClick</code> method above could be rewritten using <code class=\"language-javascript\">concat</code> as:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'marklar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ES6 supports a <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator\">spread syntax</a> for arrays which can make this easier. If you\u2019re using Create React App, this syntax is available by default.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">,</span> <span class=\"token string\">'marklar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can also rewrite code that mutates objects to avoid mutation, in a similar way. For example, let\u2019s say we have an object named <code class=\"language-javascript\">colormap</code> and we want to write a function that changes <code class=\"language-javascript\">colormap.right</code> to be <code class=\"language-javascript\">'blue'</code>. We could write:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateColorMap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">colormap</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  colormap<span class=\"token punctuation\">.</span>right <span class=\"token operator\">=</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To write this without mutating the original object, we can use <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\">Object.assign</a> method:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateColorMap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">colormap</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> colormap<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">right</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-javascript\">updateColorMap</code> now returns a new object, rather than mutating the old one. <code class=\"language-javascript\">Object.assign</code> is in ES6 and requires a polyfill.</p>\n<p><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax\">Object spread syntax</a> makes it easier to update objects without mutation as well:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateColorMap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">colormap</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>colormap<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">right</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This feature was added to JavaScript in ES2018.</p>\n<p>If you\u2019re using Create React App, both <code class=\"language-javascript\">Object.assign</code> and the object spread syntax are available by default.</p>\n<p>When you deal with deeply nested objects, updating them in an immutable way can feel convoluted. If you run into this problem, check out <a class=\"external-link\" href=\"https://github.com/mweststrate/immer\">Immer</a> or <a class=\"external-link\" href=\"https://github.com/kolodny/immutability-helper\">immutability-helper</a>. These libraries let you write highly readable code without losing the benefits of immutability.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/optimizing-performance.md\">Edit this page</a></p></div></article>", "path": "/react/optimizing-performance", "nav": ["/react/jsx-in-depth", "/react/portals"]}, {"key": "Portals", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Portal \u63d0\u4f9b\u4e00\u500b\u512a\u79c0\u65b9\u6cd5\u4f86\u8b93 children \u53ef\u4ee5 render \u5230 parent component DOM \u6a39\u4ee5\u5916\u7684 DOM \u7bc0\u9ede\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createPortal</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u7b2c\u4e00\u500b\u53c3\u6578\uff08<code class=\"language-javascript\">child</code>\uff09\u662f\u4efb\u4f55<a href=\"/react/react-component#render\">\u53ef render \u7684 React child</a>\uff0c\u4f8b\u5982 element\u3001string \u6216\u8005 fragment\u3002\u7b2c\u4e8c\u500b\u53c3\u6578\uff08<code class=\"language-javascript\">container</code>\uff09\u5247\u662f\u4e00\u500b DOM element\u3002</p>\n<h2 id=\"usage\"><a class=\"anchor\" href=\"/react/portals#usage\"></a>\u4f7f\u7528\u65b9\u5f0f </h2>\n<p>\u901a\u5e38\u7576 component \u7684 render \u65b9\u6cd5\u56de\u50b3\u4e00\u500b element \u6642\uff0c\u6b64 element \u6703\u4f5c\u70ba child \u88ab mount \u9032\u6700\u63a5\u8fd1\u7684 parent \u7bc0\u9ede\u4e2d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// React mount \u4e00\u500b\u65b0\u7684 div \u4e26\u5c07 children render \u9032\u53bb</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7136\u800c\u5728\u67d0\u4e9b\u72c0\u6cc1\u4e0b\uff0c\u5c07 child \u63d2\u5165\u4e0d\u540c\u4f4d\u7f6e\u7684 DOM \u5167\u5341\u5206\u597d\u7528\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// React *\u4e0d\u6703*\u5efa\u7acb\u65b0\u7684 div\u3002\u5b83\u6703\u5c07 children render \u9032 `domNode` \u4e2d\u3002</span>\n  <span class=\"token comment\">// `domNode` \u53ef\u4ee5\u662f\u4efb\u4f55\u5728\u96a8\u610f\u4f4d\u7f6e\u7684\u5408\u6cd5 DOM node\u3002</span>\n  <span class=\"token keyword\">return</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createPortal</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    domNode</span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4e00\u500b\u5178\u578b\u7684 portal \u4f7f\u7528\u6848\u4f8b\u662f\uff0c\u7576 parent component \u6709 <code class=\"language-javascript\">overflow: hidden</code> \u6216\u8005 <code class=\"language-javascript\">z-index</code> \u7684\u6a23\u5f0f\u6642\uff0c\u537b\u4ecd\u9700\u8981 child \u5728\u8996\u89ba\u4e0a\u300c\u8df3\u51fa\u300d\u5176\u5bb9\u5668\u7684\u72c0\u6cc1\u3002\u4f8b\u5982 dialog\u3001hovercard \u8207 tooltip \u90fd\u5c6c\u65bc\u6b64\u6848\u4f8b\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u7576\u4f7f\u7528 portal \u6642\uff0c\u8acb\u7559\u610f<a href=\"/react/accessibility#programmatically-managing-focus\">\u63a7\u7ba1\u9375\u76e4 focus</a> \u5c0d\u65bc\u7121\u969c\u7919\u529f\u80fd\u6703\u8b8a\u5f97\u975e\u5e38\u91cd\u8981\u3002</p>\n<p>\u4f7f\u7528\u8df3\u7a97 dialog \u6642\uff0c\u61c9\u78ba\u4fdd\u6bcf\u500b\u4eba\u90fd\u53ef\u4ee5\u4f9d\u7167 <a class=\"external-link\" href=\"https://www.w3.org/TR/wai-aria-practices-1.1/#dialog_modal\">WAI-ARIA Modal \u958b\u767c\u898f\u7bc4</a> \u5b9a\u7fa9\u7684\u65b9\u5f0f\u8207\u5176\u4e92\u52d5\u3002</p>\n</div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/yzMaBd\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<h2 id=\"event-bubbling-through-portals\"><a class=\"anchor\" href=\"/react/portals#event-bubbling-through-portals\"></a>\u900f\u904e Portal \u9032\u884c Event Bubbling </h2>\n<p>\u96d6\u7136 portal \u53ef\u4ee5\u88ab\u653e\u7f6e\u5728 DOM tree \u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\uff0c\u4f46 portal \u7684\u5176\u4ed6\u884c\u70ba\u8207\u4e00\u822c\u7684 React child \u5225\u7121\u4e8c\u81f4\u3002\u50cf\u662f context \u7b49\u529f\u80fd\u7684\u904b\u4f5c\u65b9\u5f0f\u4e26\u4e0d\u6703\u56e0\u70ba child \u662f portal \u800c\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u70ba\u4e0d\u8ad6 portal \u5728 DOM tree \u4e2d\u7684\u4f4d\u7f6e\u70ba\u4f55\uff0c\u5b83\u90fd\u5b58\u5728\u65bc <em>React tree</em> \u4e2d\u3002</p>\n<p>\u76f8\u540c\u7684\u884c\u70ba\u4e5f\u5305\u62ec event bubbling\u3002\u4e00\u500b\u5728 portal \u5167\u89f8\u767c\u7684 event \u6703\u50b3\u905e\u5230\u6db5\u84cb\u5b83\u7684 <em>React tree</em> \u7956\u5148\u4e2d\uff0c\u5c31\u7b97\u6db5\u84cb\u5b83\u7684\u90a3\u4e9b element \u4e26\u4e0d\u662f DOM tree \u4e0a\u7684\u7956\u5148\u3002\u5047\u8a2d\u5b58\u5728\u4ee5\u4e0b HTML \u7d50\u69cb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>app-root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>modal-root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4e00\u500b\u5728 <code class=\"language-javascript\">#app-root</code> \u4e2d\u7684 <code class=\"language-javascript\">Parent</code> component \u53ef\u4ee5\u6355\u6349\u5f9e sibling \u7bc0\u9ede <code class=\"language-javascript\">#modal-root</code> bubble \u4e0a\u4f86\u4e14\u672a\u88ab\u63a5\u6536\u904e\u7684 event\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u9019\u5169\u500b container \u662f DOM \u4e0a\u7684 sibling</span>\n<span class=\"token keyword\">const</span> appRoot <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app-root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> modalRoot <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'modal-root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Modal</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Portal element \u6703\u5728 Modal \u7684 children \u88ab</span>\n    <span class=\"token comment\">// mount \u4e4b\u5f8c\u624d\u63d2\u5165 DOM tree \u4e2d\uff0c\u9019\u4ee3\u8868 children</span>\n    <span class=\"token comment\">// \u6703\u88ab mount \u5728\u4e00\u500b\u5206\u96e2\u7684 DOM \u7bc0\u9ede\u4e0a\u3002\u5982\u679c\u4e00\u500b</span>\n    <span class=\"token comment\">// child component \u9700\u8981\u5728 mount \u7d50\u675f\u6642\u99ac\u4e0a\u9023\u63a5\u5230 DOM tree \u4e2d\uff0c</span>\n    <span class=\"token comment\">// \u4f8b\u5982\u6e2c\u91cf\u4e00\u500b DOM node\uff0c\u6216\u8005\u5728\u5b50\u7bc0\u9ede\u4e2d\u4f7f\u7528 'autoFocus' \u7b49\u72c0\u6cc1\uff0c</span>\n    <span class=\"token comment\">// \u5247\u61c9\u5c07 state \u52a0\u5165 Modal \u4e2d\uff0c\u4e26\u53ea\u5728 Modal \u63d2\u5165 DOM tree \u5f8c</span>\n    <span class=\"token comment\">// \u624d render children\u3002</span>\n    modalRoot<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    modalRoot<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createPortal</span><span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">clicks</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u9019\u6703\u5728 Child \u4e2d\u7684 button \u88ab\u9ede\u64ca\u6642\u89f8\u767c\u4e26\u66f4\u65b0 Parent \u7684 state\uff0c</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u5c31\u7b97 Child \u7684 button \u4e26\u4e0d\u662f DOM \u4e2d\u7684\u76f4\u63a5\u5f8c\u4ee3\u3002</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">clicks</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>clicks <span class=\"token operator\">+</span> <span class=\"token number\">1</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Number of clicks: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>clicks<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          Open up the browser DevTools</span>\n<span class=\"token plain-text\">          to observe that the button</span>\n<span class=\"token plain-text\">          is not a child of the div</span>\n<span class=\"token plain-text\">          with the onClick handler.</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Modal</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Child</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Modal</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Child</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u9019\u500b button \u4e2d\u7684 click event \u6703\u88ab bubble \u5230 parent \u4e2d\uff0c</span>\n  <span class=\"token comment\">// \u56e0\u70ba\u9019\u908a\u4e26\u6c92\u6709\u5b9a\u7fa9 'onClick' attribute</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>modal<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>appRoot<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Parent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/jGBWpE\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\u5427\uff01</strong></a></p>\n<p>Parent component \u53ef\u4ee5\u6355\u6349\u5f9e portal bubble \u4e0a\u4f86\u7684 event \u80fd\u4f7f\u958b\u767c\u5177\u6709\u4e0d\u76f4\u63a5\u4f9d\u8cf4\u65bc portal \u7684\u66f4\u5f48\u6027\u5316\u62bd\u8c61\u6027\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5982\u679c\u4f60 render \u4e86\u4e00\u500b <code class=\"language-javascript\">&lt;Modal /&gt;</code> component\uff0c\u5247\u4e0d\u8ad6 Modal \u662f\u5426\u662f\u4f7f\u7528 portal \u5be6\u4f5c\uff0c\u5b83\u7684 parent \u7686\u53ef\u4ee5\u6355\u6349\u5230\u5176 event\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/portals.md\">Edit this page</a></p></div></article>", "path": "/react/portals", "nav": ["/react/optimizing-performance", "/react/profiler"]}, {"key": "Profiler", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>The <code class=\"language-javascript\">Profiler</code> measures how often a React application renders and what the \u201ccost\u201d of rendering is.\nIts purpose is to help identify parts of an application that are slow and may benefit from <a href=\"/react/hooks-faq#how-to-memoize-calculations\">optimizations such as memoization</a>.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Profiling adds some additional overhead, so <strong>it is disabled in <a href=\"/react/optimizing-performance#use-the-production-build\">the production build</a></strong>.</p>\n<p>To opt into production profiling, React provides a special production build with profiling enabled.\nRead more about how to use this build at <a class=\"external-link\" href=\"https://fb.me/react-profiling\">fb.me/react-profiling</a></p>\n</div>\n<h2 id=\"usage\"><a class=\"anchor\" href=\"/react/profiler#usage\"></a>Usage </h2>\n<p>A <code class=\"language-javascript\">Profiler</code> can be added anywhere in a React tree to measure the cost of rendering that part of the tree.\nIt requires two props: an <code class=\"language-javascript\">id</code> (string) and an <code class=\"language-javascript\">onRender</code> callback (function) which React calls any time a component within the tree \u201ccommits\u201d an update.</p>\n<p>For example, to profile a <code class=\"language-javascript\">Navigation</code> component and its descendants:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Navigation<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Navigation</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Main</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Multiple <code class=\"language-javascript\">Profiler</code> components can be used to measure different parts of an application:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Navigation<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Navigation</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Main<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Main</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">Profiler</code> components can also be nested to measure different components within the same subtree:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Panel<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Panel</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Content<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Content</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Profiler</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>PreviewPane<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PreviewPane</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Panel</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Profiler</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>Although <code class=\"language-javascript\">Profiler</code> is a light-weight component, it should be used only when necessary; each use adds some CPU and memory overhead to an application.</p>\n</div>\n<h2 id=\"onrender-callback\"><a class=\"anchor\" href=\"/react/profiler#onrender-callback\"></a><code class=\"language-javascript\">onRender</code> Callback </h2>\n<p>The <code class=\"language-javascript\">Profiler</code> requires an <code class=\"language-javascript\">onRender</code> function as a prop.\nReact calls this function any time a component within the profiled tree \u201ccommits\u201d an update.\nIt receives parameters describing what was rendered and how long it took.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">onRenderCallback</span><span class=\"token punctuation\">(</span>\n  id<span class=\"token punctuation\">,</span> <span class=\"token comment\">// the \"id\" prop of the Profiler tree that has just committed</span>\n  phase<span class=\"token punctuation\">,</span> <span class=\"token comment\">// either \"mount\" (if the tree just mounted) or \"update\" (if it re-rendered)</span>\n  actualDuration<span class=\"token punctuation\">,</span> <span class=\"token comment\">// time spent rendering the committed update</span>\n  baseDuration<span class=\"token punctuation\">,</span> <span class=\"token comment\">// estimated time to render the entire subtree without memoization</span>\n  startTime<span class=\"token punctuation\">,</span> <span class=\"token comment\">// when React began rendering this update</span>\n  commitTime<span class=\"token punctuation\">,</span> <span class=\"token comment\">// when React committed this update</span>\n  interactions <span class=\"token comment\">// the Set of interactions belonging to this update</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Aggregate or log render timings...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Let\u2019s take a closer look at each of the props:</p>\n<ul>\n<li><strong><code class=\"language-javascript\">id: string</code></strong> -\nThe <code class=\"language-javascript\">id</code> prop of the <code class=\"language-javascript\">Profiler</code> tree that has just committed.\nThis can be used to identify which part of the tree was committed if you are using multiple profilers.</li>\n<li><strong><code class=\"language-javascript\">phase: \"mount\" | \"update\"</code></strong> -\nIdentifies whether the tree has just been mounted for the first time or re-rendered due to a change in props, state, or hooks.</li>\n<li><strong><code class=\"language-javascript\">actualDuration: number</code></strong> -\nTime spent rendering the <code class=\"language-javascript\">Profiler</code> and its descendants for the current update.\nThis indicates how well the subtree makes use of memoization (e.g. <a href=\"/react/react-api#reactmemo\"><code class=\"language-javascript\">React.memo</code></a>, <a href=\"/react/hooks-reference#usememo\"><code class=\"language-javascript\">useMemo</code></a>, <a href=\"/react/hooks-faq#how-do-i-implement-shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate</code></a>).\nIdeally this value should decrease significantly after the initial mount as many of the descendants will only need to re-render if their specific props change.</li>\n<li><strong><code class=\"language-javascript\">baseDuration: number</code></strong> -\nDuration of the most recent <code class=\"language-javascript\">render</code> time for each individual component within the <code class=\"language-javascript\">Profiler</code> tree.\nThis value estimates a worst-case cost of rendering (e.g. the initial mount or a tree with no memoization).</li>\n<li><strong><code class=\"language-javascript\">startTime: number</code></strong> -\nTimestamp when React began rendering the current update.</li>\n<li><strong><code class=\"language-javascript\">commitTime: number</code></strong> -\nTimestamp when React committed the current update.\nThis value is shared between all profilers in a commit, enabling them to be grouped if desirable.</li>\n<li><strong><code class=\"language-javascript\">interactions: Set</code></strong> -\nSet of <a class=\"external-link\" href=\"https://fb.me/react-interaction-tracing\">\u201cinteractions\u201d</a> that were being traced when the update was scheduled (e.g. when <code class=\"language-javascript\">render</code> or <code class=\"language-javascript\">setState</code> were called).</li>\n</ul>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>Interactions can be used to identify the cause of an update, although the API for tracing them is still experimental.</p>\n<p>Learn more about it at <a class=\"external-link\" href=\"https://fb.me/react-interaction-tracing\">fb.me/react-interaction-tracing</a></p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-profiler.md\">Edit this page</a></p></div></article>", "path": "/react/profiler", "nav": ["/react/portals", "/react/react-without-es6"]}, {"key": "\u6c92\u6709 ES6 \u7684 React", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u901a\u5e38\u4f60\u6703\u628a React component \u5b9a\u7fa9\u6210\u4e00\u500b JavaScript class\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u9084\u6c92\u958b\u59cb\u4f7f\u7528 ES6 \u7684\u8a71\uff0c\u5247\u53ef\u4ee5\u8003\u616e\u7528 <code class=\"language-javascript\">create-react-class</code> \u4f86\u4ee3\u66ff\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> createReactClass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'create-react-class'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> Greeting <span class=\"token operator\">=</span> <span class=\"token function\">createReactClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ES6 class \u8207 <code class=\"language-javascript\">createReactClass()</code> \u7684 API \u5341\u5206\u76f8\u4f3c\uff0c\u53ea\u6709\u4ee5\u4e0b\u5e7e\u500b\u4e0d\u540c\u8655\u3002</p>\n<h2 id=\"declaring-default-props\"><a class=\"anchor\" href=\"/react/react-without-es6#declaring-default-props\"></a>\u5ba3\u544a\u9810\u8a2d Props </h2>\n<p>\u4f7f\u7528 function \u8207 ES6 class \u8a9e\u6cd5\u6642\uff0c<code class=\"language-javascript\">defaultProps</code> \u6703\u88ab\u5b9a\u7fa9\u70ba component \u4e0a\u7684\u4e00\u500b\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\nGreeting<span class=\"token punctuation\">.</span>defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Mary'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u800c\u4f7f\u7528 <code class=\"language-javascript\">createReactClass()</code> \u8a9e\u6cd5\u6642\uff0c\u4f60\u5247\u9700\u8981\u5728\u50b3\u905e\u7684\u7269\u4ef6\u4e0a\u5b9a\u7fa9 <code class=\"language-javascript\">getDefaultProps()</code> \u65b9\u6cd5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> Greeting <span class=\"token operator\">=</span> <span class=\"token function\">createReactClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">getDefaultProps</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Mary'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// ...</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"setting-the-initial-state\"><a class=\"anchor\" href=\"/react/react-without-es6#setting-the-initial-state\"></a>\u8a2d\u5b9a\u521d\u59cb State </h2>\n<p>\u5728 ES6 class \u8a9e\u6cd5\u4e2d\uff0c\u4f60\u53ef\u4ee5\u85c9\u7531\u5728 constructor \u4e2d\u8a2d\u5b9a <code class=\"language-javascript\">this.state</code> \u4f86\u5b9a\u7fa9\u521d\u59cb state\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> props<span class=\"token punctuation\">.</span>initialCount<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u800c\u4f7f\u7528 <code class=\"language-javascript\">createReactClass()</code> \u8a9e\u6cd5\u6642\uff0c\u4f60\u5247\u9700\u8981\u53e6\u5916\u63d0\u4f9b\u4e00\u500b\u6703\u56de\u50b3\u521d\u59cb state \u7684 <code class=\"language-javascript\">getInitialState</code> \u65b9\u6cd5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> Counter <span class=\"token operator\">=</span> <span class=\"token function\">createReactClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">getInitialState</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>initialCount<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"autobinding\"><a class=\"anchor\" href=\"/react/react-without-es6#autobinding\"></a>\u81ea\u52d5\u7d81\u5b9a </h2>\n<p>\u5728\u4f7f\u7528 ES6 class \u5ba3\u544a React component \u6642\uff0c\u5176\u65b9\u6cd5\u7684\u8a9e\u7fa9\u8207\u4e00\u822c\u7684 ES6 class \u76f8\u540c\u3002\u4e5f\u5c31\u662f\u8aaa\uff0c\u9019\u4e9b\u65b9\u6cd5\u4e0d\u6703\u81ea\u52d5\u7d81\u5b9a <code class=\"language-javascript\">this</code> \u5230 instance \u4e0a\u3002\u4f60\u6703\u9700\u8981\u660e\u78ba\u5730\u5728 constructor \u4e2d\u4f7f\u7528 <code class=\"language-javascript\">.bind(this)</code> \u4f86\u7d81\u5b9a <code class=\"language-javascript\">this</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SayHello</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// \u9019\u884c\u5f88\u91cd\u8981\uff01</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u56e0\u70ba `this.handleClick` \u5df2\u7d93\u88ab\u7d81\u5b9a\u4e86\uff0c\u6240\u4ee5\u6211\u5011\u624d\u53ef\u4ee5\u628a\u5b83\u7576\u4f5c event handler \u4f7f\u7528\u3002</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Say hello\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u800c\u4f7f\u7528 <code class=\"language-javascript\">createReactClass()</code> \u6642\u5c31\u4e0d\u9700\u8981\u9019\u9ebc\u505a\uff0c\u56e0\u70ba\u5b83\u6703\u81ea\u52d5\u7d81\u5b9a\u6240\u6709\u65b9\u6cd5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> SayHello <span class=\"token operator\">=</span> <span class=\"token function\">createReactClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">getInitialState</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function-variable function\">handleClick</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Say hello\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u4ee3\u8868\u4f7f\u7528 ES6 class \u6642\u6703\u9700\u8981\u70ba event handler \u591a\u5beb\u4e00\u4e9b boilerplate \u7a0b\u5f0f\u78bc\uff0c\u4f46\u9019\u7a2e\u5beb\u6cd5\u7684\u597d\u8655\u662f\u5728\u5927\u578b\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\u6703\u6709\u7a0d\u5fae\u597d\u4e00\u9ede\u7684\u6548\u80fd\u3002</p>\n<p>\u5982\u679c\u5beb boilerplate \u7a0b\u5f0f\u78bc\u5c0d\u4f60\u4f86\u8aaa\u5be6\u5728\u662f\u5f88\u6c92\u6709\u5438\u5f15\u529b\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#public_instance_fields\">ES2022 Class Properties</a> \u8a9e\u6cd5\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SayHello</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'Hello!'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Say hello\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u60f3\u8981\u4fdd\u96aa\u4e00\u9ede\uff0c\u4f60\u6709\u4ee5\u4e0b\u5e7e\u500b\u9078\u64c7\uff1a</p>\n<ul>\n<li>\u5728 constructor \u4e2d\u7d81\u5b9a\u65b9\u6cd5\u3002</li>\n<li>\u4f7f\u7528 arrow function\uff0c\u4f8b\u5982 <code class=\"language-javascript\">onClick={(e) =&gt; this.handleClick(e)}</code>\u3002</li>\n<li>\u7e7c\u7e8c\u4f7f\u7528 <code class=\"language-javascript\">createReactClass</code>\u3002</li>\n</ul>\n<h2 id=\"mixins\"><a class=\"anchor\" href=\"/react/react-without-es6#mixins\"></a>Mixin </h2>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>ES6 \u4e26\u6c92\u6709\u652f\u63f4\u4efb\u4f55 mixin \u8a9e\u6cd5\u3002\u56e0\u6b64\u7576\u4f60\u5728 React \u4e2d\u4f7f\u7528 ES6 class \u6642\u4e5f\u4e0d\u652f\u63f4\u4f7f\u7528 mixin\u3002</p>\n<p><strong>\u6211\u5011\u4e5f\u767c\u73fe\u5728\u7a0b\u5f0f\u4e2d\u4f7f\u7528 mixin \u6703\u9020\u6210\u5f88\u591a\u554f\u984c\uff0c<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/07/13/mixins-considered-harmful.html\">\u56e0\u6b64\u4e0d\u5efa\u8b70\u5728\u65b0\u7684\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528 mixin</a>\u3002</strong></p>\n<p>\u6b64\u6bb5\u843d\u5167\u5bb9\u50c5\u4f9b\u53c3\u8003\u3002</p>\n</div>\n<p>\u6709\u6642\u5019\u5b8c\u5168\u4e0d\u540c\u7684 component \u9593\u53ef\u80fd\u6703\u5171\u6709\u76f8\u540c\u7684\u529f\u80fd\u3002\u9019\u7a2e\u72c0\u6cc1\u6709\u6642\u5019\u88ab\u7a31\u70ba<a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Cross-cutting_concern\">\u6a6b\u5207\u95dc\u6ce8\u9ede</a> \u554f\u984c\u3002<code class=\"language-javascript\">createReactClass</code> \u53ef\u4ee5\u8b93\u4f60\u4f7f\u7528\u820a\u6709\u7684 <code class=\"language-javascript\">mixins</code> \u6a5f\u5236\u4f86\u89e3\u6c7a\u6b64\u554f\u984c\u3002</p>\n<p>\u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u60c5\u5883\u662f\uff0c\u4e00\u500b component \u60f3\u8981\u6bcf\u9694\u4e00\u6bb5\u6642\u9593\u5c31\u66f4\u65b0\u81ea\u5df1\u4e00\u6b21\u3002\u4f7f\u7528 <code class=\"language-javascript\">setInterval()</code> \u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5be6\u73fe\u9019\u500b\u529f\u80fd\uff0c\u4f46\u91cd\u8981\u7684\u662f\u8981\u5728\u4e0d\u9700\u8981 <code class=\"language-javascript\">setInterval()</code> \u4e4b\u5f8c\u628a\u5b83\u53d6\u6d88\u6389\u4ee5\u4fdd\u7559\u8a18\u61b6\u9ad4\u7a7a\u9593\u3002React \u63d0\u4f9b <a href=\"/react/react-component#the-component-lifecycle\">\u751f\u547d\u9031\u671f\u65b9\u6cd5</a>\u8b93\u4f60\u77e5\u9053\u4e00\u500b component \u4ec0\u9ebc\u6642\u5019\u6703\u88ab\u5efa\u7acb\u6216\u92b7\u6bc0\u3002\u8b93\u6211\u5011\u7528\u9019\u4e9b\u65b9\u6cd5\u5efa\u7acb\u4e00\u500b\u7c21\u6613 mixin\uff0c\u4ee5\u63d0\u4f9b\u7c21\u55ae\u7684 <code class=\"language-javascript\">setInterval()</code> \u529f\u80fd\uff0c\u4e26\u8b93\u9019\u500b <code class=\"language-javascript\">setInterval()</code> \u5728\u4f60\u7684 component \u88ab\u92b7\u6bc0\u6642\u81ea\u52d5\u6e05\u9664\u6389\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> SetIntervalMixin <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">componentWillMount</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>intervals <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">setInterval</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>intervals<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">setInterval</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">componentWillUnmount</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>intervals<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>clearInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> createReactClass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'create-react-class'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> TickTock <span class=\"token operator\">=</span> <span class=\"token function\">createReactClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">mixins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>SetIntervalMixin<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// \u4f7f\u7528 mixin</span>\n  <span class=\"token function-variable function\">getInitialState</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">seconds</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">componentDidMount</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u547c\u53eb\u4e00\u500b mixin \u4e2d\u7684\u65b9\u6cd5</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">tick</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">seconds</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>seconds <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        React has been running for </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>seconds<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> seconds.\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'example'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TickTock</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u4e00\u500b component \u4f7f\u7528\u4e86\u8907\u6578\u500b mixin\uff0c\u4e14\u5176\u4e2d\u7684\u591a\u500b mixin \u540c\u6642\u5b9a\u7fa9\u4e86\u76f8\u540c\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff08\u4f8b\u5982\uff0c\u591a\u500b mixin \u90fd\u60f3\u8981\u5728 component \u88ab\u92b7\u6bc0\u6642\u505a\u4e00\u4e9b\u6e05\u9664\u7684\u52d5\u4f5c\uff09\uff0c\u5247\u6240\u6709\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u90fd\u4fdd\u8b49\u6703\u88ab\u547c\u53eb\u5230\u3002\u9019\u4e9b Mixin \u4e2d\u7684\u65b9\u6cd5\u6703\u4f9d\u7167\u5b83\u5011\u7684\u6392\u5217\u9806\u5e8f\u4f9d\u5e8f\u57f7\u884c\uff0c\u4e26\u6703\u5728\u6700\u5f8c\u547c\u53eb component \u4e0a\u7684\u5c0d\u61c9\u65b9\u6cd5\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/react-without-es6.md\">Edit this page</a></p></div></article>", "path": "/react/react-without-es6", "nav": ["/react/profiler", "/react/react-without-jsx"]}, {"key": "\u6c92\u6709 JSX \u7684 React", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>JSX \u5c0d\u65bc\u4f7f\u7528 React \u4e26\u4e0d\u662f\u4e0d\u53ef\u6216\u7f3a\u7684\u3002\u7576\u4f60\u4e0d\u60f3\u5728\u958b\u767c\u74b0\u5883\u4e2d\u8a2d\u7f6e\u7de8\u8b6f\u6642\uff0c\u4e0d\u4f7f\u7528 JSX \u958b\u767c React \u683c\u5916\u65b9\u4fbf\u3002</p>\n<p>\u6bcf\u500b JSX \u5143\u7d20\u90fd\u53ea\u662f\u547c\u53eb <code class=\"language-javascript\">React.createElement(component, props, ...children)</code> \u7684\u8a9e\u6cd5\u7cd6\u3002\u6240\u6709\u4efb\u4f55\u4f60\u80fd\u7528 JSX \u505a\u7684\u4e8b\uff0c\u4f60\u90fd\u80fd\u7528\u7d14 JavaScript \u505a\u5230\u3002</p>\n<p>\u6bd4\u5982\uff0c\u9019\u6bb5\u7528 JSX \u5beb\u6210\u7684\u7de8\u78bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Hello</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>toWhat<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">toWhat</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>World<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u53ef\u4ee5\u7de8\u8b6f\u6210\u9019\u6bb5\u6c92\u6709 JSX \u7684\u7a0b\u5f0f\u78bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Hello</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Hello </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>toWhat<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>Hello<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">toWhat</span><span class=\"token operator\">:</span> <span class=\"token string\">'World'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u60f3\u770b\u66f4\u591a JSX \u662f\u5982\u4f55\u8f49\u63db\u6210 JavaScript \u7684\u7bc4\u4f8b\uff0c\u4f60\u53ef\u4ee5\u5617\u8a66<a class=\"external-link\" href=\"https://babeljs.io/repl/#?presets=react&amp;code_lz=GYVwdgxgLglg9mABACwKYBt1wBQEpEDeAUIogE6pQhlIA8AJjAG4B8AEhlogO5xnr0AhLQD0jVgG4iAXyJA\">\u7dda\u4e0a Babel \u7de8\u8b6f\u5668</a>\u3002</p>\n<p>Component \u53ef\u4ee5\u662f\u4e00\u500b\u5b57\u4e32\u3001\u53ef\u4ee5\u662f <code class=\"language-javascript\">React.Component</code> \u7684 subclass\uff0c\u6216\u662f\u500b plain function\u3002</p>\n<p>\u5982\u679c\u4f60\u5df2\u7d93\u75b2\u65bc\u4e0d\u65b7\u91cd\u8907\u5beb <code class=\"language-javascript\">React.createElement</code>\uff0c\u4e00\u500b\u5e38\u898b\u7684\u65b9\u5f0f\u662f\u8ce6\u4e88\u4e00\u500b\u7e2e\u5beb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> e <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>createElement<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token function\">e</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Hello World'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u9019\u500b <code class=\"language-javascript\">React.createElement</code> \u7e2e\u5beb\u7684\u683c\u5f0f\uff0c\u4ed6\u53ef\u4ee5\u8ddf\u4e0d\u4f7f\u7528 JSX \u958b\u767c React \u4e00\u6a23\u65b9\u4fbf\u3002</p>\n<p>\u6b64\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u53c3\u8003\u793e\u7fa4\u5c08\u6848\u50cf\u662f <a class=\"external-link\" href=\"https://github.com/mlmorg/react-hyperscript\"><code class=\"language-javascript\">react-hyperscript</code></a> \u548c <a class=\"external-link\" href=\"https://github.com/ohanhi/hyperscript-helpers\"><code class=\"language-javascript\">hyperscript-helpers</code></a>\uff0c\u9019\u4e9b\u5c08\u6848\u63d0\u4f9b\u4e86\u66f4\u70ba\u7c21\u6f54\u7684\u8a9e\u6cd5\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/react-without-jsx.md\">Edit this page</a></p></div></article>", "path": "/react/react-without-jsx", "nav": ["/react/react-without-es6", "/react/reconciliation"]}, {"key": "Reconciliation", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React \u63d0\u4f9b\u8072\u660e\u5f0f (declarative) \u7684 API\uff0c\u8b93\u958b\u767c\u8005\u5728\u4f7f\u7528 React \u6642\uff0c\u53ef\u4ee5\u4e0d\u7528\u95dc\u6ce8\u6bcf\u6b21 Component \u66f4\u65b0\u6642\u5e95\u5c64\u6709\u4ec0\u9ebc\u6539\u8b8a\u3002\u9019\u8b93\u958b\u767c\u61c9\u7528\u7a0b\u5f0f\u7c21\u55ae\u8a31\u591a\uff0c\u4f46\u4e5f\u53ef\u80fd\u8b93\u958b\u767c\u8005\u5c0d React \u5e95\u5c64\u7684\u76f8\u95dc\u5be6\u4f5c\u4e0d\u5920\u77ad\u89e3\u3002\u56e0\u6b64\u5728\u9019\u7bc7\u6587\u7ae0\u4e2d\u63cf\u8ff0\u4e86\u5be6\u4f5c React \u5e95\u5c64\u4e2d\u300cdiffing\u300d\u6f14\u7b97\u6cd5\u6642\uff0c\u6211\u5011\u63a1\u53d6\u4ec0\u9ebc\u7b56\u7565\u8b93 component \u7684\u66f4\u65b0\u662f\u53ef\u9810\u6e2c\u7684\uff0c\u540c\u6642\u53ef\u4ee5\u6eff\u8db3\u8981\u6c42\u9ad8\u6548\u80fd\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<h2 id=\"motivation\"><a class=\"anchor\" href=\"/react/reconciliation#motivation\"></a>\u52d5\u6a5f </h2>\n<p>\u5728\u4f7f\u7528 React \u6642\uff0c\u6bcf\u6b21\u547c\u53eb <code class=\"language-javascript\">render()</code> \u51fd\u5f0f\uff0c\u6211\u5011\u90fd\u53ef\u4ee5\u7576\u6210\u662f\u5efa\u7acb\u4e86\u4e00\u9846\u7531 React element \u69cb\u6210\u7684\u6a39\u72c0\u7d50\u69cb\u3002\u800c\u5728\u6bcf\u4e00\u6b21\u6709 state \u6216 props \u66f4\u65b0\u6642\uff0c<code class=\"language-javascript\">render()</code> \u51fd\u5f0f\u5c31\u6703\u56de\u50b3\u4e00\u9846\u4e0d\u540c\u7684 tree\u3002\u56e0\u6b64\uff0cReact \u9700\u8981\u5224\u65b7\u5982\u4f55\u6709\u6548\u7387\u7684\u628a UI \u5f9e\u820a\u7684 tree \u66f4\u65b0\u6210\u65b0\u7684 tree\u3002</p>\n<p>\u5c0d\u65bc\u9019\u500b\u300c\u5982\u4f55\u7528\u6700\u5c11\u64cd\u4f5c\u53bb\u5c07\u820a\u7684 tree \u8f49\u63db\u6210\u65b0\u7684 tree\u300d\u7684\u6f14\u7b97\u6cd5\u554f\u984c\u6709\u4e00\u4e9b\u901a\u7528\u7684\u89e3\u6cd5\uff0c\u4f46\u5373\u4f7f\u662f\u76ee\u524d<a class=\"external-link\" href=\"https://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf\">\u6700\u5148\u9032\u7684\u6f14\u7b97\u6cd5</a>\u90fd\u9084\u9700\u8981 O(n<sup>3</sup>) \u7684\u6642\u9593\u8907\u96dc\u5ea6\uff08n \u70ba tree \u4e2d element \u7684\u6578\u91cf\uff09\u3002</p>\n<p>\u5047\u8a2d React \u4f7f\u7528\u9019\u7a2e\u6f14\u7b97\u6cd5\uff0c\u5247\u5448\u73fe 1000 \u500b element \u9700\u8981 10 \u5104\u6b21\u7684\u6bd4\u8f03\u3002\u56e0\u70ba\u9019\u500b\u6bd4\u8f03\u6210\u672c\u5be6\u5728\u592a\u9ad8\uff0c\u6240\u4ee5 React \u5728\u4ee5\u4e0b\u5169\u500b\u5047\u8a2d\u4e0b\u63a1\u7528\u4e86\u4e00\u500b O(n) \u7684\u5553\u767c\u5f0f (heuristic) \u6f14\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u5169\u500b\u4e0d\u540c\u985e\u578b\u7684 element \u6703\u7522\u751f\u51fa\u4e0d\u540c\u7684 tree</li>\n<li>\u958b\u767c\u8005\u53ef\u4ee5\u901a\u904e <code class=\"language-javascript\">key</code> prop \u4f86\u6307\u51fa\u54ea\u4e9b\u5b50 element \u5728\u4e0d\u540c\u7684 render \u4e0b\u80fd\u4fdd\u6301\u4e0d\u8b8a\uff1b</li>\n</ol>\n<p>\u800c\u4e8b\u5be6\u4e0a\uff0c\u4ee5\u4e0a\u5047\u8a2d\u5728\u5e7e\u4e4e\u6240\u6709\u5be6\u52d9\u4e0a\u6703\u51fa\u73fe\u7684\u5834\u666f\u90fd\u6210\u7acb\u3002</p>\n<h2 id=\"the-diffing-algorithm\"><a class=\"anchor\" href=\"/react/reconciliation#the-diffing-algorithm\"></a>Diffing \u6f14\u7b97\u6cd5 </h2>\n<p>\u7576\u6bd4\u5c0d\u5169\u9846 tree \u6642\uff0cReact \u9996\u5148\u6bd4\u8f03\u5169\u68f5 tree \u7684 root element\u3002\u4e0d\u540c\u985e\u578b\u7684 root element \u6703\u6709\u4e0d\u540c\u7684\u8655\u7406\u65b9\u5f0f\u3002</p>\n<h3 id=\"elements-of-different-types\"><a class=\"anchor\" href=\"/react/reconciliation#elements-of-different-types\"></a>\u6bd4\u5c0d\u4e0d\u540c\u985e\u578b\u7684 Element </h3>\n<p>\u7576\u6bd4\u5c0d\u7684\u5169\u500b root element \u70ba\u4e0d\u540c\u985e\u578b\u7684\u5143\u7d20\u6642\uff0cReact \u6703\u5c07\u539f\u6709\u7684 tree \u6574\u9846\u62c6\u6389\u4e26\u4e14\u91cd\u65b0\u5efa\u7acb\u8d77\u65b0\u7684 tree\u3002\u4f8b\u5982\uff0c\u7576\u4e00\u500b\u5143\u7d20\u5f9e <code class=\"language-javascript\">&lt;a&gt;</code> \u8b8a\u6210 <code class=\"language-javascript\">&lt;img&gt;</code>\u3001\u5f9e <code class=\"language-javascript\">&lt;Article&gt;</code> \u8b8a\u6210 <code class=\"language-javascript\">&lt;Comment&gt;</code>\u3001\u6216\u5f9e <code class=\"language-javascript\">&lt;Button&gt;</code> \u8b8a\u6210 <code class=\"language-javascript\">&lt;div&gt;</code> \u6642\uff0c\u90fd\u6703\u89f8\u767c\u4e00\u500b\u5b8c\u6574\u7684\u91cd\u5efa\u6d41\u7a0b\u3002</p>\n<p>\u7576\u62c6\u6389\u4e00\u9846 tree \u6642\uff0c\u820a\u7684 DOM \u7bc0\u9ede\u6703\u88ab\u92b7\u6bc0\uff0c\u4e14\u8a72 component instance \u6703\u57f7\u884c <code class=\"language-javascript\">componentWillUnmount()</code> \u51fd\u5f0f\u3002\u7576\u5efa\u7acb\u4e00\u9846\u65b0\u7684 tree \u6642\uff0c\u65b0\u5efa\u7acb\u7684 DOM \u7bc0\u9ede\u6703\u88ab\u63d2\u5165\u5230 DOM \u4e2d\uff0c\u4e14\u8a72 component instance \u6703\u4f9d\u6b21\u57f7\u884c <code class=\"language-javascript\">UNSAFE_componentWillMount()</code> \u8207 <code class=\"language-javascript\">componentDidMount()</code> \u65b9\u6cd5\u3002\u800c\u6240\u6709\u8ddf\u4e4b\u524d\u820a\u7684 tree \u6240\u95dc\u806f\u7684 state \u4e5f\u6703\u88ab\u92b7\u6bc0\u3002</p>\n<p>\u4efb\u4f55\u5728 root \u4ee5\u4e0b\u7684 component \u4e5f\u6703\u88ab unmount\uff0c\u5b83\u5011\u7684\u72c0\u614b\u6703\u88ab\u92b7\u6bc0\u3002\u4f8b\u5982\uff0c\u7576\u6bd4\u5c0d\u4ee5\u4e0b\u8b8a\u66f4\u6642\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Counter</span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Counter</span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>React \u6703 destroy \u820a\u7684 <code class=\"language-javascript\">Counter</code> \u4e26\u4e14\u91cd\u65b0\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u3002</p>\n<div class=\"blockquote\">\n<strong>\u7b46\u8a18\uff1a</strong>\n<p>\u9019\u500b\u65b9\u6cd5\u5df2\u7d93\u88ab\u8a8d\u70ba\u5df2\u904e\u6642\uff0c\u4f60\u5728\u5beb\u65b0\u7a0b\u5f0f\u61c9<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u907f\u514d\u4f7f\u7528\u4ed6\u5011</a>\uff1a</p>\n<ul>\n<li><code class=\"language-javascript\">UNSAFE_componentWillMount()</code></li>\n</ul>\n</div>\n<h3 id=\"dom-elements-of-the-same-type\"><a class=\"anchor\" href=\"/react/reconciliation#dom-elements-of-the-same-type\"></a>\u6bd4\u5c0d\u540c\u4e00\u985e\u578b\u7684 DOM Element </h3>\n<p>\u7576\u6bd4\u5c0d\u5169\u500b\u76f8\u540c\u985e\u578b\u7684 React element \u6642\uff0cReact \u6703\u4fdd\u7559 DOM \u7bc0\u9ede\uff0c\u53ea\u6bd4\u5c0d\u53ca\u66f4\u65b0\u6709\u6539\u8b8a\u7684 attribute\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>before<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stuff<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>after<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stuff<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u900f\u904e\u6bd4\u5c0d\u9019\u5169\u500b element\uff0cReact \u77e5\u9053\u53ea\u9700\u8981\u4fee\u6539 DOM \u7bc0\u9ede\u4e0a\u7684 className\u3002</p>\n<p>\u7576\u66f4\u65b0 <code class=\"language-javascript\">style</code> \u6642\uff0cReact \u50c5\u66f4\u65b0\u6709\u6240\u66f4\u8b8a\u7684\u5c6c\u6027\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{{color:</span> <span class=\"token attr-name\">'red',</span> <span class=\"token attr-name\"><span class=\"token namespace\">fontWeight:</span></span> <span class=\"token attr-name\">'bold'}}</span> <span class=\"token punctuation\">/&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{{color:</span> <span class=\"token attr-name\">'green',</span> <span class=\"token attr-name\"><span class=\"token namespace\">fontWeight:</span></span> <span class=\"token attr-name\">'bold'}}</span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u900f\u904e\u6bd4\u5c0d\u9019\u5169\u500b element\uff0cReact \u77e5\u9053\u53ea\u9700\u8981\u4fee\u6539 <code class=\"language-javascript\">color</code> \u7684\u6a23\u5f0f\uff0c\u800c\u4e0d\u9700\u4fee\u6539 <code class=\"language-javascript\">fontWeight\u3002</code></p>\n<p>\u5728\u8655\u7406\u5b8c\u76ee\u524d\u7bc0\u9ede\u4e4b\u5f8c\uff0cReact \u6703\u7e7c\u7e8c\u5c0d children \u9032\u884c\u905e\u8ff4\u8655\u7406\u3002</p>\n<h3 id=\"component-elements-of-the-same-type\"><a class=\"anchor\" href=\"/react/reconciliation#component-elements-of-the-same-type\"></a>\u6bd4\u5c0d\u540c\u985e\u578b\u7684 Component Element </h3>\n<p>\u7576\u4e00\u500b component \u66f4\u65b0\u6642\uff0c\u8a72 component \u7684 instance \u4fdd\u6301\u4e0d\u8b8a\uff0c\u9019\u6a23 state \u80fd\u5920\u88ab\u4fdd\u7559\u5728\u4e0d\u540c\u6b21\u7684 render \u4e2d\u3002React \u6703\u66f4\u65b0\u8a72 component instance \u7684 props \u4ee5\u8ddf\u6700\u65b0\u7684 element \u4fdd\u6301\u4e00\u81f4\uff0c\u4e26\u4e14\u547c\u53eb\u8a72 instance \u7684 <code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code> \u3001 <code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code> \u548c <code class=\"language-javascript\">componentDidUpdate()</code> \u65b9\u6cd5\u3002</p>\n<p>\u63a5\u4e0b\u4f86\uff0c\u8a72 instance \u6703\u518d\u547c\u53eb <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\uff0c\u800c diff \u7b97\u6cd5\u5c07\u6703\u905e\u8ff4\u8655\u7406\u820a\u7684\u7d50\u679c\u4ee5\u53ca\u65b0\u7684\u7d50\u679c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u7b46\u8a18\uff1a</strong>\n<p>\u4e0b\u5217\u65b9\u6cd5\u5df2\u904e\u6642\uff0c\u4f60\u5728\u5beb\u65b0\u7a0b\u5f0f\u61c9<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u907f\u514d\u4f7f\u7528\u4ed6\u5011</a>\uff1a</p>\n<ul>\n<li><code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code></li>\n<li><code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code></li>\n</ul>\n</div>\n<h3 id=\"recursing-on-children\"><a class=\"anchor\" href=\"/react/reconciliation#recursing-on-children\"></a>\u5c0d Children \u9032\u884c\u905e\u8ff4\u8655\u7406 </h3>\n<p>\u5728\u9810\u8a2d\u689d\u4ef6\u4e0b\uff0c\u7576\u905e\u8ff4\u8655\u7406 DOM \u7bc0\u9ede\u7684 children \u6642\uff0cReact \u53ea\u6703\u540c\u6642\u904d\u6b77\u5169\u500b children \u7684 array\uff0c\u4e26\u5728\u767c\u73fe\u5dee\u7570\u6642\uff0c\u7522\u751f\u4e00\u500b mutation\u3002</p>\n<p>\u4f8b\u5982\uff0c\u7576\u5728 children \u7684 array \u5c3e\u7aef\u65b0\u589e\u4e00\u500b element \u6642\uff0c\u5728\u9019\u5169\u500b tree \u4e4b\u9593\u7684\u8f49\u63db\u6548\u679c\u5f88\u597d\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>first<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>second<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>first<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>second<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>third<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>React \u6703\u5148\u5339\u914d\u5169\u500b <code class=\"language-javascript\">&lt;li&gt;first&lt;/li&gt;</code> \u5c0d\u61c9\u7684 tree\uff0c\u7136\u5f8c\u5339\u914d\u7b2c\u4e8c\u500b\u5143\u7d20 <code class=\"language-javascript\">&lt;li&gt;second&lt;/li&gt;</code> \u5c0d\u61c9\u7684 tree\uff0c\u6700\u5f8c\u63d2\u5165\u7b2c\u4e09\u500b\u5143\u7d20 <code class=\"language-javascript\">&lt;li&gt;third&lt;/li&gt;</code> \u7684 tree\u3002</p>\n<p>\u5982\u679c\u53ea\u662f\u55ae\u7d14\u7684\u5be6\u4f5c\uff0c\u5247\u5728 array \u958b\u982d\u63d2\u5165\u65b0\u5143\u7d20\u6703\u8b93\u6548\u80fd\u8b8a\u5dee\u3002\u4f8b\u5982\uff0c\u5728\u5169\u500b tree \u4e4b\u9593\u7684\u8f49\u63db\u6548\u679c\u5f88\u5dee\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Duke<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Villanova<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Connecticut<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Duke<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">&gt;</span></span>Villanova<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u9019\u500b\u60c5\u6cc1\u4e0b\uff0cReact \u6703\u91dd\u5c0d\u6bcf\u500b child \u90fd\u9032\u884c mutate\uff0c\u800c\u4e0d\u662f\u8b93\u5169\u500b\u76f8\u540c\u7684 <code class=\"language-javascript\">&lt;li&gt;Duke&lt;/li&gt;</code> \u548c <code class=\"language-javascript\">&lt;li&gt;Villanova&lt;/li&gt;</code> subtree \u4e0d\u53c3\u8207 mutate\u3002\u9019\u7a2e\u4f4e\u6548\u7387\u7684\u60c5\u6cc1\u4e0b\u53ef\u80fd\u6703\u5e36\u4f86\u6548\u80fd\u554f\u984c\u3002</p>\n<p><strong>Keys</strong></p>\n<p>\u70ba\u4e86\u89e3\u6c7a\u4ee5\u4e0a\u554f\u984c\uff0cReact \u63d0\u4f9b\u4e86 key \u5c6c\u6027\u3002\u7576 children \u64c1\u6709 <code class=\"language-javascript\">key</code> \u5c6c\u6027\u6642\uff0cReact \u4f7f\u7528 key \u4f86\u5339\u914d\u539f\u6709 tree \u4e0a\u7684 children \u4ee5\u53ca\u5f8c\u7e8c tree \u7684 children\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u7bc4\u4f8b\u5728\u65b0\u589e <code class=\"language-javascript\">key</code> \u5c6c\u6027\u4e4b\u5f8c\uff0c\u53ef\u4ee5\u6539\u5584\u5728\u4e0a\u500b\u4f8b\u5b50\u4e2d\u767c\u751f\u7684\u6548\u80fd\u554f\u984c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-xml\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2015<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Duke<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2016<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Villanova<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2014<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connecticut<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2015<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Duke<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2016<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Villanova<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u73fe\u5728 React \u77e5\u9053\u53ea\u6709\u5e36\u8457 <code class=\"language-javascript\">'2014'</code> key \u7684 element \u662f\u65b0\u7684\uff0c\u800c\u5e36\u8457 <code class=\"language-javascript\">'2015'</code> \u4ee5\u53ca <code class=\"language-javascript\">'2016'</code> key \u7684 element \u53ea\u662f\u76f8\u5c0d\u4f4d\u7f6e\u79fb\u52d5\u4e86\u3002</p>\n<p>\u5be6\u969b\u4e0a\uff0c\u627e\u51fa\u4e00\u500b key \u901a\u5e38\u4e26\u4e0d\u56f0\u96e3\u3002\u4f60\u8981\u986f\u793a\u7684 element \u53ef\u80fd\u5df2\u7d93\u5177\u6709\u552f\u4e00\u7684 ID \u4e86\uff0c\u9019\u500b key \u53ef\u80fd\u662f\u4f86\u81ea\u65bc\u4f60\u7684\u8cc7\u6599\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u7576\u4ee5\u4e0a\u60c5\u6cc1\u4e0d\u6210\u7acb\u6642\uff0c\u4f60\u53ef\u4ee5\u65b0\u589e\u4e00\u500b ID \u5b57\u4e32\u5230\u4f60\u7684 Model \u4e2d\uff0c\u6216\u8005\u5229\u7528\u4e00\u90e8\u5206\u5167\u5bb9\u4f5c\u70ba hash \u4f86\u7522\u751f\u4e00\u500b key\u3002\u9019\u500b key \u4e0d\u9700\u8981\u662f\u5168\u57df\u552f\u4e00\uff0c\u4f46\u5728 array \u4e2d\u9700\u8981\u4fdd\u6301\u552f\u4e00\u3002</p>\n<p>\u6700\u5f8c\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5143\u7d20\u5728 array \u4e2d\u7684\u7d22\u5f15\u503c\u4f5c\u70ba key\u3002\u9019\u500b\u65b9\u6cd5\u5728\u5143\u7d20\u4e0d\u9032\u884c\u91cd\u65b0\u6392\u5e8f\u6642\u6bd4\u8f03\u5408\u9069\uff0c\u4f46\u5982\u679c\u6709\u9806\u5e8f\u4fee\u6539\uff0cdiff \u5c31\u6703\u8b8a\u6162\u3002</p>\n<p>\u7576\u4f7f\u7528 array \u7d22\u5f15\u503c\u4f5c\u70ba key \u7684 component \u9032\u884c\u91cd\u65b0\u6392\u5e8f\u6642\uff0ccomponent state \u53ef\u80fd\u6703\u9047\u5230\u4e00\u4e9b\u554f\u984c\u3002\u7531\u65bc component instance \u662f\u57fa\u65bc\u5b83\u5011\u7684 key \u4f86\u6c7a\u5b9a\u662f\u5426\u66f4\u65b0\u4ee5\u53ca\u91cd\u8907\u4f7f\u7528\uff0c\u5982\u679c key \u662f\u4e00\u500b\u7d22\u5f15\u503c\uff0c\u90a3\u9ebc\u4fee\u6539\u9806\u5e8f\u6642\u6703\u4fee\u6539\u76ee\u524d\u7684 key\uff0c\u5c0e\u81f4 component \u7684 state\uff08\u4f8b\u5982\u4e0d\u53d7\u63a7\u5236\u8f38\u5165\u6846\uff09\u53ef\u80fd\u76f8\u4e92\u7be1\u6539\u5c0e\u81f4\u7121\u6cd5\u9810\u671f\u7684\u8b8a\u52d5\u3002</p>\n<p>\u4e0b\u9762\u662f\u4e00\u500b\u5728 Codepen \u4e0a\u7684\u7bc4\u4f8b\uff0c<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//redirect-to-codepen/reconciliation/index-used-as-key\">\u793a\u7bc4\u4f7f\u7528\u7d22\u5f15\u503c\u4f5c\u70ba key \u6642\u5c0e\u81f4\u7684\u554f\u984c</a>\uff0c\u4ee5\u53ca<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//redirect-to-codepen/reconciliation/no-index-used-as-key\">\u4e00\u500b\u4fee\u5fa9\u4e86\u91cd\u65b0\u6392\u5217\u3001\u6392\u5e8f\u3001\u4ee5\u53ca\u5728 array \u958b\u982d\u63d2\u5165\u7684\u554f\u984c\uff0c\u4e14\u4e0d\u4f7f\u7528\u7d22\u5f15\u503c\u4f5c\u70ba key \u7684\u7248\u672c</a>\u3002</p>\n<h2 id=\"tradeoffs\"><a class=\"anchor\" href=\"/react/reconciliation#tradeoffs\"></a>\u6b0a\u8861 </h2>\n<p>\u8acb\u8a18\u5f97 Reconciliation \u53ea\u662f\u4e00\u500b\u5be6\u4f5c\u7d30\u7bc0\uff0c\u5373\u4f7f React \u5728\u6bcf\u500b\u52d5\u4f5c\u5f8c\u4e4b\u5f8c\u5c0d\u6574\u500b\u61c9\u7528\u9032\u884c\u91cd\u65b0 render\uff0c\u5f97\u5230\u7684\u6700\u7d42\u7d50\u679c\u4e5f\u6703\u548c\u9032\u884c Reconciliation \u5f8c\u662f\u4e00\u6a23\u7684\u3002\u5728\u9019\u500b\u60c5\u5f62\u4e0b\uff0c\u91cd\u65b0 render \u8868\u793a\u5728\u6240\u6709 component \u5167\u547c\u53eb <code class=\"language-javascript\">render</code>\uff0c\u9019\u4e0d\u4ee3\u8868 React \u6703 unmount \u6216\u91cd\u65b0 mount \u5b83\u5011\u3002React \u53ea\u6703\u57fa\u65bc\u4ee5\u4e0a\u63d0\u5230\u7684\u898f\u5247\u4f86\u6c7a\u5b9a\u5982\u4f55\u9032\u884c\u5dee\u7570\u7684\u5408\u4f75\u3002</p>\n<p>\u6211\u5011\u6703\u5b9a\u671f\u6539\u5584\u555f\u767c\u5f0f\u6f14\u7b97\u6cd5\uff0c\u8b93\u5e38\u898b\u7684\u4f7f\u7528\u5834\u666f\u80fd\u5920\u66f4\u6709\u6548\u7387\u5730\u57f7\u884c\u3002\u5728\u76ee\u524d\u7684\u5be6\u4f5c\u4e2d\uff0c\u53ef\u4ee5\u7406\u89e3\u70ba\u4e00\u68f5 subtree \u80fd\u5728\u5176\u76f8\u540c\u968e\u5c64\u7684\u5144\u5f1f\u4e4b\u9593\u79fb\u52d5\uff0c\u4f46\u4e0d\u80fd\u79fb\u52d5\u5230\u5176\u4ed6\u4f4d\u7f6e\u3002\u5982\u679c\u79fb\u52d5\u5230\u5176\u4ed6\u4f4d\u7f6e\uff0c\u5247\u6f14\u7b97\u6cd5\u6703\u91cd\u65b0 render \u6574\u68f5 subtree\u3002</p>\n<p>\u7531\u65bc React \u4f9d\u8cf4\u5553\u767c\u5f0f\u7684\u6f14\u7b97\u6cd5\uff0c\u56e0\u6b64\u7576\u4ee5\u4e0b\u5047\u8a2d\u6c92\u6709\u5f97\u5230\u6eff\u8db3\uff0c\u6548\u80fd\u5c07\u6703\u6709\u6240\u5f71\u97ff\u3002</p>\n<ol>\n<li>\u8a72\u6f14\u7b97\u6cd5\u4e0d\u6703\u5617\u8a66\u5339\u914d\u4e0d\u540c component \u985e\u578b\u7684 subtree\u3002\u5982\u679c\u4f60\u767c\u73fe\u4f60\u5728\u5169\u7a2e\u4e0d\u540c\u985e\u578b\u7684 component \u4e2d\u5207\u63db\uff0c\u4f46\u8f38\u51fa\u975e\u5e38\u76f8\u4f3c\u7684\u5167\u5bb9\uff0c\u5efa\u8b70\u628a\u5b83\u5011\u6539\u6210\u540c\u4e00\u985e\u578b\u3002\u5be6\u969b\u4e0a\uff0c\u6211\u5011\u6c92\u6709\u767c\u73fe\u5728\u6539\u6210\u540c\u4e00\u7a2e\u985e\u578b\u5f8c\u6703\u767c\u751f\u554f\u984c\u3002</li>\n<li>Key \u61c9\u8a72\u5177\u6709\u7a69\u5b9a\u3001\u53ef\u9810\u6e2c\u3001\u4ee5\u53ca array \u5167\u552f\u4e00\u7684\u7279\u8cea\u3002\u4e0d\u7a69\u5b9a\u7684 key\uff08\u4f8b\u5982\u900f\u904e <code class=\"language-javascript\">Math.random()</code> \u96a8\u6a5f\u751f\u6210\u7684\uff09\u6703\u5c0e\u81f4\u8a31\u591a component instance \u548c DOM \u7bc0\u9ede\u88ab\u4e0d\u5fc5\u8981\u5730\u91cd\u65b0\u5efa\u7acb\uff0c\u9019\u53ef\u80fd\u5c0e\u81f4\u6548\u80fd\u4f4e\u4e0b\u548c child component \u4e2d\u7684 state \u4e1f\u5931\u3002</li>\n</ol></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reconciliation.md\">Edit this page</a></p></div></article>", "path": "/react/reconciliation", "nav": ["/react/react-without-jsx", "/react/refs-and-the-dom"]}, {"key": "Refs \u548c DOM", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Ref \u63d0\u4f9b\u4e86\u4e00\u7a2e\u53ef\u4ee5\u53d6\u5f97 DOM \u7bc0\u9ede\u6216\u5728 render \u65b9\u6cd5\u5167\u5efa\u7acb React element \u7684\u65b9\u5f0f\u3002</p>\n<p>\u5728\u5178\u578b\u7684 React \u8cc7\u6599\u6d41\u88e1\uff0c<a href=\"/react/components-and-props\">props</a> \u662f parent component \u548c child component \u552f\u4e00\u7684\u4e92\u52d5\u65b9\u5f0f\u3002\u4f60\u6703\u85c9\u7531\u4f7f\u7528\u65b0\u7684 prop \u91cd\u65b0 render \u4f86\u6539\u8b8a\u4f60\u7684 child\u3002\u7136\u800c\uff0c\u6709\u4e9b\u60c5\u6cc1\u4e0b\u4f60\u9700\u8981\u5728\u5178\u578b\u7684\u8cc7\u6599\u6d41\u4ee5\u5916\u66f4\u6539\u4f60\u7684 child\u3002\u9019\u500b\u88ab\u66f4\u6539\u7684 child \u53ef\u80fd\u662f React component \u7684\u5176\u4e2d\u4e00\u500b instance\uff0c\u6216\u4ed6\u53ef\u80fd\u662f\u500b DOM element\u3002\u5728\u9019\u5169\u7a2e\u60c5\u6cc1\u4e0b\uff0cReact \u63d0\u4f9b\u4e86\u300c\u9003\u751f\u53e3\u300d\u3002</p>\n<h3 id=\"when-to-use-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#when-to-use-refs\"></a>\u4ec0\u9ebc\u6642\u5019\u8a72\u4f7f\u7528 Ref </h3>\n<p>\u6709\u5e7e\u7a2e\u9069\u5408\u4f7f\u7528 ref \u7684\u60c5\u6cc1\uff1a</p>\n<ul>\n<li>\u7ba1\u7406 focus\u3001\u9078\u64c7\u6587\u5b57\u3001\u6216\u5f71\u97f3\u64ad\u653e\u3002</li>\n<li>\u89f8\u767c\u5373\u6642\u7684\u52d5\u756b\u3002</li>\n<li>\u8207\u7b2c\u4e09\u65b9 DOM \u51fd\u5f0f\u5eab\u6574\u5408\u3002</li>\n</ul>\n<p>\u907f\u514d\u5728\u4efb\u4f55\u53ef\u4ee5\u5ba3\u544a\u6027\u5b8c\u6210\u4e8b\u60c5\u7684\u5730\u65b9\u4f7f\u7528 ref\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4e0d\u8981\u628a <code class=\"language-javascript\">Dialog</code> component \u4e0a\u7684 <code class=\"language-javascript\">open()</code> \u548c <code class=\"language-javascript\">close()</code> \u5c0d\u5916\u516c\u958b\uff0c\u61c9\u8a72\u5c07 <code class=\"language-javascript\">isOpen</code> \u7684 prop \u50b3\u9032\u53bb\u3002</p>\n<h3 id=\"dont-overuse-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#dont-overuse-refs\"></a>\u4e0d\u8981\u904e\u5ea6\u4f7f\u7528 Ref </h3>\n<p>\u4f60\u4e00\u958b\u59cb\u53ef\u80fd\u6703\u50be\u5411\u65bc\u5728\u61c9\u7528\u7a0b\u5f0f\u88e1\u4f7f\u7528 ref\u300c\u8b93\u4e8b\u60c5\u767c\u751f\u300d\u3002\u5982\u679c\u9019\u662f\u4f60\u7684\u60c5\u5f62\uff0c\u82b1\u9ede\u6642\u9593\u8a8d\u771f\u601d\u8003\u4e00\u4e0b state \u61c9\u8a72\u5728\u54ea\u500b component \u7684\u5c64\u7d1a\u88ab\u6301\u6709\u3002\u901a\u5e38\u4f60\u6703\u6e05\u695a\u767c\u73fe\uff0c\u5728\u9ad8\u5c64\u7d1a\u7684\u5730\u65b9\u6301\u6709\u662f\u6bd4\u8f03\u5408\u9069\u7684\u4f4d\u7f6e\u3002\u8acb\u53c3\u95b1<a href=\"/react/lifting-state-up\">\u63d0\u5347 State</a>\u9019\u7bc7\u6307\u5357\u88e1\u9762\u7684\u7bc4\u4f8b\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u5df2\u7d93\u88ab\u66f4\u65b0\u70ba\u4f7f\u7528 React 16.3 \u6240\u5f15\u5165\u7684 <code class=\"language-javascript\">React.createRef()</code> API\u3002\u5982\u679c\u4f60\u662f\u5229\u7528\u6bd4\u8f03\u820a\u7248\u672c\u7684 React\uff0c\u6211\u5011\u63a8\u85a6\u4f7f\u7528 <a href=\"/react/refs-and-the-dom#callback-refs\">callback refs</a>\u3002</p>\n</div>\n<h3 id=\"creating-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#creating-refs\"></a>\u5efa\u7acb Ref </h3>\n<p>Ref \u662f\u85c9\u7531\u4f7f\u7528 <code class=\"language-javascript\">React.createRef()</code> \u6240\u7522\u751f\u7684\uff0c\u5b83\u85c9\u7531 <code class=\"language-javascript\">ref</code> \u53c3\u6578\u88ab\u4f9d\u9644\u5728 React element\u3002Ref \u5e38\u5e38\u6703\u5728\u4e00\u500b component \u88ab\u5efa\u7acb\u51fa\u4f86\u7684\u6642\u5019\uff0c\u88ab\u8ce6\u503c\u5728\u67d0\u500b instance \u5c6c\u6027\uff0c\u9019\u6a23\u4e00\u4f86\u4ed6\u5011\u5c31\u53ef\u4ee5\u5728\u6574\u500b component \u88e1\u9762\u88ab\u53c3\u8003\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myRef <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myRef<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"accessing-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#accessing-refs\"></a>\u5b58\u53d6 Ref </h3>\n<p>\u7576 ref \u5728 <code class=\"language-javascript\">render</code> \u88e1\u88ab\u50b3\u5230\u4e00\u500b element \u7684\u6642\u5019\uff0c\u4e00\u500b\u6307\u5411\u7bc0\u9ede\u5c0d ref \u7684 <code class=\"language-javascript\">current</code> \u53c3\u6578\u7684\u53c3\u8003\u6703\u8b8a\u5f97\u53ef\u4ee5\u53d6\u5f97\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ref \u7684\u503c\u6703\u6839\u64da\u7bc0\u9ede\u7684\u985e\u578b\u800c\u6709\u6240\u4e0d\u540c\uff1a</p>\n<ul>\n<li>\u7576\u5728 HTML element \u4e0a\u4f7f\u7528 <code class=\"language-javascript\">ref</code> \u53c3\u6578\u6642\uff0c\u4f7f\u7528 <code class=\"language-javascript\">React.createRef()</code> \u5efa\u7acb <code class=\"language-javascript\">ref</code> \u6703\u53d6\u5f97\u5b83\u5e95\u4e0b\u7684 DOM element \u4f86\u505a\u70ba\u5b83\u7684 <code class=\"language-javascript\">current</code> \u5c6c\u6027\u3002</li>\n<li>\u7576\u5728\u5ba2\u88fd\u5316\u7684 class component \u4f7f\u7528 <code class=\"language-javascript\">ref</code> \u53c3\u6578\u6642\uff0c<code class=\"language-javascript\">ref</code> \u53d6\u5f97\u88ab mount \u7684 component \u4e0a\u7684 instance \u4f86\u7576\u4f5c\u4ed6\u7684 <code class=\"language-javascript\">current</code>\u3002</li>\n<li><strong>\u4f60\u4e0d\u80fd\u5728 function component \u4e0a\u4f7f\u7528 <code class=\"language-javascript\">ref</code></strong>\uff0c\u56e0\u70ba\u4ed6\u5011\u6c92\u6709 instance\u3002</li>\n</ul>\n<p>\u4e0b\u9762\u7684\u7bc4\u4f8b\u793a\u7bc4\u4e86\u5dee\u7570\u3002</p>\n<h4 id=\"adding-a-ref-to-a-dom-element\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#adding-a-ref-to-a-dom-element\"></a>\u5728 DOM Element \u52a0\u4e0a Ref </h4>\n<p>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u5229\u7528 <code class=\"language-javascript\">ref</code> \u4f86\u5132\u5b58\u5c0d\u65bc DOM \u7bc0\u9ede\u7684\u53c3\u8003\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomTextInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// \u7522\u751f\u4e00\u500b\u53ef\u4ee5\u5132\u5b58 textInput DOM element \u7684 ref</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>focusTextInput <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">focusTextInput</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">focusTextInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u7279\u5225\u5229\u7528\u539f\u751f\u7684 DOM API \u4f86\u95dc\u6ce8\u6587\u5b57\u7684\u8f38\u5165</span>\n    <span class=\"token comment\">// \u6ce8\u610f\uff1a\u6211\u5011\u6b63\u5229\u7528\u300ccurrent\u300d\u4f86\u53d6\u5f97 DOM \u7bc0\u9ede</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u544a\u8a34 React \u6211\u5011\u60f3\u8981\u5c07 &lt;input&gt; ref</span>\n    <span class=\"token comment\">// \u548c\u6211\u5011\u5728 constructor \u7522\u751f\u7684 `textInput` \u9023\u7d50</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n          <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n          <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Focus the text input<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>focusTextInput<span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React \u6703\u5728 component mount \u7684\u6642\u5019\u5c07 DOM element \u8ce6\u503c\u5230 <code class=\"language-javascript\">current</code> \u5c6c\u6027\uff0c\u4e26\u5728 unmount \u6642\u5c07\u5b83\u6e05\u7a7a\u56de <code class=\"language-javascript\">null</code>\u3002<code class=\"language-javascript\">ref</code> \u7684\u66f4\u65b0\u767c\u751f\u5728\u751f\u547d\u9031\u671f <code class=\"language-javascript\">componentDidMount</code> \u6216 <code class=\"language-javascript\">componentDidUpdate</code> \u4e4b\u524d\u3002</p>\n<h4 id=\"adding-a-ref-to-a-class-component\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#adding-a-ref-to-a-class-component\"></a>\u5728 Class Component \u52a0\u4e0a Ref </h4>\n<p>\u5982\u679c\u6211\u5011\u60f3\u8981\u628a\u4e0a\u9762\u7684 <code class=\"language-javascript\">CustomTextInput</code> \u5305\u8d77\u4f86\u7136\u5f8c\u6a21\u64ec\u5b83\u5728\u88ab mount \u4e4b\u5f8c\u99ac\u4e0a\u88ab\u9ede\u64ca\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 ref \u4f86\u7372\u5f97\u5ba2\u88fd\u5316\u7684 input \u4f75\u624b\u52d5\u547c\u53eb\u4ed6\u7684 <code class=\"language-javascript\">focusTextInput</code> \u51fd\u5f0f\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AutoFocusTextInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focusTextInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomTextInput</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\u9019\u7a2e\u60c5\u6cc1\u53ea\u9069\u7528\u65bc\u5229\u7528 class \u4f86\u5ba3\u544a <code class=\"language-javascript\">CustomTextInput</code> \u7684\u60c5\u5f62\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomTextInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"refs-and-function-components\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#refs-and-function-components\"></a>Ref \u548c Function Component </h4>\n<p>\u9810\u8a2d\u4e0a\uff0c<strong>\u4f60\u4e0d\u80fd\u5728 function component \u4e0a\u4f7f\u7528 <code class=\"language-javascript\">ref</code></strong>\uff0c\u56e0\u70ba\u5b83\u5011\u6c92\u6709 instance\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">MyFunctionComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This will *not* work!</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyFunctionComponent</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u60f3\u8981\u8b93\u5176\u4ed6\u4eba\u5c07 <code class=\"language-javascript\">ref</code> \u5e36\u5230\u4f60\u7684 function component\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/forwarding-refs\"><code class=\"language-javascript\">forwardRef</code></a>\uff08\u53ef\u80fd\u8207 <a href=\"/react/hooks-reference#useimperativehandle\"><code class=\"language-javascript\">useImperativeHandle</code></a>\uff09\uff0c\u6216\u8005\u4f60\u53ef\u4ee5\u8f49\u63db\u6210 class component\u3002</p>\n<p>\u7136\u800c\uff0c\u53ea\u8981\u4f60\u60f3\u8981\u6307\u5230\u7684\u662f DOM element \u6216 class component\uff0c\u4f60\u4e5f\u53ef\u4ee5<strong>\u5728 function component \u88e1\u4f7f\u7528 <code class=\"language-javascript\">ref</code></strong>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">CustomTextInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5fc5\u9808\u5728\u9019\u88e1\u5ba3\u544a textInput \u4f7f ref \u53ef\u4ee5\u53c3\u8003\u5230\u5b83</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> textInput <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    textInput<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>textInput<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Focus the text input<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"exposing-dom-refs-to-parent-components\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#exposing-dom-refs-to-parent-components\"></a>\u5c0d Parent Component \u516c\u958b DOM \u7684 Ref </h3>\n<p>\u5728\u5f88\u5c11\u7684\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u8981\u5728 parent component \u53d6\u5f97 child \u7684 DOM \u7bc0\u9ede\u3002\u5728\u4e00\u822c\u7684\u60c5\u5f62\u4e0b\uff0c\u4e26\u4e0d\u5efa\u8b70\u9019\u9ebc\u505a\uff0c\u56e0\u70ba\u9019\u6703\u7834\u58de component \u7684\u5c01\u88dd\uff0c\u4f46\u6709\u6642\u5019\u9019\u9ebc\u505a\u5c0d\u65bc\u89f8\u767c focus \u6216\u6e2c\u91cf child \u7684 DOM \u7bc0\u9ede\u7684\u5927\u5c0f\u3001\u4f4d\u7f6e\u662f\u5f88\u6709\u7528\u7684\u3002</p>\n<p>\u96d6\u7136\u4f60\u53ef\u4ee5<a href=\"/react/refs-and-the-dom#adding-a-ref-to-a-class-component\">\u5728 child component \u65b0\u589e\u4e00\u500b ref</a>\uff0c\u4f46\u9019\u4e26\u4e0d\u662f\u7406\u60f3\u7684\u89e3\u6cd5\uff0c\u56e0\u70ba\u4f60\u53ea\u80fd\u62ff\u5230\u4e00\u500b component \u7684 instance \u800c\u4e0d\u662f\u4e00\u500b DOM \u7bc0\u9ede\u3002\u53e6\u5916\uff0c\u5728 function component \u88e1\u4e26\u4e0d\u9069\u7528\u3002</p>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u6bd4 React 16.3 \u9084\u65b0\u7684\u7248\u672c\uff0c\u5728\u9019\u7a2e\u60c5\u5f62\u4e0b\uff0c\u6211\u5011\u63a8\u85a6\u4f7f\u7528<a href=\"/react/forwarding-refs\">\u50b3\u9001 ref</a>\u3002<strong>\u50b3\u9001 Ref \u4f7f\u5f97 component \u80fd\u5920\u9078\u64c7\u8981\u4e0d\u8981\u628a child component \u7684 ref \u7576\u4f5c\u81ea\u5df1\u7684 ref</strong>\u3002\u4f60\u53ef\u4ee5\u5728<a href=\"/react/forwarding-refs#forwarding-refs-to-dom-components\">\u50b3\u9001 ref \u7684\u6587\u4ef6\u88e1</a>\u627e\u5230\u8a73\u7d30\u95dc\u65bc\u600e\u9ebc\u628a child \u7684 DOM \u7bc0\u9ede\u516c\u958b\u7d66 parent component \u7684\u7bc4\u4f8b\u3002</p>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u6bd4 React 16.2 \u9084\u820a\u7684\u7248\u672c\uff0c\u6216\u4f60\u9700\u8981\u6bd4\u50b3\u9001 ref \u7684\u65b9\u5f0f\u6709\u66f4\u591a\u7684\u5f48\u6027\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<a class=\"external-link\" href=\"https://gist.github.com/gaearon/1a018a023347fe1c2476073330cc5509\">\u9019\u500b\u4e0d\u540c\u7684\u65b9\u5f0f</a>\u4e26\u628a ref \u7576\u4f5c\u53e6\u500b\u6709\u540d\u5b57\u7684 prop \u4f86\u50b3\u9032\u53bb\u3002</p>\n<p>\u53ef\u80fd\u7684\u8a71\uff0c\u6211\u5011\u6703\u5efa\u8b70\u4e0d\u8981\u628a DOM \u7bc0\u9ede\u516c\u958b\uff0c\u4f46\u9019\u53ef\u80fd\u662f\u500b\u6709\u7528\u7684\u9003\u751f\u8259\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0c\u9019\u500b\u65b9\u5f0f\u9700\u8981\u4f60\u5728 child component \u65b0\u589e\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u3002\u5982\u679c\u4f60\u5c0d child component \u7684\u5be6\u4f5c\u5b8c\u5168\u7121\u6cd5\u63a7\u5236\uff0c\u4f60\u7684\u6700\u7d42\u9078\u64c7\u662f\u4f7f\u7528<a href=\"/react/react-dom#finddomnode\"><code class=\"language-javascript\">findDOMNode()</code></a>\uff0c\u4f46\u6211\u5011\u4e26\u4e0d\u5efa\u8b70\u4f7f\u7528\uff0c\u4e14\u5728 <a href=\"/react/strict-mode#warning-about-deprecated-finddomnode-usage\"><code class=\"language-javascript\">StrictMode</code></a> \u88e1\u4ed6\u6703\u88ab\u6dd8\u6c70\u6389\u3002</p>\n<h3 id=\"callback-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#callback-refs\"></a>Callback Refs </h3>\n<p>React \u4e5f\u652f\u63f4\u53e6\u4e00\u7a2e\u8a2d\u5b9a ref \u7684\u65b9\u5f0f\uff0c\u9019\u7a2e\u65b9\u6cd5\u53eb\u505a\u300ccallback refs\u300d\uff0c\u5b83\u63d0\u4f9b\u4e86\u5c0d ref \u7684\u8a2d\u5b9a\u4e0a\u66f4\u7d30\u7dfb\u7684\u63a7\u5236\u3002</p>\n<p>\u4e0d\u662f\u5c07 <code class=\"language-javascript\">createRef()</code> \u6240\u7522\u751f\u7684 <code class=\"language-javascript\">ref</code> \u50b3\u905e\u4e0b\u53bb\uff0c\u800c\u662f\u628a\u4e00\u500b function \u5f80\u4e0b\u50b3\u3002\u9019\u500b function \u6703\u5c07 React component \u7684 instance \u6216 HTML DOM \u4f5c\u70ba\u4ed6\u7684\u53c3\u6578\uff0c\u7136\u5f8c\u53ef\u4ee5\u88ab\u5132\u5b58\u4e4b\u5f8c\u5728\u5225\u7684\u5730\u65b9\u4f7f\u7528\u3002</p>\n<p>\u4e0b\u9762\u7684\u4f8b\u5b50\u5be6\u4f5c\u4e86\u4e00\u500b\u5e38\u898b\u7684\u6a21\u5f0f\uff1a\u5229\u7528 <code class=\"language-javascript\">ref</code> \u7684 callback \u4f86\u5132\u5b58\u4e00\u500b\u5728 instance \u5c6c\u6027\u88e1 DOM \u7bc0\u9ede\u7684\u53c3\u8003\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomTextInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">setTextInputRef</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">element</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput <span class=\"token operator\">=</span> element<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">focusTextInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u5229\u7528\u539f\u751f\u7684 DOM API \u4f86 focus \u6587\u5b57\u8f38\u5165</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u5728 mount \u7684\u6642\u5019\u81ea\u52d5 focus \u8f38\u5165</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">focusTextInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u5229\u7528 `ref` callback \u4f86\u5132\u5b58 instance \u6b04\u4f4d\u88e1\u6587\u5b57\u8f38\u5165 DOM \u7684\u53c3\u8003</span>\n    <span class=\"token comment\">// \uff08\u4f8b\u5982\uff1athis.textInput\uff09</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n          <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setTextInputRef<span class=\"token punctuation\">}</span></span></span>        <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n          <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Focus the text input<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>focusTextInput<span class=\"token punctuation\">}</span></span></span>        <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React \u6703\u5728 component \u5b89\u88dd\u6642\u7528 DOM element \u547c\u53eb <code class=\"language-javascript\">ref</code> callback\uff0c\u7136\u5f8c\u5728 unmount \u6642\u7528 <code class=\"language-javascript\">null</code> \u547c\u53eb\u4ed6\u3002Ref \u88ab\u4fdd\u8b49\u5728 <code class=\"language-javascript\">componentDidMount</code> \u6216 <code class=\"language-javascript\">componentDidUpdate</code> \u89f8\u767c\u6642\u80fd\u5920\u7dad\u6301\u5728\u6700\u65b0\u7684\u72c0\u614b\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u5c07 callback ref \u5728 component \u4e4b\u9593\u50b3\u905e\uff0c\u5c31\u50cf\u4f60\u53ef\u4ee5\u7528\u4e00\u6a23\u7684\u65b9\u5f0f\u5728 <code class=\"language-javascript\">React.createRef()</code> \u6240\u7522\u751f\u7684 object ref \u4e00\u6a23\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">CustomTextInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomTextInput</span></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token attr-name\">inputRef</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputElement <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span></span>      <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u88e1\uff0c<code class=\"language-javascript\">Parent</code> \u5c07\u4ed6\u7684 ref callback \u505a\u70ba\u4e00\u500b <code class=\"language-javascript\">inputRef</code> prop \u50b3\u5230 <code class=\"language-javascript\">CustomTextInput</code>\uff0c\u7136\u5f8c <code class=\"language-javascript\">CustomTextInput</code> \u5c07\u4e00\u6a23\u7684 function \u7576\u4f5c\u7279\u5225\u7684 <code class=\"language-javascript\">ref</code> \u5c6c\u6027\u4f86\u50b3\u7d66 <code class=\"language-javascript\">&lt;input&gt;</code>\u3002\u56e0\u6b64\uff0c\u5728 <code class=\"language-javascript\">Parent</code> \u7684 <code class=\"language-javascript\">this.inputElement</code> \u6703\u88ab\u8a2d\u70ba\u8207\u5728 <code class=\"language-javascript\">CustomTextInput</code> \u88e1 <code class=\"language-javascript\">&lt;input&gt;</code> element \u76f8\u95dc\u7684 DOM \u7bc0\u9ede\u3002</p>\n<h3 id=\"legacy-api-string-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#legacy-api-string-refs\"></a>Legacy API: String Refs </h3>\n<p>\u5982\u679c\u4f60\u4ee5\u524d\u5c31\u4f7f\u7528\u904e React\uff0c\u4f60\u53ef\u80fd\u5c0d\u4e00\u500b\u820a\u7684 API \u6709\u9ede\u719f\u6089\uff0c\u7576 <code class=\"language-javascript\">ref</code> \u5c6c\u6027\u662f\u5b57\u4e32\u7684\u6642\u5019\uff0c\u4f8b\u5982 <code class=\"language-javascript\">\"textInput\"</code>\uff0c\u7136\u5f8c DOM \u7bc0\u9ede\u88ab\u7576\u4f5c <code class=\"language-javascript\">this.refs.textInput</code> \u4f86\u53d6\u5f97\u3002\u6211\u5011\u4e0d\u5efa\u8b70\u4f7f\u7528\u5b83\uff0c\u56e0\u70ba string ref \u6709<a class=\"external-link\" href=\"https://github.com/facebook/react/pull/8333#issuecomment-271648615\">\u4e00\u4e9b\u554f\u984c</a>\uff0c\u6240\u4ee5\u4ed6\u88ab\u8996\u70ba legacy\uff0c\u4e14<strong>\u5f88\u6709\u53ef\u80fd\u6703\u5728\u672a\u4f86\u7684\u7248\u672c\u88ab\u79fb\u9664</strong>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528 <code class=\"language-javascript\">this.refs.textInput</code> \u4f86\u53d6\u5f97 ref\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a href=\"/react/refs-and-the-dom#callback-refs\">callback \u7684\u65b9\u5f0f</a>\u6216 <a href=\"/react/refs-and-the-dom#creating-refs\"><code class=\"language-javascript\">createRef</code> API</a>\u3002</p>\n</div>\n<h3 id=\"caveats-with-callback-refs\"><a class=\"anchor\" href=\"/react/refs-and-the-dom#caveats-with-callback-refs\"></a>\u5c0d callback ref \u7684\u8b66\u544a </h3>\n<p>\u5982\u679c <code class=\"language-javascript\">ref</code> callback \u662f\u88ab inline function \u6240\u5b9a\u7fa9\u7684\uff0c\u4ed6\u6703\u5728\u66f4\u65b0\u7684\u6642\u5019\u88ab\u547c\u53eb\u5169\u6b21\uff0c\u7b2c\u4e00\u6b21\u7528 <code class=\"language-javascript\">null</code> \u7136\u5f8c\u518d\u7528 DOM element \u547c\u53eb\u4e00\u6b21\u3002\u9019\u662f\u56e0\u70ba\u65b0\u7684 function \u7684 instance \u662f\u5728\u6bcf\u6b21 render \u7684\u6642\u5019\u88ab\u7522\u751f\uff0c\u6240\u4ee5 React \u9700\u8981\u5c07\u820a\u7684 ref \u6e05\u6389\u7136\u5f8c\u8a2d\u5b9a\u65b0\u7684\u3002\u4f60\u53ef\u4ee5\u85c9\u7531\u5b9a\u7fa9 <code class=\"language-javascript\">ref</code> callback \u70ba class \u4e0a\u7684\u4e00\u500b bound method \u4f86\u907f\u514d\u9019\u7a2e\u60c5\u5f62\uff0c\u4f46\u5728\u5927\u591a\u60c5\u6cc1\u4e0b\u4ed6\u4e26\u6c92\u6709\u4efb\u4f55\u5f71\u97ff\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/refs-and-the-dom.md\">Edit this page</a></p></div></article>", "path": "/react/refs-and-the-dom", "nav": ["/react/reconciliation", "/react/render-props"]}, {"key": "Render Props", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><a class=\"external-link\" href=\"https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce\">\u300crender prop\u300d</a>\u9019\u500b\u8a5e\u6307\u7684\u662f\u4e00\u7a2e\u7528\u4e00\u500b\u5176\u503c\u70ba\u51fd\u5f0f\u7684 prop \u4f86\u5728 React component \u4e4b\u9593\u5171\u4eab\u7a0b\u5f0f\u78bc\u7684\u6280\u5de7\u3002</p>\n<p>\u4e00\u500b\u5e36\u6709 render prop \u7684 component \u4e0d\u6703\u57f7\u884c\u81ea\u5df1\u7684 render \u908f\u8f2f\uff0c\u800c\u6703\u63a5\u53d7\u4e00\u500b\u56de\u50b3 React element \u7684\u51fd\u5f0f\u4e26\u547c\u53eb\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DataProvider</span></span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u4f7f\u7528 render props \u7684\u51fd\u5f0f\u5eab\u5305\u542b <a class=\"external-link\" href=\"https://reacttraining.com/react-router/web/api/Route/render-func\">React Router</a>\u3001<a class=\"external-link\" href=\"https://github.com/paypal/downshift\">Downshift</a> \u548c <a class=\"external-link\" href=\"https://github.com/jaredpalmer/formik\">Formik</a>\u3002</p>\n<p>\u4ee5\u4e0b\u6211\u5011\u6703\u8a0e\u8ad6\u70ba\u4ec0\u9ebc render props \u5982\u6b64\u6709\u7528\uff0c\u4ee5\u53ca\u600e\u9ebc\u5be6\u4f5c\u81ea\u5df1\u7684 render props\u3002</p>\n<h2 id=\"use-render-props-for-cross-cutting-concerns\"><a class=\"anchor\" href=\"/react/render-props#use-render-props-for-cross-cutting-concerns\"></a>\u70ba\u6a6b\u5207\u95dc\u6ce8\u9ede\u4f7f\u7528 Render Props</h2>\n<p>Component \u662f React \u4e2d\u4e3b\u8981\u7684\u7a0b\u5f0f\u78bc\u91cd\u7528\u55ae\u4f4d\uff0c\u4f46\u5982\u4f55\u5c07\u4e00\u500b component \u6240\u5305\u542b\u7684 state \u6216\u884c\u70ba\u5171\u4eab\u7d66\u5176\u4ed6\u4e5f\u540c\u6a23\u9700\u8981\u9019\u4e9b\u72c0\u614b\u6216\u884c\u70ba\u7684 component \u4e26\u4e0d\u662f\u90a3\u9ebc\u76f4\u89c0\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4e0b\u9762\u9019\u500b component \u8ca0\u8cac\u5728\u4e00\u500b\u7db2\u9801\u61c9\u7528\u4e2d\u8ffd\u8e64\u6ed1\u9f20\u6e38\u6a19\u7684\u4f4d\u7f6e\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientY\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'100vh'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onMouseMove</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The current mouse position is (</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">}</span><span class=\"token plain-text\">)</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7576\u6e38\u6a19\u5728\u87a2\u5e55\u4e2d\u79fb\u52d5\u6642\uff0c\u9019\u500b component \u6703\u5728\u4e00\u500b <code class=\"language-javascript\">&lt;p&gt;</code> \u4e2d\u986f\u793a\u5b83\u7684 (x,y) \u5ea7\u6a19\u3002</p>\n<p>\u73fe\u5728\u554f\u984c\u4f86\u4e86\uff1a\u6211\u5011\u8a72\u5982\u4f55\u5728\u5176\u4ed6 component \u4e2d\u91cd\u7528\u9019\u500b\u884c\u70ba\u5462\uff1f\u63db\u53e5\u8a71\u8aaa\uff0c\u5982\u679c\u53e6\u4e00\u500b component \u9700\u8981\u77e5\u9053\u6e38\u6a19\u7684\u4f4d\u7f6e\uff0c\u6211\u5011\u80fd\u4e0d\u80fd\u5c07\u9019\u500b\u884c\u70ba\u5c01\u88dd\u8d77\u4f86\uff0c\u8b93\u5176\u4ed6\u7684 component \u80fd\u8f15\u9b06\u5730\u5171\u4eab\u5462\uff1f</p>\n<p>\u65e2\u7136 component \u662f React \u4e2d\u7a0b\u5f0f\u78bc\u57fa\u672c\u91cd\u7528\u55ae\u4f4d\uff0c\u6211\u5011\u4f86\u8a66\u8a66\u770b\u91cd\u69cb\u9019\u6bb5\u7a0b\u5f0f\u78bc\uff0c\u6539\u6210\u7528\u4e00\u500b <code class=\"language-javascript\">&lt;Mouse&gt;</code> component \u4f86\u5c01\u88dd\u9019\u4e9b\u9700\u8981\u5728\u5176\u4ed6\u5730\u65b9\u91cd\u7528\u7684\u884c\u70ba\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// &lt;Mouse&gt; component \u5c01\u88dd\u6211\u5011\u6240\u9700\u7684\u884c\u70ba...</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Mouse</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientY\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'100vh'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onMouseMove</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n\n        </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ...\u4f46\u6211\u5011\u5982\u4f55 render \u9664\u4e86 &lt;p&gt; \u4ee5\u5916\u7684\u6771\u897f\uff1f */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The current mouse position is (</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">}</span><span class=\"token plain-text\">)</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728 <code class=\"language-javascript\">&lt;Mouse&gt;</code> component \u5c01\u88dd\u4e86\u5168\u90e8\u8ddf\u76e3\u807d <code class=\"language-javascript\">mousemove</code> \u4e8b\u4ef6\u6709\u95dc\u7684\u884c\u70ba\uff0c\u4e5f\u5132\u5b58\u4e86\u6e38\u6a19\u7684 (x,y) \u4f4d\u7f6e\uff0c\u4f46\u5b83\u9084\u4e0d\u7b97\u771f\u7684\u53ef\u91cd\u7528\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u5047\u8a2d\u6211\u5011\u6709\u4e00\u500b <code class=\"language-javascript\">&lt;Cat&gt;</code> component \uff0c\u5b83\u6703\u5728\u87a2\u5e55\u4e2d render \u8ffd\u8457\u6ed1\u9f20\u8dd1\u7684\u8c93\u54aa\u5716\u7247\u3002\u6211\u5011\u53ef\u80fd\u6703\u7528\u4e00\u500b <code class=\"language-javascript\">&lt;Cat mouse={{ x, y }}&gt;</code> \u7684 prop \u4f86\u544a\u8a34\u9019\u500b component \u6ed1\u9f20\u7684\u5ea7\u6a19\uff0c\u5b83\u4fbf\u77e5\u9053\u8a72\u628a\u9019\u5f35\u5716\u7247\u653e\u5728\u87a2\u5e55\u4e2d\u4f55\u8655\u3002</p>\n<p>\u4f5c\u70ba\u7b2c\u4e00\u6b21\u5617\u8a66\uff0c\u4f60\u53ef\u80fd\u6703\u8a66\u8457\u628a <code class=\"language-javascript\">&lt;Cat&gt;</code> \u5f9e <em><code class=\"language-javascript\">&lt;Mouse&gt;</code>\u7684 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\u88e1\u9762</em> render \u51fa\u4f86\uff0c\u50cf\u9019\u6a23\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Cat</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> mouse <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>mouse<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/cat.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">position</span><span class=\"token operator\">:</span> <span class=\"token string\">'absolute'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> mouse<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> mouse<span class=\"token punctuation\">.</span>y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseWithCat</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientY\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'100vh'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onMouseMove</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n\n        </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/*\n          \u6211\u5011\u5927\u53ef\u4ee5\u5728\u9019\u88e1\u628a &lt;p&gt; \u63db\u6210 &lt;Cat&gt; ...\u4f46\u9019\u6a23\u6211\u5011\u5c31\u5fc5\u9808\u5728\u6bcf\u6b21\u7528\u5230\u5b83\u6642\uff0c\n          \u5275\u5efa\u53e6\u5916\u4e00\u500b &lt;MouseWithSomethingElse&gt; component\uff0c\n          \u6240\u4ee5 &lt;MouseWithCat&gt; \u7684\u53ef\u91cd\u7528\u6027\u9084\u4e0d\u5920\u3002\n        */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cat</span></span> <span class=\"token attr-name\">mouse</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MouseWithCat</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6b64\u65b9\u6cd5\u5728\u7279\u5b9a\u6848\u4f8b\u4e2d\u53ef\u884c\uff0c\u4f46\u6211\u5011\u9084\u672a\u80fd\u4ee5\u53ef\u91cd\u7528\u7684\u65b9\u6cd5\u628a\u9019\u500b\u884c\u70ba\u5c01\u88dd\u8d77\u4f86\u3002\u73fe\u5728\uff0c\u6bcf\u6b21\u5728\u4e0d\u540c\u6848\u4f8b\u4e2d\uff0c\u5982\u679c\u6211\u5011\u9700\u8981\u77e5\u9053\u6ed1\u9f20\u4f4d\u7f6e\uff0c\u4fbf\u5fc5\u9808\u53e6\u5916\u5275\u5efa\u4e00\u500b\u7279\u5b9a\u70ba\u8a72\u6848\u4f8b render \u67d0\u4e9b\u6771\u897f\u7684 component \uff08\u63db\u53e5\u8a71\u8aaa\uff0c\u5c31\u662f\u53e6\u4e00\u500b <code class=\"language-javascript\">&lt;MouseWithCat&gt;</code> \uff09</p>\n<p>\u9019\u5c31\u662f render prop \u767c\u63ee\u529f\u7528\u7684\u5730\u65b9\u4e86\uff1a\u6211\u5011\u63d0\u4f9b  <code class=\"language-javascript\">&lt;Mouse&gt;</code> \u4e00\u500b function prop --- render prop\uff0c\u8b93\u5b83\u80fd\u5920\u52d5\u614b\u6c7a\u5b9a\u8a72 render \u4ec0\u9ebc\uff0c\u800c\u4e0d\u662f\u628a <code class=\"language-javascript\">&lt;Cat&gt;</code> \u5beb\u6b7b\u5728 <code class=\"language-javascript\">&lt;Mouse&gt;</code> component \u88e1\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Cat</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> mouse <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>mouse<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/cat.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">position</span><span class=\"token operator\">:</span> <span class=\"token string\">'absolute'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> mouse<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> mouse<span class=\"token punctuation\">.</span>y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Mouse</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>clientY\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'100vh'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onMouseMove</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseMove<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n\n        </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/*\n          \u7528 `render` prop \u53bb\u52d5\u614b\u6c7a\u5b9a\u8a72 render \u4ec0\u9ebc\uff0c\u800c\u4e0d\u662f\u5c07 &lt;Mouse&gt; render \u7684\u6771\u897f\u975c\u614b\u8868\u793a\u51fa\u4f86\u3002\n        */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">mouse</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cat</span></span> <span class=\"token attr-name\">mouse</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\uff0c\u6211\u5011\u63d0\u4f9b\u4e00\u500b <code class=\"language-javascript\">render</code> prop \u7d66 <code class=\"language-javascript\">&lt;Mouse&gt;</code> \uff0c\u8b93\u5b83\u80fd\u5920\u52d5\u614b\u6c7a\u5b9a\u5b83\u8a72 render \u4ec0\u9ebc\uff0c\u800c\u4e0d\u662f\u70ba\u4e86\u4e00\u4e9b\u7279\u5b9a\u6848\u4f8b\uff0c\u53bb\u8907\u88fd <code class=\"language-javascript\">&lt;Mouse&gt;</code> component \u4e26\u5728\u5b83\u7684 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\u4e2d\u786c\u6027\u5beb\u5165\u67d0\u4e9b\u6771\u897f\u3002</p>\n<p>\u66f4\u5177\u9ad4\u5730\u8aaa\uff0c<strong>render prop \u662f\u4e00\u500b\u8b93 component \u77e5\u9053\u8a72 render \u4ec0\u9ebc\u7684 function prop\u3002</strong></p>\n<p>\u9019\u500b\u6280\u5de7\u8b93\u6211\u5011\u60f3\u5171\u4eab\u7684\u884c\u70ba\u8b8a\u5f97\u6975\u70ba\u53ef\u8f49\u79fb\u3002\u8981\u4f7f\u7528\u9019\u500b\u884c\u70ba\u6642\uff0c\u5c31 render \u4e00\u500b\u6709 <code class=\"language-javascript\">render</code> prop \u7684 <code class=\"language-javascript\">&lt;Mouse&gt;</code>\uff0c\u8b93 <code class=\"language-javascript\">render</code> prop \u4f86\u544a\u8a34 <code class=\"language-javascript\">&lt;Mouse&gt;</code> \u8a72\u7528\u73fe\u5728\u6e38\u6a19\u7684 (x,y) render \u4ec0\u9ebc\u3002</p>\n<p>\u95dc\u65bc render props \u4e00\u4ef6\u6709\u8da3\u7684\u4e8b\u662f\uff0c\u4f60\u53ef\u4ee5\u7528\u5305\u542b render prop \u7684\u666e\u901a component \u4f86\u5be6\u4f5c <a href=\"/react/higher-order-components\">higher-order component</a>\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5982\u679c\u4f60\u504f\u597d\u7528 <code class=\"language-javascript\">withMouse</code> HOC \u800c\u4e0d\u662f <code class=\"language-javascript\">&lt;Mouse&gt;</code> component \u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u8f15\u6613\u5730\u7528\u4e00\u500b\u666e\u901a\u7684 <code class=\"language-javascript\">&lt;Mouse&gt;</code> \u52a0\u4e0a render prop \u4f86\u5efa\u7acb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u5982\u679c\u4f60\u771f\u7684\u60f3\u7528 HOC \uff0c\u4f60\u53ef\u4ee5\u8f15\u6613\u5730\u7528\u4e00\u500b</span>\n<span class=\"token comment\">// \u6709 render prop \u7684\u666e\u901a component \u4f86\u5efa\u7acb\uff01</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">withMouse</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> React<span class=\"token punctuation\">.</span>Component <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">mouse</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Component</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">mouse</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u56e0\u6b64 render prop \u8b93\u5169\u7a2e\u6a21\u5f0f\u7686\u53ef\u4f7f\u7528\u3002</p>\n<h2 id=\"using-props-other-than-render\"><a class=\"anchor\" href=\"/react/render-props#using-props-other-than-render\"></a>\u4f7f\u7528 Props \u4ee3\u66ff <code class=\"language-javascript\">render</code> </h2>\n<p>\u8a18\u4f4f\uff0c\u53ea\u56e0\u70ba\u9019\u500b\u6a21\u5f0f\u7a31\u70ba \u300crender props\u300d\uff0c\u4e0d\u4ee3\u8868<em>\u4f60\u4e00\u5b9a\u8981\u7528\u4e00\u500b\u540d\u70ba <code class=\"language-javascript\">render</code> \u7684 prop\u4f86\u4f7f\u7528\u9019\u500b\u6a21\u5f0f</em>\u3002\u4e8b\u5be6\u4e0a\uff0c<a class=\"external-link\" href=\"https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce\"><em>\u4efb\u4f55</em>\u662f\u51fd\u5f0f\u4e14\u88ab component \u7528\u4f86\u8a8d\u77e5\u8a72 render \u4ec0\u9ebc\u7684 prop\uff0c\u90fd\u53eb\u505a \u300credner prop\u300d</a>\u3002</p>\n<p>\u96d6\u7136\u4e0a\u8ff0\u7bc4\u4f8b\u4f7f\u7528 <code class=\"language-javascript\">render</code>\uff0c\u6211\u5011\u53ef\u4ee5\u540c\u6a23\u8f15\u6613\u5730\u4f7f\u7528 <code class=\"language-javascript\">children</code> prop\uff01</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token attr-name\">children</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">mouse</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The mouse position is </span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, </span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u8a18\u5f97\uff0c<code class=\"language-javascript\">children</code> prop \u4e0d\u9700\u8981\u5728 JSX element \u7684\u5c6c\u6027\u5217\u8868\u4e2d\u8a3b\u660e\u3002\u4f60\u53ef\u4ee5\u76f4\u63a5\u628a\u5b83\u653e\u5728 element <em>\u88e1\u9762</em>\uff01</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">mouse</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The mouse position is </span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, </span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Mouse</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4f60\u6703\u770b\u5230\u9019\u500b\u6280\u5de7\u5728 <a class=\"external-link\" href=\"https://github.com/chenglou/react-motion\">react-motion</a> API \u4e2d\u88ab\u4f7f\u7528\u3002</p>\n<p>\u56e0\u70ba\u9019\u500b\u6280\u5de7\u6709\u4e00\u9ede\u4e0d\u5e38\u898b\uff0c\u5728\u8a2d\u8a08\u50cf\u9019\u6a23\u7684 API \u6642\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u5728 <code class=\"language-javascript\">propTypes</code> \u660e\u78ba\u5730\u628a <code class=\"language-javascript\">children</code> \u5b9a\u7fa9\u70ba\u4e00\u500b\u51fd\u5f0f\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">Mouse<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">.</span>isRequired\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"caveats\"><a class=\"anchor\" href=\"/react/render-props#caveats\"></a>\u8b66\u544a </h2>\n<h3 id=\"be-careful-when-using-render-props-with-reactpurecomponent\"><a class=\"anchor\" href=\"/react/render-props#be-careful-when-using-render-props-with-reactpurecomponent\"></a>\u6ce8\u610f\u7576 Render Props \u4f7f\u7528\u5728 React.PureComponent \u6642</h3>\n<p>\u5982\u679c\u4f60\u5728 <code class=\"language-javascript\">render</code> \u65b9\u6cd5\u4e2d\u5efa\u7acb\u51fd\u5f0f\uff0c\u4f7f\u7528 render prop \u6703\u8b93 <a href=\"/react/react-api#reactpurecomponent\"><code class=\"language-javascript\">React.PureComponent</code></a> \u5e36\u4f86\u7684\u597d\u8655\u4f5c\u5ee2\u3002\u9019\u662f\u56e0\u70ba\u5c0d\u65b0\u7684 props \u800c\u8a00\uff0cprop \u7684\u6dfa\u6bd4\u8f03\u6703\u6c38\u9060\u56de\u50b3 <code class=\"language-javascript\">false</code>\uff0c\u4e26\u4e14\u6bcf\u6b21 <code class=\"language-javascript\">render</code> \u90fd\u6703\u70ba render prop \u7522\u751f\u65b0\u7684\u503c\u3002</p>\n<p>\u4f8b\u5982\uff0c\u7e7c\u7e8c\u6211\u5011\u4e0a\u8ff0\u7684 <code class=\"language-javascript\">&lt;Mouse&gt;</code> component\uff0c\u5982\u679c <code class=\"language-javascript\">Mouse</code> \u7e7c\u627f <code class=\"language-javascript\">React.PureComponent</code> \u800c\u4e0d\u662f <code class=\"language-javascript\">React.Component</code> \u7684\u8a71\uff0c\u6211\u5011\u7684\u7bc4\u4f8b\u6703\u50cf\u9019\u6a23\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Mouse</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u5982\u4e0a\u8ff0\u5be6\u4f5c\u5167\u5bb9...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n\n        </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/*\n          \u9019\u5f88\u4e0d\u597d\uff01render prop \u7684\u503c\u5728\u6bcf\u6b21 render \u90fd\u6703\u4e0d\u4e00\u6a23\u3002\n        */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">mouse</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cat</span></span> <span class=\"token attr-name\">mouse</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u6bcf\u6b21 <code class=\"language-javascript\">&lt;MouseTracker&gt;</code> render \u6642\uff0c\u5b83\u6703\u7522\u751f\u4e00\u500b\u65b0\u7684\u51fd\u5f0f\uff0c\u4f5c\u70ba <code class=\"language-javascript\">&lt;Mouse render&gt;</code> prop \u7684\u503c\uff0c\u4fbf\u4f7f\u4e00\u958b\u59cb <code class=\"language-javascript\">&lt;Mouse&gt;</code> \u7e7c\u627f <code class=\"language-javascript\">React.PureComponent</code> \u7684\u6548\u679c\u4f5c\u5ee2\uff01</p>\n<p>\u70ba\u4e86\u907f\u958b\u9019\u500b\u554f\u984c\uff0c\u4f60\u6709\u6642\u5019\u53ef\u4ee5\u628a\u9019\u500b prop \u5b9a\u7fa9\u70ba\u4e00\u500b instance \u65b9\u6cd5\uff0c\u50cf\u662f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MouseTracker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// `this.renderTheCat` \u88ab\u5b9a\u7fa9\u6210\u4e00\u500b instance \u65b9\u6cd5</span>\n  <span class=\"token comment\">// \u7576\u6211\u5011\u5728 render \u4f7f\u7528\u5230\u6642\uff0c\u6703\u6c38\u9060\u6307\u5411*\u76f8\u540c\u7684*\u51fd\u5f0f</span>\n  <span class=\"token function\">renderTheCat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Cat</span></span> <span class=\"token attr-name\">mouse</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>mouse<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Move the mouse around!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Mouse</span></span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderTheCat<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u4e0d\u80fd\u628a prop \u5b9a\u7fa9\u6210\u975c\u614b\u7684\u6848\u4f8b\u4e2d\uff08\u4f8b\uff1a\u56e0\u70ba\u4f60\u9700\u8981\u5c01\u9589 component \u7684 props \u548c/\u6216 state\uff09\uff0c<code class=\"language-javascript\">&lt;Mouse&gt;</code> \u61c9\u6539\u70ba\u7e7c\u627f <code class=\"language-javascript\">React.Component</code>\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/render-props.md\">Edit this page</a></p></div></article>", "path": "/react/render-props", "nav": ["/react/refs-and-the-dom", "/react/static-type-checking"]}, {"key": "\u975c\u614b\u578b\u5225\u6aa2\u67e5", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Static type checkers like <a class=\"external-link\" href=\"https://flow.org/\">Flow</a> and <a class=\"external-link\" href=\"https://www.typescriptlang.org/\">TypeScript</a> identify certain types of problems before you even run your code. They can also improve developer workflow by adding features like auto-completion. For this reason, we recommend using Flow or TypeScript instead of <code class=\"language-javascript\">PropTypes</code> for larger code bases.</p>\n<h2 id=\"flow\"><a class=\"anchor\" href=\"/react/static-type-checking#flow\"></a>Flow </h2>\n<p><a class=\"external-link\" href=\"https://flow.org/\">Flow</a> is a static type checker for your JavaScript code. It is developed at Facebook and is often used with React. It lets you annotate the variables, functions, and React components with a special type syntax, and catch mistakes early. You can read an <a class=\"external-link\" href=\"https://flow.org/en/docs/getting-started/\">introduction to Flow</a> to learn its basics.</p>\n<p>To use Flow, you need to:</p>\n<ul>\n<li>Add Flow to your project as a dependency.</li>\n<li>Ensure that Flow syntax is stripped from the compiled code.</li>\n<li>Add type annotations and run Flow to check them.</li>\n</ul>\n<p>We will explain these steps below in detail.</p>\n<h3 id=\"adding-flow-to-a-project\"><a class=\"anchor\" href=\"/react/static-type-checking#adding-flow-to-a-project\"></a>Adding Flow to a Project </h3>\n<p>First, navigate to your project directory in the terminal. You will need to run the following command:</p>\n<p>If you use <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev flow-bin</code></pre></div>\n<p>If you use <a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev flow-bin</code></pre></div>\n<p>This command installs the latest version of Flow into your project.</p>\n<p>Now, add <code class=\"language-javascript\">flow</code> to the <code class=\"language-javascript\">\"scripts\"</code> section of your <code class=\"language-javascript\">package.json</code> to be able to use this from the terminal:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token string-property property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token string-property property\">\"flow\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"flow\"</span><span class=\"token punctuation\">,</span></span>    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Finally, run one of the following commands:</p>\n<p>If you use <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> run flow init</code></pre></div>\n<p>If you use <a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> run flow init</code></pre></div>\n<p>This command will create a Flow configuration file that you will need to commit.</p>\n<h3 id=\"stripping-flow-syntax-from-the-compiled-code\"><a class=\"anchor\" href=\"/react/static-type-checking#stripping-flow-syntax-from-the-compiled-code\"></a>Stripping Flow Syntax from the Compiled Code </h3>\n<p>Flow extends the JavaScript language with a special syntax for type annotations. However, browsers aren\u2019t aware of this syntax, so we need to make sure it doesn\u2019t end up in the compiled JavaScript bundle that is sent to the browser.</p>\n<p>The exact way to do this depends on the tools you use to compile JavaScript.</p>\n<h4 id=\"create-react-app\"><a class=\"anchor\" href=\"/react/static-type-checking#create-react-app\"></a>Create React App </h4>\n<p>If your project was set up using <a class=\"external-link\" href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a>, congratulations! The Flow annotations are already being stripped by default so you don\u2019t need to do anything else in this step.</p>\n<h4 id=\"babel\"><a class=\"anchor\" href=\"/react/static-type-checking#babel\"></a>Babel </h4>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>These instructions are <em>not</em> for Create React App users. Even though Create React App uses Babel under the hood, it is already configured to understand Flow. Only follow this step if you <em>don\u2019t</em> use Create React App.</p>\n</div>\n<p>If you manually configured Babel for your project, you will need to install a special preset for Flow.</p>\n<p>If you use Yarn, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev @babel/preset-flow</code></pre></div>\n<p>If you use npm, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev @babel/preset-flow</code></pre></div>\n<p>Then add the <code class=\"language-javascript\">flow</code> preset to your <a class=\"external-link\" href=\"https://babeljs.io/docs/usage/babelrc/\">Babel configuration</a>. For example, if you configure Babel through <code class=\"language-javascript\">.babelrc</code> file, it could look like this:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"presets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token string\">\"@babel/preset-flow\"</span><span class=\"token punctuation\">,</span></span>    <span class=\"token string\">\"react\"</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This will let you use the Flow syntax in your code.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Flow does not require the <code class=\"language-javascript\">react</code> preset, but they are often used together. Flow itself understands JSX syntax out of the box.</p>\n</div>\n<h4 id=\"other-build-setups\"><a class=\"anchor\" href=\"/react/static-type-checking#other-build-setups\"></a>Other Build Setups </h4>\n<p>If you don\u2019t use either Create React App or Babel, you can use <a class=\"external-link\" href=\"https://github.com/flowtype/flow-remove-types\">flow-remove-types</a> to strip the type annotations.</p>\n<h3 id=\"running-flow\"><a class=\"anchor\" href=\"/react/static-type-checking#running-flow\"></a>Running Flow </h3>\n<p>If you followed the instructions above, you should be able to run Flow for the first time.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> flow</code></pre></div>\n<p>If you use npm, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> run flow</code></pre></div>\n<p>You should see a message like:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">No errors!\n\u2728  Done in 0.17s.</code></pre></div>\n<h3 id=\"adding-flow-type-annotations\"><a class=\"anchor\" href=\"/react/static-type-checking#adding-flow-type-annotations\"></a>Adding Flow Type Annotations </h3>\n<p>By default, Flow only checks the files that include this annotation:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// @flow</span></code></pre></div>\n<p>Typically it is placed at the top of a file. Try adding it to some files in your project and run <code class=\"language-javascript\">yarn flow</code> or <code class=\"language-javascript\">npm run flow</code> to see if Flow already found any issues.</p>\n<p>There is also <a class=\"external-link\" href=\"https://flow.org/en/docs/config/options/#toc-all-boolean\">an option</a> to force Flow to check <em>all</em> files regardless of the annotation. This can be too noisy for existing projects, but is reasonable for a new project if you want to fully type it with Flow.</p>\n<p>Now you\u2019re all set! We recommend to check out the following resources to learn more about Flow:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://flow.org/en/docs/types/\">Flow Documentation: Type Annotations</a></li>\n<li><a class=\"external-link\" href=\"https://flow.org/en/docs/editors/\">Flow Documentation: Editors</a></li>\n<li><a class=\"external-link\" href=\"https://flow.org/en/docs/react/\">Flow Documentation: React</a></li>\n<li><a class=\"external-link\" href=\"https://medium.com/flow-type/linting-in-flow-7709d7a7e969\">Linting in Flow</a></li>\n</ul>\n<h2 id=\"typescript\"><a class=\"anchor\" href=\"/react/static-type-checking#typescript\"></a>TypeScript </h2>\n<p><a class=\"external-link\" href=\"https://www.typescriptlang.org/\">TypeScript</a> is a programming language developed by Microsoft. It is a typed superset of JavaScript, and includes its own compiler. Being a typed language, TypeScript can catch errors and bugs at build time, long before your app goes live. You can learn more about using TypeScript with React <a class=\"external-link\" href=\"https://github.com/Microsoft/TypeScript-React-Starter#typescript-react-starter\">here</a>.</p>\n<p>To use TypeScript, you need to:</p>\n<ul>\n<li>Add TypeScript as a dependency to your project</li>\n<li>Configure the TypeScript compiler options</li>\n<li>Use the right file extensions</li>\n<li>Add definitions for libraries you use</li>\n</ul>\n<p>Let\u2019s go over these in detail.</p>\n<h3 id=\"using-typescript-with-create-react-app\"><a class=\"anchor\" href=\"/react/static-type-checking#using-typescript-with-create-react-app\"></a>Using TypeScript with Create React App </h3>\n<p>Create React App supports TypeScript out of the box.</p>\n<p>To create a <strong>new project</strong> with TypeScript support, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\">npx create-react-app my-app --template typescript</code></pre></div>\n<p>You can also add it to an <strong>existing Create React App project</strong>, <a class=\"external-link\" href=\"https://facebook.github.io/create-react-app/docs/adding-typescript\">as documented here</a>.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>If you use Create React App, you can <strong>skip the rest of this page</strong>. It describes the manual setup which doesn\u2019t apply to Create React App users.</p>\n</div>\n<h3 id=\"adding-typescript-to-a-project\"><a class=\"anchor\" href=\"/react/static-type-checking#adding-typescript-to-a-project\"></a>Adding TypeScript to a Project </h3>\n<p>It all begins with running one command in your terminal.</p>\n<p>If you use <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev typescript</code></pre></div>\n<p>If you use <a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev typescript</code></pre></div>\n<p>Congrats! You\u2019ve installed the latest version of TypeScript into your project. Installing TypeScript gives us access to the <code class=\"language-javascript\">tsc</code> command. Before configuration, let\u2019s add <code class=\"language-javascript\">tsc</code> to the \u201cscripts\u201d section in our <code class=\"language-javascript\">package.json</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token string-property property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token string-property property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tsc\"</span><span class=\"token punctuation\">,</span></span>    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"configuring-the-typescript-compiler\"><a class=\"anchor\" href=\"/react/static-type-checking#configuring-the-typescript-compiler\"></a>Configuring the TypeScript Compiler </h3>\n<p>The compiler is of no help to us until we tell it what to do. In TypeScript, these rules are defined in a special file called <code class=\"language-javascript\">tsconfig.json</code>. To generate this file:</p>\n<p>If you use <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> run tsc --init</code></pre></div>\n<p>If you use <a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a>, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\">npx tsc --init</code></pre></div>\n<p>Looking at the now generated <code class=\"language-javascript\">tsconfig.json</code>, you can see that there are many options you can use to configure the compiler. For a detailed description of all the options, check <a class=\"external-link\" href=\"https://www.typescriptlang.org/docs/handbook/tsconfig-json.html\">here</a>.</p>\n<p>Of the many options, we\u2019ll look at <code class=\"language-javascript\">rootDir</code> and <code class=\"language-javascript\">outDir</code>. In its true fashion, the compiler will take in typescript files and generate javascript files. However we don\u2019t want to get confused with our source files and the generated output.</p>\n<p>We\u2019ll address this in two steps:</p>\n<ul>\n<li>Firstly, let\u2019s arrange our project structure like this. We\u2019ll place all our source code in the <code class=\"language-javascript\">src</code> directory.</li>\n</ul>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 index.ts\n\u2514\u2500\u2500 tsconfig.json</code></pre></div>\n<ul>\n<li>Next, we\u2019ll tell the compiler where our source code is and where the output should go.</li>\n</ul>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// tsconfig.json</span>\n\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token string-property property\">\"rootDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"src\"</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token string-property property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"build\"</span></span>    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Great! Now when we run our build script the compiler will output the generated javascript to the <code class=\"language-javascript\">build</code> folder. The <a class=\"external-link\" href=\"https://github.com/Microsoft/TypeScript-React-Starter/blob/master/tsconfig.json\">TypeScript React Starter</a> provides a <code class=\"language-javascript\">tsconfig.json</code> with a good set of rules to get you started.</p>\n<p>Generally, you don\u2019t want to keep the generated javascript in your source control, so be sure to add the build folder to your <code class=\"language-javascript\">.gitignore</code>.</p>\n<h3 id=\"file-extensions\"><a class=\"anchor\" href=\"/react/static-type-checking#file-extensions\"></a>File extensions </h3>\n<p>In React, you most likely write your components in a <code class=\"language-javascript\">.js</code> file. In TypeScript we have 2 file extensions:</p>\n<p><code class=\"language-javascript\">.ts</code> is the default file extension while <code class=\"language-javascript\">.tsx</code> is a special extension used for files which contain <code class=\"language-javascript\">JSX</code>.</p>\n<h3 id=\"running-typescript\"><a class=\"anchor\" href=\"/react/static-type-checking#running-typescript\"></a>Running TypeScript </h3>\n<p>If you followed the instructions above, you should be able to run TypeScript for the first time.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">yarn</span> build</code></pre></div>\n<p>If you use npm, run:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> run build</code></pre></div>\n<p>If you see no output, it means that it completed successfully.</p>\n<h3 id=\"type-definitions\"><a class=\"anchor\" href=\"/react/static-type-checking#type-definitions\"></a>Type Definitions </h3>\n<p>To be able to show errors and hints from other packages, the compiler relies on declaration files. A declaration file provides all the type information about a library. This enables us to use javascript libraries like those on npm in our project. </p>\n<p>There are two main ways to get declarations for a library:</p>\n<p><strong>Bundled</strong> - The library bundles its own declaration file. This is great for us, since all we need to do is install the library, and we can use it right away. To check if a library has bundled types, look for an <code class=\"language-javascript\">index.d.ts</code> file in the project. Some libraries will have it specified in their <code class=\"language-javascript\">package.json</code> under the <code class=\"language-javascript\">typings</code> or <code class=\"language-javascript\">types</code> field.</p>\n<p><strong><a class=\"external-link\" href=\"https://github.com/DefinitelyTyped/DefinitelyTyped\">DefinitelyTyped</a></strong> - DefinitelyTyped is a huge repository of declarations for libraries that don\u2019t bundle a declaration file. The declarations are crowd-sourced and managed by Microsoft and open source contributors. React for example doesn\u2019t bundle its own declaration file. Instead we can get it from DefinitelyTyped. To do so enter this command in your terminal.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token comment\"># yarn</span>\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev @types/react\n\n<span class=\"token comment\"># npm</span>\n<span class=\"token function\">npm</span> i --save-dev @types/react</code></pre></div>\n<p><strong>Local Declarations</strong>\nSometimes the package that you want to use doesn\u2019t bundle declarations nor is it available on DefinitelyTyped. In that case, we can have a local declaration file. To do this, create a <code class=\"language-javascript\">declarations.d.ts</code> file in the root of your source directory. A simple declaration could look like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-typescript\"><code class=\"language-javascript\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">module</span> <span class=\"token string\">'querystring'</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>val<span class=\"token operator\">:</span> object<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>val<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> object\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You are now ready to code! We recommend to check out the following resources to learn more about TypeScript:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://www.typescriptlang.org/docs/handbook/2/everyday-types.html\">TypeScript Documentation: Everyday Types</a></li>\n<li><a class=\"external-link\" href=\"https://www.typescriptlang.org/docs/handbook/migrating-from-javascript.html\">TypeScript Documentation: Migrating from JavaScript</a></li>\n<li><a class=\"external-link\" href=\"https://www.typescriptlang.org/docs/handbook/react-&amp;-webpack.html\">TypeScript Documentation: React and Webpack</a></li>\n</ul>\n<h2 id=\"rescript\"><a class=\"anchor\" href=\"/react/static-type-checking#rescript\"></a>ReScript </h2>\n<p><a class=\"external-link\" href=\"https://rescript-lang.org/\">ReScript</a> is a typed language that compiles to JavaScript. Some of its core features are  guaranteed 100% type coverage, first-class JSX support and <a class=\"external-link\" href=\"https://rescript-lang.org/docs/react/latest/introduction\">dedicated React bindings</a> to allow integration in existing JS / TS React codebases.</p>\n<p>You can find more infos on integrating ReScript in your existing JS / React codebase <a class=\"external-link\" href=\"https://rescript-lang.org/docs/manual/latest/installation#integrate-into-an-existing-js-project\">here</a>.</p>\n<h2 id=\"kotlin\"><a class=\"anchor\" href=\"/react/static-type-checking#kotlin\"></a>Kotlin </h2>\n<p><a class=\"external-link\" href=\"https://kotlinlang.org/\">Kotlin</a> is a statically typed language developed by JetBrains. Its target platforms include the JVM, Android, LLVM, and <a class=\"external-link\" href=\"https://kotlinlang.org/docs/reference/js-overview.html\">JavaScript</a>. </p>\n<p>JetBrains develops and maintains several tools specifically for the React community: <a class=\"external-link\" href=\"https://github.com/JetBrains/kotlin-wrappers\">React bindings</a> as well as <a class=\"external-link\" href=\"https://github.com/JetBrains/create-react-kotlin-app\">Create React Kotlin App</a>. The latter helps you start building React apps with Kotlin with no build configuration.</p>\n<h2 id=\"other-languages\"><a class=\"anchor\" href=\"/react/static-type-checking#other-languages\"></a>Other Languages </h2>\n<p>Note there are other statically typed languages that compile to JavaScript and are thus React compatible. For example, <a class=\"external-link\" href=\"https://fable.io/\">F#/Fable</a> with <a class=\"external-link\" href=\"https://elmish.github.io/react\">elmish-react</a>. Check out their respective sites for more information, and feel free to add more statically typed languages that work with React to this page!</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/static-type-checking.md\">Edit this page</a></p></div></article>", "path": "/react/static-type-checking", "nav": ["/react/render-props", "/react/strict-mode"]}, {"key": "\u56b4\u683c\u6a21\u5f0f", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><code class=\"language-javascript\">\u56b4\u683c\u6a21\u5f0f</code>\u662f\u4e00\u500b\u7528\u4f86\u7a81\u986f\u61c9\u7528\u7a0b\u5f0f\u88e1\u6f5b\u5728\u554f\u984c\u7684\u5de5\u5177\u3002\u5982\u540c <code class=\"language-javascript\">Fragment</code> \u4e00\u6a23\uff0c<code class=\"language-javascript\">\u56b4\u683c\u6a21\u5f0f</code>\u4e0d\u6703 render \u4efb\u4f55\u53ef\u898b\u7684 UI\u3002\u5b83\u70ba\u4e86\u5e95\u4e0b\u7684\u6240\u6709\u7684\u4f9d\u8cf4\u5011\u555f\u52d5\u4e86\u984d\u5916\u7684\u6aa2\u67e5\u548c\u8b66\u544a\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u56b4\u683c\u6a21\u5f0f\u6aa2\u67e5\u53ea\u6703\u5728\u958b\u767c\u6a21\u5f0f\u4e2d\u57f7\u884c\uff1b<em>\u5b83\u5011\u4e0d\u61c9\u8a72\u5f71\u97ff\u6b63\u5f0f\u74b0\u5883</em>\u3002</p>\n</div>\n<p>\u4f60\u53ef\u4ee5\u5728\u61c9\u7528\u7a0b\u5f0f\u7684\u4efb\u4f55\u5730\u65b9\u6253\u958b\u56b4\u683c\u6a21\u5f0f\u3002\u4f8b\u5982\uff1a<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ExampleApplication</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Header</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.StrictMode</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ComponentOne</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ComponentTwo</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.StrictMode</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Footer</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u88e1\uff0c\u56b4\u683c\u6a21\u5f0f\u6aa2\u67e5\u5c07<em>\u4e0d\u6703</em>\u8dd1\u5728 <code class=\"language-javascript\">Header</code> \u548c <code class=\"language-javascript\">Footer</code> \u5143\u4ef6\u4e0a\u3002\u7136\u800c <code class=\"language-javascript\">ComponentOne</code> \u548c <code class=\"language-javascript\">ComponentTwo</code>\uff0c\u4ee5\u53ca\u5b83\u5011\u5e95\u4e0b\u7684\u6240\u6709\u5b50\u4f9d\u8cf4\uff0c\u90fd\u6703\u88ab\u6aa2\u67e5\u3002</p>\n<p><code class=\"language-javascript\">StrictMode</code> \u76ee\u524d\u53ef\u4ee5\u5e6b\u52a9\uff1a</p>\n<ul>\n<li><a href=\"/react/strict-mode#identifying-unsafe-lifecycles\">\u767c\u73fe\u64c1\u6709\u4e0d\u5b89\u5168\u751f\u547d\u9031\u671f\u7684 component</a></li>\n<li><a href=\"/react/strict-mode#warning-about-legacy-string-ref-api-usage\">\u8b66\u544a\u4f7f\u7528\u4e86 legacy string ref API</a></li>\n<li><a href=\"/react/strict-mode#warning-about-deprecated-finddomnode-usage\">\u8b66\u544a\u4f7f\u7528\u5230\u4e86\u88ab\u68c4\u7528\u7684 findDOMNode</a></li>\n<li><a href=\"/react/strict-mode#detecting-unexpected-side-effects\">\u5075\u6e2c\u610f\u60f3\u4e0d\u5230\u7684\u526f\u4f5c\u7528</a></li>\n<li><a href=\"/react/strict-mode#detecting-legacy-context-api\">\u5075\u6e2c legacy context API</a></li>\n<li><a href=\"/react/strict-mode#ensuring-reusable-state\">\u78ba\u4fdd\u53ef\u91cd\u7528\u7684 state</a></li>\n</ul>\n<p>\u5176\u4ed6\u529f\u80fd\u6703\u5728\u672a\u4f86\u7248\u672c\u7684 React \u91cb\u51fa\u6642\u88ab\u52a0\u9032\u53bb\u3002</p>\n<h3 id=\"identifying-unsafe-lifecycles\"><a class=\"anchor\" href=\"/react/strict-mode#identifying-unsafe-lifecycles\"></a>\u767c\u73fe\u4e0d\u5b89\u5168\u7684\u751f\u547d\u9031\u671f </h3>\n<p>\u5982<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u9019\u7bc7\u6587\u7ae0</a>\u6240\u8ff0\uff0c\u67d0\u4e9b\u907a\u7559\u7684\u751f\u547d\u9031\u671f\u5728\u975e\u540c\u6b65\u7684 React \u61c9\u7528\u7a0b\u5f0f\u88e1\u4f7f\u7528\u662f\u4e0d\u5b89\u5168\u7684\u3002\u7136\u800c\uff0c\u5982\u679c\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528\u5230\u7b2c\u4e09\u65b9\u5957\u4ef6\uff0c\u78ba\u8a8d\u9019\u4e9b\u751f\u547d\u9031\u671f\u6709\u6c92\u6709\u88ab\u4f7f\u7528\u5230\u662f\u5f88\u56f0\u96e3\u7684\u3002\u5e78\u597d\u56b4\u683c\u6a21\u5f0f\u53ef\u4ee5\u5728\u9019\u9ede\u5e6b\u52a9\u6211\u5011\uff01</p>\n<p>\u7576\u56b4\u683c\u6a21\u5f0f\u88ab\u6253\u958b\u7684\u6642\u5019\uff0cReact \u7de8\u8b6f\u4e86\u4e00\u6574\u4e32\u7528\u5230\u9019\u4e9b\u4e0d\u5b89\u5168\u751f\u547d\u9031\u671f\u7684 class component\uff0c\u7136\u5f8c\u8a18\u9304\u4e86\u9019\u4e9b component \u7684\u8b66\u544a\u8a0a\u606f\uff0c\u4f8b\u5982\uff1a</p>\n<p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/e4fdbff774b356881123e69ad88eda88/1628f/strict-mode-unsafe-lifecycles-warning.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/e4fdbff774b356881123e69ad88eda88/1e088/strict-mode-unsafe-lifecycles-warning.png\">Image link</a>\n</span>\n</span>\n</a>\n</p>\n<p><em>\u73fe\u5728</em> \u5c31\u95dc\u6ce8\u9019\u4e9b\u88ab\u56b4\u683c\u6a21\u5f0f\u6240\u767c\u73fe\u7684\u554f\u984c\uff0c\u6703\u5e6b\u52a9\u4f60\u5728 React \u5c07\u4f86\u7684\u7248\u672c\u88e1\u8655\u7406\u975e\u540c\u6b65 render \u7684\u6642\u5019\u66f4\u5bb9\u6613\u3002</p>\n<h3 id=\"warning-about-legacy-string-ref-api-usage\"><a class=\"anchor\" href=\"/react/strict-mode#warning-about-legacy-string-ref-api-usage\"></a>\u8b66\u544a\u4f7f\u7528\u5230\u4e86 legacy string ref API </h3>\n<p>\u4ee5\u524d React \u63d0\u4f9b\u4e86\u5169\u7a2e\u7ba1\u7406 ref \u7684\u65b9\u5f0f\uff1alegacy string ref API \u548c callback API\u3002\u96d6\u7136 string ref API \u5728\u5169\u8005\u4e4b\u9593\u662f\u6bd4\u8f03\u65b9\u4fbf\u7684\uff0c\u4f46\u5b83\u6709\u5f88\u591a<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/1373\">\u7f3a\u9ede</a>\uff0c\u6240\u4ee5\u6211\u5011\u7684\u5b98\u65b9\u63a8\u85a6\u662f<a href=\"/react/refs-and-the-dom#legacy-api-string-refs\">\u4f7f\u7528 callback form</a>.</p>\n<p>React 16.3 \u52a0\u4e0a\u4e86\u7b2c\u4e09\u7a2e\u9078\u64c7\uff0c\u63d0\u4f9b\u4e86 string ref \u7684\u4fbf\u5229\u6027\u4e14\u514d\u9664\u4e86\u90a3\u4e9b\u7f3a\u9ede\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>\u56e0\u70ba object ref \u5df2\u7d93\u5927\u91cf\u53d6\u4ee3\u4e86 string ref\uff0c\u56b4\u683c\u6a21\u5f0f\u73fe\u5728\u6703\u5728\u4f60\u4f7f\u7528 string ref \u7684\u6642\u5019\u8b66\u544a\u4f60\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9664\u4e86\u65b0\u7684 <code class=\"language-javascript\">createRef</code> API \u4ee5\u5916\uff0ccallback ref \u6703\u6301\u7e8c\u88ab\u652f\u63f4\u3002</p>\n<p>\u4f60\u4e0d\u9700\u8981\u6539\u6389\u4f60 component \u88e1\u7684 callback ref\u3002\u5b83\u5011\u7a0d\u5fae\u66f4\u6709\u5f48\u6027\uff0c\u6240\u4ee5\u5b83\u5011\u6703\u6301\u7e8c\u662f\u4e00\u500b\u9032\u968e\u6027\u7684\u529f\u80fd\u3002</p>\n</div>\n<p><a href=\"/react/refs-and-the-dom\">\u5b78\u7fd2\u66f4\u591a\u95dc\u65bc\u65b0\u7684 <code class=\"language-javascript\">createRef</code> API\u3002</a></p>\n<h3 id=\"warning-about-deprecated-finddomnode-usage\"><a class=\"anchor\" href=\"/react/strict-mode#warning-about-deprecated-finddomnode-usage\"></a>\u8b66\u544a\u4f7f\u7528\u5230\u4e86\u88ab\u68c4\u7528\u7684 findDOMNode </h3>\n<p>React \u904e\u53bb\u652f\u63f4\u4e86 <code class=\"language-javascript\">findDOMNode</code> \u4f86\u7528 class instance \u641c\u5c0b tree \u88e1\u9762\u7684 DOM \u7bc0\u9ede\u3002\u901a\u5e38\u4f60\u4e0d\u9700\u8981\u9019\u500b\uff0c\u56e0\u70ba\u4f60\u53ef\u4ee5 <a href=\"/react/refs-and-the-dom#creating-refs\">\u76f4\u63a5\u628a\u4e00\u500b ref \u9644\u5230\u4f60\u7684 DOM \u7bc0\u9ede</a>\u3002</p>\n<p><code class=\"language-javascript\">findDOMNode</code> \u4e5f\u53ef\u4ee5\u88ab\u4f7f\u7528\u5728 class component \u4e0a\uff0c\u4f46\u9019\u662f\u4e00\u500b\u7834\u58de\u62bd\u8c61\u5c64\u7684\u7528\u6cd5\uff0c\u5b83\u5141\u8a31\u4e86 parent \u4f86\u8981\u6c42 render \u67d0\u500b\u7279\u5b9a\u7684 children\u3002\u5b83\u7522\u751f\u4e86\u91cd\u69cb\u7684\u98a8\u96aa\uff0c\u56e0\u70ba parent \u53ef\u80fd\u6703\u9032\u5165\u5230\u67d0\u500b DOM \u7bc0\u9ede\uff0c\u6240\u4ee5\u4f60\u4e0d\u80fd\u96a8\u610f\u6539\u8b8a component \u7684\u5be6\u4f5c\u7d30\u7bc0\u3002<code class=\"language-javascript\">findDOMNode</code> \u53ea\u6703\u56de\u50b3\u7b2c\u4e00\u500b child\uff0c\u4f46\u5982\u679c\u4f7f\u7528\u4e86 Fragment\uff0c\u6709\u53ef\u80fd\u67d0\u500b component \u6703 render \u591a\u500b DOM \u7bc0\u9ede\u3002<code class=\"language-javascript\">findDOMNode</code> \u662f\u4e00\u500b\u53ea\u80fd\u8b80\u4e00\u6b21\u7684 API\u3002\u5b83\u53ea\u5728\u4f60\u8981\u6c42\u7684\u6642\u5019\u544a\u8a34\u4f60\u7b54\u6848\u3002\u5982\u679c\u4e00\u500b child component render \u4e86\u4e0d\u540c\u7684\u7bc0\u9ede\uff0c\u6c92\u6709\u4efb\u4f55\u65b9\u6cd5\u53ef\u4ee5\u8655\u7406\u9019\u6a23\u7684\u6539\u8b8a\u3002\u6240\u4ee5 <code class=\"language-javascript\">findDOMNode</code> \u53ea\u5728\u5143\u4ef6\u6c38\u9060\u56de\u50b3\u4e00\u500b\u55ae\u4e00\u4e14\u6c38\u9060\u4e0d\u6539\u8b8a\u7684 DOM \u7bc0\u9ede\u6642\u6709\u7528\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u85c9\u7531\u50b3\u905e ref \u5230\u4f60\u7684\u5ba2\u88fd\u5316 component\uff0c\u4e14\u628a\u5b83\u50b3\u5230\u4f7f\u7528 <a href=\"/react/forwarding-refs#forwarding-refs-to-dom-components\">ref forwarding</a> \u7684 DOM\uff0c\u4f7f\u5b83\u8b8a\u5f97\u660e\u986f\u3002</p>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u5728\u4f60\u7684 component \u52a0\u4e0a\u4e00\u500b\u5305\u88f9\u7684 DOM \u7bc0\u9ede\uff0c\u7136\u5f8c\u628a ref \u76f4\u63a5\u9644\u5728\u5b83\u4e0a\u9762\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wrapper <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wrapper<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5728 CSS \u88e1\uff0c\u5982\u679c\u4f60\u4e0d\u60f3\u8981\u67d0\u500b\u7bc0\u9ede\u6210\u70ba layout \u7684\u4e00\u90e8\u4efd\uff0c<a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/display#display_contents\"><code class=\"language-javascript\">display: contents</code></a> attribute \u53ef\u4ee5\u88ab\u4f7f\u7528\u3002</p>\n</div>\n<h3 id=\"detecting-unexpected-side-effects\"><a class=\"anchor\" href=\"/react/strict-mode#detecting-unexpected-side-effects\"></a>\u5075\u6e2c\u610f\u60f3\u4e0d\u5230\u7684\u526f\u4f5c\u7528 </h3>\n<p>\u6982\u5ff5\u4e0a\uff0cReact \u5728\u5169\u7a2e\u9762\u76f8\u4e0a\u80fd\u5920\u904b\u4f5c\uff1a</p>\n<ul>\n<li><strong>render</strong> \u9762\u76f8\u6c7a\u5b9a\u4e86\u5fc5\u9808\u505a\u51fa\u4ec0\u9ebc\u6539\u8b8a\u5230\u4f8b\u5982 DOM \u7684\u5730\u65b9\u3002\u5728\u9019\u500b\u9762\u76f8\u4e0a\uff0cReact \u547c\u53eb <code class=\"language-javascript\">render</code> \u7136\u5f8c\u6bd4\u8f03\u4e86\u5b83\u8207\u4e0a\u4e00\u6b21 render \u7684\u7d50\u679c\u3002</li>\n<li><strong>commit</strong> \u9762\u76f8\u662f\u6bcf\u7576 React \u904b\u7528\u5230\u4efb\u4f55\u6539\u8b8a\u7684\u6642\u5019\u3002\uff08\u5728 React DOM \u7684\u4f8b\u5b50\uff0c\u7576 React \u63d2\u5165\u3001\u66f4\u65b0\u3001\u6216\u79fb\u9664 DOM \u7bc0\u9ede\u3002\uff09React \u4e5f\u5728\u9019\u500b\u9762\u76f8\u4e0a\u547c\u53eb\u4e86\u50cf\u662f <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code> \u7684\u751f\u547d\u9031\u671f\u3002</li>\n</ul>\n<p>Commit \u9762\u76f8\u901a\u5e38\u975e\u5e38\u5feb\uff0c\u4f46 render \u53ef\u80fd\u6703\u5f88\u6162\u3002\u70ba\u4e86\u9019\u500b\u539f\u56e0\uff0c\u5c07\u4f86\u7684\u975e\u540c\u6b65\u6a21\u5f0f\uff08\u9084\u6c92\u88ab\u9810\u8a2d\u6210\u958b\u555f\uff09\u6703\u628a render \u7684\u5de5\u4f5c\u5207\u6210\u5c0f\u584a\uff0c\u66ab\u505c\u548c\u6062\u5fa9\u9019\u4e9b\u5de5\u4f5c\u85c9\u4ee5\u907f\u514d\u963b\u64cb\u700f\u89bd\u5668\u3002 \u9019\u8868\u793a React \u53ef\u80fd\u6703\u5728 commit \u4e4b\u524d\u8abf\u7528\u591a\u6b21 render \u9762\u76f8\u7684\u751f\u547d\u9031\u671f\uff0c\u6216\u662f\u4ed6\u6703\u4e0d\u7ba1\u6709\u6c92\u6709 commit \u5c31\u8abf\u7528\u5b83\u5011\uff08\u56e0\u70ba\u932f\u8aa4\u6216\u662f\u66f4\u9ad8\u512a\u5148\u6027\u7684\u4e2d\u65b7\uff09\u3002</p>\n<p>Render \u9762\u76f8\u7684\u751f\u547d\u9031\u671f\u5305\u542b\u4e86\u4ee5\u4e0b class component \u51fd\u5f0f:</p>\n<ul>\n<li><code class=\"language-javascript\">constructor</code></li>\n<li><code class=\"language-javascript\">componentWillMount</code>\uff08\u6216 <code class=\"language-javascript\">UNSAFE_componentWillMount</code>\uff09</li>\n<li><code class=\"language-javascript\">componentWillReceiveProps</code>\uff08\u6216 <code class=\"language-javascript\">UNSAFE_componentWillReceiveProps</code>\uff09</li>\n<li><code class=\"language-javascript\">componentWillUpdate</code>\uff08\u6216 <code class=\"language-javascript\">UNSAFE_componentWillUpdate</code>\uff09</li>\n<li><code class=\"language-javascript\">getDerivedStateFromProps</code></li>\n<li><code class=\"language-javascript\">shouldComponentUpdate</code></li>\n<li><code class=\"language-javascript\">render</code></li>\n<li><code class=\"language-javascript\">setState</code> updater functions (\u7b2c\u4e00\u500b\u53c3\u6578)</li>\n</ul>\n<p>\u56e0\u70ba\u4ee5\u4e0a\u51fd\u5f0f\u53ef\u80fd\u6703\u88ab\u547c\u53eb\u4e0d\u53ea\u4e00\u6b21\uff0c\u4e0d\u5305\u542b\u526f\u4f5c\u7528\u662f\u5f88\u91cd\u8981\u7684\u3002\u5ffd\u8996\u9019\u500b\u898f\u5247\u53ef\u80fd\u6703\u5c0e\u81f4\u5404\u7a2e\u554f\u984c\uff0c\u5305\u542b\u8a18\u61b6\u9ad4\u6ef2\u6f0f\uff0c\u548c\u4e0d\u5408\u6cd5\u7684\u61c9\u7528\u7a0b\u5f0f state\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u5075\u6e2c\u9019\u4e9b\u554f\u984c\u5f88\u56f0\u96e3\uff0c\u56e0\u70ba\u5b83\u5011\u901a\u5e38\u662f <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Deterministic_algorithm\">non-deterministic</a>\u3002</p>\n<p>\u56b4\u683c\u6a21\u5f0f\u7121\u6cd5\u81ea\u52d5\u6aa2\u6e2c side effect\uff0c\u4f46\u5b83\u53ef\u4ee5\u85c9\u7531\u4f7f\u9019\u4e9b side effect \u8b8a\u5f97\u66f4\u6709\u78ba\u5b9a\u6027\uff0c\u4f86\u5e6b\u52a9\u4f60\u767c\u73fe\u5b83\u5011\u3002\u5b83\u85c9\u7531\u6545\u610f\u8abf\u7528\u5169\u6b21\u4e0b\u9762\u7684\u51fd\u5f0f\u4f86\u5b8c\u6210\u9019\u500b\u529f\u80fd\uff1a</p>\n<ul>\n<li>Class component <code class=\"language-javascript\">constructor</code>\u3001<code class=\"language-javascript\">render</code> \u548c <code class=\"language-javascript\">shouldComponentUpdate</code> \u65b9\u6cd5</li>\n<li>Class component \u7684\u975c\u614b <code class=\"language-javascript\">getDerivedStateFromProps</code> \u65b9\u6cd5</li>\n<li>Function component \u7684\u5167\u5bb9</li>\n<li>\u72c0\u614b\u66f4\u65b0\u51fd\u5f0f\uff08<code class=\"language-javascript\">setState</code> \u7684\u7b2c\u4e00\u500b\u53c3\u6578\uff09</li>\n<li>\u51fd\u6578\u50b3\u905e\u81f3 <code class=\"language-javascript\">useState</code>\u3001<code class=\"language-javascript\">useMemo</code> \u6216 <code class=\"language-javascript\">useReducer</code></li>\n</ul>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u53ea\u5728\u958b\u767c\u6a21\u5f0f\u767c\u751f\u3002<em>\u751f\u547d\u9031\u671f\u4e0d\u6703\u88ab\u91cd\u8907\u8abf\u7528\u5728\u6b63\u5f0f\u74b0\u5883\u3002</em></p>\n</div>\n<p>\u4f8b\u5982\uff0c\u8003\u616e\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff1a\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TopLevelRoute</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    SharedApplicationState<span class=\"token punctuation\">.</span><span class=\"token function\">recordEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ExampleComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>\u7b2c\u4e00\u773c\u770b\u9019\u6bb5\u7a0b\u5f0f\u78bc\uff0c\u53ef\u80fd\u4e0d\u6703\u89ba\u5f97\u5b83\u6709\u554f\u984c\u3002\u4f46\u5982\u679c <code class=\"language-javascript\">SharedApplicationState.recordEvent</code> \u4e0d\u662f <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning\">idempotent</a> \u7684\u8a71\uff0c\u591a\u6b21\u5be6\u9ad4\u5316\u9019\u500b component \u53ef\u80fd\u6703\u5c0e\u81f4\u4e0d\u5408\u6cd5\u7684\u61c9\u7528\u7a0b\u5f0f state\u3002\u9019\u7a2e\u7d30\u5fae\u7684\u932f\u8aa4\u53ef\u80fd\u5728\u958b\u767c\u671f\u9593\u4e0d\u6703\u51fa\u73fe\uff0c\u6216\u8005\u6703\u4e0d\u4e00\u81f4\u5730\u51fa\u73fe\uff0c\u56e0\u6b64\u88ab\u5ffd\u7565\u4e86\u3002</p>\n<p>\u901a\u904e\u6709\u610f\u5730\u96d9\u91cd\u8abf\u7528\u5982 component constructor\uff0c\u56b4\u683c\u6a21\u5f0f\u4f7f\u9019\u7a2e\u6a21\u5f0f\u66f4\u5bb9\u6613\u88ab\u767c\u73fe\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5f9e React 17 \u958b\u59cb\uff0cReact \u6703\u81ea\u52d5\u66f4\u6539\u5982 <code class=\"language-javascript\">console.log()</code> \u7684 console \u65b9\u6cd5\uff0c\u4ee5\u5728\u7b2c\u4e8c\u6b21\u8abf\u7528\u751f\u547d\u9031\u671f\u51fd\u6578\u6642\u4f7f log \u975c\u97f3\uff0c\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u5b83\u53ef\u80fd\u6703\u5c0e\u81f4\u7121\u6cd5\u9810\u671f\u7684\u884c\u70ba\uff0c\u4f60<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/20090#issuecomment-715927125\">\u53ef\u4ee5\u4f7f\u7528\u66ff\u4ee3\u65b9\u6848</a>\u3002</p>\n<p>\u5f9e React 18 \u958b\u59cb\uff0cReact \u4e0d\u6703\u6291\u5236\u4efb\u4f55 log\u3002\u7136\u800c\uff0c\u5982\u679c\u4f60\u6709\u5b89\u88dd React DevTools\uff0c\u5247\u7b2c\u4e8c\u6b21\u547c\u53eb\u6642\u6703\u986f\u5f97\u6709\u4e9b\u9eef\u6de1\u3002React DevTools \u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b\u8a2d\u5b9a\uff08\u9810\u8a2d\u95dc\u9589\uff09\u4f86\u5b8c\u5168\u6291\u5236\u5b83\u5011\u3002</p>\n</div>\n<h3 id=\"detecting-legacy-context-api\"><a class=\"anchor\" href=\"/react/strict-mode#detecting-legacy-context-api\"></a>\u6aa2\u6e2c legacy context API </h3>\n<p>Legacy context API \u662f\u5bb9\u6613\u51fa\u932f\u7684\uff0c\u4e26\u5c07\u5728\u4ee5\u5f8c\u7684\u4e3b\u8981\u7248\u672c\u4e2d\u522a\u9664\u3002\u5b83\u4ecd\u7136\u9069\u7528\u65bc\u6240\u6709 16.x \u7248\u672c\uff0c\u4f46\u5c07\u5728\u56b4\u683c\u6a21\u5f0f\u4e0b\u986f\u793a\u4ee5\u4e0b\u8b66\u544a\u8a0a\u606f\uff1a</p>\n<p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/fca5c5e1fb2ef2e2d59afb100b432c12/51800/warn-legacy-context-in-strict-mode.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/fca5c5e1fb2ef2e2d59afb100b432c12/1e088/warn-legacy-context-in-strict-mode.png\">Image link</a>\n</span>\n</span>\n</a>\n</p>\n<p>\u95b1\u8b80<a href=\"/react/context\">\u65b0\u7684 context API \u6587\u4ef6</a>\uff0c\u4ee5\u52a9\u65bc\u9077\u79fb\u5230\u65b0\u7248\u672c\u3002</p>\n<h3 id=\"ensuring-reusable-state\"><a class=\"anchor\" href=\"/react/strict-mode#ensuring-reusable-state\"></a>Ensuring reusable state </h3>\n<p>In the future, we\u2019d like to add a feature that allows React to add and remove sections of the UI while preserving state. For example, when a user tabs away from a screen and back, React should be able to immediately show the previous screen. To do this, React will support remounting trees using the same component state used before unmounting.</p>\n<p>This feature will give React better performance out-of-the-box, but requires components to be resilient to effects being mounted and destroyed multiple times. Most effects will work without any changes, but some effects do not properly clean up subscriptions in the destroy callback, or implicitly assume they are only mounted or destroyed once.</p>\n<p>To help surface these issues, React 18 introduces a new development-only check to Strict Mode. This new check will automatically unmount and remount every component, whenever a component mounts for the first time, restoring the previous state on the second mount.</p>\n<p>To demonstrate the development behavior you\u2019ll see in Strict Mode with this feature, consider what happens when React mounts a new component. Without this change, when a component mounts, React creates the effects:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">* React mounts the component.\n  * Layout effects are created.\n  * Effects are created.</code></pre></div>\n<p>With Strict Mode starting in React 18, whenever a component mounts in development, React will simulate immediately unmounting and remounting the component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">* React mounts the component.\n    * Layout effects are created.\n    * Effect effects are created.\n* React simulates effects being destroyed on a mounted component.\n    * Layout effects are destroyed.\n    * Effects are destroyed.\n* React simulates effects being re-created on a mounted component.\n    * Layout effects are created\n    * Effect setup code runs</code></pre></div>\n<p>On the second mount, React will restore the state from the first mount. This feature simulates user behavior such as a user tabbing away from a screen and back, ensuring that code will properly handle state restoration.</p>\n<p>When the component unmounts, effects are destroyed as normal:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">* React unmounts the component.\n  * Layout effects are destroyed.\n  * Effect effects are destroyed.</code></pre></div>\n<p>Unmounting and remounting includes:</p>\n<ul>\n<li><code class=\"language-javascript\">componentDidMount</code></li>\n<li><code class=\"language-javascript\">componentWillUnmount</code></li>\n<li><code class=\"language-javascript\">useEffect</code></li>\n<li><code class=\"language-javascript\">useLayoutEffect</code></li>\n<li><code class=\"language-javascript\">useInsertionEffect</code></li>\n</ul>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This only applies to development mode, <em>production behavior is unchanged</em>.</p>\n</div>\n<p>For help supporting common issues, see:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://github.com/reactwg/react-18/discussions/18\">How to support Reusable State in Effects</a></li>\n</ul></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/strict-mode.md\">Edit this page</a></p></div></article>", "path": "/react/strict-mode", "nav": ["/react/static-type-checking", "/react/typechecking-with-proptypes"]}, {"key": "Typechecking With PropTypes", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><div class=\"blockquote\">\n<strong>Note:</strong>\n<p><code class=\"language-javascript\">React.PropTypes</code> has moved into a different package since React v15.5. Please use <a class=\"external-link\" href=\"https://www.npmjs.com/package/prop-types\">the <code class=\"language-javascript\">prop-types</code> library instead</a>.</p>\n<p>We provide <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2017/04/07/react-v15.5.0.html#migrating-from-reactproptypes\">a codemod script</a> to automate the conversion.</p>\n</div>\n<p>As your app grows, you can catch a lot of bugs with typechecking. For some applications, you can use JavaScript extensions like <a class=\"external-link\" href=\"https://flow.org/\">Flow</a> or <a class=\"external-link\" href=\"https://www.typescriptlang.org/\">TypeScript</a> to typecheck your whole application. But even if you don\u2019t use those, React has some built-in typechecking abilities. To run typechecking on the props for a component, you can assign the special <code class=\"language-javascript\">propTypes</code> property:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nGreeting<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In this example, we are using a class component, but the same functionality could also be applied to function components, or components created by <a href=\"/react/react-api#reactmemo\"><code class=\"language-javascript\">React.memo</code></a> or <a href=\"/react/react-api#reactforwardref\"><code class=\"language-javascript\">React.forwardRef</code></a>.</p>\n<p><code class=\"language-javascript\">PropTypes</code> exports a range of validators that can be used to make sure the data you receive is valid. In this example, we\u2019re using <code class=\"language-javascript\">PropTypes.string</code>. When an invalid value is provided for a prop, a warning will be shown in the JavaScript console. For performance reasons, <code class=\"language-javascript\">propTypes</code> is only checked in development mode.</p>\n<h3 id=\"proptypes\"><a class=\"anchor\" href=\"/react/typechecking-with-proptypes#proptypes\"></a>PropTypes </h3>\n<p>Here is an example documenting the different validators provided:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n\nMyComponent<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// You can declare that a prop is a specific JS type. By default, these</span>\n  <span class=\"token comment\">// are all optional.</span>\n  <span class=\"token literal-property property\">optionalArray</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalBool</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>bool<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalFunc</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalNumber</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalObject</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalString</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">optionalSymbol</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>symbol<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// Anything that can be rendered: numbers, strings, elements or an array</span>\n  <span class=\"token comment\">// (or fragment) containing these types.</span>\n  <span class=\"token literal-property property\">optionalNode</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// A React element.</span>\n  <span class=\"token literal-property property\">optionalElement</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// A React element type (ie. MyComponent).</span>\n  <span class=\"token literal-property property\">optionalElementType</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>elementType<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// You can also declare that a prop is an instance of a class. This uses</span>\n  <span class=\"token comment\">// JS's instanceof operator.</span>\n  <span class=\"token literal-property property\">optionalMessage</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">instanceOf</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// You can ensure that your prop is limited to specific values by treating</span>\n  <span class=\"token comment\">// it as an enum.</span>\n  <span class=\"token literal-property property\">optionalEnum</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">oneOf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'News'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Photos'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// An object that could be one of many types</span>\n  <span class=\"token literal-property property\">optionalUnion</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">oneOfType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">,</span>\n    PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">instanceOf</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// An array of a certain type</span>\n  <span class=\"token literal-property property\">optionalArrayOf</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">arrayOf</span><span class=\"token punctuation\">(</span>PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// An object with property values of a certain type</span>\n  <span class=\"token literal-property property\">optionalObjectOf</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">objectOf</span><span class=\"token punctuation\">(</span>PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// An object taking on a particular shape</span>\n  <span class=\"token literal-property property\">optionalObjectWithShape</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">fontSize</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>number\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// An object with warnings on extra properties</span>\n  <span class=\"token literal-property property\">optionalObjectWithStrictShape</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">exact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>number\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>   \n\n  <span class=\"token comment\">// You can chain any of the above with `isRequired` to make sure a warning</span>\n  <span class=\"token comment\">// is shown if the prop isn't provided.</span>\n  <span class=\"token literal-property property\">requiredFunc</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// A required value of any data type</span>\n  <span class=\"token literal-property property\">requiredAny</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>any<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// You can also specify a custom validator. It should return an Error</span>\n  <span class=\"token comment\">// object if the validation fails. Don't `console.warn` or throw, as this</span>\n  <span class=\"token comment\">// won't work inside `oneOfType`.</span>\n  <span class=\"token function-variable function\">customProp</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> propName<span class=\"token punctuation\">,</span> componentName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">matchme</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">'Invalid prop `'</span> <span class=\"token operator\">+</span> propName <span class=\"token operator\">+</span> <span class=\"token string\">'` supplied to'</span> <span class=\"token operator\">+</span>\n        <span class=\"token string\">' `'</span> <span class=\"token operator\">+</span> componentName <span class=\"token operator\">+</span> <span class=\"token string\">'`. Validation failed.'</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// You can also supply a custom validator to `arrayOf` and `objectOf`.</span>\n  <span class=\"token comment\">// It should return an Error object if the validation fails. The validator</span>\n  <span class=\"token comment\">// will be called for each key in the array or object. The first two</span>\n  <span class=\"token comment\">// arguments of the validator are the array or object itself, and the</span>\n  <span class=\"token comment\">// current item's key.</span>\n  <span class=\"token literal-property property\">customArrayProp</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">arrayOf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">propValue<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> componentName<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> propFullName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">matchme</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>propValue<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">'Invalid prop `'</span> <span class=\"token operator\">+</span> propFullName <span class=\"token operator\">+</span> <span class=\"token string\">'` supplied to'</span> <span class=\"token operator\">+</span>\n        <span class=\"token string\">' `'</span> <span class=\"token operator\">+</span> componentName <span class=\"token operator\">+</span> <span class=\"token string\">'`. Validation failed.'</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"requiring-single-child\"><a class=\"anchor\" href=\"/react/typechecking-with-proptypes#requiring-single-child\"></a>Requiring Single Child </h3>\n<p>With <code class=\"language-javascript\">PropTypes.element</code> you can specify that only a single child can be passed to a component as children.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This must be exactly one element or it will warn.</span>\n    <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nMyComponent<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>isRequired\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"default-prop-values\"><a class=\"anchor\" href=\"/react/typechecking-with-proptypes#default-prop-values\"></a>Default Prop Values </h3>\n<p>You can define default values for your <code class=\"language-javascript\">props</code> by assigning to the special <code class=\"language-javascript\">defaultProps</code> property:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Specifies the default values for props:</span>\nGreeting<span class=\"token punctuation\">.</span>defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Stranger'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Renders \"Hello, Stranger\":</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'example'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Greeting</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Since ES2022 you can also declare <code class=\"language-javascript\">defaultProps</code> as static property within a React component class. For more information, see the <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#public_static_fields\">class public static fields</a>. This modern syntax will require a compilation step to work within older browsers. </p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'stranger'</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The <code class=\"language-javascript\">defaultProps</code> will be used to ensure that <code class=\"language-javascript\">this.props.name</code> will have a value if it was not specified by the parent component. The <code class=\"language-javascript\">propTypes</code> typechecking happens after <code class=\"language-javascript\">defaultProps</code> are resolved, so typechecking will also apply to the <code class=\"language-javascript\">defaultProps</code>.</p>\n<h3 id=\"function-components\"><a class=\"anchor\" href=\"/react/typechecking-with-proptypes#function-components\"></a>Function Components </h3>\n<p>If you are using function components in your regular development, you may want to make some small changes to allow PropTypes to be properly applied.</p>\n<p>Let\u2019s say you have a component like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorldComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To add PropTypes, you may want to declare the component in a separate function before exporting, like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorldComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HelloWorldComponent</code></pre></div>\n<p>Then, you can add PropTypes directly to the <code class=\"language-javascript\">HelloWorldComponent</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorldComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nHelloWorldComponent<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HelloWorldComponent</code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/typechecking-with-proptypes.md\">Edit this page</a></p></div></article>", "path": "/react/typechecking-with-proptypes", "nav": ["/react/strict-mode", "/react/uncontrolled-components"]}, {"key": "Uncontrolled Component", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u63a8\u85a6\u4f7f\u7528<a href=\"/react/forms#controlled-components\">controlled component</a>\u4f86\u5be6\u4f5c\u8868\u55ae\u3002\u5728\u63a7\u5236\u5143\u4ef6\u88e1\uff0c\u8868\u55ae\u7684\u8cc7\u6599\u662f\u88ab React component \u6240\u8655\u7406\u3002\u53e6\u4e00\u500b\u9078\u64c7\u662f uncontrolled component\uff0c\u8868\u55ae\u7684\u8cc7\u6599\u662f\u7531 DOM \u672c\u8eab\u6240\u8655\u7406\u7684\u3002</p>\n<p>\u5982\u679c\u8981\u5beb\u4e00\u500b uncontrolled component\uff0c\u4f60\u53ef\u4ee5<a href=\"/react/refs-and-the-dom\">\u4f7f\u7528 ref</a> \u4f86\u5f9e DOM \u53d6\u5f97\u8868\u55ae\u7684\u8cc7\u6599\uff0c\u800c\u4e0d\u662f\u70ba\u4e86\u6bcf\u500b state \u7684\u66f4\u65b0\u5beb event handler\u3002</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u9019\u6bb5\u7a0b\u5f0f\u78bc\u5728 uncontrolled component \u88e1\u63a5\u53d7\u4e00\u500b\u540d\u5b57\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NameForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A name was submitted: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Name:</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://codepen.io/gaearon/pen/WooRWa?editors=0010\"><strong>\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\uff01</strong></a></p>\n<p>\u7531\u65bc uncontrolled component \u4fdd\u6301\u4e86 DOM \u88e1\u7684\u552f\u4e00\u7684\u771f\u76f8\u4f86\u6e90\uff0c\u6709\u7684\u6642\u5019\u4f7f\u7528 uncontrolled component \u6642\u66f4\u5bb9\u6613\u6574\u5408 React \u548c\u975e React \u7684\u7a0b\u5f0f\u78bc\u3002\u5982\u679c\u4f60\u60f3\u6709\u500b\u53c8\u5feb\u53c8\u9ad2\u7684\u65b9\u6cd5\uff0c\u5b83\u4e5f\u53ef\u4ee5\u6e1b\u5c11\u4e00\u4e9b\u7a0b\u5f0f\u78bc\u3002\u5426\u5247\uff0c\u901a\u5e38\u61c9\u4f7f\u7528 controlled component\u3002</p>\n<p>\u5982\u679c\u4ecd\u4e0d\u6e05\u695a\u5728\u7279\u5b9a\u60c5\u6cc1\u4e0b\u61c9\u4f7f\u7528\u54ea\u7a2e\u985e\u578b\u7684 component\uff0c\u4f60\u53ef\u80fd\u6703\u89ba\u5f97<a class=\"external-link\" href=\"https://goshakkk.name/controlled-vs-uncontrolled-inputs-react/\">\u9019\u7bc7\u95dc\u65bc\u63a7\u5236\u8207\u4e0d\u53ef\u63a7\u5236\u8f38\u5165\u7684\u6587\u7ae0</a>\u6709\u6240\u5e6b\u52a9\u3002</p>\n<h3 id=\"default-values\"><a class=\"anchor\" href=\"/react/uncontrolled-components#default-values\"></a>\u9810\u8a2d\u503c </h3>\n<p>\u5728 React \u7684 render \u751f\u547d\u9031\u671f\u88e1\uff0c\u8868\u55ae\u4e0a\u7684 <code class=\"language-javascript\">value</code> attribute \u6703\u8986\u5beb\u6389 DOM \u7684\u503c\u3002\u5728 uncontrolled component \u88e1\uff0c\u4f60\u5e38\u5e38\u6703\u5e0c\u671b React \u53bb\u6307\u5b9a\u521d\u59cb\u503c\uff0c\u4f46\u8b93\u4e4b\u5f8c\u7684\u66f4\u65b0\u4fdd\u6301\u4e0d\u53ef\u63a7\u5236\u7684\u3002\u70ba\u4e86\u8655\u7406\u9019\u7a2e\u60c5\u6cc1\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a <code class=\"language-javascript\">defaultValue</code> attribute \u800c\u975e <code class=\"language-javascript\">value</code>\u3002\u5728 component mount \u5f8c\u6539\u8b8a <code class=\"language-javascript\">defaultValue</code> \u5c6c\u6027\u4e0d\u6703\u9020\u6210\u4efb\u4f55\u5728 DOM \u88e1\u9762\u7684\u503c\u66f4\u65b0\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Name:</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">defaultValue</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Bob<span class=\"token punctuation\">\"</span></span></span>          <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u76f8\u540c\u5730\uff0c <code class=\"language-javascript\">&lt;input type=\"checkbox\"&gt;</code> \u548c <code class=\"language-javascript\">&lt;input type=\"radio\"&gt;</code> \u652f\u63f4 <code class=\"language-javascript\">defaultChecked</code>\uff0c\u800c <code class=\"language-javascript\">&lt;select&gt;</code> \u548c <code class=\"language-javascript\">&lt;textarea&gt;</code> \u652f\u63f4 <code class=\"language-javascript\">defaultValue</code>\u3002</p>\n<h2 id=\"the-file-input-tag\"><a class=\"anchor\" href=\"/react/uncontrolled-components#the-file-input-tag\"></a>\u6a94\u6848\u8f38\u5165\u6a19\u7c64 </h2>\n<p>\u5728 HTML \u88e1\uff0c<code class=\"language-javascript\">&lt;input type=\"file\"&gt;</code> \u8b93\u4f7f\u7528\u8005\u80fd\u5920\u9078\u64c7\u5f9e\u4ed6\u5011\u7684\u88dd\u7f6e\u5132\u5b58\u4f86\u4e0a\u50b3\u4e00\u500b\u6216\u591a\u500b\u6a94\u6848\u5230\u4f3a\u670d\u5668\uff0c\u6216\u7531 JavaScript \u900f\u904e <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\">File API</a> \u4f86\u8655\u7406\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-html\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>\u5728 React \u88e1\uff0c<code class=\"language-javascript\">&lt;input type=\"file\" /&gt;</code> \u6c38\u9060\u90fd\u662f uncontrolled component\uff0c\u56e0\u70ba\u5b83\u7684\u503c\u53ea\u80fd\u88ab\u4f7f\u7528\u8005\u8a2d\u5b9a\uff0c\u800c\u7121\u6cd5\u7531\u7a0b\u5f0f\u78bc\u4f86\u8a2d\u5b9a\u3002</p>\n<p>\u4f60\u61c9\u8a72\u4f7f\u7528 File API \u4f86\u8207\u6a94\u6848\u4e4b\u9593\u4e92\u52d5\u3002\u4ee5\u4e0b\u7bc4\u4f8b\u986f\u793a\u5982\u4f55\u5efa\u7acb\u4e00\u500b <a href=\"/react/refs-and-the-dom\">ref \u5230 DOM \u7bc0\u9ede\u4e0a</a> \u4f86\u53d6\u5f97\u5728\u9001\u51fa\u7684 handler \u7684\u6a94\u6848\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">FileInput</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileInput <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Selected file - </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileInput<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span></span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Upload file:</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileInput<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Submit</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FileInput</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p><a class=\"external-link\" href=\"https://zh-hant.reactjs.org//redirect-to-codepen/uncontrolled-components/input-type-file\">\u5728 CodePen \u4e0a\u8a66\u8a66\u770b\uff01</a></p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/uncontrolled-components.md\">Edit this page</a></p></div></article>", "path": "/react/uncontrolled-components", "nav": ["/react/typechecking-with-proptypes", "/react/web-components"]}, {"key": "Web Component", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React \u548c <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components\">Web Component</a> \u662f\u70ba\u4e86\u89e3\u6c7a\u4e0d\u540c\u7684\u554f\u984c\u6240\u5efa\u7acb\u7684\u3002Web Component \u70ba\u4e86\u53ef\u91cd\u8907\u4f7f\u7528\u7684 component \u63d0\u4f9b\u4e86\u5f37\u5927\u7684\u5c01\u88dd\uff0c\u800c React \u63d0\u4f9b\u4e86\u4e00\u500b\u5ba3\u544a\u5f0f\u51fd\u5f0f\u5eab\uff0c\u4f7f DOM \u8207\u4f60\u7684\u8cc7\u6599\u4fdd\u6301\u540c\u6b65\u3002\u9019\u5169\u500b\u76ee\u6a19\u662f\u76f8\u8f14\u76f8\u6210\u7684\u3002\u4f5c\u70ba\u958b\u767c\u4eba\u54e1\uff0c\u4f60\u53ef\u4ee5\u81ea\u7531\u5730\u5728 Web Component \u4e2d\u4f7f\u7528 React\uff0c\u6216\u5728 React \u4e2d\u4f7f\u7528 Web Component\uff0c\u6216\u5169\u8005\u90fd\u662f\u3002</p>\n<p>\u5927\u90e8\u5206\u4f7f\u7528 React \u7684\u4eba\u6c92\u6709\u4f7f\u7528 Web Component\uff0c\u4f46\u4f60\u53ef\u80fd\u6703\u60f3\u8981\u4f7f\u7528\uff0c\u5c24\u5176\u662f\u4f60\u7528\u5230\u4e86\u4f7f\u7528 Web Component \u6240\u5beb\u7684\u7b2c\u4e09\u65b9\u7684 UI component\u3002</p>\n<h2 id=\"using-web-components-in-react\"><a class=\"anchor\" href=\"/react/web-components#using-web-components-in-react\"></a>\u5728 React \u88e1\u4f7f\u7528 Web Component </h2>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloMessage</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x-search</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x-search</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>Web Component \u901a\u5e38\u6703\u516c\u958b\u547d\u4ee4\u5f0f\u7684 API\u3002\u4f8b\u5982\uff0c\u4e00\u500b <code class=\"language-javascript\">video</code> Web Component \u53ef\u80fd\u6703\u516c\u958b <code class=\"language-javascript\">play()</code> \u548c <code class=\"language-javascript\">pause()</code> \u51fd\u5f0f\u3002\u70ba\u4e86\u80fd\u5920\u4f7f\u7528 Web Component \u7684\u547d\u4ee4\u5f0f API\uff0c\u4f60\u6703\u9700\u8981\u4f7f\u7528 ref \u4f86\u8ddf DOM \u7bc0\u9ede\u76f4\u63a5\u4e92\u52d5\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684 Web Component\uff0c\u6700\u597d\u7684\u89e3\u6cd5\u662f\u5beb\u4e00\u500b React component \u4f86\u5305\u4f4f\u4f60\u7684 Web Component\u3002</p>\n<p>Web Component \u6240\u767c\u51fa\u7684\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u6703\u88ab\u6b63\u78ba\u7684\u50b3\u905e\u5230 React \u7684 render tree\u3002\n\u4f60\u5c07\u6703\u9700\u8981\u624b\u52d5\u628a event handler \u9644\u52a0\u5230\u4f60\u7684 React component \u5167\u8655\u7406\u9019\u4e9b\u4e8b\u4ef6\u3002</p>\n</div>\n<p>\u4e00\u500b\u5e38\u898b\u7684\u7591\u60d1\u662f Web Component \u4f7f\u7528\u300cclass\u300d\u800c\u4e0d\u662f\u300cclassName\u300d\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">BrickFlipbox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>brick-flipbox</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">front</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">back</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>brick-flipbox</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"using-react-in-your-web-components\"><a class=\"anchor\" href=\"/react/web-components#using-react-in-your-web-components\"></a>\u5728\u4f60\u7684 Web Component \u88e1\u4f7f\u7528 React  </h2>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">XSearch</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">HTMLElement</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> mountPoint <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'span'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">attachShadow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'open'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>mountPoint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://www.google.com/search?q='</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>mountPoint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>url<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\ncustomElements<span class=\"token punctuation\">.</span><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">'x-search'</span><span class=\"token punctuation\">,</span> XSearch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5982\u679c\u4f60\u7528 Babel \u8f49\u63db\u4e86 class\uff0c\u9019\u6bb5\u7a0b\u5f0f\u78bc<strong>\u5c07\u4e0d\u6703</strong>\u6b63\u5e38\u904b\u4f5c\u3002\u67e5\u770b<a class=\"external-link\" href=\"https://github.com/w3c/webcomponents/issues/587\">\u9019\u500b issue</a> \u88e1\u9762\u7684\u8a0e\u8ad6\u3002\n\u5728\u8f09\u5165 web component \u4e4b\u524d\u5f15\u5165 <a class=\"external-link\" href=\"https://github.com/webcomponents/polyfills/tree/master/packages/webcomponentsjs#custom-elements-es5-adapterjs\">custom-elements-es5-adapter</a> \u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c\u3002</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/web-components.md\">Edit this page</a></p></div></article>", "path": "/react/web-components", "nav": ["/react/uncontrolled-components", "/react/react-api"]}]}, {"key": "API \u53c3\u8003", "values": [{"key": "React", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><code class=\"language-javascript\">React</code> \u662f React \u51fd\u5f0f\u5eab\u7684\u9032\u5165\u9ede\u3002 \u5982\u679c\u4f60\u4f7f\u7528 <code class=\"language-javascript\">&lt;script&gt;</code> \u6a19\u7c64\u8f09\u5165 React,\u9019\u4e9b\u9802\u5c64 API \u53ef\u4ee5\u5728 <code class=\"language-javascript\">React</code> \u5168\u57df\u8b8a\u6578\u4f7f\u7528\u3002\u5982\u679c\u4f60\u4f7f\u7528 ES6 \u64b0\u5beb\u4e26\u4f7f\u7528 npm\uff0c\u4f60\u53ef\u4ee5\u5beb\u6210 <code class=\"language-javascript\">import React from 'react'</code> \u3002\u5982\u679c\u4f60\u4f7f\u7528 ES5 \u64b0\u5beb\u4e26\u4f7f\u7528 npm\uff0c\u4f60\u53ef\u4ee5\u5beb\u6210 <code class=\"language-javascript\">var React = require('react')</code> \u3002</p>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/react-api#overview\"></a>\u6982\u89c0 </h2>\n<h3 id=\"components\"><a class=\"anchor\" href=\"/react/react-api#components\"></a>Component </h3>\n<p>React component \u53ef\u4ee5\u8b93\u4f60\u628a UI \u5207\u5206\u70ba\u7368\u7acb\u4e26\u53ef\u91cd\u8907\u4f7f\u7528\u7684\u55ae\u4f4d\uff0c\u4e26\u4e14\u6bcf\u500b\u55ae\u4f4d\u53ef\u4ee5\u62bd\u51fa\u4f86\u7368\u7acb\u601d\u8003\u3002React component \u53ef\u4ee5\u900f\u904e\u7e7c\u627f <code class=\"language-javascript\">React.Component</code> \u6216\u662f <code class=\"language-javascript\">React.PureComponent</code> \u5b9a\u7fa9\u3002</p>\n<ul>\n<li><a href=\"/react/react-api#reactcomponent\"><code class=\"language-javascript\">React.Component</code></a></li>\n<li><a href=\"/react/react-api#reactpurecomponent\"><code class=\"language-javascript\">React.PureComponent</code></a></li>\n</ul>\n<p>\u5982\u679c\u4f60\u6c92\u6709\u4f7f\u7528 ES6 class\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">create-react-class</code> \u6a21\u7d44\u3002\u8acb\u53c3\u95b1<a href=\"/react/react-without-es6\">\u4f7f\u7528 React \u4f46\u4e0d\u4f7f\u7528 ES6</a> \u53d6\u5f97\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<p>React component \u4e5f\u53ef\u4ee5\u5b9a\u7fa9\u70ba function \u4e26\u53ef\u4ee5\u88ab\u5c01\u88dd\uff1a</p>\n<ul>\n<li><a href=\"/react/react-api#reactmemo\"><code class=\"language-javascript\">React.memo</code></a></li>\n</ul>\n<h3 id=\"creating-react-elements\"><a class=\"anchor\" href=\"/react/react-api#creating-react-elements\"></a>\u5efa\u7acb React Element </h3>\n<p>\u6211\u5011\u63a8\u85a6<a href=\"/react/introducing-jsx\">\u4f7f\u7528 JSX</a> \u4f86\u63cf\u8ff0\u4f60\u7684 UI \u61c9\u8a72\u9577\u6210\u4ec0\u9ebc\u6a23\u5b50\u3002 \u6bcf\u500b JSX element \u90fd\u53ea\u662f\u547c\u53eb <a href=\"/react/react-api#createelement\"><code class=\"language-javascript\">React.createElement()</code></a> \u7684\u8a9e\u6cd5\u7cd6\u3002\u7576\u4f60\u4f7f\u7528 JSX \u7684\u6642\u5019\u4f60\u5c07\u4e0d\u9700\u8981\u76f4\u63a5\u547c\u53eb\u4ee5\u4e0b\u7684 method\uff1a</p>\n<ul>\n<li><a href=\"/react/react-api#createelement\"><code class=\"language-javascript\">createElement()</code></a></li>\n<li><a href=\"/react/react-api#createfactory\"><code class=\"language-javascript\">createFactory()</code></a></li>\n</ul>\n<p>\u53c3\u95b1<a href=\"/react/react-without-jsx\">\u4f7f\u7528 React \u4f46\u4e0d\u4f7f\u7528 JSX</a> \u53d6\u5f97\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"transforming-elements\"><a class=\"anchor\" href=\"/react/react-api#transforming-elements\"></a>\u64cd\u4f5c Element </h3>\n<p><code class=\"language-javascript\">React</code> \u63d0\u4f9b\u4e86\u591a\u7a2e API \u8b93\u4f60\u53ef\u4ee5\u64cd\u4f5c element\uff1a</p>\n<ul>\n<li><a href=\"/react/react-api#cloneelement\"><code class=\"language-javascript\">cloneElement()</code></a></li>\n<li><a href=\"/react/react-api#isvalidelement\"><code class=\"language-javascript\">isValidElement()</code></a></li>\n<li><a href=\"/react/react-api#reactchildren\"><code class=\"language-javascript\">React.Children</code></a></li>\n</ul>\n<h3 id=\"fragments\"><a class=\"anchor\" href=\"/react/react-api#fragments\"></a>Fragment </h3>\n<p><code class=\"language-javascript\">React</code> \u4e5f\u63d0\u4f9b\u4e86\u4e00\u500b component \u8b93\u4f60\u4e00\u6b21 render \u591a\u500b element \u800c\u4e0d\u9700\u8981\u984d\u5916\u7684 wrapper\u3002</p>\n<ul>\n<li><a href=\"/react/react-api#reactfragment\"><code class=\"language-javascript\">React.Fragment</code></a></li>\n</ul>\n<h3 id=\"refs\"><a class=\"anchor\" href=\"/react/react-api#refs\"></a>Refs </h3>\n<ul>\n<li><a href=\"/react/react-api#reactcreateref\"><code class=\"language-javascript\">React.createRef</code></a></li>\n<li><a href=\"/react/react-api#reactforwardref\"><code class=\"language-javascript\">React.forwardRef</code></a></li>\n</ul>\n<h3 id=\"suspense\"><a class=\"anchor\" href=\"/react/react-api#suspense\"></a>Suspense </h3>\n<p>Suspense \u8b93 components \u5728 render \u4e4b\u524d\u53ef\u4ee5\u300c\u66ab\u505c\u300d\u4e26\u7b49\u5f85\u5176\u4ed6\u4e8b\u60c5\u3002\u76ee\u524d Suspense \u53ea\u652f\u63f4\u4e00\u500b\u60c5\u5883\uff1a<a href=\"/react/code-splitting#reactlazy\">\u4f7f\u7528 <code class=\"language-javascript\">React.lazy</code> \u52d5\u614b\u8f09\u5165 component</a> \u3002\u5728\u672a\u4f86\uff0c\u6211\u5011\u4e5f\u6703\u652f\u63f4\u50cf\u662f\u6293\u53d6\u8cc7\u6599\u7b49\u66f4\u591a\u7684\u4f7f\u7528\u60c5\u5883\u3002</p>\n<ul>\n<li><a href=\"/react/react-api#reactlazy\"><code class=\"language-javascript\">React.lazy</code></a></li>\n<li><a href=\"/react/react-api#reactsuspense\"><code class=\"language-javascript\">React.Suspense</code></a></li>\n</ul>\n<h3 id=\"transitions\"><a class=\"anchor\" href=\"/react/react-api#transitions\"></a>Transitions </h3>\n<p><em>Transitions</em> \u662f React 18 \u5f15\u5165\u7684\u65b0 concurrent \u529f\u80fd\u3002\u5b83\u5011\u5141\u8a31\u4f60 mark \u66f4\u65b0\u70ba transitions\uff0c\u9019\u662f\u544a\u8a34 React \u5b83\u5011\u53ef\u4ee5\u88ab\u4e2d\u65b7\uff0c\u4e26\u4e14\u5c0d\u65bc\u5df2\u7d93\u53ef\u770b\u898b\u7684\u5167\u5bb9\uff0c\u907f\u514d\u56de\u5230 Suspense fallback\u3002</p>\n<ul>\n<li><a href=\"/react/react-api#starttransition\"><code class=\"language-javascript\">React.startTransition</code></a></li>\n<li><a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">React.useTransition</code></a></li>\n</ul>\n<h3 id=\"hooks\"><a class=\"anchor\" href=\"/react/react-api#hooks\"></a>Hooks </h3>\n<p><em>Hooks</em> \u662f React 16.8 \u958b\u59cb\u7684\u65b0\u529f\u80fd\u3002\u9019\u8b93\u4f60\u53ef\u4ee5\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6\u7684 React \u529f\u80fd\u800c\u4e0d\u9700\u8981\u64b0\u5beb\u4e00\u500b class\u3002Hooks \u6709\u4e00\u500b\u5c08\u5c6c\u7684<a href=\"/react/hooks-intro\">\u6587\u4ef6\u5c08\u5340</a> \u548c\u5206\u958b\u7684 API \u53c3\u8003\u8cc7\u6599\uff1a</p>\n<ul>\n<li>\n<p><a href=\"/react/hooks-reference#basic-hooks\">\u57fa\u672c Hooks</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code></a></li>\n<li><a href=\"/react/hooks-reference#useeffect\"><code class=\"language-javascript\">useEffect</code></a></li>\n<li><a href=\"/react/hooks-reference#usecontext\"><code class=\"language-javascript\">useContext</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/react/hooks-reference#additional-hooks\">\u9032\u968e Hooks</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a></li>\n<li><a href=\"/react/hooks-reference#usecallback\"><code class=\"language-javascript\">useCallback</code></a></li>\n<li><a href=\"/react/hooks-reference#usememo\"><code class=\"language-javascript\">useMemo</code></a></li>\n<li><a href=\"/react/hooks-reference#useref\"><code class=\"language-javascript\">useRef</code></a></li>\n<li><a href=\"/react/hooks-reference#useimperativehandle\"><code class=\"language-javascript\">useImperativeHandle</code></a></li>\n<li><a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a></li>\n<li><a href=\"/react/hooks-reference#usedebugvalue\"><code class=\"language-javascript\">useDebugValue</code></a></li>\n<li><a href=\"/react/hooks-reference#usedeferredvalue\"><code class=\"language-javascript\">useDeferredValue</code></a></li>\n<li><a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">useTransition</code></a></li>\n<li><a href=\"/react/hooks-reference#useid\"><code class=\"language-javascript\">useId</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/react/hooks-reference#library-hooks\">Library Hooks</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usesyncexternalstore\"><code class=\"language-javascript\">useSyncExternalStore</code></a></li>\n<li><a href=\"/react/hooks-reference#useinsertioneffect\"><code class=\"language-javascript\">useInsertionEffect</code></a></li>\n</ul>\n</li>\n</ul>\n\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/react-api#reference\"></a>\u53c3\u8003\u8cc7\u6599 </h2>\n<h3 id=\"reactcomponent\"><a class=\"anchor\" href=\"/react/react-api#reactcomponent\"></a><code class=\"language-javascript\">React.Component</code> </h3>\n<p><code class=\"language-javascript\">React.Component</code> \u662f\u7576\u4f60\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes\">ES6 classes</a> \u5b9a\u7fa9 React component \u6642\u6240\u7528\u7684 base class\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u53c3\u95b1 <a href=\"/react/react-component\">React.Component API \u53c3\u8003\u8cc7\u6599</a> \u53ef\u67e5\u5230\u8ddf <code class=\"language-javascript\">React.Component</code> \u76f8\u95dc\u7684 method \u53ca properties\u3002</p>\n\n<h3 id=\"reactpurecomponent\"><a class=\"anchor\" href=\"/react/react-api#reactpurecomponent\"></a><code class=\"language-javascript\">React.PureComponent</code> </h3>\n<p><code class=\"language-javascript\">React.PureComponent</code> \u8ddf <a href=\"/react/react-api#reactcomponent\"><code class=\"language-javascript\">React.Component</code></a> \u5f88\u76f8\u4f3c\u3002\u4ed6\u5011\u4e4b\u9593\u7684\u5dee\u5225\u662f <a href=\"/react/react-api#reactcomponent\"><code class=\"language-javascript\">React.Component</code></a> \u4e26\u6c92\u6709\u5be6\u4f5c <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a>\uff0c\u4f46 <code class=\"language-javascript\">React.PureComponent</code> \u63d0\u4f9b\u4e86\u4e00\u500b\u5be6\u4f5c\u4ee5\u5c0d\u65bc prop \u53ca state \u9032\u884c shallow compare\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5099\u8a3b</strong>\n<p><code class=\"language-javascript\">React.PureComponent</code> \u7684 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u53ea\u5c0d object \u9032\u884c shallow compare\u3002\u5982\u679c\u9019\u4e9b object \u5305\u542b\u8907\u96dc\u7684\u8cc7\u6599\u7d50\u69cb\uff0c\u5728\u6df1\u5c64\u7684\u8cc7\u6599\u6709\u6240\u6539\u8b8a\u7684\u6642\u5019\u5c07\u6709\u53ef\u80fd\u56de\u50b3\u932f\u8aa4\u7d50\u679c (false-negative)\u3002\u7e7c\u627f <code class=\"language-javascript\">PureComponent</code> \u7684\u6642\u5019\uff0c\u8acb\u78ba\u4fdd\u4f60\u53ea\u6709\u7c21\u55ae\u7684 prop \u8ddf state\uff0c\u6216\u5728\u7576\u4f60\u77e5\u9053\u6df1\u5c64\u7684\u8cc7\u6599\u6709\u6240\u6539\u8b8a\u7684\u6642\u5019\u4f7f\u7528 <a href=\"/react/react-component#forceupdate\"><code class=\"language-javascript\">forceUpdate()</code></a>\u3002\u4f60\u4e5f\u53ef\u4ee5\u8003\u616e\u6539\u7528 <a class=\"external-link\" href=\"https://immutable-js.com/\">immutable objects</a> \u9032\u884c\u5feb\u901f\u7684\u6df1\u5c64\u8cc7\u6599\u6bd4\u8f03\u3002</p>\n<p>\u6b64\u5916\uff0c<code class=\"language-javascript\">React.PureComponent</code> \u7684 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u5c07\u6703\u8df3\u904e\u6574\u500b subtree \u7684 prop \u66f4\u65b0\u3002\u8acb\u78ba\u4fdd\u6240\u6709 children component \u4e5f\u662f\u300cpure\u300d\u7684\u3002</p>\n</div>\n\n<h3 id=\"reactmemo\"><a class=\"anchor\" href=\"/react/react-api#reactmemo\"></a><code class=\"language-javascript\">React.memo</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> MyComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* render using props */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">React.memo</code> \u662f\u4e00\u500b <a href=\"/react/higher-order-components\">higher order component</a>\u3002\b</p>\n<p>\u5982\u679c\u4f60\u7684 function component \u6bcf\u6b21\u5f97\u5230\u76f8\u540c prop \u7684\u6642\u5019\u90fd\u6703 render \u76f8\u540c\u7d50\u679c\uff0c\u4f60\u53ef\u4ee5\u5c07\u5176\u5305\u5728 <code class=\"language-javascript\">React.memo</code> \u4e4b\u4e2d\uff0c\u900f\u904e\u5feb\u53d6 render \u7d50\u679c\u4f86\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u52a0\u901f\u3002\u9019\u8868\u793a React \u6703\u8df3\u904e render \u9019\u500b component\uff0c\u4e26\u76f4\u63a5\u91cd\u7528\u4e0a\u6b21\u7684 render \u7d50\u679c\u3002</p>\n<p><code class=\"language-javascript\">React.memo</code> \u53ea\u6703\u78ba\u8a8d props \u7684\u6539\u8b8a\u3002\u5982\u679c\u4f60\u7684 function component \u88ab wrap \u5728 <code class=\"language-javascript\">React.memo</code> \u5167\uff0c\u5be6\u4f5c\u4e2d\u5177\u6709\u4e00\u500b <a href=\"/react/hooks-state\"><code class=\"language-javascript\">useState</code></a>\u3001<a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a> \u6216 <a href=\"/react/hooks-reference#usecontext\"><code class=\"language-javascript\">useContext</code></a> Hook\uff0c\u7576 state \u6216 context \u6539\u8b8a\u6642\uff0c\u5b83\u4ecd\u7136\u6703\u6301\u7e8c rerender\u3002</p>\n<p>\u9019\u9810\u8a2d\u53ea\u6703\u5c0d prop \u9032\u884c shallow compare \u3002\u5982\u679c\u4f60\u9700\u8981\u63a7\u5236\u6bd4\u8f03\u7684\u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u63d0\u4f9b\u4e00\u500b\u81ea\u8a02\u7684\u6bd4\u8f03 function \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* render using props */</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">areEqual</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/*\n  return true if passing nextProps to render would return\n  the same result as passing prevProps to render,\n  otherwise return false\n  */</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span>MyComponent<span class=\"token punctuation\">,</span> areEqual<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u500b function \u662f\u7528\u4f86\u4f5c\u70ba<strong><a href=\"/react/optimizing-performance\">\u6548\u80fd\u6700\u4f73\u5316</a></strong>\u6240\u7528\u3002\u8acb\u52ff\u4f9d\u8cf4\u9019\u500b function \u4f86\u300c\u907f\u514d\u300drender\uff0c\u9019\u53ef\u80fd\u6703\u7522\u751f bug\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5099\u8a3b</strong>\n<p>\u8207 class component \u7684 <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a> method \u4e0d\u540c,<code class=\"language-javascript\">areEqual</code> function \u7576 prop \u76f8\u7b49\u7684\u6642\u5019\u56de\u50b3 <code class=\"language-javascript\">true</code>\uff0c\u4e0d\u76f8\u7b49\u7684\u6642\u5019\u56de\u50b3 <code class=\"language-javascript\">false</code>\u3002 \u9019\u8ddf <code class=\"language-javascript\">shouldComponentUpdate</code> \u525b\u597d\u76f8\u53cd\u3002</p>\n</div>\n\n<h3 id=\"createelement\"><a class=\"anchor\" href=\"/react/react-api#createelement\"></a><code class=\"language-javascript\">createElement()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n  type<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>children<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5efa\u7acb\u4e26\u56de\u50b3\u4e00\u500b\u65b0\u7684 <a href=\"/react/rendering-elements\">React element</a> \u63cf\u8ff0\u6307\u5b9a\u7684 type\u3002 Type \u53c3\u6578\u53ef\u4ee5\u662f\u4e00\u500b\u6a19\u7c64\u540d\u7a31\u5b57\u4e32\uff08\u50cf\u662f <code class=\"language-javascript\">'div'</code> \u6216\u662f <code class=\"language-javascript\">'span'</code>\uff09\u3001\u4e00\u500b <a href=\"/react/components-and-props\">React component</a> type (class \u6216\u662f function) \u6216\u8005\u662f\u4e00\u500b <a href=\"/react/react-api#reactfragment\">React fragment</a> type\u3002</p>\n<p>\u4f7f\u7528 <a href=\"/react/introducing-jsx\">JSX</a> \u5beb\u7684\u7a0b\u5f0f\u5c07\u6703\u88ab\u8f49\u63db\u4f7f\u7528 <code class=\"language-javascript\">React.createElement()</code>\u3002\u5982\u679c\u4f7f\u7528 JSX\uff0c\u4f60\u901a\u5e38\u4e0d\u9700\u8981\u81ea\u5df1\u547c\u53eb <code class=\"language-javascript\">React.createElement()</code>\u3002\u8acb\u53c3\u95b1<a href=\"/react/react-without-jsx\">\u4f7f\u7528 React \u4f46\u4e0d\u4f7f\u7528 JSX</a>\u3002</p>\n\n<h3 id=\"cloneelement\"><a class=\"anchor\" href=\"/react/react-api#cloneelement\"></a><code class=\"language-javascript\">cloneElement()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">React.cloneElement(\n  element,\n  [config],\n  [...children]\n)</code></pre></div>\n<p>\u4f7f\u7528 <code class=\"language-javascript\">element</code> \u4f5c\u70ba\u958b\u59cb clone \u4e26\u56de\u50b3\u4e00\u500b\u65b0 React element\u3002<code class=\"language-javascript\">config</code> \u61c9\u8a72\u5305\u542b\u6240\u6709\u65b0\u7684 props\u3001<code class=\"language-javascript\">key</code>\u3001\u6216 <code class=\"language-javascript\">ref</code>\u3002\u7522\u751f\u7684 element \u5c07\u6703\u6709\u539f\u59cb element \u7684 props \u4ee5\u53ca\u65b0 props \u7684 shallow merge\u3002\u65b0\u7684 children \u6703\u53d6\u4ee3\u73fe\u6709\u7684 children\u3002\u5982\u679c <code class=\"language-javascript\">config</code> \u4e2d\u4e0d\u5b58\u5728 <code class=\"language-javascript\">key</code> \u548c <code class=\"language-javascript\">ref</code>\uff0c\u5247\u539f\u59cb\u7684 <code class=\"language-javascript\">key</code> \u548c <code class=\"language-javascript\">ref</code> \u6703\u88ab\u4fdd\u7559\u3002</p>\n<p><code class=\"language-javascript\">React.cloneElement()</code> \u5e7e\u4e4e\u7b49\u65bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>element.type</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>element.type</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u4f46\u662f\uff0c\u9019\u540c\u6642\u4e5f\u6703\u4fdd\u7559 <code class=\"language-javascript\">ref</code>\u3002\u5982\u679c\u4f60\u6709\u4e00\u500b child \u4e0a\u6709 <code class=\"language-javascript\">ref</code> \u7684\u6642\u5019\uff0c\u4f60\u5c07\u4e0d\u6703\u4e0d\u5c0f\u5fc3\u5f9e\u4f60\u7684\u4e0a\u5c64\u5143\u4ef6\u5077\u8d70 ref\u3002\u4f60\u7684\u65b0 element \u6703\u4fdd\u7559\u4e00\u6a23\u7684 <code class=\"language-javascript\">ref</code>\u3002\u5982\u679c\u6709\u5b58\u5728 <code class=\"language-javascript\">ref</code> \u6216 <code class=\"language-javascript\">key</code> \u7684\u8a71\uff0c\u5c07\u6703\u53d6\u4ee3\u820a\u7684\u3002</p>\n<p>\u9019\u500b API \u662f\u7528\u4f86\u53d6\u4ee3\u76ee\u524d\u5df2\u7d93\u904e\u6642\u7684 <code class=\"language-javascript\">React.addons.cloneWithProps()</code>\u3002</p>\n\n<h3 id=\"createfactory\"><a class=\"anchor\" href=\"/react/react-api#createfactory\"></a><code class=\"language-javascript\">createFactory()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createFactory</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b function \u53ef\u4ee5\u7522\u751f\u6307\u5b9a type \u7684 React element\u3002\u8ddf <a href=\"/react/react-api#createelement\"><code class=\"language-javascript\">React.createElement()</code></a> \u4e00\u6a23\uff0c\u9019\u500b type \u53c3\u6578\u53ef\u4ee5\u662f\u4e00\u500b\u6a19\u7c64\u540d\u7a31\u5b57\u4e32\uff08\u50cf\u662f <code class=\"language-javascript\">'div'</code> \u6216\u662f <code class=\"language-javascript\">'span'</code>\uff09\u3001\u4e00\u500b <a href=\"/react/components-and-props\">React component</a> type (class \u6216\u662f function) \u6216\u8005\u662f\u4e00\u500b <a href=\"/react/react-api#reactfragment\">React fragment</a> type\u3002</p>\n<p>\u9019\u500b helper \u5df2\u7d93\u88ab\u8a8d\u5b9a\u70ba\u904e\u6642\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u4f7f\u7528 JSX \u6216\u662f\u76f4\u63a5\u4f7f\u7528 <code class=\"language-javascript\">React.createElement()</code>\u3002</p>\n<p>\u5982\u679c\u4f7f\u7528 JSX\uff0c\u4f60\u901a\u5e38\u4e0d\u9700\u8981\u81ea\u5df1\u547c\u53eb <code class=\"language-javascript\">React.createFactory()</code>\u3002\u8acb\u53c3\u95b1<a href=\"/react/react-without-jsx\">\u4f7f\u7528 React \u4f46\u4e0d\u4f7f\u7528 JSX</a>\u3002</p>\n\n<h3 id=\"isvalidelement\"><a class=\"anchor\" href=\"/react/react-api#isvalidelement\"></a><code class=\"language-javascript\">isValidElement()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">isValidElement</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u6aa2\u67e5\u4e00\u500b object \u662f\u5426\u70ba React element\u3002\u901a\u5e38\u56de\u50b3 <code class=\"language-javascript\">true</code> \u6216\u662f <code class=\"language-javascript\">false</code>\u3002</p>\n\n<h3 id=\"reactchildren\"><a class=\"anchor\" href=\"/react/react-api#reactchildren\"></a><code class=\"language-javascript\">React.Children</code> </h3>\n<p><code class=\"language-javascript\">React.Children</code> \u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u53ef\u4ee5\u5c07 <code class=\"language-javascript\">this.props.children</code> \u4f5c\u70ba\u4e0d\u900f\u660e\u7684\u8cc7\u6599\u7d50\u69cb\u8655\u7406\u3002</p>\n<h4 id=\"reactchildrenmap\"><a class=\"anchor\" href=\"/react/react-api#reactchildrenmap\"></a><code class=\"language-javascript\">React.Children.map</code> </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>thisArg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5c0d\u6bcf\u4e00\u500b\u5217\u70ba <code class=\"language-javascript\">children</code> \u4e4b\u4e2d\u7684\u76f4\u63a5 child \u547c\u53eb function \u4e26\u5c07 <code class=\"language-javascript\">this</code> \u8a2d\u5b9a\u70ba <code class=\"language-javascript\">thisArg</code>\u3002\u5982\u679c <code class=\"language-javascript\">children</code> \u662f\u4e00\u500b array\uff0c\u9019\u5c07\u6703\u5217\u8209\u6574\u500b array \u4e26\u5c0d\u6bcf\u4e00\u500b child \u547c\u53eb\u9019\u500b function\u3002\u5982\u679c children \u662f <code class=\"language-javascript\">null</code> \u6216\u662f <code class=\"language-javascript\">undefined</code>\uff0c\u9019\u500b method \u5c07\u6703\u56de\u50b3 <code class=\"language-javascript\">null</code> \u6216\u662f <code class=\"language-javascript\">undefined</code> \u800c\u4e0d\u662f\u4e00\u500b array\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5099\u8a3b</strong>\n<p>\u5982\u679c <code class=\"language-javascript\">children</code> \u662f\u4e00\u500b <code class=\"language-javascript\">Fragment</code>\uff0c\u5b83\u5c07\u6703\u88ab\u8996\u70ba\u53ea\u6709\u4e00\u500b child \u800c\u4e0d\u6703\u7e7c\u7e8c\u6df1\u5165\u5217\u8209\u3002</p>\n</div>\n<h4 id=\"reactchildrenforeach\"><a class=\"anchor\" href=\"/react/react-api#reactchildrenforeach\"></a><code class=\"language-javascript\">React.Children.forEach</code> </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>thisArg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u8ddf <a href=\"/react/react-api#reactchildrenmap\"><code class=\"language-javascript\">React.Children.map()</code></a> \u4e00\u6a23\uff0c\u4f46\u4e0d\u6703\u56de\u50b3\u4e00\u500b array \u3002</p>\n<h4 id=\"reactchildrencount\"><a class=\"anchor\" href=\"/react/react-api#reactchildrencount\"></a><code class=\"language-javascript\">React.Children.count</code> </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u56de\u50b3 <code class=\"language-javascript\">children</code> \u5230\u5e95\u6709\u5e7e\u500b child\uff0c\u8ddf\u50b3\u5165 <code class=\"language-javascript\">map</code> \u6216\u662f <code class=\"language-javascript\">forEach</code> \u7684 callback \u6703\u88ab\u547c\u53eb\u7684\u6b21\u6578\u4e00\u81f4\u3002</p>\n<h4 id=\"reactchildrenonly\"><a class=\"anchor\" href=\"/react/react-api#reactchildrenonly\"></a><code class=\"language-javascript\">React.Children.only</code> </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">only</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u78ba\u8a8d <code class=\"language-javascript\">children</code> \u53ea\u6709\u4e00\u500b child (\u4e00\u500b React element\uff09\u4e26\u56de\u50b3\u5b83\uff0c\u4e0d\u7136\u9019\u500b method \u5c07\u6703\u62cb\u51fa\u932f\u8aa4\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5099\u8a3b</strong>\n<p><code class=\"language-javascript\">React.Children.only()</code> \u7121\u6cd5\u63a5\u53d7 <a href=\"/react/react-api#reactchildrenmap\"><code class=\"language-javascript\">React.Children.map()</code></a> \u7684\u56de\u50b3\u503c\uff0c\u56e0\u70ba\u90a3\u500b\u56de\u50b3\u503c\u5c07\u6703\u662f\u4e00\u500b array \u800c\u4e0d\u662f\u4e00\u500b React element \u3002</p>\n</div>\n<h4 id=\"reactchildrentoarray\"><a class=\"anchor\" href=\"/react/react-api#reactchildrentoarray\"></a><code class=\"language-javascript\">React.Children.toArray</code> </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5c07 <code class=\"language-javascript\">children</code> \u9019\u500b\u4e0d\u900f\u660e\u7684\u8cc7\u6599\u7d50\u69cb\u8f49\u70ba\u4e00\u500b\u6241\u5e73\u7684 array \u4e26\u5c0d\u6bcf\u500b child \u6307\u5b9a\u4e00\u500b key\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u4f60\u7684 render method \u4e2d\u64cd\u4f5c children \u7684\u96c6\u5408\u6642\u975e\u5e38\u6709\u7528\uff0c\u7279\u5225\u662f\u7576\u4f60\u60f3\u8981\u5728\u50b3\u905e\u5b83\u5011\u4e4b\u524d\u8abf\u6574\u9806\u5e8f\u6216\u662f\u64f7\u53d6\u4e00\u90e8\u4efd <code class=\"language-javascript\">this.props.children</code> \u7684\u6642\u5019\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5099\u8a3b</strong>\n<p><code class=\"language-javascript\">React.Children.toArray()</code> \u6703\u6539\u8b8a key \u4f86\u4fdd\u7559\u5de2\u72c0 array \u7684\u8a9e\u610f\u3002\u4e5f\u5c31\u662f\u8aaa <code class=\"language-javascript\">toArray</code> \u5c07\u6703\u5728\u6bcf\u500b key \u524d\u9762\u52a0\u5165\u524d\u7db4\uff0c\u78ba\u4fdd\u6bcf\u500b element \u7684 key \u90fd\u5728\u8207\u5b83\u539f\u672c\u8f38\u5165\u7684 array \u76f8\u95dc\u3002</p>\n</div>\n\n<h3 id=\"reactfragment\"><a class=\"anchor\" href=\"/react/react-api#reactfragment\"></a><code class=\"language-javascript\">React.Fragment</code> </h3>\n<p><code class=\"language-javascript\">React.Fragment</code> \u8b93\u4f60\u53ef\u4ee5\u5728\u4e00\u500b <code class=\"language-javascript\">render()</code> method \u4e2d\u4e00\u6b21\u56de\u50b3\u591a\u500b element \u800c\u4e0d\u9700\u8981\u5efa\u7acb\u4e00\u500b\u984d\u5916\u7684 DOM element\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      Some text.\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">A heading</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.Fragment</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">&lt;&gt;&lt;/&gt;</code> \u7684\u7cbe\u7c21\u8868\u793a\u6cd5\u3002\u8acb\u53c3\u95b1 <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2017/11/28/react-v16.2.0-fragment-support.html\">React v16.2.0\uff1a \u66f4\u597d\u7684 Fragment \u652f\u63f4</a>\u4ee5\u7372\u5f97\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"reactcreateref\"><a class=\"anchor\" href=\"/react/react-api#reactcreateref\"></a><code class=\"language-javascript\">React.createRef</code> </h3>\n<p><code class=\"language-javascript\">React.createRef</code> \u6703\u5efa\u7acb\u4e00\u500b <a href=\"/react/refs-and-the-dom\">ref</a> \u4ee5\u900f\u904e ref attribute \u593e\u5e36\u5728\u4e00\u500b React element \u4e4b\u4e0a\u3002\n<div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<h3 id=\"reactforwardref\"><a class=\"anchor\" href=\"/react/react-api#reactforwardref\"></a><code class=\"language-javascript\">React.forwardRef</code> </h3>\n<p><code class=\"language-javascript\">React.forwardRef</code> \u6703\u5efa\u7acb\u4e00\u500b React component \u4e26\u5c07 <a href=\"/react/refs-and-the-dom\">ref</a> attribute \u8f49\u4ea4\u7d66\u65d7\u4e0b\u7684\u53e6\u5916\u4e00\u500b component \u3002\u9019\u500b\u6280\u5de7\u4e0d\u662f\u5f88\u5e38\u88ab\u4f7f\u7528\uff0c\u4f46\u5728\u4ee5\u4e0b\u5169\u500b\u60c5\u6cc1\u5f88\u9069\u5408\uff1a</p>\n<ul>\n<li><a href=\"/react/forwarding-refs#forwarding-refs-to-dom-components\">\u5c07 ref \u8f49\u4ea4\u7d66 DOM component</a></li>\n<li><a href=\"/react/forwarding-refs#forwarding-refs-in-higher-order-components\">\u5728 higher-order-component \u4e4b\u4e2d\u8f49\u4ea4 ref</a></li>\n</ul>\n<p><code class=\"language-javascript\">React.forwardRef</code> \u63a5\u53d7\u4e00\u500b render function \u4f5c\u70ba\u53c3\u6578\u3002React \u6703\u547c\u53eb\u9019\u500b function \u4e26\u50b3\u5165\u5169\u500b\u53c3\u6578\uff1a <code class=\"language-javascript\">props</code> \u4ee5\u53ca <code class=\"language-javascript\">ref</code> \u3002\u9019\u500b function \u61c9\u8a72\u8981\u56de\u50b3\u4e00\u500b React node\u3002</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> FancyButton <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>FancyButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// You can now get a ref directly to the DOM button:</span>\n<span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FancyButton</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click me!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">FancyButton</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre>\n</div></p>\n<p>\u5728\u4e0a\u9762\u9019\u500b\u7bc4\u4f8b\uff0cReact \u6703\u628a\u7d66\u4e88 <code class=\"language-javascript\">&lt;FancyButton ref={ref}&gt;</code> \u7684 <code class=\"language-javascript\">ref</code> \u8f49\u4ea4\u7d66\u50b3\u5165 <code class=\"language-javascript\">React.forwardRef</code> \u7684 function \u4f5c\u70ba\u5176\u7b2c\u4e8c\u500b\u53c3\u6578\u3002\u9019\u500b render function \u63a5\u8457\u5c07\u9019\u500b <code class=\"language-javascript\">ref</code> \u8f49\u4ea4\u7d66 <code class=\"language-javascript\">&lt;button ref={ref}&gt;</code> element\u3002</p>\n<p>\u7d50\u679c\uff0c\u7576 React \u593e\u4e0a\u9019\u500b ref \u7684\u6642\u5019\uff0c<code class=\"language-javascript\">ref.current</code> \u5c07\u6703\u76f4\u63a5\u6307\u5230 <code class=\"language-javascript\">&lt;button&gt;</code> \u9019\u500b DOM element \u5be6\u4f8b\u3002</p>\n<p>\u8acb\u53c3\u95b1<a href=\"/react/forwarding-refs\">\u8f49\u4ea4 ref</a> \u7372\u5f97\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"reactlazy\"><a class=\"anchor\" href=\"/react/react-api#reactlazy\"></a><code class=\"language-javascript\">React.lazy</code> </h3>\n<p><code class=\"language-javascript\">React.lazy()</code> \u8b93\u4f60\u53ef\u4ee5\u5b9a\u7fa9\u4e00\u500b\u52d5\u614b\u8f09\u5165\u7684 component\u3002\u9019\u53ef\u4ee5\u5728\u521d\u59cb render \u671f\u9593\u5ef6\u7de9\u8f09\u5165\u6c92\u6709\u88ab\u7528\u5230\u7684 component \u4f86\u6e1b\u5c11 bundle size\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u95b1\u8b80\u6211\u5011\u7684 <a href=\"/react/code-splitting#reactlazy\">code splitting \u6587\u4ef6</a> \u4f86\u5b78\u7fd2\u600e\u9ebc\u4f7f\u7528\u5b83\u3002\u4f60\u53ef\u80fd\u4e5f\u60f3\u8981\u95b1\u8b80<a class=\"external-link\" href=\"https://medium.com/@pomber/lazy-loading-and-preloading-components-in-react-16-6-804de091c82d\">\u9019\u7bc7\u6587\u7ae0</a> \u66f4\u6df1\u5165\u4e86\u89e3\u5982\u4f55\u4f7f\u7528\u9019\u500b function\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// This component is loaded dynamically</span>\n<span class=\"token keyword\">const</span> SomeComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./SomeComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u8acb\u6ce8\u610f\u7576\u4f60\u4f7f\u7528 <code class=\"language-javascript\">lazy</code> component \u7684\u6642\u5019\uff0c\u4f60\u7684 render tree \u4e0a\u5c64\u4e2d\u5fc5\u9808\u5305\u542b\u4e00\u500b <code class=\"language-javascript\">&lt;React.Suspense&gt;</code> \u4f86\u6307\u5b9a loading indicator\u3002</p>\n<h3 id=\"reactsuspense\"><a class=\"anchor\" href=\"/react/react-api#reactsuspense\"></a><code class=\"language-javascript\">React.Suspense</code> </h3>\n<p><code class=\"language-javascript\">React.Suspense</code> \u8b93\u4f60\u6307\u5b9a loading indicator\uff0c\u907f\u514d\u4e0b\u9762 tree \u4e2d\u7684\u67d0\u4e9b component \u5c1a\u672a\u6e96\u5099\u597d render\u3002\u672a\u4f86\u6211\u5011\u8a08\u756b\u8b93 <code class=\"language-javascript\">Suspense</code> \u8655\u7406\u66f4\u591a\u5834\u666f\uff0c\u50cf\u662f\u8cc7\u6599\u7684\u53d6\u5f97\u3002\u4f60\u53ef\u4ee5\u95b1\u8b80\u95dc\u65bc\u9019\u500b\u5728<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/11/27/react-16-roadmap.html\">\u6211\u5011\u7684 roadmap</a>\u3002</p>\n<p>\u73fe\u5728\uff0clazy loading component \u662f <code class=\"language-javascript\">&lt;React.Suspense&gt;</code> <strong>\u552f\u4e00</strong>\u652f\u63f4\u7684\u4f7f\u7528\u5834\u666f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// This component is loaded dynamically</span>\n<span class=\"token keyword\">const</span> OtherComponent <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./OtherComponent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// Displays &lt;Spinner&gt; until OtherComponent loads</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Spinner</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OtherComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.Suspense</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u6211\u5011\u7684 <a href=\"/react/code-splitting#reactlazy\">code splitting \u6587\u4ef6</a> \u6709\u66f4\u591a\u8cc7\u8a0a\u3002\u8acb\u6ce8\u610f <code class=\"language-javascript\">lazy</code> component \u53ef\u4ee5\u5728 <code class=\"language-javascript\">Suspense</code> tree \u4e2d\u5e95\u4e0b\u5f88\u591a\u5c64 \u2500\u2500 \u4f60\u4e0d\u9700\u8981\u628a\u6bcf\u4e00\u500b <code class=\"language-javascript\">lazy</code> \u5143\u7d20\u5305\u8d77\u4f86\u3002\u6700\u597d\u7684\u65b9\u6cd5\u662f\u5c07 <code class=\"language-javascript\">&lt;Suspense&gt;</code> \u653e\u5728\u4f60\u60f3\u770b\u5230 loading indicator \u7684\u5730\u65b9\uff0c\u800c\u5728\u6240\u6709\u4f60\u60f3\u9032\u884c code splitting \u7684\u5730\u65b9\u4f7f\u7528 <code class=\"language-javascript\">lazy()</code> \u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5c0d\u65bc\u5df2\u7d93\u986f\u793a\u7d66\u4f7f\u7528\u8005\u7684\u5167\u5bb9\uff0c\u5207\u63db\u56de loading indicator \u53ef\u80fd\u6703\u8b93\u4eba\u8ff7\u60d1\u3002\u6709\u6642\u5019\u5728\u65b0\u7684 UI \u6e96\u5099\u597d\u4e4b\u524d\uff0c\u986f\u793a\u300c\u820a\u300d\u7684 UI \u6703\u4f86\u5f97\u66f4\u597d\u3002\u82e5\u8981\u9054\u6210\u9019\u500b\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u65b0\u7684 <a href=\"/react/react-api#starttransition\"><code class=\"language-javascript\">startTransition</code></a> \u548c <a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">useTransition</code></a> transition APIs\uff0c\u4f86 mark \u66f4\u65b0\u70ba\u4e00\u500b transitions\uff0c\u4e26\u4e14\u907f\u514d\u4e0d\u9810\u671f\u7684 fallback\u3002</p>\n</div>\n<h4 id=\"reactsuspense-in-server-side-rendering\"><a class=\"anchor\" href=\"/react/react-api#reactsuspense-in-server-side-rendering\"></a><code class=\"language-javascript\">React.Suspense</code> \u662f Server Side Rendering </h4>\n<p>\u5728 server side rendering \u671f\u9593\uff0cSuspense Boundaries \u5141\u8a31\u4f60\u900f\u904e suspending \u4ee5\u66f4\u5c0f\u7684 chunks \u4f86 flush \u61c9\u7528\u7a0b\u5f0f\u3002\n\u7576\u4e00\u500b component suspends \u6642\uff0c\u6211\u5011 schedule \u4e00\u500b\u4f4e\u512a\u5148\u7d1a\u7684 task \u4f86 render \u6700\u8fd1\u7684 Suspense boundary \u7684 fallback\u3002\u5982\u679c component \u5728\u6211\u5011 flush fallback \u4e4b\u524d unsuspends\uff0c\u90a3\u9ebc\u6211\u5011\u628a\u5be6\u969b\u7684\u5167\u5bb9\u50b3\u9001\u4e0b\u53bb\uff0c\u4e26\u4e1f\u68c4 fallback\u3002</p>\n<h4 id=\"reactsuspense-during-hydration\"><a class=\"anchor\" href=\"/react/react-api#reactsuspense-during-hydration\"></a><code class=\"language-javascript\">React.Suspense</code> during hydration </h4>\n<p>Suspense boundary \u4f9d\u8cf4\u65bc\u5b83\u5011\u7684 parent boundary \u5728\u5b83\u5011\u88ab hydrate \u4e4b\u524d\u88ab hydrate\uff0c\u4f46\u5b83\u5011\u53ef\u4ee5\u7368\u7acb\u65bc sibling boundary hydrate\u3002\u5728\u88ab hydrate \u4e4b\u524d\u767c\u751f\u7684 event \u5c07\u6703\u5c0e\u81f4 boundary hydrate \u7684\u512a\u5148\u7d1a\u9ad8\u65bc\u76f8\u9130\u7684 boundary\u3002<a class=\"external-link\" href=\"https://github.com/reactwg/react-18/discussions/130\">\u95b1\u8b80\u66f4\u591a</a>\u3002</p>\n<h3 id=\"starttransition\"><a class=\"anchor\" href=\"/react/react-api#starttransition\"></a><code class=\"language-javascript\">React.startTransition</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">React<span class=\"token punctuation\">.</span><span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u500b\u65b9\u6cd5\u88ab\u8a2d\u8a08\u7684\u662f\u88ab\u7528\u5728\u7576 <a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">React.useTransition</code></a> \u4e0d\u53ef\u4f7f\u7528\u6642\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5728 transition \u4e2d\u7684\u66f4\u65b0\u6703\u7522\u751f\u66f4\u7dca\u6025\u7684\u66f4\u65b0\uff0c\u4f8b\u5982\uff1a\u9ede\u64ca\u3002</p>\n<p>\u5728 transition \u4e2d\u7684\u66f4\u65b0\u4e0d\u6703\u986f\u793a re-suspended \u7684 fallback \u5167\u5bb9\uff0c\u5141\u8a31\u4f7f\u7528\u8005\u53ef\u4ee5\u5728\u66f4\u65b0\u671f\u9593\u7e7c\u7e8c\u4e92\u52d5\u3002</p>\n<p><code class=\"language-javascript\">React.startTransition</code> \u4e0d\u63d0\u4f9b\u4e00\u500b <code class=\"language-javascript\">isPending</code> \u7684 flag\u3002\u82e5\u8981\u8ffd\u8e64 transition \u7684 pending \u72c0\u614b\uff0c\u53c3\u8003 <a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">React.useTransition</code></a>\u3002</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-react.md\">Edit this page</a></p></div></article>", "path": "/react/react-api", "nav": ["/react/web-components", "/react/react-component"]}, {"key": "React.Component", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u672c\u7ae0\u7bc0\u5305\u542b\u4e86 React component class \u7684\u8a73\u7d30 API \u53c3\u8003\u3002\u6211\u5011\u5047\u8a2d\u4f60\u5c0d React \u7684\u57fa\u672c\u6982\u5ff5\u5df2\u5341\u5206\u719f\u6089\uff0c\u4f8b\u5982 <a href=\"/react/components-and-props\">Component \u548c Prop</a> \u4ee5\u53ca <a href=\"/react/state-and-lifecycle\">State \u548c \u751f\u547d\u9031\u671f</a>\u3002\u5982\u679c\u4f60\u5c0d\u9019\u4e9b\u6982\u5ff5\u9084\u4e0d\u6e05\u695a\uff0c\u8acb\u5148\u95b1\u8b80\u76f8\u95dc\u6587\u4ef6\u3002</p>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/react-component#overview\"></a>\u6982\u89c0 </h2>\n<p>\u5728 React \u4e2d\uff0c\u4f60\u53ef\u4ee5\u5c07 component \u5b9a\u7fa9\u6210 class \u6216 function\u3002\u76ee\u524d\uff0c\u88ab\u5b9a\u7fa9\u70ba class \u7684 component \u63d0\u4f9b\u4e86\u66f4\u591a\u529f\u80fd\uff0c\u6211\u5011\u5c07\u6703\u5728\u672c\u7ae0\u7bc0\u4e2d\u9010\u4e00\u4ecb\u7d39\u3002\u8981\u5b9a\u7fa9\u4e00\u500b React component class\uff0c\u4f60\u9700\u8981\u7e7c\u627f\uff08extend\uff09<code class=\"language-javascript\">React.Component</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Welcome</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728 <code class=\"language-javascript\">React.Component</code> \u7684 subclass \u4e2d\u552f\u4e00\u4e00\u500b\u4f60<em>\u5fc5\u9808</em>\u5b9a\u7fa9\u7684\u65b9\u6cd5\u662f <a href=\"/react/react-component#render\"><code class=\"language-javascript\">render()</code></a>\u3002\u672c\u7ae0\u7bc0\u4e2d\u6240\u6709\u5176\u4ed6\u7684\u65b9\u6cd5\u90fd\u4e26\u975e\u7d55\u5c0d\u5fc5\u8981\u3002</p>\n<p><strong>\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u4f60\u4e0d\u8981\u5efa\u7acb\u81ea\u5df1\u7684 base component class\u3002</strong> \u5728 React component \u4e2d\uff0c<a href=\"/react/composition-vs-inheritance\">\u7a0b\u5f0f\u7684\u91cd\u8907\u4f7f\u7528\u6027\u4e3b\u8981\u662f\u900f\u904e\u7d44\u5408\u800c\u975e\u7e7c\u627f\u4f86\u5b8c\u6210\u7684</a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>React \u4e26\u4e0d\u6703\u5f37\u8feb\u4f60\u4f7f\u7528 ES6 class \u8a9e\u6cd5\u3002\u5982\u679c\u4f60\u60f3\u907f\u514d\u5b83\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">create-react-class</code> \u6216\u4e00\u500b\u985e\u4f3c\u7684\u81ea\u8a02\u62bd\u8c61\u3002\u60f3\u4e86\u89e3\u66f4\u591a\u8a73\u60c5\uff0c\u8acb\u53c3\u8003<a href=\"/react/react-without-es6\">\u5982\u4f55\u5728 React \u4e2d\u4e0d\u4f7f\u7528 ES6</a>\u4e00\u6587\u3002</p>\n</div>\n<h3 id=\"the-component-lifecycle\"><a class=\"anchor\" href=\"/react/react-component#the-component-lifecycle\"></a>Component \u751f\u547d\u9031\u671f </h3>\n<p>\u6bcf\u4e00\u500b component \u90fd\u6709\u6578\u500b \u300c\u751f\u547d\u9031\u671f\u65b9\u6cd5\u300d\uff0c\u4f60\u53ef\u4ee5 <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Method_overriding\">override</a> \u9019\u4e9b\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u5728\u958b\u767c\u904e\u7a0b\u4e2d\u67d0\u4e9b\u7279\u5b9a\u7684\u6642\u523b\u57f7\u884c\u67d0\u4e9b\u7a0b\u5f0f\u3002<strong>\u4f60\u53ef\u4ee5\u4f7f\u7528<a class=\"external-link\" href=\"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/\">\u9019\u500b\u751f\u547d\u9031\u671f\u8868</a>\u4f5c\u70ba\u901f\u67e5\u8868\u3002</strong> \u4ee5\u4e0b\uff0c\u5e38\u7528\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5c07\u6703\u4ee5\u7c97\u9ad4\u8868\u9054\u3002\u5176\u9918\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5247\u76f8\u5c0d\u8f03\u5c11\u3002</p>\n<h4 id=\"mounting\"><a class=\"anchor\" href=\"/react/react-component#mounting\"></a>Mounting </h4>\n<p>\u7576\u4e00\u500b component \u7684 instance \u88ab\u5efa\u7acb\u4e14\u52a0\u5165 DOM \u4e2d\u6642\uff0c\u5176\u751f\u547d\u9031\u671f\u5c07\u6703\u4f9d\u7167\u4e0b\u5217\u7684\u9806\u5e8f\u547c\u53eb\u9019\u4e9b\u65b9\u6cd5\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#constructor\"><strong><code class=\"language-javascript\">constructor()</code></strong></a></li>\n<li><a href=\"/react/react-component#static-getderivedstatefromprops\"><code class=\"language-javascript\">static getDerivedStateFromProps()</code></a></li>\n<li><a href=\"/react/react-component#render\"><strong><code class=\"language-javascript\">render()</code></strong></a></li>\n<li><a href=\"/react/react-component#componentdidmount\"><strong><code class=\"language-javascript\">componentDidMount()</code></strong></a></li>\n</ul>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u65b9\u6cd5\u5df2\u7d93\u88ab\u8a8d\u70ba\u5df2\u904e\u6642\uff0c\u4f60\u5728\u5beb\u65b0\u7a0b\u5f0f\u61c9<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u907f\u514d\u4f7f\u7528</a>\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#unsafe_componentwillmount\"><code class=\"language-javascript\">UNSAFE_componentWillMount()</code></a></li>\n</ul>\n</div>\n<h4 id=\"updating\"><a class=\"anchor\" href=\"/react/react-component#updating\"></a>\u66f4\u65b0 </h4>\n<p>\u7576 prop \u6216 state \u6709\u8b8a\u5316\u6642\uff0c\u5c31\u6703\u7522\u751f\u66f4\u65b0\u3002\u7576\u4e00\u500b component \u88ab\u91cd\u65b0 render \u6642\uff0c\u5176\u751f\u547d\u9031\u671f\u5c07\u6703\u4f9d\u7167\u4e0b\u5217\u7684\u9806\u5e8f\u547c\u53eb\u9019\u4e9b\u65b9\u6cd5\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#static-getderivedstatefromprops\"><code class=\"language-javascript\">static getDerivedStateFromProps()</code></a></li>\n<li><a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a></li>\n<li><a href=\"/react/react-component#render\"><strong><code class=\"language-javascript\">render()</code></strong></a></li>\n<li><a href=\"/react/react-component#getsnapshotbeforeupdate\"><code class=\"language-javascript\">getSnapshotBeforeUpdate()</code></a></li>\n<li><a href=\"/react/react-component#componentdidupdate\"><strong><code class=\"language-javascript\">componentDidUpdate()</code></strong></a></li>\n</ul>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u4e0b\u5217\u65b9\u6cd5\u5df2\u904e\u6642\uff0c\u4f60\u5728\u5beb\u65b0\u7a0b\u5f0f\u61c9<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u907f\u514d\u4f7f\u7528</a>\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#unsafe_componentwillupdate\"><code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code></a></li>\n<li><a href=\"/react/react-component#unsafe_componentwillreceiveprops\"><code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code></a></li>\n</ul>\n</div>\n<h4 id=\"unmounting\"><a class=\"anchor\" href=\"/react/react-component#unmounting\"></a>Unmounting </h4>\n<p>\u7576\u4e00\u500b component \u88ab\u5f9e DOM \u4e2d\u79fb\u9664\u6642\uff0c\u9019\u500b\u65b9\u6cd5\u5c07\u6703\u88ab\u547c\u53eb\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#componentwillunmount\"><strong><code class=\"language-javascript\">componentWillUnmount()</code></strong></a></li>\n</ul>\n<h4 id=\"error-handling\"><a class=\"anchor\" href=\"/react/react-component#error-handling\"></a>\u932f\u8aa4\u8655\u7406 </h4>\n<p>\u7576\u4e00\u500b component \u5728 render \u7684\u904e\u7a0b\u3001\u751f\u547d\u9031\u671f\u3001\u6216\u5728\u67d0\u500b child component \u7684 constructor \u4e2d\u767c\u751f\u932f\u8aa4\u6642\uff0c\u9019\u4e9b\u65b9\u6cd5\u6703\u88ab\u547c\u53eb\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#static-getderivedstatefromerror\"><code class=\"language-javascript\">static getDerivedStateFromError()</code></a></li>\n<li><a href=\"/react/react-component#componentdidcatch\"><code class=\"language-javascript\">componentDidCatch()</code></a></li>\n</ul>\n<h3 id=\"other-apis\"><a class=\"anchor\" href=\"/react/react-component#other-apis\"></a>\u5176\u4ed6 APIs </h3>\n<p>\u6bcf\u500b component \u4e5f\u63d0\u4f9b\u4e86\u5176\u4ed6 API\uff1a</p>\n<ul>\n<li><a href=\"/react/react-component#setstate\"><code class=\"language-javascript\">setState()</code></a></li>\n<li><a href=\"/react/react-component#forceupdate\"><code class=\"language-javascript\">forceUpdate()</code></a></li>\n</ul>\n<h3 id=\"class-properties\"><a class=\"anchor\" href=\"/react/react-component#class-properties\"></a>Class \u5c6c\u6027 </h3>\n<ul>\n<li><a href=\"/react/react-component#defaultprops\"><code class=\"language-javascript\">defaultProps</code></a></li>\n<li><a href=\"/react/react-component#displayname\"><code class=\"language-javascript\">displayName</code></a></li>\n</ul>\n<h3 id=\"instance-properties\"><a class=\"anchor\" href=\"/react/react-component#instance-properties\"></a>Instance \u5c6c\u6027 </h3>\n<ul>\n<li><a href=\"/react/react-component#props\"><code class=\"language-javascript\">props</code></a></li>\n<li><a href=\"/react/react-component#state\"><code class=\"language-javascript\">state</code></a></li>\n</ul>\n\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/react-component#reference\"></a>\u53c3\u8003\u6307\u5357 </h2>\n<h3 id=\"commonly-used-lifecycle-methods\"><a class=\"anchor\" href=\"/react/react-component#commonly-used-lifecycle-methods\"></a>\u5e38\u7528\u7684\u751f\u547d\u5468\u671f\u65b9\u6cd5 </h3>\n<p>\u6b64\u6bb5\u843d\u5c07\u6703\u4ecb\u7d39\u4f60\u5728\u5efa\u7acb React component \u6642\u6700\u53ef\u80fd\u6703\u4f7f\u7528\u5230\u7684\u5e7e\u7a2e\u65b9\u6cd5\u3002<strong>\u60f3\u66f4\u6df1\u5165\u4e86\u89e3\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u8acb\u53c3\u8003<a class=\"external-link\" href=\"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/\">\u751f\u547d\u9031\u671f\u8868</a>\u3002</strong></p>\n<h3 id=\"render\"><a class=\"anchor\" href=\"/react/react-component#render\"></a><code class=\"language-javascript\">render()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">render()</code> \u662f class component \u4e2d\u552f\u4e00\u5fc5\u8981\u7684\u65b9\u6cd5\u3002</p>\n<p>\u7576 render \u88ab\u547c\u53eb\u6642\uff0c\u5b83\u5c07\u6703\u6aa2\u8996 <code class=\"language-javascript\">this.props</code> \u548c <code class=\"language-javascript\">this.state</code> \u4e2d\u7684\u8b8a\u5316\uff0c\u4e26\u56de\u50b3\u4ee5\u4e0b\u985e\u5225\u4e4b\u4e00\uff1a</p>\n<ul>\n<li><strong>React element\u3002</strong> \u901a\u5e38\u662f\u900f\u904e <a href=\"/react/introducing-jsx\">JSX</a> \u5efa\u7acb\u7684\u3002\u4f8b\u5982\uff0c<code class=\"language-javascript\">&lt;div /&gt;</code>\u548c<code class=\"language-javascript\">&lt;MyComponent /&gt;</code>\u9019\u5169\u500b React element \u6703\u544a\u8a34 React \u8981 render \u4e00\u500b DOM node \u548c\u4e00\u500b\u4f7f\u7528\u8005\u5b9a\u7fa9\u7684 component\u3002</li>\n<li><strong>Array \u548c fragment\u3002</strong> \u5b83\u5011\u6703\u5f9e render \u4e2d\u56de\u50b3\u6578\u500b element\u3002\u7d30\u7bc0\u8acb\u53c3\u8003 <a href=\"/react/fragments\">fragment</a>\u3002</li>\n<li><strong>Portal</strong>\u3002\u5b83\u5011\u8b93\u4f60\u5c07 children render \u5230\u4e0d\u540c\u7684 DOM subtree \u4e2d\u3002\u7d30\u7bc0\u8acb\u53c3\u8003 <a href=\"/react/portals\">portal</a>\u3002</li>\n<li><strong>String \u548c number\u3002</strong> \u9019\u4e9b\u5728 DOM \u4e2d\u5c07\u6703\u88ab render \u70ba\u6587\u5b57 node\u3002</li>\n<li><strong>Boolean \u6216 <code class=\"language-javascript\">null</code>\u3002</strong> \u4ec0\u9ebc\u90fd\u4e0d render\u3002\uff08\u6b64\u985e\u578b\u4e3b\u8981\u662f\u652f\u63f4 <code class=\"language-javascript\">\u56de\u50b3 test &amp;&amp; &lt;Child /&gt;</code> \u7684\u6a21\u5f0f\uff0c\u9019\u88e1\u7684 <code class=\"language-javascript\">test</code> \u662f\u4e00\u500b boolean \u503c\uff09\u3002</li>\n</ul>\n<p><code class=\"language-javascript\">render()</code> function \u61c9\u8a72\u662f pure \u7684\uff0c\u9019\u8868\u793a\uff1a\u5b83\u4e26\u4e0d\u6703\u6539\u8b8a component \u7684 state\uff0c\u5b83\u5728\u6bcf\u6b21\u547c\u53eb\u6642\u90fd\u6703\u56de\u50b3\u540c\u6a23\u7684\u7d50\u679c\uff0c\u5b83\u4e26\u4e0d\u6703\u76f4\u63a5\u548c\u700f\u89bd\u5668\u6709\u6240\u4e92\u52d5\u3002</p>\n<p>\u5982\u679c\u4f60\u9700\u8981\u548c\u700f\u89bd\u5668\u4e92\u52d5\uff0c\u8acb\u5728 <code class=\"language-javascript\">componentDidMount()</code> \u6216\u5176\u4ed6\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5167\u57f7\u884c\u4f60\u7684\u7a0b\u5f0f\u3002\u5c07 <code class=\"language-javascript\">render()</code> \u7dad\u6301\u5728 pure \u7684\u72c0\u614b\u6709\u52a9\u65bc\u4f60\u5c0d component \u7684\u7406\u89e3\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u82e5 <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a> \u56de\u50b3\u7684\u503c\u70ba <code class=\"language-javascript\">false</code> \u7684\u8a71\uff0c<code class=\"language-javascript\">render()</code>\u5c07\u4e0d\u6703\u88ab\u547c\u53eb\u3002</p>\n</div>\n\n<h3 id=\"constructor\"><a class=\"anchor\" href=\"/react/react-component#constructor\"></a><code class=\"language-javascript\">constructor()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>\u5982\u679c\u4f60\u6c92\u6709\u521d\u59cb\u5316 state \u4e5f\u4e0d\u7d81\u5b9a\u65b9\u6cd5\u7684\u8a71\uff0c\u4f60\u7684 React component \u5c31\u4e0d\u9700\u8981 constructor\u3002</strong></p>\n<p>\u4e00\u500b React component \u7684 constructor \u6703\u5728\u5176\u88ab mount \u4e4b\u524d\u88ab\u547c\u53eb\u3002\u7576\u4f60\u70ba\u4e00\u500b <code class=\"language-javascript\">React.Component</code> subclass \u5efa\u7acb constructor \u6642\uff0c\u4f60\u61c9\u8a72\u5728\u5176\u4ed6\u4efb\u4f55\u5ba3\u544a\u4e4b\u524d\u547c\u53eb <code class=\"language-javascript\">super(props)</code>\u3002\u5426\u5247\uff0c<code class=\"language-javascript\">this.props</code> \u5728 constructor \u4e2d\u7684\u503c\u6703\u51fa\u73fe undefined \u7684 bug\u3002</p>\n<p>\u901a\u5e38\u5728 React \u4e2d constructor \u53ea\u6703\u6709\u5169\u7a2e\u7528\u9014\uff1a</p>\n<ul>\n<li>\u900f\u904e\u6307\u5b9a\u4e00\u500b <code class=\"language-javascript\">this.state</code> \u7269\u4ef6\u4f86\u521d\u59cb\u5316<a href=\"/react/state-and-lifecycle\">\u5167\u90e8 state</a>\u3002</li>\n<li>\u70ba <a href=\"/react/handling-events\">event handler</a> \u65b9\u6cd5\u7d81\u5b9a instance\u3002</li>\n</ul>\n<p>\u8acb<strong>\u4e0d\u8981\u5728 <code class=\"language-javascript\">constructor()</code> \u4e2d\u547c\u53eb <code class=\"language-javascript\">setState()</code></strong>\u3002\u5982\u679c\u4f60\u7684 component \u9700\u8981\u4f7f\u7528\u5167\u90e8 state\uff0c\u8acb\u5728 constructor \u4e2d<strong>\u5c07\u5176\u6700\u521d\u7684 state \u6307\u5b9a\u70ba <code class=\"language-javascript\">this.state</code></strong>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// \u4e0d\u8981\u5728\u9019\u88e1\u547c\u53eb this.setState()\uff01</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Constructor \u662f\u552f\u4e00\u4e00\u500b\u4f60\u61c9\u8a72\u76f4\u63a5\u6307\u5b9a <code class=\"language-javascript\">this.state</code> \u7684\u5730\u65b9\u3002\u5728\u6240\u6709\u5176\u4ed6\u7684\u65b9\u6cd5\u4e2d\uff0c\u4f60\u5247\u9700\u8981\u4f7f\u7528 <code class=\"language-javascript\">this.setState()</code>\u3002</p>\n<p>\u8acb\u907f\u514d\u5728 constructor \u4e2d\u7522\u751f\u4efb\u4f55 side effect \u6216 subscription\u3002\u5982\u679c\u4f60\u9700\u8981\u5b83\u5011\u7684\u8a71\uff0c\u8acb\u4f7f\u7528 <code class=\"language-javascript\">componentDidMount()</code>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><strong>\u8acb\u907f\u514d\u8907\u88fd prop \u5230 state \u4e4b\u4e2d\uff01\u9019\u662f\u4e00\u500b\u5f88\u5e38\u898b\u7684\u932f\u8aa4\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token comment\">// \u8acb\u4e0d\u8981\u9019\u6a23\u505a\uff01</span>\n <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> props<span class=\"token punctuation\">.</span>color <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u6a23\u505a\u7684\u554f\u984c\u662f\uff1a\u4e00\u4f86\u9019\u6beb\u7121\u5fc5\u8981\uff08\u4f60\u53ef\u4ee5\u76f4\u63a5\u7528 <code class=\"language-javascript\">this.props.color</code>\uff09\uff0c\u4e8c\u4f86\u9019\u6703\u7522\u751f bug\uff08\u4efb\u4f55\u6539\u8b8a\u5c0d <code class=\"language-javascript\">color</code> prop \u6240\u7522\u751f\u7684\u66f4\u65b0\u90fd\u4e0d\u6703\u51fa\u73fe\u5728 state \u4e2d\uff09\u3002</p>\n<p><strong>\u8acb\u5728\u53ea\u6709\u5728\u4f60\u523b\u610f\u8981\u5ffd\u7565 prop \u66f4\u65b0\u7684\u60c5\u6cc1\u4e0b\u624d\u4f7f\u7528\u9019\u500b\u6a21\u5f0f\u3002</strong> \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u6bd4\u8f03\u5408\u7406\u7684\u505a\u6cd5\u662f\u5c07 prop \u91cd\u65b0\u547d\u540d\u70ba <code class=\"language-javascript\">initialColor</code> \u6216 <code class=\"language-javascript\">defaultColor</code>\u3002\u5982\u6b64\u4e00\u4f86\uff0c\u4f60\u53ef\u4ee5\u5728\u5fc5\u8981\u7684\u60c5\u6cc1\u4e0b\u900f\u904e<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key\">\u4fee\u6539\u4e00\u500b component \u7684 <code class=\"language-javascript\">key</code></a> \u4f86\u5f37\u8feb\u5b83\u300c\u91cd\u7f6e\u300d\u5176\u521d\u59cb\u7684 state\u3002</p>\n<p>\u82e5\u60f3\u77e5\u9053\u5982\u4f55\u8655\u7406 state \u4f9d\u8cf4 prop \u7684\u60c5\u6cc1\uff0c\u8acb\u53c3\u8003\u6211\u5011 <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html\">\u95dc\u65bc\u907f\u514d derived state \u7684\u90e8\u843d\u683c\u6587\u7ae0</a>\u3002</p>\n</div>\n\n<h3 id=\"componentdidmount\"><a class=\"anchor\" href=\"/react/react-component#componentdidmount\"></a><code class=\"language-javascript\">componentDidMount()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5728\u4e00\u500b component \u88ab mount\uff08\u52a0\u5165 DOM tree \u4e2d\uff09\u5f8c\uff0c<code class=\"language-javascript\">componentDidMount()</code> \u6703\u99ac\u4e0a\u88ab\u547c\u53eb\u3002\u9700\u8981 DOM node \u7684\u521d\u59cb\u5316\u61c9\u8a72\u5beb\u5728\u9019\u500b\u65b9\u6cd5\u88e1\u9762\u3002\u5982\u679c\u4f60\u9700\u8981\u5f9e\u9060\u7aef\u7d42\u7aef\u9ede\uff08remote endpoint\uff09\u8acb\u6c42\u8cc7\u6599\u7684\u8a71, \u6b64\u8655\u975e\u5e38\u9069\u5408\u9032\u884c\u5be6\u4f8b\u5316\u7db2\u8def\u8acb\u6c42\uff08network request\uff09\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u9069\u5408\u8a2d\u7acb\u4efb\u4f55 subscription\u3002\u8a2d\u7acb\u5b8c subscription \u5f8c\uff0c\u5225\u5fd8\u4e86\u5728 <code class=\"language-javascript\">componentWillUnmount()</code> \u5167\u53d6\u6d88 subscription\u3002</p>\n<p>\u4f60<strong>\u53ef\u4ee5\u99ac\u4e0a\u5728 <code class=\"language-javascript\">componentDidMount()</code> \u5167\u547c\u53eb <code class=\"language-javascript\">setState()</code>\u3002</strong>\u9019\u6703\u89f8\u767c\u4e00\u6b21\u984d\u5916\u7684 render\uff0c\u4f46\u9019\u6703\u5728\u700f\u89bd\u5668\u66f4\u65b0\u87a2\u5e55\u4e4b\u524d\u767c\u751f\u3002\u5728\u9019\u500b\u60c5\u6cc1\u4e0b\uff0c\u5373\u4f7f <code class=\"language-javascript\">render()</code> \u88ab\u547c\u53eb\u5169\u6b21\uff0c\u9019\u78ba\u4fdd\u4f7f\u7528\u8005\u4e0d\u6703\u770b\u898b\u9019\u5169\u6b21 render \u4e2d\u904e\u6e21\u6642\u671f\u7684 state\u3002\u8acb\u8b39\u614e\u4f7f\u7528\u9019\u500b\u6a21\u5f0f\uff0c\u56e0\u70ba\u9019\u7d93\u5e38\u6703\u5c0e\u81f4\u6548\u80fd\u554f\u984c\u3002\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u4f60\u61c9\u8a72\u80fd\u5920\u5728  <code class=\"language-javascript\">constructor()</code> \u5167\u6307\u5b9a\u521d\u59cb state \u7684\u503c\u3002\u4e0d\u904e\uff0c\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u50cf\u662f\u5728\u4f7f\u7528 modal \u548c tooltip \u7684\u6642\u5019\uff0c\u4f60\u6240 render \u7684 component \u82e5\u662f\u4f9d\u8cf4\u67d0\u500b DOM node \u7684\u5927\u5c0f\u6216\u4f4d\u7f6e\u6642\uff0c\u9019\u7a2e\u6a21\u5f0f\u6709\u6642\u5019\u53ef\u80fd\u662f\u6709\u5fc5\u8981\u7684\u3002</p>\n\n<h3 id=\"componentdidupdate\"><a class=\"anchor\" href=\"/react/react-component#componentdidupdate\"></a><code class=\"language-javascript\">componentDidUpdate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">,</span> prevState<span class=\"token punctuation\">,</span> snapshot<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">componentDidUpdate()</code> \u6703\u5728\u66f4\u65b0\u5f8c\u99ac\u4e0a\u88ab\u547c\u53eb\u3002\u9019\u500b\u65b9\u6cd5\u4e26\u4e0d\u6703\u5728\u521d\u6b21 render \u6642\u88ab\u547c\u53eb\u3002</p>\n<p>\u5728 component \u66f4\u65b0\u4e4b\u5f8c\uff0c\u53ef\u4ee5\u5728\u6b64\u8655\u5c0d DOM \u9032\u884c\u904b\u4f5c\u3002\u6b64\u8655\u4e5f\u9069\u5408\u505a\u7db2\u8def\u8acb\u6c42\uff0c\u5982\u679c\u4f60\u6709\u6bd4\u8f03\u76ee\u524d\u7684 prop \u548c\u4e4b\u524d\u7684 prop \u7684\u8a71\uff08\u5982\u679c prop \u6c92\u6709\u6539\u8b8a\u7684\u8a71\uff0c\u7db2\u8def\u8acb\u6c42\u53ef\u80fd\u4e26\u975e\u5fc5\u8981\uff09\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u5e38\u898b\u7528\u6cd5\uff08\u5225\u5fd8\u4e86\u6bd4\u8f03 prop\uff09\uff1a</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>userID <span class=\"token operator\">!==</span> prevProps<span class=\"token punctuation\">.</span>userID<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>userID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60<strong>\u53ef\u4ee5\u99ac\u4e0a\u5728 <code class=\"language-javascript\">componentDidUpdate()</code> \u5167\u547c\u53eb <code class=\"language-javascript\">setState()</code></strong>\uff0c\u4f46\u6ce8\u610f\u9019\u5fc5\u9808\u8981\u88ab\u5305\u570d\u5728\u4e00\u500b\u985e\u4f3c\u4e0a\u8ff0\u7bc4\u4f8b\u7684\u689d\u4ef6\u8a9e\u53e5\u5167\uff0c\u5426\u5247\u4f60\u6703\u9032\u5165\u4e00\u500b\u7121\u9650\u8ff4\u5708\u3002\u9019\u4e5f\u6703\u5c0e\u81f4\u984d\u5916\u7684\u91cd\u65b0 render\u3002\u96d6\u7136\u4f7f\u7528\u8005\u770b\u4e0d\u898b\uff0c\u4f46\u9019\u53ef\u80fd\u6703\u5f71\u97ff component \u7684\u6548\u80fd\u3002\u5982\u679c\u4f60\u60f3\u8a66\u8457\u5c07\u67d0\u4e9b state \u8907\u88fd\u5230\u7531\u4e0a\u5f80\u4e0b\u50b3\u7684 prop \u7684\u8a71\uff0c\u8acb\u8003\u616e\u76f4\u63a5\u4f7f\u7528 prop\u3002\u8acb\u53c3\u8003<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html\">\u70ba\u4f55\u8907\u88fd prop \u5230 state \u4e2d\u6703\u7522\u751f bug</a>\u3002</p>\n<p>\u5982\u679c\u4f60\u7684 component \u88e1\u9762\u6709 <code class=\"language-javascript\">getSnapshotBeforeUpdate()</code> \u9019\u500b\u5f88\u5c11\u898b\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u5176\u56de\u50b3\u7684\u503c\u5c07\u6703\u88ab\u7576\u4f5c\u7b2c\u4e09\u500b\u300csnapshot\u300d\u53c3\u6578\u50b3\u7d66 <code class=\"language-javascript\">componentDidUpdate()</code>\u3002\u5426\u5247\u9019\u500b\u53c3\u6578\u6703\u662f undefined\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5982\u679c <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a> \u56de\u50b3\u7684\u503c\u70ba false \u7684\u8a71\uff0c<code class=\"language-javascript\">componentDidUpdate()</code> \u5c07\u4e0d\u6703\u88ab\u547c\u53eb\u3002</p>\n</div>\n\n<h3 id=\"componentwillunmount\"><a class=\"anchor\" href=\"/react/react-component#componentwillunmount\"></a><code class=\"language-javascript\">componentWillUnmount()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">componentWillUnmount()</code> \u6703\u5728\u3127\u500b component \u88ab unmount \u548c destroy \u5f8c\u99ac\u4e0a\u88ab\u547c\u53eb\u3002\u4f60\u53ef\u4ee5\u5728\u9019\u500b\u65b9\u6cd5\u5167\u9032\u884c\u4efb\u4f55\u6e05\u7406\uff0c\u50cf\u662f\u53d6\u6d88\u8a08\u6642\u5668\u548c\u7db2\u8def\u8acb\u6c42\u6216\u662f\u79fb\u9664\u4efb\u4f55\u5728 <code class=\"language-javascript\">componentDidMount()</code> \u5167\u5efa\u7acb\u7684  subscription\u3002</p>\n<p>\u4f60<strong>\u4e0d\u61c9\u8a72\u5728 <code class=\"language-javascript\">componentWillUnmount()</code> \u5167\u547c\u53eb <code class=\"language-javascript\">setState()</code></strong>\uff0c\u56e0\u70ba\u9019\u500b component \u6c38\u9060\u4e0d\u6703\u518d\u91cd\u65b0 render\u3002\u7576\u4e00\u500b component instance \u88ab unmount \u5f8c\uff0c\u5b83\u5c31\u6c38\u9060\u4e0d\u6703\u518d\u88ab mount\u3002</p>\n\n<h3 id=\"rarely-used-lifecycle-methods\"><a class=\"anchor\" href=\"/react/react-component#rarely-used-lifecycle-methods\"></a>\u4e0d\u5e38\u4f7f\u7528\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5 </h3>\n<p>\u9019\u500b\u7ae0\u7bc0\u5167\u4ecb\u7d39\u7684\u65b9\u6cd5\u662f\u5728\u90a3\u4e9b\u4e0d\u5e38\u898b\u7684\u60c5\u6cc1\u4e2d\u4f7f\u7528\u7684\u3002\u5b83\u5011\u6709\u6642\u5f88\u65b9\u4fbf\uff0c\u4f46\u662f\u4f60\u5927\u591a\u6578\u7684 component \u5927\u6982\u4e0d\u6703\u9700\u8981\u4f7f\u7528\u5b83\u5011\u3002<strong>\u4f60\u53ef\u4ee5\u5728\u9019\u500b<a class=\"external-link\" href=\"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/\">\u751f\u547d\u9031\u671f\u8868</a>\u4e0a\u65b9\u9ede\u9078\u300c\u986f\u793a\u4e0d\u5e38\u4f7f\u7528\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u300d\uff0c\u4e26\u770b\u5230\u4ee5\u4e0b\u6240\u4ecb\u7d39\u7684\u65b9\u6cd5\u3002</strong></p>\n<h3 id=\"shouldcomponentupdate\"><a class=\"anchor\" href=\"/react/react-component#shouldcomponentupdate\"></a><code class=\"language-javascript\">shouldComponentUpdate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">,</span> nextState<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u4f86\u8b93 React \u77e5\u9053\u4e00\u500b component \u7684 output \u4e26\u4e0d\u6703\u88ab\u76ee\u524d\u5728 state \u6216 prop \u5167\u7684\u6539\u8b8a\u6240\u5f71\u97ff\u3002React \u7684\u9810\u8a2d\u884c\u70ba\u662f\u6bcf\u7576 state \u6709\u6240\u6539\u8b8a\u6642\u5c31\u91cd\u65b0 render\u3002\u5728\u7d55\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b\uff0c\u4f60\u61c9\u8a72\u4f9d\u8cf4\u9019\u500b\u9810\u8a2d\u884c\u70ba\u3002</p>\n<p><code class=\"language-javascript\">shouldComponentUpdate()</code> \u6703\u5728\u65b0\u7684 prop \u6216 state \u88ab\u63a5\u6536\u4e4b\u5f8c\u4e26\u5728\u8a72 component \u88ab render \u4e4b\u524d\u88ab\u547c\u53eb\u3002\u5176\u9810\u8a2d\u503c\u662f <code class=\"language-javascript\">true</code>\u3002\u9019\u500b\u65b9\u6cd5\u4e26\u4e0d\u6703 component \u521d\u6b21 render \u6642\u6216\u4f7f\u7528 <code class=\"language-javascript\">forceUpdate()</code> \u6642\u88ab\u547c\u53eb\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u7684\u5b58\u5728\u8457\u8981\u662f\u70ba\u4e86 <strong><a href=\"/react/optimizing-performance\">\u6548\u80fd\u6700\u4f73\u5316</a></strong>\u3002\u8acb\u4e0d\u8981\u4f9d\u8cf4\u9019\u500b\u65b9\u6cd5\u4f86\u300c\u907f\u514d\u300d render\uff0c\u56e0\u70ba\u9019\u5f88\u6709\u53ef\u80fd\u6703\u5c0e\u81f4 bug\u3002<strong>\u8acb\u8003\u616e\u4f7f\u7528 React \u5167\u5efa\u7684 <a href=\"/react/react-api#reactpurecomponent\"><code class=\"language-javascript\">PureComponent</code></a></strong> \u4e26\u907f\u514d\u624b\u5beb <code class=\"language-javascript\">shouldComponentUpdate()</code>\u3002<code class=\"language-javascript\">PureComponent</code> \u6703\u70ba prop \u548c state \u505a\u4e00\u500b\u6dfa\u5c64\u6bd4\u8f03\uff08shallow comparison\uff09\u4e26\u6e1b\u4f4e\u4f60\u932f\u904e\u5fc5\u8981\u66f4\u65b0\u7684\u6a5f\u6703\u3002</p>\n<p>\u5982\u679c\u4f60\u5f88\u78ba\u5b9a\u4f60\u60f3\u8981\u624b\u5beb\u9019\u500b\u65b9\u6cd5\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u5c07 <code class=\"language-javascript\">this.props</code> \u548c <code class=\"language-javascript\">nextProps</code> \u4ee5\u53ca <code class=\"language-javascript\">this.state</code> \u548c <code class=\"language-javascript\">nextState</code> \u505a\u6bd4\u8f03\u4e26\u56de\u50b3 <code class=\"language-javascript\">false</code> \u4ee5\u544a\u77e5 React \u9019\u6b21\u7684\u66f4\u65b0\u53ef\u4ee5\u88ab\u7565\u904e\u3002\u8acb\u6ce8\u610f\uff0c\u56de\u50b3 <code class=\"language-javascript\">false</code> \u4e26\u4e0d\u6703\u907f\u514d child component \u5728<em>\u5b83\u5011\u7684</em> state \u6539\u8b8a\u6642\u91cd\u65b0 render\u3002</p>\n<p>\u6211\u5011\u4e26\u4e0d\u5efa\u8b70\u4f60\u505a\u6df1\u5ea6\u6bd4\u8f03\uff08deep equality check\uff09\u6216\u5728 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u5167\u4f7f\u7528 <code class=\"language-javascript\">JSON.stringify()</code>\u3002\u5b83\u5011\u6548\u7387\u4e0d\u4f73\u4e14\u6703\u9020\u6210\u6548\u80fd\u554f\u984c\u3002</p>\n<p>\u76ee\u524d\uff0c\u5982\u679c <code class=\"language-javascript\">shouldComponentUpdate()</code> \u56de\u50b3 <code class=\"language-javascript\">false</code> \u7684\u8a71\uff0c<a href=\"/react/react-component#unsafe_componentwillupdate\"><code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code></a>\u3001<a href=\"/react/react-component#render\"><code class=\"language-javascript\">render()</code></a> \u548c <a href=\"/react/react-component#componentdidupdate\"><code class=\"language-javascript\">componentDidUpdate()</code></a> \u90fd\u4e0d\u6703\u88ab\u547c\u53eb\u3002\u5728\u672a\u4f86\uff0cReact \u53ef\u80fd\u6703\u628a <code class=\"language-javascript\">shouldComponentUpdate()</code> \u7576\u4f5c\u4e00\u500b\u63d0\u793a\u800c\u975e\u4e00\u500b\u56b4\u683c\u6307\u4ee4\uff0c\u800c\u56de\u50b3 <code class=\"language-javascript\">false</code> \u53ef\u80fd\u9084\u662f\u6703\u9020\u6210 component \u91cd\u65b0 render\u3002</p>\n\n<h3 id=\"static-getderivedstatefromprops\"><a class=\"anchor\" href=\"/react/react-component#static-getderivedstatefromprops\"></a><code class=\"language-javascript\">static getDerivedStateFromProps()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromProps</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">getDerivedStateFromProps</code> \u6703\u5728\u4e00\u500b component \u88ab render \u524d\u88ab\u547c\u53eb\uff0c\u4e0d\u7ba1\u662f\u5728\u9996\u6b21 mount \u6642\u6216\u5f8c\u7e8c\u7684\u66f4\u65b0\u6642\u3002\u5b83\u61c9\u8a72\u56de\u50b3\u4e00\u500b object \u4ee5\u66f4\u65b0 state\uff0c\u6216\u56de\u50b3 <code class=\"language-javascript\">null</code> \u4ee5\u8868\u793a\u4e0d\u9700\u8981\u66f4\u65b0\u4efb\u4f55 state\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u662f\u70ba\u4e86\u67d0\u4e9b<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#when-to-use-derived-state\">\u5f88\u5c11\u898b\u7684\u4f8b\u5b50</a>\u800c\u5b58\u5728\u7684\uff0c\u50cf\u662f\u6709\u6642 state \u6703\u4f9d\u8cf4 prop \u5728\u4e00\u6bb5\u6642\u9593\u904e\u5f8c\u6240\u7522\u751f\u7684\u6539\u8b8a\u3002\u4f8b\u5982\uff0c\u4e5f\u8a31\u5efa\u7acb\u4e00\u500b <code class=\"language-javascript\">&lt;Transition&gt;</code> component \u662f\u5f88\u65b9\u4fbf\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u7528\u5b83\u4f86\u6bd4\u8f03\u5176\u4e4b\u524d\u8207\u4e4b\u5f8c\u7684 children\uff0c\u4e26\u6c7a\u5b9a\u6211\u5011\u8981 animate in and out \u54ea\u4e00\u500b child\u3002</p>\n<p>\u7e7c\u627f state \u6703\u5c0e\u81f4\u5197\u9577\u7684\u7a0b\u5f0f\u78bc\u4e26\u4f7f\u4f60\u7684 component \u5f88\u96e3\u7406\u89e3\u3002<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html\">\u8acb\u78ba\u8a8d\u4f60\u77e5\u9053\u9019\u4e9b\u8f03\u70ba\u7c21\u55ae\u7684\u66ff\u4ee3\u65b9\u6848</a>\u3002</p>\n<ul>\n<li>\u5982\u679c\u4f60\u9700\u8981\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u7522\u751f\u76f8\u5c0d\u61c9\u7684<strong>side effect</strong>\uff08\u4f8b\u5982\uff0c\u8cc7\u6599\u63d0\u53d6\u6216\u4f7f\u7528\u52d5\u756b\uff09\uff0c\u8acb\u4f7f\u7528 <a href=\"/react/react-component#componentdidupdate\"><code class=\"language-javascript\">componentDidUpdate</code></a>\u3002</li>\n<li>\u5982\u679c\u4f60\u60f3\u8981 <strong>\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u91cd\u65b0\u8a08\u7b97\u67d0\u4e9b\u8cc7\u6599</strong>\uff0c<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization\">\u8acb\u4f7f\u7528 memoization helper</a>\u3002</li>\n<li>\u5982\u679c\u4f60\u60f3\u8981 <strong>\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u300c\u91cd\u7f6e\u300d\u67d0\u500b state</strong>\uff0c\u8acb\u8003\u616e\u5efa\u7acb\u4e00\u500b<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-controlled-component\">\u5b8c\u5168\u88ab\u63a7\u5236</a> \u7684 component \u6216<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key\">\u5e36\u6709 <code class=\"language-javascript\">key</code> \u7684\u5b8c\u5168\u4e0d\u53ef\u88ab\u63a7\u5236</a> component\u3002</li>\n</ul>\n<p>\u9019\u500b\u65b9\u6cd5\u7121\u6cd5\u89f8\u53ca\u4e00\u500b component \u7684 instance\u3002\u5982\u679c\u4f60\u60f3\u8981\u9019\u9ebc\u505a\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u628a\u4e00\u500b component \u7684 prop \u548c state \u63d0\u53d6\u51fa\u4f86\u8b8a\u6210 pure function\uff0c\u4e26\u5beb\u5728\u8a72 class definition \u4e4b\u5916\uff0c\u4e26\u900f\u904e\u9019\u6a23\u7684\u65b9\u5f0f\u5728 <code class=\"language-javascript\">getDerivedStateFromProps()</code> \u548c\u5176\u4ed6 class \u65b9\u6cd5\u4e4b\u9593\u91cd\u8907\u4f7f\u7528\u67d0\u4e9b\u7a0b\u5f0f\u78bc\u3002</p>\n<p>\u8acb\u6ce8\u610f\u9019\u500b\u65b9\u6cd5\u5728<em>\u6bcf\u4e00\u6b21</em> render \u6642\u90fd\u6703\u88ab\u89f8\u767c\uff0c\u4e0d\u8ad6\u539f\u56e0\u70ba\u4f55\u3002\u9019\u548c <code class=\"language-javascript\">UNSAFE_componentWillReceiveProps</code> \u6709\u6240\u4e0d\u540c\uff0c\u9019\u500b\u65b9\u6cd5\u53ea\u6709\u5728 parent \u5c0e\u81f4\u91cd\u65b0 render \u6642\u88ab\u89f8\u767c\uff0c\u800c\u975e\u5728\u672c\u5730\u7684 <code class=\"language-javascript\">setState</code> \u5c0e\u81f4\u91cd\u65b0 render \u6642\u88ab\u89f8\u767c\u3002</p>\n\n<h3 id=\"getsnapshotbeforeupdate\"><a class=\"anchor\" href=\"/react/react-component#getsnapshotbeforeupdate\"></a><code class=\"language-javascript\">getSnapshotBeforeUpdate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">getSnapshotBeforeUpdate</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">,</span> prevState<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">getSnapshotBeforeUpdate()</code> \u5728\u63d0\u4ea4\u6700\u65b0 render \u7684 output \u4e4b\u524d\u7acb\u5373\u88ab\u8abf\u7528\u3002\u5b83\u8b93\u4f60\u5728 DOM \u6539\u8b8a\u4e4b\u524d\u5148\u5f9e\u5176\u4e2d\u6293\u53d6\u4e00\u4e9b\u8cc7\u8a0a\uff08\u4f8b\u5982\u6efe\u52d5\u8ef8\u7684\u4f4d\u7f6e\uff09\u3002\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u56de\u50b3\u7684\u4efb\u4f55\u503c\u6703\u88ab\u7576\u4f5c\u4e00\u500b\u53c3\u6578\u50b3\u905e\u7d66 <code class=\"language-javascript\">componentDidUpdate()</code>\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u4e26\u4e0d\u5e38\u898b\uff0c\u4f46\u5b83\u53ef\u80fd\u6703\u5728\u50cf\u662f\u5c0d\u8a71\u4e32\u9019\u985e\u9700\u8981\u4ee5\u67d0\u7a2e\u7279\u6b8a\u65b9\u59cb\u8655\u7406\u6efe\u52d5\u8ef8\u4f4d\u7f6e\u7684 UI \u4e2d\u51fa\u73fe\u3002</p>\n<p>\u4e00\u500b snapshot \u7684\u503c\uff08\u6216 <code class=\"language-javascript\">null</code>\uff09\u61c9\u8a72\u88ab\u56de\u50b3\u3002</p>\n<p>\u4f8b\u5982\uff1a</p>\n<p><div class=\"gatsby-highlight\">\n<pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ScrollingList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>listRef <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getSnapshotBeforeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Are we adding new items to the list?</span>\n    <span class=\"token comment\">// Capture the scroll position so we can adjust scroll later.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>list<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>listRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">.</span>scrollHeight <span class=\"token operator\">-</span> list<span class=\"token punctuation\">.</span>scrollTop<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState<span class=\"token punctuation\">,</span> snapshot</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If we have a snapshot value, we've just added new items.</span>\n    <span class=\"token comment\">// Adjust scroll so these new items don't push the old ones out of view.</span>\n    <span class=\"token comment\">// (snapshot here is the value returned from getSnapshotBeforeUpdate)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>snapshot <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>listRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n      list<span class=\"token punctuation\">.</span>scrollTop <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span>scrollHeight <span class=\"token operator\">-</span> snapshot<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>listRef<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ...contents... */</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div></p>\n<p>\u5728\u4e0a\u9762\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u8b80\u53d6 <code class=\"language-javascript\">getSnapshotBeforeUpdate</code> \u5167\u7684 <code class=\"language-javascript\">scrollHeight</code> property \u662f\u5f88\u91cd\u8981\u7684\uff0c\u56e0\u70ba\u300crender\u300d\u968e\u6bb5\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff08\u5982 <code class=\"language-javascript\">render</code>\uff09\u548c\u300ccommit\u300d\u968e\u6bb5\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff08\u50cf\u662f <code class=\"language-javascript\">getSnapshotBeforeUpdate</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code>\uff09\u5169\u8005\u4e4b\u9593\u53ef\u80fd\u6703\u6709\u4e00\u4e9b\u5ef6\u9072\u3002</p>\n\n<h3 id=\"error-boundaries\"><a class=\"anchor\" href=\"/react/react-component#error-boundaries\"></a>\u932f\u8aa4\u908a\u754c </h3>\n<p><a href=\"/react/error-boundaries\">\u932f\u8aa4\u908a\u754c</a> \u662f\u7528\u65bc\u622a\u53d6 child component tree \u4e2d JavaScript \u932f\u8aa4\u3001\u8a18\u9304\u932f\u8aa4\u3001\u4e26\u986f\u793a\u4e00\u500b fallback UI \u800c\u975e\u6545\u969c\u7684 component tree \u7684\u4e00\u7fa4 React component\u3002\u932f\u8aa4\u908a\u754c\u6703\u5728 render \u671f\u9593\u3001\u751f\u547d\u9031\u671f\u65b9\u6cd5\u3001\u4ee5\u53ca\u5176\u4e0b\u6574\u500b tree \u7fa4\u7d44\u6240\u6709\u7684 constructor \u5167\u622a\u53d6\u932f\u8aa4\u3002</p>\n<p>\u4e00\u500b class component \u6703\u8b8a\u6210\u932f\u8aa4\u908a\u754c\uff0c\u5982\u679c\u5176\u5b9a\u7fa9\u4e86 <code class=\"language-javascript\">static getDerivedStateFromError()</code> \u548c <code class=\"language-javascript\">componentDidCatch()</code> \u5169\u7a2e\u6216\u5176\u4e2d\u4e4b\u4e00\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u3002 \u5f9e\u9019\u4e9b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u4e2d\u66f4\u65b0 state \u8b93\u4f60\u622a\u53d6\u5728\u5176\u4e0b\u7684 tree \u5167\u672a\u88ab\u8655\u7406\u7684 JavaScript \u932f\u8aa4\uff0c\u4e26\u986f\u793a\u4e00\u500b fallback UI\u3002</p>\n<p>\u8acb\u53ea\u5728\u5f9e\u610f\u6599\u4e4b\u5916\u7684\u7570\u5e38\u4e2d\u4f7f\u7528\u932f\u8aa4\u908a\u754c\u3002<strong>\u8acb\u4e0d\u8981\u7528\u5b83\u4f86\u63a7\u5236\u6d41\u7a0b\u3002</strong></p>\n<p>\u60f3\u4e86\u89e3\u66f4\u591a\uff0c\u8acb\u53c3\u8003 <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2017/07/26/error-handling-in-react-16.html\"><em>React 16 \u4e2d\u7684\u932f\u8aa4\u908a\u754c</em></a>\u4e00\u6587\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u932f\u8aa4\u908a\u754c\u53ea\u6703\u622a\u53d6\u5728 tree \u4e2d\u3001\u81ea\u8eab<strong>\u4ee5\u4e0b</strong>\u7684 component \u4e2d\u7684\u932f\u8aa4\u3002\u932f\u8aa4\u908a\u754c\u7121\u6cd5\u622a\u53d6\u81ea\u8eab\u5167\u7684\u932f\u8aa4\u3002</p>\n</div>\n<h3 id=\"static-getderivedstatefromerror\"><a class=\"anchor\" href=\"/react/react-component#static-getderivedstatefromerror\"></a><code class=\"language-javascript\">static getDerivedStateFromError()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromError</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u6703\u5728\u67d0\u500b\u932f\u8aa4\u88ab\u4e00\u500b descendant component \u62cb\u51fa\u5f8c\u88ab\u547c\u53eb\u3002\n\u5b83\u6703\u63a5\u6536\u8a72\u932f\u8aa4\u70ba\u5176\u53c3\u6578\u4e26\u56de\u50b3\u4e00\u500b\u503c\u4ee5\u66f4\u65b0 state\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorBoundary</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u66f4\u65b0 state\uff0c\u5982\u6b64\u4e0b\u6b21 render \u6642 React \u624d\u80fd\u986f\u793a fallback UI</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>hasError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u4f60\u53ef\u4ee5 render \u4efb\u4f55\u81ea\u8a02\u7684 fallback UI</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Something went wrong.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">getDerivedStateFromError()</code> \u6703\u5728\u300crender\u300d\u671f\u9593\u88ab\u547c\u53eb\uff0c\u6240\u4ee5 side effect \u662f\u4e0d\u88ab\u5141\u8a31\u7684\u3002\n\u5982\u679c\u4f60\u60f3\u8981\u4f7f\u7528 side effect \u7684\u8a71\uff0c\u8acb\u4f7f\u7528 <code class=\"language-javascript\">componentDidCatch()</code>\u3002</p>\n</div>\n\n<h3 id=\"componentdidcatch\"><a class=\"anchor\" href=\"/react/react-component#componentdidcatch\"></a><code class=\"language-javascript\">componentDidCatch()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidCatch</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> info<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u6703\u5728\u67d0\u500b\u932f\u8aa4\u88ab\u4e00\u500b descendant component \u62cb\u51fa\u5f8c\u88ab\u547c\u53eb\u3002\n\u5b83\u63a5\u53d7\u5169\u500b\u53c3\u6578\uff1a</p>\n<ol>\n<li><code class=\"language-javascript\">error</code> - \u88ab\u62cb\u51fa\u7684\u932f\u8aa4\u3002</li>\n<li><code class=\"language-javascript\">info</code> - \u4e00\u500b\u6709 <code class=\"language-javascript\">componentStack</code> key \u7684 object\uff0c\u9019\u500b key \u5305\u542b\u6709<a href=\"/react/error-boundaries#component-stack-traces\">\u90a3\u4e00\u500b component \u62cb\u51fa\u932f\u8aa4\u7684\u8cc7\u8a0a</a>\u3002</li>\n</ol>\n<p><code class=\"language-javascript\">componentDidCatch()</code> \u6703\u5728\u300ccommit\u300d\u671f\u9593\u88ab\u547c\u53eb\uff0c\u6240\u4ee5 side effect \u662f\u88ab\u5141\u8a31\u7684\u3002\n\u9019\u500b\u65b9\u6cd5\u61c9\u8a72\u88ab\u7528\u4f86\u505a\u985e\u4f3c\u8a18\u9304\u932f\u8aa4\u9019\u985e\u7684\u4e8b\u60c5\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorBoundary</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u66f4\u65b0 state\uff0c\u5982\u6b64\u4e0b\u6b21 render \u6642 React \u624d\u80fd\u986f\u793a fallback UI</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidCatch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> info</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// ComponentStack \u7684\u7bc4\u4f8b\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">//   in ComponentThatThrows (created by App)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">//   in ErrorBoundary (created by App)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">//   in div (created by App)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">//   in App</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">logComponentStackToMyService</span><span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">.</span>componentStack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>hasError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// \u4f60\u53ef\u4ee5 render \u4efb\u4f55\u81ea\u8a02\u7684 fallback UI</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Something went wrong.</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React \u5728 production \u548c development \u5728\u8655\u7406 <code class=\"language-javascript\">componentDidCatch()</code> \u932f\u8aa4\u7684\u65b9\u5f0f\u4e0d\u540c\u3002</p>\n<p>\u5728 development \u6642\uff0c\u932f\u8aa4\u5c07\u6703\u5192\u6ce1\u5230 <code class=\"language-javascript\">window</code>\uff0c\u610f\u601d\u662f\u4efb\u4f55\u7684 <code class=\"language-javascript\">window.onerror</code> \u6216 <code class=\"language-javascript\">window.addEventListener('error', callback)</code> \u5c07\u6514\u622a\u900f\u904e <code class=\"language-javascript\">componentDidCatch</code> \u6240\u6355\u6349\u5230\u7684\u932f\u8aa4\u3002</p>\n<p>\u53cd\u4e4b\uff0c\u5728 production \u6642\u4e0d\u6703\u5192\u6ce1\uff0c\u610f\u601d\u662f\u4efb\u4f55 ancestor \u932f\u8aa4\u8655\u7406\u5c07\u53ea\u6703\u63a5\u6536\u672a\u7531 <code class=\"language-javascript\">componentDidCatch()</code> \u660e\u78ba\u6355\u6349\u7684\u932f\u8aa4\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n</div>\n<div class=\"blockquote\">\n<strong>\u5728\u6709\u932f\u8aa4\u7684\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u900f\u904e\u547c\u53eb setState \u4f86 render \u4e00\u500b\u542b\u6709 componentDidCatch() \u7684 fallback UI\uff0c\u4f46\u9019\u500b\u65b9\u6cd5\u6703\u5728\u672a\u4f86\u7684\u7248\u672c\u4e2d\u6703\u88ab\u68c4\u7528\u3002\n\u8acb\u4f7f\u7528 static getDerivedStateFromError() \u4f86\u8655\u7406 fallback render\u3002</strong>\n</div>\n\n<h3 id=\"legacy-lifecycle-methods\"><a class=\"anchor\" href=\"/react/react-component#legacy-lifecycle-methods\"></a>\u904e\u6642\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5 </h3>\n<p>\u4ee5\u4e0b\u4ecb\u7d39\u7684\u5e7e\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u662f\u300c\u904e\u6642\u300d\u7684\u3002\u5b83\u5011\u4ecd\u7136\u80fd\u904b\u4f5c\uff0c\u4f46\u6211\u5011\u4e26\u4e0d\u5efa\u8b70\u4f60\u5728\u65b0\u7684\u7a0b\u5f0f\u78bc\u5167\u4f7f\u7528\u9019\u4e9b\u65b9\u6cd5\u3002\u4f60\u53ef\u4ee5<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/03/27/update-on-async-rendering.html\">\u5728\u9019\u7bc7\u6587\u7ae0\u4e2d</a>\u4e86\u89e3\u5982\u4f55\u5f9e\u904e\u6642\u7684\u65b9\u6cd5 migrate \u5230\u6211\u5011\u5efa\u8b70\u7684\u65b9\u6cd5\u3002</p>\n<h3 id=\"unsafe_componentwillmount\"><a class=\"anchor\" href=\"/react/react-component#unsafe_componentwillmount\"></a><code class=\"language-javascript\">UNSAFE_componentWillMount()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">UNSAFE_componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5148\u524d\u7684\u547d\u540d\u662f <code class=\"language-javascript\">componentWillMount</code>\u3002\u9019\u500b\u547d\u540d\u76f4\u5230\u7b2c 17 \u7248\u4ecd\u7136\u80fd\u7e7c\u7e8c\u904b\u4f5c\u3002\u8acb\u4f7f\u7528<a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod#rename-unsafe-lifecycles\"><code class=\"language-javascript\">\u91cd\u65b0\u547d\u540d\u4e0d\u5b89\u5168\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5</code> codemod</a> \u4f86\u81ea\u52d5\u66f4\u65b0\u4f60\u7684 component\u3002</p>\n</div>\n<p><code class=\"language-javascript\">UNSAFE_componentWillMount()</code> \u6703\u5728 mounting \u767c\u751f\u524d\u88ab\u547c\u53eb\u3002\u5b83\u6703\u5728 <code class=\"language-javascript\">render()</code> \u524d\u88ab\u547c\u53eb\uff0c\u56e0\u6b64\u5728\u9019\u500b\u65b9\u6cd5\u5167\u540c\u6b65\u547c\u53eb <code class=\"language-javascript\">setState()</code> \u4e26\u4e0d\u6703\u89f8\u767c\u984d\u5916\u7684 render\u3002\u4e0d\u904e\uff0c\u4e00\u822c\u60c5\u6cc1\u4f86\u8aaa\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u4f7f\u7528 <code class=\"language-javascript\">constructor()</code> \u4f86\u521d\u59cb\u5316 state\u3002</p>\n<p>\u8acb\u907f\u514d\u5728\u9019\u500b\u65b9\u6cd5\u4e2d\u5e36\u5165\u4efb\u4f55\u7684 side effect \u6216 subscription\u3002\u5982\u679c\u4f60\u9700\u8981\u90a3\u6a23\u505a\u7684\u8a71\uff0c\u8acb\u4f7f\u7528 <code class=\"language-javascript\">componentDidMount()</code>\u3002</p>\n<p>\u9019\u662f\u552f\u4e00\u4e00\u500b\u5728\u4f3a\u670d\u5668\u7aef render \u6642\u88ab\u547c\u53eb\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u3002</p>\n\n<h3 id=\"unsafe_componentwillreceiveprops\"><a class=\"anchor\" href=\"/react/react-component#unsafe_componentwillreceiveprops\"></a><code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">UNSAFE_componentWillReceiveProps</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5148\u524d\u7684\u547d\u540d\u662f <code class=\"language-javascript\">componentWillReceiveProps</code>\u3002\u9019\u500b\u547d\u540d\u76f4\u5230\u7b2c 17 \u7248\u4ecd\u7136\u80fd\u7e7c\u7e8c\u904b\u4f5c\u3002\u8acb\u4f7f\u7528<a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod#rename-unsafe-lifecycles\"><code class=\"language-javascript\">\u91cd\u65b0\u547d\u540d\u4e0d\u5b89\u5168\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5</code> codemod</a> \u4f86\u81ea\u52d5\u66f4\u65b0\u4f60\u7684 component\u3002</p>\n</div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5e38\u5e38\u6703\u5c0e\u81f4 bug \u548c\u7a0b\u5f0f\u78bc\u7684\u4e0d\u4e00\u81f4\u3002</p>\n<ul>\n<li>\u5982\u679c\u4f60\u9700\u8981\u5728\u67d0\u500b prop \u6539\u8b8a\u6642 <strong>\u57f7\u884c\u4e00\u500b\u76f8\u5c0d\u61c9\u7684 side effect</strong>\uff08\u4f8b\u5982\u8cc7\u6599\u63d0\u53d6\u6216\u4f7f\u7528\u52d5\u756b\uff09\uff0c\u8acb\u4f7f\u7528<a href=\"/react/react-component#componentdidupdate\"><code class=\"language-javascript\">componentDidUpdate</code></a> \u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u3002</li>\n<li>\u5982\u679c\u4f60\u60f3\u8981 <strong>\u53ea\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u91cd\u65b0\u8a08\u7b97\u67d0\u4e9b\u8cc7\u6599</strong>\uff0c<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization\">\u8acb\u4f7f\u7528 memoization helper</a>\u3002</li>\n<li>\u5982\u679c\u4f60\u60f3\u8981 <strong>\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u300c\u91cd\u7f6e\u300d\u67d0\u500b state</strong>\uff0c\u8acb\u8003\u616e\u5efa\u7acb\u4e00\u500b<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-controlled-component\">\u5b8c\u5168\u88ab\u63a7\u5236</a> \u7684 component \u6216<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key\">\u5e36\u6709 <code class=\"language-javascript\">key</code> \u7684\u5b8c\u5168\u88ab\u63a7\u5236</a> component\u3002</li>\n</ul>\n<p>\u91dd\u5c0d\u4ee5\u4e0a\u9019\u4e9b\u4f7f\u7528\u60c5\u5883\uff0c\u8acb<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html\">\u9075\u7167\u9019\u7bc7\u6587\u7ae0\u5167\u63a8\u85a6\u7684\u65b9\u6cd5\u4f86\u8655\u7406\u7e7c\u627f\u7684 state</a>\u3002</p>\n</div>\n<p><code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code> \u6703\u5728\u4e00\u500b\u88ab mount \u7684 component \u63a5\u6536\u65b0\u7684 prop \u524d\u88ab\u547c\u53eb\u3002\u5982\u679c\u4f60\u9700\u8981\u5728\u67d0\u500b prop \u6539\u8b8a\u6642\u66f4\u65b0 state \u7684\u8a71\uff08\u4f8b\u5982\uff0c\u91cd\u7f6e state\uff09\uff0c\u4f60\u53ef\u4ee5\u5728\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u88e1\u9762\u6bd4\u8f03 <code class=\"language-javascript\">this.props</code> \u548c<code class=\"language-javascript\">nextProps</code>\uff0c\u4e26\u4f7f\u7528 <code class=\"language-javascript\">this.setState()</code> \u9032\u884c state \u7684\u8f49\u79fb\u3002</p>\n<p>\u8acb\u6ce8\u610f\u5982\u679c\u4e00\u500b parent component \u5c0e\u81f4\u4f60\u7684 component \u91cd\u65b0 render \u7684\u8a71\uff0c\u5373\u4f7f prop \u6c92\u6709\u6539\u8b8a\uff0c\u9019\u500b\u65b9\u6cd5\u4ecd\u7136\u6703\u88ab\u547c\u53eb\u3002\u5982\u679c\u4f60\u4e0d\u60f3\u8981\u6709\u9019\u4e9b\u6539\u8b8a\u7684\u8a71\uff0c\u8acb\u78ba\u8a8d\u4f60\u6709\u6bd4\u8f03\u76ee\u524d\u548c\u4e4b\u5f8c\u7684 prop \u7684\u503c\u3002</p>\n<p>React \u4e26\u4e0d\u6703\u5728\u521d\u6b21 <a href=\"/react/react-component#mounting\">mounting</a> \u6642\u4f7f\u7528\u521d\u59cb\u5316\u7684 props \u4f86\u547c\u53eb <code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code>\u3002\u5b83\u53ea\u6703\u5728 component \u67d0\u4e9b prop \u53ef\u80fd\u6703\u66f4\u65b0\u6642\u547c\u53eb\u9019\u500b\u65b9\u6cd5\u3002\u4e00\u822c\u4f86\u8aaa\uff0c\u547c\u53eb <code class=\"language-javascript\">this.setState()</code> \u4e26\u4e0d\u6703\u89f8\u767c <code class=\"language-javascript\">UNSAFE_componentWillReceiveProps()</code>\u3002</p>\n\n<h3 id=\"unsafe_componentwillupdate\"><a class=\"anchor\" href=\"/react/react-component#unsafe_componentwillupdate\"></a><code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">UNSAFE_componentWillUpdate</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">,</span> nextState<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5148\u524d\u7684\u547d\u540d\u662f <code class=\"language-javascript\">componentWillUpdate</code>\u3002\u9019\u500b\u547d\u540d\u76f4\u5230\u7b2c 17 \u7248\u4ecd\u7136\u80fd\u7e7c\u7e8c\u904b\u4f5c\u3002\u8acb\u4f7f\u7528<a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod#rename-unsafe-lifecycles\"><code class=\"language-javascript\">\u91cd\u65b0\u547d\u540d\u4e0d\u5b89\u5168\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5</code> codemod</a> \u4f86\u81ea\u52d5\u66f4\u65b0\u4f60\u7684 component\u3002</p>\n</div>\n<p><code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code> \u6703\u5728 render \u767c\u751f\u4e4b\u524d\u3001\u7576\u65b0\u7684 prop \u6216 state \u6b63\u5728\u88ab\u63a5\u6536\u6642\u88ab\u547c\u53eb\u3002\u8acb\u5c07\u9019\u500b\u65b9\u6cd5\u4f5c\u70ba\u66f4\u65b0\u767c\u751f\u4e4b\u524d\u505a\u6e96\u5099\u7684\u4e00\u500b\u6a5f\u6703\u3002\u9019\u500b\u65b9\u6cd5\u4e26\u4e0d\u6703\u5728\u521d\u6b21 render \u6642\u88ab\u547c\u53eb\u3002</p>\n<p>\u8acb\u6ce8\u610f\u4f60\u4e0d\u80fd\u5728\u9019\u88e1\u547c\u53eb <code class=\"language-javascript\">this.setState()</code>\uff0c\u4f60\u4e5f\u4e0d\u61c9\u8a72\u5728\u9019\u88e1\u9032\u884c\u5176\u4ed6\u4efb\u4f55\u5728 <code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code> \u56de\u50b3\u4e4b\u524d\u6703\u89f8\u767c React component \u66f4\u65b0\u7684\u884c\u70ba\uff08\u4f8b\u5982 dispatch \u4e00\u500b Redux action\uff09\u3002</p>\n<p>\u901a\u5e38\uff0c\u9019\u500b\u65b9\u6cd5\u53ef\u4ee5\u88ab <code class=\"language-javascript\">componentDidUpdate()</code> \u53d6\u4ee3\u3002\u5982\u679c\u4f60\u5728\u9019\u500b\u65b9\u6cd5\u5167\u5f9e DOM \u4e2d\u8b80\u53d6\u8cc7\u6599\uff08\u4f8b\u5982\u5132\u5b58\u6efe\u52d5\u8ef8\u7684\u4f4d\u7f6e\uff09\uff0c\u4f60\u53ef\u4ee5\u5c07\u90a3\u90e8\u5206\u7684\u908f\u8f2f\u79fb\u5230 <code class=\"language-javascript\">getSnapshotBeforeUpdate()</code> \u88e1\u9762\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5982\u679c <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate()</code></a> \u56de\u50b3 false \u7684\u8a71\uff0c<code class=\"language-javascript\">UNSAFE_componentWillUpdate()</code> \u5c07\u4e0d\u6703\u88ab\u547c\u53eb\u3002</p>\n</div>\n\n<h2 id=\"other-apis-1\"><a class=\"anchor\" href=\"/react/react-component#other-apis-1\"></a>\u5176\u4ed6\u7684 API </h2>\n<p>\u548c\u4e0a\u8ff0\u90a3\u4e9b\u7531 React \u66ff\u4f60\u547c\u53eb\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u4e0d\u540c\uff0c\u4ee5\u4e0b\u4ecb\u7d39\u7684\u65b9\u6cd5\u662f<em>\u4f60</em>\u53ef\u4ee5\u5f9e\u4f60\u7684 component \u547c\u53eb\u7684\u3002</p>\n<p>\u53ea\u6709\u5169\u500b\u65b9\u6cd5\uff1a <code class=\"language-javascript\">setState()</code> \u548c <code class=\"language-javascript\">forceUpdate()</code>\u3002</p>\n<h3 id=\"setstate\"><a class=\"anchor\" href=\"/react/react-component#setstate\"></a><code class=\"language-javascript\">setState()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>updater<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">setState()</code> \u6703\u5c07\u6539\u8b8a\u6392\u9032\u4e00\u500b queue \u4e2d\uff0c\u4e26\u544a\u77e5 React \u9019\u500b component \u4ee5\u53ca\u5b83\u7684 children \u9700\u8981\u7528\u66f4\u65b0\u5f8c\u7684 state \u91cd\u65b0 render\u3002\u9019\u662f\u4f60\u6703\u5728\u4e8b\u4ef6\u8655\u7406\u548c\u4f3a\u670d\u5668\u56de\u61c9\u7528\u4f86\u66f4\u65b0\u4f7f\u7528\u8005\u4ecb\u9762\u6700\u4e3b\u8981\u7684\u65b9\u6cd5\u3002</p>\n<p>\u8acb\u628a <code class=\"language-javascript\">setState()</code> \u60f3\u6210\u4e00\u500b<em>\u8acb\u6c42</em>\u800c\u975e\u4e00\u500b\u99ac\u4e0a\u5c0d component \u9032\u884c\u66f4\u65b0\u7684\u6307\u4ee4\u3002\u70ba\u4e86\u9054\u5230\u66f4\u597d\u7684\u6548\u80fd\uff0cReact \u4e5f\u8a31\u6703\u5ef6\u9072\u9019\u500b\u8acb\u6c42\uff0c\u7136\u5f8c\u4e00\u6b21\u66f4\u65b0\u6578\u500b component\u3002\u5728\u6975\u5c11\u6578\u60c5\u6cc1\u4e0b\uff0c\u4f60\u9700\u8981\u5f37\u5236\u540c\u6b65 DOM \u66f4\u65b0\uff0c\u4f60\u53ef\u4ee5\u5c07\u5176\u5305\u88dd\u5728 <a href=\"/react/react-dom#flushsync\"><code class=\"language-javascript\">flushSync</code></a> \u4e2d\uff0c\u4f46\u9019\u53ef\u80fd\u6703\u5f71\u97ff\u6548\u80fd\u3002</p>\n<p><code class=\"language-javascript\">setState()</code> \u4e26\u4e0d\u6703\u7e3d\u662f\u99ac\u4e0a\u66f4\u65b0 component\u3002\u5b83\u6709\u53ef\u80fd\u6703\u5c07\u66f4\u65b0\u5206\u6279\u8655\u7406\u66f4\u65b0\u6216\u5ef6\u9072\u5230\u7a0d\u5f8c\u624d\u66f4\u65b0\u3002\u9019\u4f7f\u5f97\u5728\u547c\u53eb <code class=\"language-javascript\">setState()</code> \u5f8c\u8b80\u53d6 <code class=\"language-javascript\">this.state</code> \u6210\u70ba\u4e00\u500b\u6f5b\u5728\u7684\u554f\u984c\u3002\u56e0\u6b64\u8acb\u4e0d\u8981\u9019\u9ebc\u505a\u3002\u76f8\u53cd\u7684\uff0c\u8acb\u4f7f\u7528 <code class=\"language-javascript\">componentDidUpdate</code> \u6216\u4e00\u500b <code class=\"language-javascript\">setState</code> callback\uff08<code class=\"language-javascript\">setState(updater, callback)</code>\uff09\u3002\u4e0d\u8ad6\u4f60\u4f7f\u7528\u54ea\u4e00\u500b\uff0cReact \u90fd\u4fdd\u8b49\u5b83\u6703\u5728\u66f4\u65b0\u5f8c\u88ab\u89f8\u767c\u3002\u5982\u679c\u4f60\u9700\u8981\u57fa\u65bc\u5148\u524d\u7684 state \u4f86\u8a2d\u5b9a state \u7684\u8a71\uff0c\u8acb\u95b1\u8b80\u4ee5\u4e0b\u95dc\u65bc <code class=\"language-javascript\">updater</code> \u7684\u53c3\u6578\u3002</p>\n<p>\u9664\u975e <code class=\"language-javascript\">shouldComponentUpdate()</code> \u56de\u50b3 <code class=\"language-javascript\">false</code>\uff0c<code class=\"language-javascript\">setState()</code> \u4e00\u5b9a\u6703\u5c0e\u81f4\u91cd\u65b0 render\u3002\u5982\u679c\u4f60\u6709\u4f7f\u7528 mutable object\uff0c\u6216\u8005\u4f60\u7121\u6cd5\u5728 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u88e1\u9762\u5efa\u7acb\u689d\u4ef6\u5f0f render \u7684\u908f\u8f2f\u7684\u8a71\uff0c\u53ea\u5728\u65b0\u7684 state \u548c\u5148\u524d\u7684 state \u4e0d\u540c\u6642\u547c\u53eb <code class=\"language-javascript\">setState()</code> \u5c07\u6703\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u91cd\u65b0 render\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u7684\u7b2c\u4e00\u500b\u53c3\u6578\u662f\u4e00\u500b\u5e36\u6709\u5982\u4e0b\u7684\u5f62\u5f0f\u7684 <code class=\"language-javascript\">updater</code> function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> stateChange</code></pre></div>\n<p><code class=\"language-javascript\">state</code> \u662f\u7576\u67d0\u500b\u6539\u8b8a\u6b63\u5728\u88ab\u61c9\u7528\u6642\u5c0d component state \u7684\u4e00\u500b\u53c3\u8003\u3002\u5b83\u4e0d\u61c9\u8a72\u76f4\u63a5\u88ab mutate\u3002\u76f8\u53cd\u7684\uff0c\u4efb\u4f55\u6539\u8b8a\u90fd\u61c9\u8a72\u7528\u4e00\u500b\u57fa\u65bc <code class=\"language-javascript\">state</code> \u548c <code class=\"language-javascript\">props</code> \u7684 input \u6240\u5efa\u7acb\u7684\u65b0\u7684 object \u4f86\u8868\u793a\u3002\u4f8b\u5982\uff0c\u5047\u8a2d\u6211\u5011\u60f3\u8981\u4f7f\u7528 <code class=\"language-javascript\">props.step</code> \u4f86\u589e\u52a0 state \u4e2d\u7684\u67d0\u500b\u503c\u7684\u8a71\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+</span> props<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u88ab updater function \u6240\u63a5\u53d7\u7684 <code class=\"language-javascript\">state</code> \u548c <code class=\"language-javascript\">props</code> \u5169\u8005\u90fd\u4fdd\u8b49\u4e00\u5b9a\u6703\u88ab\u66f4\u65b0\u5230\u6700\u65b0\u7684\u72c0\u614b\u3002Updater \u7684 output \u6703\u88ab\u548c <code class=\"language-javascript\">state</code> \u6dfa\u5c64\u5408\u4f75\u3002</p>\n<p><code class=\"language-javascript\">setState()</code> \u7684\u7b2c\u4e8c\u500b\u53c3\u6578\u662f\u4e00\u500b\u975e\u5fc5\u8981\u3001\u9078\u64c7\u6027\u7684 callback function\u3002\u5b83\u6703\u5728 <code class=\"language-javascript\">setState</code> \u5b8c\u6210\u4e14 component \u88ab\u91cd\u65b0 render \u5f8c\u88ab\u57f7\u884c\u3002\u4e00\u822c\u4f86\u8aaa\u5982\u679c\u4f60\u8981\u4f7f\u7528\u9019\u6a23\u7684\u908f\u8f2f\u7684\u8a71\uff0c\u6211\u5011\u6bd4\u8f03\u63a8\u85a6\u4f60\u4f7f\u7528 <code class=\"language-javascript\">componentDidUpdate()</code>\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u9078\u64c7\u5c07\u4e00\u500b object\uff08\u800c\u975e function\uff09\u4f5c\u70ba\u7b2c\u4e00\u500b\u53c3\u6578\u50b3\u7d66 <code class=\"language-javascript\">setState()</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>stateChange<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u6703\u5c07 <code class=\"language-javascript\">stateChange</code> \u6dfa\u5c64\u5408\u4f75\u81f3\u65b0\u7684 state \u4e2d\u3002\u8209\u500b\u4f8b\u5b50\uff0c\u5047\u8a2d\u4f60\u60f3\u8abf\u6574\u8cfc\u7269\u8eca\u4e2d\u7269\u54c1\u7684\u6578\u91cf\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u7a2e\u5f62\u5f0f\u7684 <code class=\"language-javascript\">setState()</code> \u4e5f\u662f\u540c\u6b65\u7684\uff0c\u800c\u540c\u6a23\u4e00\u500b\u9031\u671f\u4e2d\u7684\u591a\u6b21\u547c\u53eb\u6709\u53ef\u80fd\u6703\u88ab\u7d50\u5408\u6210\u4e00\u6279\u505a\u8655\u7406\u3002\u4f8b\u5982\uff0c\u5047\u8a2d\u4f60\u60f3\u5728\u540c\u4e00\u500b\u9031\u671f\u4e2d\u589e\u52a0\u67d0\u500b\u7269\u54c1\u7684\u6578\u91cf\u8d85\u904e\u4e00\u6b21\u7684\u8a71\uff0c\u9019\u6a23\u505a\u7684\u7d50\u679c\u6703\u548c\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u76f8\u540c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-javascript\"><code class=\"language-javascript\">Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>\n  previousState<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>quantity <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>quantity <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5728\u540c\u4e00\u500b\u9031\u671f\u4e2d\uff0c\u5f8c\u7e8c\u7684\u547c\u53eb\u6703\u8986\u84cb\u4e4b\u524d\u7684\u547c\u53eb\u6240\u7522\u751f\u7684\u503c\uff0c\u6240\u4ee5\u7269\u54c1\u7684\u6578\u91cf\u53ea\u6703\u88ab\u589e\u52a0\u4e00\u6b21\u3002\u5982\u679c\u4e0b\u500b state \u662f\u6839\u64da\u76ee\u524d\u7684 state \u800c\u6c7a\u5b9a\u7684\u8a71\uff0c\u6211\u5011\u6bd4\u8f03\u5efa\u8b70\u4f60\u7528 updater function \u4f86\u66f4\u65b0 state\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>quantity <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u60f3\u4e86\u89e3\u66f4\u591a\u7d30\u7bc0\uff0c\u8acb\u53c3\u8003\uff1a</p>\n<ul>\n<li><a href=\"/react/state-and-lifecycle\">State \u548c\u751f\u547d\u9031\u671f\u6307\u5357</a></li>\n<li><a class=\"external-link\" href=\"https://stackoverflow.com/a/48610973/458193\">\u6df1\u5165\u89e3\u6790\uff1a\u70ba\u4ec0\u9ebc <code class=\"language-javascript\">setState()</code> \u7684\u547c\u53eb\u6703\u6279\u6b21\u8655\u7406\uff1f\u4ec0\u9ebc\u6642\u5019\u6703\u5982\u6b64\uff1f</a></li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/issues/11527#issuecomment-360199710\">\u6df1\u5165\u89e3\u6790\uff1a\u70ba\u4ec0\u9ebc <code class=\"language-javascript\">this.state</code> \u4e0d\u6703\u99ac\u4e0a\u88ab\u66f4\u65b0\uff1f</a></li>\n</ul>\n\n<h3 id=\"forceupdate\"><a class=\"anchor\" href=\"/react/react-component#forceupdate\"></a><code class=\"language-javascript\">forceUpdate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">component<span class=\"token punctuation\">.</span><span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u7576\u4f60\u7684 component \u7684 state \u6216 prop \u6539\u8b8a\u7684\u6642\u5019\uff0c\u4f60\u7684 component \u7684\u9810\u8a2d\u884c\u70ba\u662f\u6703\u91cd\u65b0 render\u3002\u5982\u679c\u4f60\u7684 <code class=\"language-javascript\">render()</code> \u65b9\u6cd5\u9084\u9700\u8981\u5176\u4ed6\u8cc7\u6599\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u85c9\u7531\u547c\u53eb <code class=\"language-javascript\">forceUpdate()</code> \u4f86\u544a\u8a34 React \u9019\u500b component \u9700\u8981\u91cd\u65b0 render\u3002</p>\n<p>\u547c\u53eb <code class=\"language-javascript\">forceUpdate()</code> \u6703\u5c0e\u81f4  <code class=\"language-javascript\">render()</code> \u88ab\u547c\u53eb\u65bc\u8a72 component \u4e26\u8df3\u904e <code class=\"language-javascript\">shouldComponentUpdate()</code>\u3002\u9019\u6703\u89f8\u767c children component \u6b63\u5e38\u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u5305\u542b\u6bcf\u500b child \u7684 <code class=\"language-javascript\">shouldComponentUpdate()</code> \u65b9\u6cd5\u3002React \u4f9d\u7136\u53ea\u6703\u5728 markup \u6539\u8b8a\u6642\u66f4\u65b0 DOM\u3002</p>\n<p>\u6b63\u5e38\u60c5\u6cc1\u4f86\u8aaa\u4f60\u61c9\u8a72\u907f\u514d\u4f7f\u7528 <code class=\"language-javascript\">forceUpdate()</code> \u4e26\u53ea\u5f9e <code class=\"language-javascript\">render()</code> \u4e2d\u7684 <code class=\"language-javascript\">this.props</code> \u548c <code class=\"language-javascript\">this.state</code> \u8b80\u53d6\u3002</p>\n\n<h2 id=\"class-properties-1\"><a class=\"anchor\" href=\"/react/react-component#class-properties-1\"></a>Class \u5c6c\u6027 </h2>\n<h3 id=\"defaultprops\"><a class=\"anchor\" href=\"/react/react-component#defaultprops\"></a><code class=\"language-javascript\">defaultProps</code> </h3>\n<p><code class=\"language-javascript\">defaultProps</code> \u53ef\u4ee5\u5728\u4e00\u500b component class \u81ea\u8eab\u88ab\u5b9a\u7fa9\u70ba\u4e00\u500b\u5c6c\u6027\uff0c\u5b83\u88ab\u7528\u4f86\u8a2d\u5b9a\u8a72 class \u7684\u9810\u8a2d props\u3002\u5b83\u662f\u70ba\u4e86 <code class=\"language-javascript\">undefined</code>\uff08\u800c\u975e <code class=\"language-javascript\">null</code>\uff09 \u7684 prop \u4f7f\u7528\u7684\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\nCustomButton<span class=\"token punctuation\">.</span>defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">props.color</code> \u7684\u503c\u6c92\u6709\u88ab\u63d0\u4f9b\u7684\u8a71\uff0c\u5b83\u6703\u88ab\u9810\u8a2d\u70ba <code class=\"language-javascript\">'blue'</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomButton</span></span> <span class=\"token punctuation\">/&gt;</span></span> <span class=\"token punctuation\">;</span> <span class=\"token comment\">// props.color \u88ab\u9810\u8a2d\u70ba blue</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">props.color</code> \u7684\u503c\u88ab\u8a2d\u70ba <code class=\"language-javascript\">null</code>\uff0c\u5176\u503c\u6703\u7e7c\u7e8c\u70ba <code class=\"language-javascript\">null</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CustomButton</span></span> <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span> <span class=\"token punctuation\">;</span> <span class=\"token comment\">// props.color \u7e7c\u7e8c\u70ba null</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n\n<h3 id=\"displayname\"><a class=\"anchor\" href=\"/react/react-component#displayname\"></a><code class=\"language-javascript\">displayName</code> </h3>\n<p><code class=\"language-javascript\">displayName</code> string \u662f\u7528\u4f86 debug \u7684\u3002\u901a\u5e38\uff0c\u4f60\u4e0d\u9700\u8981\u660e\u78ba\u7684\u8a2d\u5b9a\u9019\u500b\u5c6c\u6027\uff0c\u56e0\u70ba\u5b83\u53ef\u4ee5\u6839\u64da\u5b9a\u7fa9\u8a72 component \u7684 function \u6216 class \u7684\u540d\u7a31\u63a8\u65b7\u9019\u500b\u503c\u70ba\u4f55\u3002\u7576\u4f60\u70ba\u4e86 debug \u6216\u5efa\u7acb\u4e00\u500b higher-order component \u800c\u9700\u8981\u5c55\u793a\u4e00\u500b\u4e0d\u540c\u7684\u540d\u5b57\u6642\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u8981\u660e\u78ba\u7684\u8a2d\u5b9a\u9019\u500b\u503c\uff0c\u8acb\u53c3\u8003<a href=\"/react/higher-order-components#convention-wrap-the-display-name-for-easy-debugging\">\u5982\u4f55\u5305\u8986 Display Name \u4e26\u8f15\u9b06 debug</a>\u3002</p>\n\n<h2 id=\"instance-properties-1\"><a class=\"anchor\" href=\"/react/react-component#instance-properties-1\"></a>Instance \u5c6c\u6027 </h2>\n<h3 id=\"props\"><a class=\"anchor\" href=\"/react/react-component#props\"></a><code class=\"language-javascript\">props</code> </h3>\n<p><code class=\"language-javascript\">this.props</code> \u5305\u542b\u4e86\u8a72 component \u7684\u547c\u53eb\u8005\u6240\u5b9a\u7fa9\u7684 prop\u3002\u60f3\u4e86\u89e3 prop \u7684\u57fa\u790e\u6982\u5ff5\uff0c\u8acb\u53c3\u8003 <a href=\"/react/components-and-props\">Components \u548c Props</a>\u6587\u4ef6\u3002</p>\n<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c<code class=\"language-javascript\">this.props.children</code> \u662f\u4e00\u500b\u7279\u5225\u7684 prop\uff0c\u901a\u5e38\u5728 JSX \u8868\u9054\u5f0f\u5167\u7684 child tag \u5167\u6240\u5b9a\u7fa9\uff0c\u800c\u4e0d\u662f\u5176\u81ea\u8eab\u7684 tag\u3002</p>\n<h3 id=\"state\"><a class=\"anchor\" href=\"/react/react-component#state\"></a><code class=\"language-javascript\">state</code> </h3>\n<p>State \u5305\u542b\u4e86\u67d0\u500b component \u5167\u7279\u5b9a\u7684\u3001\u6703\u96a8\u6642\u9593\u6539\u8b8a\u7684\u8cc7\u6599\uff0c\u9019\u500b state \u662f\u7531\u4f7f\u7528\u8005\u5b9a\u7fa9\u7684\u3002\u5b83\u61c9\u662f\u4e00\u500b\u7c21\u55ae\u7684 JavaScript object\u3002</p>\n<p>\u5982\u679c\u67d0\u500b\u503c\u4e26\u6c92\u6709\u5728 render \u6216\u8cc7\u6599\u6d41\u4e2d\u88ab\u4f7f\u7528\uff08\u4f8b\u5982\u8a08\u6642\u5668\u7684 ID\uff09\uff0c\u4f60\u4e0d\u9700\u8981\u5c07\u5b83\u653e\u5728 state \u5167\u3002\u9019\u985e\u7684\u503c\u53ef\u4ee5\u5728 component \u5be6\u4f8b\u4e0a\u88ab\u5b9a\u7fa9\u70ba field\u3002</p>\n<p>\u60f3\u66f4\u4e86\u89e3 state \u5982\u4f55\u904b\u4f5c\uff0c\u8acb\u53c3\u8003 <a href=\"/react/state-and-lifecycle\">State \u548c\u751f\u547d\u9031\u671f</a>\u3002</p>\n<p>\u8acb\u6c38\u9060\u4e0d\u8981\u76f4\u63a5 mutate <code class=\"language-javascript\">this.state</code>\uff0c\u56e0\u70ba\u5f8c\u7e8c\u7684 <code class=\"language-javascript\">setState()</code> \u6703\u66ff\u63db\u6389\u4f60\u7684 mutation\u3002\u8acb\u5c07 <code class=\"language-javascript\">this.state</code> \u8996\u70ba\u4e0d\u53ef\u8b8a\u7684\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-react-component.md\">Edit this page</a></p></div></article>", "path": "/react/react-component", "nav": ["/react/react-api", "/react/react-dom"]}, {"key": "ReactDOM", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><code class=\"language-javascript\">react-dom</code> \u63d0\u4f9b\u4e86 DOM \u7684\u7279\u5b9a\u65b9\u6cd5\u8b93\u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u9802\u5c64\u4f7f\u7528\uff0c\u5982\u679c\u6709\u9700\u8981\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u70ba\u4e00\u500b\u9003\u751f\u7a97\u53e3\u4f86\u812b\u96e2 React \u6a21\u578b\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u4f7f\u7528 ES5 \u8207 npm\uff0c\u4f60\u53ef\u4ee5\u9019\u6a23\u5beb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ReactDOM <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">react-dom</code> package \u4e5f\u63d0\u4f9b\u4e86\u7279\u5b9a\u65bc client \u548c server \u61c9\u7528\u7a0b\u5f0f\u7684 module\uff1a</p>\n<ul>\n<li><a href=\"/react/react-dom-client\"><code class=\"language-javascript\">react-dom/client</code></a></li>\n<li><a href=\"/react/react-dom-server\"><code class=\"language-javascript\">react-dom/server</code></a></li>\n</ul>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/react-dom#overview\"></a>\u6982\u89bd </h2>\n<p><code class=\"language-javascript\">react-dom</code> package export \u9019\u4e9b\u65b9\u6cd5\uff1a</p>\n<ul>\n<li><a href=\"/react/react-dom#createportal\"><code class=\"language-javascript\">createPortal()</code></a></li>\n<li><a href=\"/react/react-dom#flushsync\"><code class=\"language-javascript\">flushSync()</code></a></li>\n</ul>\n<p>\u9019\u4e9b <code class=\"language-javascript\">react-dom</code> \u65b9\u6cd5\u4e5f\u88ab export\uff0c\u4f46\u662f\u88ab\u8996\u70ba\u662f legacy\uff1a</p>\n<ul>\n<li><a href=\"/react/react-dom#render\"><code class=\"language-javascript\">render()</code></a></li>\n<li><a href=\"/react/react-dom#hydrate\"><code class=\"language-javascript\">hydrate()</code></a></li>\n<li><a href=\"/react/react-dom#finddomnode\"><code class=\"language-javascript\">findDOMNode()</code></a></li>\n<li><a href=\"/react/react-dom#unmountcomponentatnode\"><code class=\"language-javascript\">unmountComponentAtNode()</code></a></li>\n</ul>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">render</code> \u8207 <code class=\"language-javascript\">hydrate</code> \u5169\u8005\u5728 React 18 \u5df2\u7d93\u66ff\u63db\u70ba\u65b0\u7684 <a href=\"/react/react-dom-client\">client \u65b9\u6cd5</a>\u3002\u5982\u679c\u4f60\u4f7f\u7528\u50cf\u662f React 17 \u65b9\u5f0f\uff0c\u9019\u4e9b\u65b9\u6cd5\u5c07\u8b66\u544a\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u7684\u884c\u70ba\u3002\uff08<a class=\"external-link\" href=\"https://reactjs.org/link/switch-to-createroot\">\u5f9e\u9019\u88e1</a>\u4e86\u89e3\u66f4\u591a\uff09\u3002</p>\n</div>\n<h3 id=\"browser-support\"><a class=\"anchor\" href=\"/react/react-dom#browser-support\"></a>\u700f\u89bd\u5668\u652f\u63f4 </h3>\n<p>React \u652f\u63f4\u6240\u6709\u4e3b\u6d41\u700f\u89bd\u5668\uff0c\u96d6\u7136\u5c0d\u65bc\u4e00\u4e9b\u820a\u7248\u700f\u89bd\u5668<a href=\"/react/javascript-environment-requirements\">\u9700\u8981\u4e00\u4e9b polyfill</a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u6211\u5011\u4e0d\u652f\u63f4\u90a3\u4e9b\u8f03\u820a\u4e0d\u652f\u63f4 ES5 \u65b9\u6cd5\u6216\u662f microtasks \u7684\u700f\u89bd\u5668\uff0c\u50cf\u662f Internet Explorer\u3002\u4f46\u5982\u679c\u9801\u9762\u4e0a\u5f15\u5165\u4e86\u50cf\u662f <a class=\"external-link\" href=\"https://github.com/es-shims/es5-shim\">es5-shim \u548c es5-sham</a> \u7b49 polyfill \u4f60\u53ef\u80fd\u6703\u767c\u73fe\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u5728\u8f03\u820a\u7684\u700f\u89bd\u5668\u4e0a\u4ecd\u53ef\u4f7f\u7528\uff0c\u4f46\u5982\u679c\u4f60\u9078\u64c7\u4e86\u9019\u689d\u8def\u4f60\u5c31\u53ea\u80fd\u9760\u4f60\u81ea\u5df1\u4e86\u3002</p>\n</div>\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/react-dom#reference\"></a>\u53c3\u8003 </h2>\n<h3 id=\"createportal\"><a class=\"anchor\" href=\"/react/react-dom#createportal\"></a><code class=\"language-javascript\">createPortal()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">createPortal</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u63d0\u4f9b\u4e86\u4e00\u500b\u65b9\u5f0f\u5c07 children <a href=\"/react/portals\">render \u5b58\u5728\u65bc DOM component \u5c64\u6b21\u7d50\u69cb\u4e4b\u5916\u7684 DOM \u7bc0\u9ede\u4e2d</a>\u3002</p>\n<h3 id=\"flushsync\"><a class=\"anchor\" href=\"/react/react-dom#flushsync\"></a><code class=\"language-javascript\">flushSync()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">flushSync</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5f37\u5236 React \u540c\u6b65 flush \u63d0\u4f9b\u7684 callback \u4e2d\u7684\u4efb\u4f55\u66f4\u65b0\u3002\u9019\u53ef\u4ee5\u78ba\u4fdd DOM \u88ab\u7acb\u5373\u7684\u66f4\u65b0\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Force this state update to be synchronous.</span>\n<span class=\"token function\">flushSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// By this point, DOM is updated.</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">flushSync</code> \u53ef\u80fd\u6703\u5c0d\u6548\u80fd\u7522\u751f\u91cd\u5927\u7684\u5f71\u97ff\u3002\u8b39\u614e\u4f7f\u7528\u3002</p>\n<p><code class=\"language-javascript\">flushSync</code> \u53ef\u80fd\u6703\u8feb\u4f7f pending \u7684 Suspense boundary \u986f\u793a <code class=\"language-javascript\">fallback</code> \u72c0\u614b\u3002</p>\n<p><code class=\"language-javascript\">flushSync</code> \u4e5f\u53ef\u4ee5\u57f7\u884c pending effects\uff0c\u4e26\u5728\u56de\u50b3\u4e4b\u524d\u540c\u6b65 apply \u5b83\u5011\u5305\u542b\u7684\u4efb\u4f55\u66f4\u65b0\u3002</p>\n<p><code class=\"language-javascript\">flushSync</code> <code class=\"language-javascript\">flushSync</code> \u5728\u5fc5\u8981\u6642\u4e5f\u53ef\u4ee5\u5728 callback \u5916 flush \u66f4\u65b0\uff0c\u4ee5 flush callback \u5185\u7684\u66f4\u65b0\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6709\u4f86\u81ea click \u7684 pending \u66f4\u65b0\uff0cReact \u53ef\u80fd\u6703\u5728 flush callback \u4e2d\u7684\u66f4\u65b0\u4e4b\u524d flush \u9019\u4e9b\u5185\u5bb9\u3002</p>\n</div>\n<h2 id=\"legacy-reference\"><a class=\"anchor\" href=\"/react/react-dom#legacy-reference\"></a>Legacy Reference </h2>\n<h3 id=\"render\"><a class=\"anchor\" href=\"/react/react-dom#render\"></a><code class=\"language-javascript\">render()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">render</code> \u5728 React 18 \u5df2\u7d93\u88ab <code class=\"language-javascript\">createRoot</code> \u53d6\u4ee3\u3002\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u8003 <a href=\"/react/react-dom-client#createroot\">createRoot</a>\u3002</p>\n</div>\n<p>\u5c07\u4e00\u500b React elemnt render \u5230\u63d0\u4f9b\u63d0\u4f9b\u7684 <code class=\"language-javascript\">container</code> \u7684 DOM \u4e2d\uff0c\u4e26\u56de\u50b3\u4e00\u500b\u8a72 component \u7684 <a href=\"/react/more-about-refs\">reference</a>\uff08\u5c0d\u65bc <a href=\"/react/components-and-props#function-and-class-components\">stateless components</a> \u56de\u50b3 <code class=\"language-javascript\">null</code>\uff09\u3002</p>\n<p>\u5982\u679c React element \u4e4b\u524d\u5df2\u7d93\u5728 <code class=\"language-javascript\">container</code> \u5167\u88ab render\uff0c\u5b83\u53ea\u6703\u57f7\u884c\u66f4\u65b0\u4e26 mutate \u5fc5\u8981\u7684 DOM\uff0c\u4f86\u5448\u73fe\u6700\u65b0\u7684 React element\u3002</p>\n<p>\u5982\u679c\u63d0\u4f9b\u4e86\u53ef\u9078\u7684 callback\uff0c\u5b83\u5c07\u6703\u5728 component \u88ab render \u6216\u66f4\u65b0\u4e4b\u5f8c\uff0c\u624d\u88ab\u57f7\u884c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">render()</code> \u63a7\u5236\u4e86\u4f60\u50b3\u5165\u5230 container \u5167\u7684 node \u5167\u5bb9\u3002\u7576\u7b2c\u4e00\u6b21\u88ab\u547c\u53eb\u6642\uff0c\u4efb\u4f55\u5b58\u5728\u65bc container \u7684 DOM element \u90fd\u6703\u88ab\u66ff\u63db\u3002\u4e4b\u5f8c\u7684\u547c\u53eb\u6703\u4f7f\u7528 React \u7684 DOM diffing \u6f14\u7b97\u6cd5\u9032\u884c\u9ad8\u6548\u7387\u7684\u66f4\u65b0\u3002</p>\n<p><code class=\"language-javascript\">render()</code> \u4e0d\u4fee\u6539 container \u7684 node\uff08\u53ea\u4fee\u6539 container \u7684 children\uff09\u3002\u5b83\u53ef\u4ee5\u5c07 component \u63d2\u5165\u4e00\u500b\u73fe\u6709\u7684 DOM node \u800c\u4e0d\u7528\u8986\u84cb\u5df2\u7d93\u5b58\u5728\u7684 children\u3002</p>\n<p><code class=\"language-javascript\">render()</code> \u76ee\u524d\u56de\u50b3\u4e00\u500b reference \u5230 root <code class=\"language-javascript\">ReactComponent</code> instance\u3002\u7136\u800c\uff0c\u4f7f\u7528\u9019\u500b\u56de\u50b3\u503c\u662f\u88ab\u907a\u7559\u7684\u65b9\u5f0f\n\u4e26\u4e14\u61c9\u8a72\u88ab\u907f\u514d\uff0c\u56e0\u70ba\u672a\u4f86\u7248\u672c\u7684 React \u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u53ef\u80fd\u6703\u975e\u540c\u6b65\u5730 render component\u3002\u5982\u679c\u4f60\u9700\u8981 reference \u5230 root <code class=\"language-javascript\">ReactComponent</code> instance\uff0c\u9996\u9078\u7684\u89e3\u6c7a\u65b9\u5f0f\u662f\u9644\u52a0\u4e00\u500b\n<a href=\"/react/refs-and-the-dom#callback-refs\">callback ref</a> \u5728 root element \u4e0a\u3002</p>\n<p>\u4f7f\u7528 <code class=\"language-javascript\">render()</code> \u4f86 hydrate \u4e00\u500b server-render container \u5df2\u7d93\u88ab\u68c4\u7528\u3002\u4f7f\u7528 <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">hydrateRoot()</code></a> \u4f5c\u70ba\u4ee3\u66ff\u3002</p>\n</div>\n\n<h3 id=\"hydrate\"><a class=\"anchor\" href=\"/react/react-dom#hydrate\"></a><code class=\"language-javascript\">hydrate()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">hydrate</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">hydrate</code> \u5728 React 18 \u5df2\u7d93\u88ab <code class=\"language-javascript\">hydrateRoot</code> \u53d6\u4ee3\u3002\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u8003 <a href=\"/react/react-dom-client#hydrateroot\">hydrateRoot</a>\u3002</p>\n</div>\n<p>\u5982\u540c <a href=\"/react/react-dom#render\"><code class=\"language-javascript\">render()</code></a>\uff0c\u4f46\u5b83\u662f\u88ab\u7528\u4f86 hydrate \u4e00\u500b container\uff0c\u5176 HTML \u5167\u5bb9\u662f\u7531 <a href=\"/react/react-dom-server\"><code class=\"language-javascript\">ReactDOMServer</code></a> render\u3002React \u5c07\u5617\u8a66\u5c07 event listener attach \u5230\u73fe\u6709 markup \u4e0a\u3002s</p>\n<p>React \u9810\u671f\u5728\u4f3a\u670d\u5668\u7aef\u548c\u5ba2\u6236\u7aef\u6240 render \u7684\u5167\u5bb9\u662f\u76f8\u540c\u7684\u3002\u5b83\u53ef\u4ee5\u4fee\u88dc text content \u7684\u5dee\u7570\uff0c\u4f46\u4f60\u61c9\u8a72\u628a\u4e0d\u5339\u914d\u7684\u90e8\u5206\u8996\u70ba bug \u4e26\u4e14\u4fee\u6b63\u3002\u5728\u958b\u767c\u6a21\u5f0f\u4e2d\uff0cReact \u6703\u8b66\u544a\u95dc\u65bc hydration \u904e\u7a0b\u4e2d\u7684\u4e0d\u5339\u914d\u3002\u5728\u4e0d\u5339\u914d\u7684\u60c5\u6cc1\u4e0b\uff0c\u5c07\u7121\u6cd5\u4fdd\u8b49 attribute \u7684\u5dee\u7570\u6703\u88ab\u4fee\u88dc\u3002\u9019\u5c0d\u65bc\u6548\u80fd\u4f86\u8aaa\u5f88\u91cd\u8981\uff0c\u56e0\u70ba\u5728\u5927\u90e8\u5206\u7684\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4e0d\u5339\u914d\u7684\u60c5\u6cc1\u5f88\u5c11\u898b\uff0c\u4e5f\u56e0\u6b64\u9a57\u8b49\u8981\u6240\u6709 markup \u7684\u6210\u672c\u975e\u5e38\u9ad8\u3002</p>\n<p>\u5982\u679c\u5728\u4f3a\u670d\u5668\u7aef\u548c\u5ba2\u6236\u7aef\u67d0\u500b element \u7684 attribute \u6216 text content \u7121\u53ef\u907f\u514d\u7684\u4e0d\u76f8\u540c\uff08\u4f8b\u5982\uff0c\u6642\u9593\u6233\uff09\uff0c\u4f60\u53ef\u4ee5\u900f\u904e\u52a0\u5165 <code class=\"language-javascript\">suppressHydrationWarning={true}</code> \u5230 element \u4f86\u95dc\u9589\u8b66\u544a\u3002\u9019\u500b\u53ea\u6709\u5728\u7b2c\u4e00\u5c64\u6642\u6709\u6548\u4e26\u4e14\u50be\u5411\u65bc\u61c9\u6025\u7684\u505a\u6cd5\u3002\u4e0d\u8981\u904e\u5ea6\u4f7f\u7528\u5b83\u3002\u9664\u975e\u5b83\u662f text content \u5426\u5247 React \u4ecd\u7136\u4e0d\u6703\u5617\u8a66\u5c0d\u5176\u9032\u884c\u4fee\u88dc\uff0c\u6240\u4ee5\u5728\u672a\u4f86\u66f4\u65b0\u4e4b\u524d\u5b83\u53ef\u80fd\u6703\u4fdd\u6301\u4e0d\u4e00\u81f4\u3002</p>\n<p>\u5982\u679c\u4f60\u523b\u610f\u8981\u5728\u670d\u52d9\u7aef\u548c\u5ba2\u6236\u7aef\u4e0a render \u4e0d\u540c\u7684\u5167\u5bb9\uff0c\u4f60\u53ef\u4ee5\u9032\u884c\u5169\u6b21\u7684 render\u3002\u5728\u5ba2\u6236\u7aef\u4e0a\u5448\u73fe\u4e0d\u540c\u5167\u5bb9\u7684 component \u53ef\u4ee5\u900f\u904e\u8b80\u53d6\u4e00\u500b state \u8b8a\u6578\u50cf\u662f <code class=\"language-javascript\">this.state.isClient</code> \u4e4b\u5f8c\u5728 <code class=\"language-javascript\">componentDidMount()</code> \u5167\u628a\u5b83\u8a2d\u5b9a\u6210 <code class=\"language-javascript\">true</code>\u3002\u9019\u6a23\u521d\u59cb render \u5c07\u8ddf\u4f3a\u670d\u5668\u7aef render \u7684\u5167\u5bb9\u4e00\u6a23\uff0c\u5f9e\u800c\u907f\u514d\u4e0d\u5339\u914d\uff0c\u4f46\u5728 hydrate \u4e4b\u5f8c\u5c07\u6703\u7acb\u5373\u540c\u6b65\u984d\u5916\u7684\u7a0b\u5e8f\u3002\u8acb\u6ce8\u610f\uff0c\u6b64\u65b9\u6cd5\u6703\u4f7f\u4f60\u7684 component \u8b8a\u6162\uff0c\u56e0\u70ba\u5b83\u5fc5\u9808\u88ab render \u5169\u6b21\uff0c\u56e0\u6b64\u8acb\u8b39\u614e\u4f7f\u7528\u3002</p>\n<p>\u8acb\u8a18\u5f97\u8981\u7559\u610f\u9023\u7dda\u7de9\u6162\u7684\u4f7f\u7528\u8005\u9ad4\u9a57\u3002JavaScript \u8f09\u5165\u986f\u7136\u6bd4 HTML \u9996\u6b21 render \u8981\u665a\u5f97\u591a\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u53ea\u6709\u5728\u5ba2\u6236\u7aef render \u4e00\u4e9b\u4e0d\u540c\u7684\u6771\u897f\uff0c\u5247\u8f49\u63db\u53ef\u80fd\u6703\u4e0d\u7a69\u5b9a\u3002\u7136\u800c\uff0c\u5982\u679c\u57f7\u884c\u9806\u5229\u7684\u8a71\uff0c\u5728\u4f3a\u670d\u5668\u4e0a render \u61c9\u7528\u7a0b\u5f0f\u7684\u300cshell\u300d\u53ef\u80fd\u662f\u6709\u5e6b\u52a9\u7684\uff0c\u800c\u4e14\u53ea\u986f\u793a\u4e00\u4e9b\u984d\u5916\u7684\u63d2\u4ef6\u5728\u5ba2\u6236\u7aef\u3002\u8981\u4e86\u89e3\u5982\u4f55\u57f7\u884c\u6b64\u64cd\u4f5c\u800c\u4e0d\u6703\u51fa\u73fe markup \u4e0d\u5339\u914d\u7684\u554f\u984c\uff0c\u8acb\u53c3\u8003\u4e0a\u4e00\u500b\u6bb5\u843d\u7684\u8aaa\u660e\u3002</p>\n\n<h3 id=\"unmountcomponentatnode\"><a class=\"anchor\" href=\"/react/react-dom#unmountcomponentatnode\"></a><code class=\"language-javascript\">unmountComponentAtNode()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">unmountComponentAtNode</code> \u5728 React 18 \u5df2\u7d93\u88ab <code class=\"language-javascript\">root.unmount()</code> \u53d6\u4ee3\u3002\u66f4\u591a\u8cc7\u8a0a\u8acb\u53c3\u8003 <a href=\"/react/react-dom-client#createroot\">createRoot</a>\u3002</p>\n</div>\n<p>\u5f9e DOM \u79fb\u9664\u4e00\u500b mount React component \u4e26\u6e05\u9664\u5b83\u7684 event handler \u4ee5\u53ca state\u3002\u5982\u679c\u6c92\u6709 component \u88ab mount \u5728 container \u7684\u8a71\uff0c\u547c\u53eb\u9019\u500b function \u4e26\u4e0d\u6703\u505a\u4efb\u4f55\u4e8b\u3002\u5982\u679c\u4e00\u500b component \u88ab unmount \u56de\u50b3\u4e00\u500b <code class=\"language-javascript\">true</code>\uff0c\u53cd\u4e4b\u5982\u679c\u6c92\u6709 component \u88ab unmount\uff0c\u56de\u50b3 <code class=\"language-javascript\">false</code>\u3002</p>\n\n<h3 id=\"finddomnode\"><a class=\"anchor\" href=\"/react/react-dom#finddomnode\"></a><code class=\"language-javascript\">findDOMNode()</code> </h3>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">findDOMNode</code> \u662f\u4e00\u500b\u7528\u4f86\u5b58\u53d6\u5e95\u5c64 DOM node \u61c9\u6025\u7684\u505a\u6cd5\u3002\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u4e0d\u9f13\u52f5\u4f7f\u7528\u9019\u500b\u61c9\u6025\u7684\u505a\u6cd5\u56e0\u70ba\u5b83\u6703\u7a7f\u900f component \u62bd\u8c61\u5316\u3002<a href=\"/react/strict-mode#warning-about-deprecated-finddomnode-usage\">\u5b83\u5df2\u7d93\u5728 <code class=\"language-javascript\">StrictMode</code> \u4e2d\u88ab\u68c4\u7528\u4e86\u3002</a></p>\n</div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">findDOMNode</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c\u9019\u500b component \u5df2\u7d93\u88ab mount \u5230 DOM\uff0c\u5247\u56de\u50b3\u5c0d\u61c9\u539f\u751f\u700f\u89bd\u5668\u7684 DOM element\u3002\u9019\u500b\u65b9\u6cd5\u5c0d\u65bc\u5f9e DOM \u4e2d\u8b80\u53d6\u503c\u662f\u6709\u7528\u7684\uff0c\u50cf\u662f\u8868\u55ae\u7684\u6b04\u4f4d\u503c\u548c\u57f7\u884c DOM \u7684\u6e2c\u91cf\u3002 <strong>\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u9644\u52a0\u4e00\u500b ref \u7d66 DOM node \u4f86\u907f\u514d\u4f7f\u7528 <code class=\"language-javascript\">findDOMNode</code>\u3002</strong></p>\n<p>\u7576\u4e00\u500b component render \u6210 <code class=\"language-javascript\">null</code> \u6216 <code class=\"language-javascript\">false</code> \u6642\uff0c <code class=\"language-javascript\">findDOMNode</code> \u56de\u50b3 <code class=\"language-javascript\">null</code>\u3002\u7576\u4e00\u500b component render \u6210\u5b57\u4e32\u6642\uff0c <code class=\"language-javascript\">findDOMNode</code> \u56de\u50b3\u4e00\u500b\u5305\u542b\u8a72\u503c\u7684\u6587\u5b57 DOM node\u3002\u5f9e React 16 \u958b\u59cb\uff0ccomponent \u53ef\u4ee5\u56de\u50b3\u5305\u542b\u5f88\u591a children \u7684 fragment\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b <code class=\"language-javascript\">findDOMNode</code> \u5c07\u6703\u56de\u50b3\u548c\u7b2c\u4e00\u500b\u975e\u7a7a\u7684\u5b50\u7bc0\u9ede\u76f8\u5c0d\u61c9\u7684 DOM node\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">findDOMNode</code> \u53ea\u5728\u5df2\u7d93 mount \u7684 component \u4e0a\u6709\u7528\uff08\u5373\u5df2\u653e\u7f6e\u5728 DOM \u4e2d\u7684 component\uff09\u3002 \u5982\u679c\u4f60\u5617\u8a66\u5728\u5c1a\u672a mount \u7684 component \u4e0a\u547c\u53eb\u5b83\uff08\u6bd4\u5982\u5728\u5c1a\u672a\u5efa\u7acb\u7684 component \u7684 <code class=\"language-javascript\">render()</code> \u4e2d\u8abf\u7528 <code class=\"language-javascript\">findDOMNode()</code>\uff09\uff0c\u5c07\u6703\u62cb\u51fa\u7570\u5e38\u3002</p>\n<p><code class=\"language-javascript\">findDOMNode</code> \u4e0d\u80fd\u88ab\u7528\u5728 function component\u3002</p>\n</div>\n</div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-react-dom.md\">Edit this page</a></p></div></article>", "path": "/react/react-dom", "nav": ["/react/react-component", "/react/react-dom-client"]}, {"key": "ReactDOMClient", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>The <code class=\"language-javascript\">react-dom/client</code> package provides client-specific methods used for initializing an app on the client. Most of your components should not need to use this module.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/client'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>If you use ES5 with npm, you can write:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ReactDOM <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dom/client'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/react-dom-client#overview\"></a>Overview </h2>\n<p>The following methods can be used in client environments:</p>\n<ul>\n<li><a href=\"/react/react-dom-client#createroot\"><code class=\"language-javascript\">createRoot()</code></a></li>\n<li><a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">hydrateRoot()</code></a></li>\n</ul>\n<h3 id=\"browser-support\"><a class=\"anchor\" href=\"/react/react-dom-client#browser-support\"></a>Browser Support </h3>\n<p>React supports all modern browsers, although <a href=\"/react/javascript-environment-requirements\">some polyfills are required</a> for older versions.</p>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>We do not support older browsers that don\u2019t support ES5 methods or microtasks such as Internet Explorer. You may find that your apps do work in older browsers if polyfills such as <a class=\"external-link\" href=\"https://github.com/es-shims/es5-shim\">es5-shim and es5-sham</a> are included in the page, but you\u2019re on your own if you choose to take this path.</p>\n</div>\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/react-dom-client#reference\"></a>Reference </h2>\n<h3 id=\"createroot\"><a class=\"anchor\" href=\"/react/react-dom-client#createroot\"></a><code class=\"language-javascript\">createRoot()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Create a React root for the supplied <code class=\"language-javascript\">container</code> and return the root. The root can be used to render a React element into the DOM with <code class=\"language-javascript\">render</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> <span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">createRoot</code> accepts two options:</p>\n<ul>\n<li><code class=\"language-javascript\">onRecoverableError</code>: optional callback called when React automatically recovers from errors.</li>\n<li><code class=\"language-javascript\">identifierPrefix</code>: optional prefix React uses for ids generated by <code class=\"language-javascript\">React.useId</code>. Useful to avoid conflicts when using multiple roots on the same page. Must be the same prefix used on the server.</li>\n</ul>\n<p>The root can also be unmounted with <code class=\"language-javascript\">unmount</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">root<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p><code class=\"language-javascript\">createRoot()</code> controls the contents of the container node you pass in. Any existing DOM elements inside are replaced when render is called. Later calls use React\u2019s DOM diffing algorithm for efficient updates.</p>\n<p><code class=\"language-javascript\">createRoot()</code> does not modify the container node (only modifies the children of the container). It may be possible to insert a component to an existing DOM node without overwriting the existing children.</p>\n<p>Using <code class=\"language-javascript\">createRoot()</code> to hydrate a server-rendered container is not supported. Use <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">hydrateRoot()</code></a> instead.</p>\n</div>\n\n<h3 id=\"hydrateroot\"><a class=\"anchor\" href=\"/react/react-dom-client#hydrateroot\"></a><code class=\"language-javascript\">hydrateRoot()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">hydrateRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Same as <a href=\"/react/react-dom-client#createroot\"><code class=\"language-javascript\">createRoot()</code></a>, but is used to hydrate a container whose HTML contents were rendered by <a href=\"/react/react-dom-server\"><code class=\"language-javascript\">ReactDOMServer</code></a>. React will attempt to attach event listeners to the existing markup.</p>\n<p><code class=\"language-javascript\">hydrateRoot</code> accepts two options:</p>\n<ul>\n<li><code class=\"language-javascript\">onRecoverableError</code>: optional callback called when React automatically recovers from errors.</li>\n<li><code class=\"language-javascript\">identifierPrefix</code>: optional prefix React uses for ids generated by <code class=\"language-javascript\">React.useId</code>. Useful to avoid conflicts when using multiple roots on the same page. Must be the same prefix used on the server.</li>\n</ul>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>React expects that the rendered content is identical between the server and the client. It can patch up differences in text content, but you should treat mismatches as bugs and fix them. In development mode, React warns about mismatches during hydration. There are no guarantees that attribute differences will be patched up in case of mismatches. This is important for performance reasons because in most apps, mismatches are rare, and so validating all markup would be prohibitively expensive.</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-react-dom-client.md\">Edit this page</a></p></div></article>", "path": "/react/react-dom-client", "nav": ["/react/react-dom", "/react/react-dom-server"]}, {"key": "ReactDOMServer", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><code class=\"language-javascript\">ReactDOMServer</code> object \u4f7f\u4f60\u80fd\u5c07 component render \u81f3\u975c\u614b\u6a19\u8a18\u3002\u5b83\u901a\u5e38\u662f\u7528\u5728 Node \u4f3a\u670d\u5668\u4e0a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// ES modules</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> ReactDOMServer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/server'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// CommonJS</span>\n<span class=\"token keyword\">var</span> ReactDOMServer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dom/server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/react-dom-server#overview\"></a>\u6982\u89c0 </h2>\n<p>These methods are only available in the <strong>environments with <a class=\"external-link\" href=\"https://nodejs.dev/learn/nodejs-streams\">Node.js Streams</a>:</strong></p>\n<ul>\n<li><a href=\"/react/react-dom-server#rendertopipeablestream\"><code class=\"language-javascript\">renderToPipeableStream()</code></a></li>\n<li><a href=\"/react/react-dom-server#rendertonodestream\"><code class=\"language-javascript\">renderToNodeStream()</code></a> (Deprecated)</li>\n<li><a href=\"/react/react-dom-server#rendertostaticnodestream\"><code class=\"language-javascript\">renderToStaticNodeStream()</code></a></li>\n</ul>\n<p>These methods are only available in the <strong>environments with <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Streams_API\">Web Streams</a></strong> (this includes browsers, Deno, and some modern edge runtimes):</p>\n<ul>\n<li><a href=\"/react/react-dom-server#rendertoreadablestream\"><code class=\"language-javascript\">renderToReadableStream()</code></a></li>\n</ul>\n<p>The following methods can be used in the environments that don\u2019t support streams:</p>\n<ul>\n<li><a href=\"/react/react-dom-server#rendertostring\"><code class=\"language-javascript\">renderToString()</code></a></li>\n<li><a href=\"/react/react-dom-server#rendertostaticmarkup\"><code class=\"language-javascript\">renderToStaticMarkup()</code></a></li>\n</ul>\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/react-dom-server#reference\"></a>Reference </h2>\n<h3 id=\"rendertopipeablestream\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertopipeablestream\"></a><code class=\"language-javascript\">renderToPipeableStream()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToPipeableStream</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Render a React element to its initial HTML. Returns a stream with a <code class=\"language-javascript\">pipe(res)</code> method to pipe the output and <code class=\"language-javascript\">abort()</code> to abort the request. Fully supports Suspense and streaming of HTML with \u201cdelayed\u201d content blocks \u201cpopping in\u201d via inline <code class=\"language-javascript\">&lt;script&gt;</code> tags later. <a class=\"external-link\" href=\"https://github.com/reactwg/react-18/discussions/37\">Read more</a></p>\n<p>If you call <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a> on a node that already has this server-rendered markup, React will preserve it and only attach event handlers, allowing you to have a very performant first-load experience.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> didError <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> <span class=\"token function\">renderToPipeableStream</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">onShellReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// The content above all Suspense boundaries is ready.</span>\n      <span class=\"token comment\">// If something errored before we started streaming, we set the error code appropriately.</span>\n      res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> didError <span class=\"token operator\">?</span> <span class=\"token number\">500</span> <span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      stream<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onShellError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Something errored before we could complete the shell so we emit an alternative shell.</span>\n      res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">;</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">'&lt;!doctype html&gt;&lt;p&gt;Loading...&lt;/p&gt;&lt;script src=\"clientrender.js\"&gt;&lt;/script&gt;'</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onAllReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// If you don't want streaming, use this instead of onShellReady.</span>\n      <span class=\"token comment\">// This will fire after the entire page content is ready.</span>\n      <span class=\"token comment\">// You can use this for crawlers or static generation.</span>\n\n      <span class=\"token comment\">// res.statusCode = didError ? 500 : 200;</span>\n      <span class=\"token comment\">// res.setHeader('Content-type', 'text/html');</span>\n      <span class=\"token comment\">// stream.pipe(res);</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      didError <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>See the <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/14c2be8dac2d5482fda8a0906a31d239df8551fc/packages/react-dom/src/server/ReactDOMFizzServerNode.js#L36-L46\">full list of options</a>.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This is a Node.js-specific API. Environments with <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Streams_API\">Web Streams</a>, like Deno and modern edge runtimes, should use <a href=\"/react/react-dom-server#rendertoreadablestream\"><code class=\"language-javascript\">renderToReadableStream</code></a> instead.</p>\n</div>\n\n<h3 id=\"rendertoreadablestream\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertoreadablestream\"></a><code class=\"language-javascript\">renderToReadableStream()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToReadableStream</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Streams a React element to its initial HTML. Returns a Promise that resolves to a <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream\">Readable Stream</a>. Fully supports Suspense and streaming of HTML. <a class=\"external-link\" href=\"https://github.com/reactwg/react-18/discussions/127\">Read more</a></p>\n<p>If you call <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a> on a node that already has this server-rendered markup, React will preserve it and only attach event handlers, allowing you to have a very performant first-load experience.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> controller <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AbortController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> didError <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> stream <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">renderToReadableStream</span><span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Success</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">signal</span><span class=\"token operator\">:</span> controller<span class=\"token punctuation\">.</span>signal<span class=\"token punctuation\">,</span>\n      <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        didError <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// This is to wait for all Suspense boundaries to be ready. You can uncomment</span>\n  <span class=\"token comment\">// this line if you want to buffer the entire HTML instead of streaming it.</span>\n  <span class=\"token comment\">// You can use this for crawlers or static generation:</span>\n\n  <span class=\"token comment\">// await stream.allReady;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> didError <span class=\"token operator\">?</span> <span class=\"token number\">500</span> <span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'&lt;!doctype html&gt;&lt;p&gt;Loading...&lt;/p&gt;&lt;script src=\"clientrender.js\"&gt;&lt;/script&gt;'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>See the <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/14c2be8dac2d5482fda8a0906a31d239df8551fc/packages/react-dom/src/server/ReactDOMFizzServerBrowser.js#L27-L35\">full list of options</a>.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This API depends on <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Streams_API\">Web Streams</a>. For Node.js, use <a href=\"/react/react-dom-server#rendertopipeablestream\"><code class=\"language-javascript\">renderToPipeableStream</code></a> instead.</p>\n</div>\n\n<h3 id=\"rendertonodestream\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertonodestream\"></a><code class=\"language-javascript\">renderToNodeStream()</code>  (Deprecated) </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToNodeStream</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u500b\u65b9\u6cd5\u6703\u5c07\u4e00\u500b React element render \u81f3\u5176\u521d\u59cb\u7684 HTML\u3002\u5b83\u6703\u56de\u50b3\u4e00\u500b <a class=\"external-link\" href=\"https://nodejs.org/api/stream.html#stream_readable_streams\">Node.js Readable stream</a>\u4e26\u8f38\u51fa\u70ba\u4e00\u500b HTML string\u3002\u901a\u904e stream \u8f38\u51fa\u7684 HTML \u548c <a href=\"/react/react-dom-server#rendertostring\"><code class=\"language-javascript\">ReactDOMServer.renderToString</code></a> \u56de\u50b3\u7684 HTML \u5b8c\u5168\u76f8\u540c\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u65b9\u6cd5\u5728\u4f3a\u670d\u5668\u7aef\u7522\u751f HTML\uff0c\u4e26\u5728\u521d\u6b21\u8acb\u6c42\u6642\u50b3\u905e markup \uff0c\u4ee5\u52a0\u5feb\u9801\u9762\u8f09\u5165\u901f\u5ea6\uff0c\u4e26\u8b93\u641c\u5c0b\u5f15\u64ce\u722c\u53d6\u4f60\u7684\u9801\u9762\u4ee5\u9054\u5230 SEO \u6700\u4f73\u5316\u7684\u6548\u679c\u3002</p>\n<p>\u5982\u679c\u4f60\u5728\u4e00\u500b\u5df2\u7d93\u6709\u4f3a\u670d\u5668\u7aef render markup \u7684 node \u4e0a\u547c\u53eb <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a>\uff0cReact \u5c07\u6703\u4fdd\u7559\u9019\u500b node \u4e26\u53ea\u9644\u4e0a\u4e8b\u4ef6\u8655\u7406\uff0c\u9019\u4f7f\u4f60\u80fd\u6709\u4e00\u500b\u9ad8\u6548\u80fd\u7684\u521d\u6b21\u8f09\u5165\u9ad4\u9a57\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b API \u53ea\u5728\u4f3a\u670d\u5668\u7aef\u6709\u7528\u3002\u4f60\u7121\u6cd5\u5728\u700f\u89bd\u5668\u4e2d\u4f7f\u7528\u6b64 API\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u56de\u50b3\u7684 stream \u5c07\u6703\u56de\u50b3\u4e00\u500b\u7531 utf-8 \u7de8\u78bc\u7684 byte stream\u3002 \u5982\u679c\u4f60\u9700\u8981\u53e6\u4e00\u7a2e\u7de8\u78bc\u7684 stream\uff0c\u8acb\u53c3\u8003\u50cf\u662f <a class=\"external-link\" href=\"https://www.npmjs.com/package/iconv-lite\">iconv-lite</a> \u9019\u7a2e\u70ba\u8f49\u63db\u6587\u672c\u63d0\u4f9b\u8f49\u63db stream \u7684\u5c08\u6848\u3002</p>\n</div>\n\n<h3 id=\"rendertostaticnodestream\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertostaticnodestream\"></a><code class=\"language-javascript\">renderToStaticNodeStream()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToStaticNodeStream</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u9019\u500b\u65b9\u6cd5\u548c <a href=\"/react/react-dom-server#rendertonodestream\"><code class=\"language-javascript\">renderToNodeStream</code></a> \u5f88\u76f8\u4f3c\uff0c\u4e0d\u904e\u9019\u500b\u65b9\u6cd5\u4e0d\u6703\u5efa\u7acb\u90a3\u4e9b\u984d\u5916 React \u5167\u90e8\u4f7f\u7528\u7684 DOM attribute\uff0c\u50cf\u662f <code class=\"language-javascript\">data-reactroot</code>\u3002\u9019\u500b\u65b9\u6cd5\u5728\u4f60\u60f3\u8981\u7528 React \u4f5c\u70ba\u4e00\u500b\u7c21\u55ae\u7684\u975c\u614b\u9801\u9762\u751f\u6210\u5668\u6642\u5f88\u6709\u7528\uff0c\u56e0\u70ba\u53bb\u9664\u4e00\u4e9b\u984d\u5916\u7684 attribute \u53ef\u4ee5\u7701\u53bb\u4e00\u4e9b\u4f4d\u5143\u7d44\u3002</p>\n<p>\u901a\u904e\u9019\u500b stream \u8f38\u51fa\u7684 HTML \u548c <a href=\"/react/react-dom-server#rendertostaticmarkup\"><code class=\"language-javascript\">ReactDOMServer.renderToStaticMarkup</code></a> \u56de\u50b3\u7684 HTML \u5b8c\u5168\u76f8\u540c\u3002</p>\n<p>\u5982\u679c\u4f60\u6253\u7b97\u5728\u524d\u7aef\u4f7f\u7528 React \u4ee5\u4f7f\u5f97 markup \u6709\u4e92\u52d5\u6027\u7684\u8a71\uff0c\u8acb\u4e0d\u8981\u4f7f\u7528\u9019\u500b\u65b9\u6cd5\u3002\u8acb\u5728\u4f3a\u670d\u5668\u7aef\u4f7f\u7528 <a href=\"/react/react-dom-server#rendertonodestream\"><code class=\"language-javascript\">renderToNodeStream</code></a> \u4e26\u5728\u524d\u7aef\u4f7f\u7528 <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u9019\u500b API \u53ea\u5728\u4f3a\u670d\u5668\u7aef\u4f7f\u7528\u3002\u4f60\u7121\u6cd5\u5728\u700f\u89bd\u5668\u4e2d\u4f7f\u7528\u6b64 API\u3002</p>\n<p>\u9019\u500b\u65b9\u6cd5\u56de\u50b3\u7684 stream \u5c07\u6703\u56de\u50b3\u4e00\u500b\u7531 utf-8 \u7de8\u78bc\u7684 byte stream\u3002 \u5982\u679c\u4f60\u9700\u8981\u53e6\u4e00\u7a2e\u7de8\u78bc\u7684 stream\uff0c\u8acb\u53c3\u8003\u50cf\u662f <a class=\"external-link\" href=\"https://www.npmjs.com/package/iconv-lite\">iconv-lite</a> \u9019\u7a2e\u70ba\u8f49\u63db\u6587\u672c\u63d0\u4f9b\u8f49\u63db stream \u7684\u5c08\u6848\u3002</p>\n</div>\n\n<h3 id=\"rendertostring\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertostring\"></a><code class=\"language-javascript\">renderToString()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Render a React element to its initial HTML. React will return an HTML string. You can use this method to generate HTML on the server and send the markup down on the initial request for faster page loads and to allow search engines to crawl your pages for SEO purposes.</p>\n<p>If you call <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a> on a node that already has this server-rendered markup, React will preserve it and only attach event handlers, allowing you to have a very performant first-load experience.</p>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p>This API has limited Suspense support and does not support streaming.</p>\n<p>On the server, it is recommended to use either <a href=\"/react/react-dom-server#rendertopipeablestream\"><code class=\"language-javascript\">renderToPipeableStream</code></a> (for Node.js) or <a href=\"/react/react-dom-server#rendertoreadablestream\"><code class=\"language-javascript\">renderToReadableStream</code></a> (for Web Streams) instead.</p>\n</div>\n\n<h3 id=\"rendertostaticmarkup\"><a class=\"anchor\" href=\"/react/react-dom-server#rendertostaticmarkup\"></a><code class=\"language-javascript\">renderToStaticMarkup()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToStaticMarkup</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Similar to <a href=\"/react/react-dom-server#rendertostring\"><code class=\"language-javascript\">renderToString</code></a>, except this doesn\u2019t create extra DOM attributes that React uses internally, such as <code class=\"language-javascript\">data-reactroot</code>. This is useful if you want to use React as a simple static page generator, as stripping away the extra attributes can save some bytes.</p>\n<p>If you plan to use React on the client to make the markup interactive, do not use this method. Instead, use <a href=\"/react/react-dom-server#rendertostring\"><code class=\"language-javascript\">renderToString</code></a> on the server and <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code></a> on the client.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-react-dom-server.md\">Edit this page</a></p></div></article>", "path": "/react/react-dom-server", "nav": ["/react/react-dom-client", "/react/dom-elements"]}, {"key": "DOM Element", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u70ba\u4e86\u80fd\u517c\u5177\u6548\u80fd\u8207\u8de8\u700f\u89bd\u5668\u7684\u517c\u5bb9\u6027\uff0cReact \u5be6\u4f5c\u4e86\u4e00\u5957\u7368\u7acb\u65bc\u700f\u89bd\u5668\u7684 DOM \u7cfb\u7d71\uff0c\u6211\u5011\u85c9\u7531\u9019\u500b\u6a5f\u6703\u89e3\u6c7a\u700f\u89bd\u5668 DOM \u7684\u7f8e\u4e2d\u4e0d\u8db3\u4e4b\u8655\u3002</p>\n<p>\u5728 React \u88e1\uff0c\u6240\u6709 DOM property \u548c attribute\uff08\u5305\u62ec event handler\uff09\u90fd\u61c9\u8a72\u4ee5 camelCase \u547d\u540d\u3002\u8209\u4f8b\u4f86\u8aaa\uff0cHTML \u7684 attribute <code class=\"language-javascript\">tabindex</code> \u5728 React \u4e2d\u5c0d\u61c9\u5230 <code class=\"language-javascript\">tabIndex</code>\u3002<code class=\"language-javascript\">aria-*</code> \u548c <code class=\"language-javascript\">data-*</code> attribute \u5247\u662f\u4f8b\u5916\uff0c\u9700\u8981\u4fdd\u6301\u5168\u90e8\u5c0f\u5beb\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c<code class=\"language-javascript\">aria-label</code> \u4fdd\u6301\u539f\u6a23\u5373\u53ef\u3002</p>\n<h2 id=\"differences-in-attributes\"><a class=\"anchor\" href=\"/react/dom-elements#differences-in-attributes\"></a>Attribute \u76f8\u7570\u4e4b\u8655 </h2>\n<p>\u6709\u4e9b attribute \u5728 React \u548c HTML \u4e4b\u9593\u904b\u4f5c\u7684\u65b9\u5f0f\u7565\u70ba\u4e0d\u540c\uff1a</p>\n<h3 id=\"checked\"><a class=\"anchor\" href=\"/react/dom-elements#checked\"></a>checked </h3>\n<p>\u7576 <code class=\"language-javascript\">&lt;input&gt;</code> \u7684 type \u662f <code class=\"language-javascript\">checkbox</code> \u6216\u662f <code class=\"language-javascript\">radio</code> \u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">checked</code> \u9019\u500b attribute \u4f86\u8a2d\u5b9a component \u662f\u5426\u88ab\u9078\u53d6\u3002\u9019\u5c0d\u5efa\u7acb controlled component \u5f88\u6709\u5e6b\u52a9\u3002<code class=\"language-javascript\">defaultChecked</code> \u5247\u662f\u4f7f\u7528\u5728 uncontrolled component\uff0c\u5728\u521d\u59cb mount \u8a2d\u5b9a component \b\u662f\u5426\u88ab\u9078\u53d6\u3002</p>\n<h3 id=\"classname\"><a class=\"anchor\" href=\"/react/dom-elements#classname\"></a>className </h3>\n<p>\u8981\u6307\u5b9a\u4e00\u500b CSS class \u6642\uff0c\u4f7f\u7528 <code class=\"language-javascript\">className</code> attribute\u3002\u9019\u5728\u6240\u6709\u6a19\u6e96\u7684 DOM \u548c SVG element \u50cf\u662f <code class=\"language-javascript\">&lt;div&gt;</code>\u3001<code class=\"language-javascript\">&lt;a&gt;</code> \u6216\u5176\u4ed6\u7684\u90fd\u80fd\u9069\u7528\u3002</p>\n<p>\u5982\u679c\u4f60\u5728 React \u88e1\u4f7f\u7528 Web Components\uff08\u9019\u4e0d\u662f\u5e38\u898b\u7684\u72c0\u6cc1\uff09\uff0c\u5247\u4f7f\u7528 <code class=\"language-javascript\">class</code>\u3002</p>\n<h3 id=\"dangerouslysetinnerhtml\"><a class=\"anchor\" href=\"/react/dom-elements#dangerouslysetinnerhtml\"></a>dangerouslySetInnerHTML </h3>\n<p><code class=\"language-javascript\">dangerouslySetInnerHTML</code> \u662f React \u7528\u4f86\u66ff\u4ee3 DOM \u7684 <code class=\"language-javascript\">innerHTML</code>\u3002\u666e\u904d\u4f86\u8aaa\uff0c\u5f9e\u7a0b\u5f0f\u78bc\u4e2d\u6ce8\u5165 HTML \u662f\u500b\u5192\u96aa\u7684\u884c\u70ba\uff0c\u4f60\u6703\u5f88\u8f15\u6613\u5730\u8b93\u4f7f\u7528\u8005\u66b4\u9732\u5728 <a class=\"external-link\" href=\"https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC\">cross-site scripting (XSS)</a> \u653b\u64ca\u98a8\u96aa\u4e4b\u4e0b\u3002\u6240\u4ee5\u5728 React \u88e1\u4f60\u9084\u662f\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165 HTML\uff0c\u4f46\u662f\u4f60\u5fc5\u9808\u4f7f\u7528 <code class=\"language-javascript\">dangerouslySetInnerHTML</code>\uff0c\u7136\u5f8c\u50b3\u5165\u4e00\u500b\u6709 <code class=\"language-javascript\">__html</code> \u70ba key \u7684 object\uff0c\u85c9\u6b64\u4f86\u63d0\u9192\u4f60\u81ea\u5df1\u9019\u6a23\u505a\u5177\u6709\u98a8\u96aa\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">createMarkup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> <span class=\"token string\">'First &amp;middot; Second'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">dangerouslySetInnerHTML</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">createMarkup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"htmlfor\"><a class=\"anchor\" href=\"/react/dom-elements#htmlfor\"></a>htmlFor </h3>\n<p>React element \u4f7f\u7528 <code class=\"language-javascript\">htmlFor</code> \u4f86\u66ff\u4ee3 <code class=\"language-javascript\">for</code>\uff0c\u56e0\u70ba <code class=\"language-javascript\">for</code> \u5728 JavaScript \u662f\u4fdd\u7559\u5b57\u3002</p>\n<h3 id=\"onchange\"><a class=\"anchor\" href=\"/react/dom-elements#onchange\"></a>onChange </h3>\n<p><code class=\"language-javascript\">onChange</code> event \u6703\u8868\u73fe\u7684\u8ddf\u4f60\u9810\u671f\u4e00\u6a23\uff1a\u6bcf\u7576\u8868\u683c\u6b04\u4f4d\u503c\u6539\u8b8a\uff0c\u9019\u500b event \u8ddf\u8457\u767c\u751f\u3002\u539f\u5148\u7684 <code class=\"language-javascript\">onChange</code> \u662f\u500b\u7528\u8a5e\u4e0d\u5920\u7cbe\u78ba\u7684\u884c\u70ba\uff0c\u4e14 React \u4f9d\u9760\u9019\u500b event \u4f86\u8655\u7406\u4f7f\u7528\u8005\u7684\u5373\u6642\u8f38\u5165\uff0c\u6240\u4ee5\u6211\u5011\u8868\u73fe\u51fa\u4e0d\u540c\u65bc\u700f\u89bd\u5668\u7684\u9810\u8a2d\u884c\u70ba\u3002</p>\n<h3 id=\"selected\"><a class=\"anchor\" href=\"/react/dom-elements#selected\"></a>selected </h3>\n<p>\u5982\u679c\u4f60\u60f3\u8981\u5c07 <code class=\"language-javascript\">&lt;option&gt;</code> \u6a19\u8a18\u6210\u5df2\u9078\u64c7\uff0c\u8acb\u5728 <code class=\"language-javascript\">&lt;select&gt;</code> \u7684 <code class=\"language-javascript\">value</code> \u4e2d\u5f15\u7528\u8a72\u9078\u9805\u7684\u503c\u3002\n\u66f4\u591a\u7d30\u7bc0\u8aaa\u660e\u8acb\u53c3\u8003<a href=\"/react/forms#the-select-tag\">\u300cThe select Tag\u300d</a>\u3002</p>\n<h3 id=\"style\"><a class=\"anchor\" href=\"/react/dom-elements#style\"></a>style </h3>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u70ba\u4e86\u65b9\u4fbf\u5728\u6587\u4ef6\u88e1\u67d0\u4e9b\u7bc4\u4f8b\u6703\u4f7f\u7528 <code class=\"language-javascript\">style</code>\uff0c\u4f46\u662f<strong>\u57fa\u672c\u4e0a\u4e0d\u63a8\u85a6\u4f7f\u7528 <code class=\"language-javascript\">style</code> attribute \u4f5c\u70ba\u521d\u6b65\u4fee\u98fe elements \u7684\u624b\u6bb5\u3002</strong>\u5728\u5927\u90e8\u5206\u7684\u60c5\u5f62\uff0c\u61c9\u8a72\u4f7f\u7528<a href=\"/react/dom-elements#classname\"><code class=\"language-javascript\">className</code></a> \u4f86\u5c0d\u61c9\u5b9a\u7fa9\u5728\u5916\u90e8 CSS stylesheet \u7684 class\u3002<code class=\"language-javascript\">style</code> \u901a\u5e38\u5728 React \u61c9\u7528\u4e2d\u6703\u88ab\u7528\u505a\u52d5\u614b style \u7684\u589e\u52a0\u65b9\u5f0f\u3002\u8acb\u53c3\u8003 <a href=\"/react/faq-styling\">FAQ: Styling and CSS</a>\u3002</p>\n</div>\n<p><code class=\"language-javascript\">style</code> attribute \u63a5\u6536\u4e00\u500b JavaScript object \u5167\u542b\u4ee5 camelCase \u547d\u540d\u7684 property\uff0c\u800c\u4e0d\u662f CSS string\u3002\u9019\u8207 DOM <code class=\"language-javascript\">style</code> JavaScript property \u4e00\u81f4\uff0c\u4f46\u6548\u7387\u66f4\u9ad8\uff0c\u4e26\u4e14\u53ef\u4ee5\u9632\u6b62 XSS \u5b89\u5168\u6f0f\u6d1e\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> divStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">backgroundImage</span><span class=\"token operator\">:</span> <span class=\"token string\">'url('</span> <span class=\"token operator\">+</span> imgUrl <span class=\"token operator\">+</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HelloWorldComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>divStyle<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello World!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f style \u4e0d\u6703\u81ea\u52d5\u52a0\u4e0a\u524d\u7db4\u3002\u70ba\u4e86\u8981\u652f\u63f4\u820a\u7684\u700f\u89bd\u5668\uff0c\u4f60\u5fc5\u9808\u81ea\u884c\u63d0\u4f9b\u76f8\u5c0d\u61c9\u7684 style property\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> divStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">WebkitTransition</span><span class=\"token operator\">:</span> <span class=\"token string\">'all'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// \u6ce8\u610f\u9019\u88e1\u662f\u5927\u5beb\u7684\u300cW\u300d</span>\n  <span class=\"token literal-property property\">msTransition</span><span class=\"token operator\">:</span> <span class=\"token string\">'all'</span> <span class=\"token comment\">// \u300cms\u300d\u662f\u552f\u4e00\u9700\u8981\u4f7f\u7528\u5c0f\u5beb\u958b\u982d\u7684\u700f\u89bd\u5668\u5f15\u64ce\u524d\u7db4</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ComponentWithTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>divStyle<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">This should work cross-browser</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u70ba\u4e86\u8207\u4f7f\u7528 JavaScript \u4f86\u5b58\u53d6 DOM node \u4e00\u81f4\uff0cstyle key \u4e5f\u4ee5 camelCase \u547d\u540d (e.g. <code class=\"language-javascript\">node.style.backgroundImage</code>)\u3002\u700f\u89bd\u5668\u5f15\u64ce\u524d\u7db4\u9664\u4e86 <a class=\"external-link\" href=\"https://www.andismith.com/blogs/2012/02/modernizr-prefixed/\"><code class=\"language-javascript\">ms</code></a> \u90fd\u61c9\u8a72\u4ee5\u4e00\u500b\u5927\u5beb\u5b57\u6bcd\u958b\u982d\u3002\u9019\u5c31\u662f <code class=\"language-javascript\">WebkitTransition</code> \u70ba\u4ec0\u9ebc\u6709\u4e00\u500b\u5927\u5beb\u300cW\u300d\u7684\u539f\u56e0\u3002</p>\n<p>React \u6703\u70ba\u67d0\u4e9b\u6578\u5b57\u578b\u614b\u7684 style property \u81ea\u52d5\u52a0\u4e0a\u300cpx\u300d\u3002\u5982\u679c\u4f60\u60f3\u8981\u4f7f\u7528\u5176\u4ed6\u55ae\u4f4d\uff0c\u4ee5 string \u7684\u5f62\u5f0f\u52a0\u4e0a\u55ae\u4f4d\u3002\u8209\u4f8b\u4f86\u8aaa\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u8f38\u51fa style: '10px'</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  Hello World!\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token comment\">// \u8f38\u51fa style: '10%'</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'10%'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  Hello World!\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u6ce8\u610f\u6240\u6709 style property \u90fd\u6703\u8f49\u63db\u6210 pixel string\u3002\u53ea\u6709\u67d0\u4e9b\u6703\u4fdd\u6301\u6c92\u6709\u55ae\u4f4d\uff0c\u5982 <code class=\"language-javascript\">zoom</code>\u3001<code class=\"language-javascript\">order</code>\u3001<code class=\"language-javascript\">flex</code>\u3002\u6c92\u6709\u55ae\u4f4d\u7684 property \u5b8c\u6574\u5217\u8868\u53ef\u4ee5\u5728<a class=\"external-link\" href=\"https://github.com/facebook/react/blob/4131af3e4bf52f3a003537ec95a1655147c81270/src/renderers/dom/shared/CSSProperty.js#L15-L59\">\u9019\u88e1</a>\u67e5\u770b\u3002</p>\n<h3 id=\"suppresscontenteditablewarning\"><a class=\"anchor\" href=\"/react/dom-elements#suppresscontenteditablewarning\"></a>suppressContentEditableWarning </h3>\n<p>\u901a\u5e38\u4f86\u8aaa\uff0c\u7576\u4e00\u500b element \u7684 children \u8a2d\u5b9a <code class=\"language-javascript\">contentEditable</code> \u6642\uff0c\u56e0\u70ba\u4e0d\u6703\u6709\u4f5c\u7528\uff0c\u6240\u4ee5\u6703\u6709\u8b66\u793a\u8a0a\u606f\u3002\u9019\u500b attribute \u6703\u6291\u5236\u8b66\u793a\u8a0a\u606f\u3002\u9664\u975e\u4f60\u5728\u5efa\u7acb\u4e00\u500b\u50cf\u662f <a class=\"external-link\" href=\"https://facebook.github.io/draft-js/\">Draft.js</a> \u7684 library\uff0c\u5426\u5247\u4e0d\u8981\u4f7f\u7528\u5b83\u3002</p>\n<h3 id=\"suppresshydrationwarning\"><a class=\"anchor\" href=\"/react/dom-elements#suppresshydrationwarning\"></a>suppressHydrationWarning </h3>\n<p>\u5982\u679c\u4f60\u4f7f\u7528 server-side React render \u6642\uff0c\u901a\u5e38 server \u548c client render \u4e0d\u540c\u6642\uff0c\u6703\u6709\u4e00\u500b\u8b66\u793a\u8a0a\u606f\u3002\u7136\u800c\uff0c\u5728\u4e00\u4e9b\u5c11\u6578\u7684\u6848\u4f8b\uff0c\u5f88\u96e3\u53bb\u4fdd\u8b49 server \u548c client side \u6703\u5b8c\u5168\u7b26\u5408\u3002\u4f8b\u5982\uff0c\u50cf\u662f timestamp \u5c31\u7121\u6cd5\u5728 server \u548c client \u4fdd\u6301\u76f8\u540c\u3002</p>\n<p>\u5982\u679c\u4f60\u8a2d\u5b9a\u4e86 <code class=\"language-javascript\">suppressHydrationWarning</code> \u70ba <code class=\"language-javascript\">true</code>\uff0cattribute \u4ee5\u53ca element \u5167\u5bb9\u4e0d\u4e00\u6a23\u6642\uff0cReact \u5c31\u4e0d\u6703\u6709\u8b66\u793a\u8a0a\u606f\u3002\u9019\u53ea\u4f5c\u7528\u5728\u4e00\u5c64\u6df1\u5ea6\uff0c\u4e14\u9700\u8981\u6709\u8a08\u756b\u6027\u5730\u4f7f\u7528\uff0c\u8acb\u52ff\u6feb\u7528\u3002\u4f60\u53ef\u4ee5\u5728 <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">ReactDOM.hydrateRoot()</code> documentation</a> \u8b80\u5230\u66f4\u591a\u95dc\u65bc hydration\u3002</p>\n<h3 id=\"value\"><a class=\"anchor\" href=\"/react/dom-elements#value\"></a>value </h3>\n<p><code class=\"language-javascript\">value</code> attribute \u53ef\u4ee5\u4f7f\u7528\u5728 <code class=\"language-javascript\">&lt;input&gt;</code>\u3001<code class=\"language-javascript\">&lt;select&gt;</code>\b \u548c <code class=\"language-javascript\">&lt;textarea&gt;</code> component\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f86\u8a2d\u5b9a component value\u3002\u9019\u5c0d\u5efa\u7acb controlled component \u5f88\u6709\u5e6b\u52a9\u3002<code class=\"language-javascript\">defaultValue</code> \u5247\u662f\u4f7f\u7528\u5728 uncontrolled component\uff0c\u5728\u521d\u59cb mount \u5f8c\u8a2d\u5b9a component \u7684 value\u3002</p>\n<h2 id=\"all-supported-html-attributes\"><a class=\"anchor\" href=\"/react/dom-elements#all-supported-html-attributes\"></a>\u53ef\u4ee5\u4f7f\u7528\u7684 HTML Attribute </h2>\n<p>\u5728 React 16 \u4e2d\uff0c\u4efb\u4f55\u6a19\u6e96<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2017/09/08/dom-attributes-in-react-16.html\">\u6216\u662f\u81ea\u8a02\u7684</a> DOM attribute \u90fd\u53ef\u4ee5\u4f7f\u7528\u3002</p>\n<p>React \u70ba DOM \u63d0\u4f9b\u4e86\u4e00\u5957\u4ee5 JavaScript \u70ba\u4e2d\u5fc3\u7684 API\u3002\u56e0\u70ba React component \u901a\u5e38\u6703\u6709\u81ea\u8a02\u6216\u8ddf DOM \u76f8\u95dc\u7684 prop\uff0cReact \u4f7f\u7528\u50cf DOM API \u4e00\u6a23\u7684 <code class=\"language-javascript\">camelCase</code>\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">tabIndex</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>      <span class=\"token comment\">// \u5c31\u50cf node.tabIndex DOM API</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Button<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span> <span class=\"token comment\">// \u5c31\u50cf node.className DOM API</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">readOnly</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>  <span class=\"token comment\">// \u5c31\u50cf node.readOnly DOM API</span></code></pre></div>\n<p>\u9664\u4e86\u4e0a\u8ff0\u6587\u4ef6\u63d0\u5230\u7684\uff0c\u9019\u4e9b prop \u8ddf\u5c0d\u61c9\u7684 HTML attribute \u904b\u4f5c\u65b9\u5f0f\u4e00\u6a23\u3002</p>\n<p>React \u4e2d\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b DOM attribute\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">accept acceptCharset accessKey action allowFullScreen alt async autoComplete\nautoFocus autoPlay capture cellPadding cellSpacing challenge charSet checked\ncite classID className colSpan cols content contentEditable contextMenu controls\ncontrolsList coords crossOrigin data dateTime default defer dir disabled\ndownload draggable encType form formAction formEncType formMethod formNoValidate\nformTarget frameBorder headers height hidden high href hrefLang htmlFor\nhttpEquiv icon id inputMode integrity is keyParams keyType kind label lang list\nloop low manifest marginHeight marginWidth max maxLength media mediaGroup method\nmin minLength multiple muted name noValidate nonce open optimum pattern\nplaceholder poster preload profile radioGroup readOnly rel required reversed\nrole rowSpan rows sandbox scope scoped scrolling seamless selected shape size\nsizes span spellCheck src srcDoc srcLang srcSet start step style summary\ntabIndex target title type useMap value width wmode wrap</code></pre></div>\n<p>\u540c\u6a23\u5730\uff0c\u6240\u6709 SVG attribute \u90fd\u53ef\u4ee5\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">accentHeight accumulate additive alignmentBaseline allowReorder alphabetic\namplitude arabicForm ascent attributeName attributeType autoReverse azimuth\nbaseFrequency baseProfile baselineShift bbox begin bias by calcMode capHeight\nclip clipPath clipPathUnits clipRule colorInterpolation\ncolorInterpolationFilters colorProfile colorRendering contentScriptType\ncontentStyleType cursor cx cy d decelerate descent diffuseConstant direction\ndisplay divisor dominantBaseline dur dx dy edgeMode elevation enableBackground\nend exponent externalResourcesRequired fill fillOpacity fillRule filter\nfilterRes filterUnits floodColor floodOpacity focusable fontFamily fontSize\nfontSizeAdjust fontStretch fontStyle fontVariant fontWeight format from fx fy\ng1 g2 glyphName glyphOrientationHorizontal glyphOrientationVertical glyphRef\ngradientTransform gradientUnits hanging horizAdvX horizOriginX ideographic\nimageRendering in in2 intercept k k1 k2 k3 k4 kernelMatrix kernelUnitLength\nkerning keyPoints keySplines keyTimes lengthAdjust letterSpacing lightingColor\nlimitingConeAngle local markerEnd markerHeight markerMid markerStart\nmarkerUnits markerWidth mask maskContentUnits maskUnits mathematical mode\nnumOctaves offset opacity operator order orient orientation origin overflow\noverlinePosition overlineThickness paintOrder panose1 pathLength\npatternContentUnits patternTransform patternUnits pointerEvents points\npointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits\nr radius refX refY renderingIntent repeatCount repeatDur requiredExtensions\nrequiredFeatures restart result rotate rx ry scale seed shapeRendering slope\nspacing specularConstant specularExponent speed spreadMethod startOffset\nstdDeviation stemh stemv stitchTiles stopColor stopOpacity\nstrikethroughPosition strikethroughThickness string stroke strokeDasharray\nstrokeDashoffset strokeLinecap strokeLinejoin strokeMiterlimit strokeOpacity\nstrokeWidth surfaceScale systemLanguage tableValues targetX targetY textAnchor\ntextDecoration textLength textRendering to transform u1 u2 underlinePosition\nunderlineThickness unicode unicodeBidi unicodeRange unitsPerEm vAlphabetic\nvHanging vIdeographic vMathematical values vectorEffect version vertAdvY\nvertOriginX vertOriginY viewBox viewTarget visibility widths wordSpacing\nwritingMode x x1 x2 xChannelSelector xHeight xlinkActuate xlinkArcrole\nxlinkHref xlinkRole xlinkShow xlinkTitle xlinkType xmlns xmlnsXlink xmlBase\nxmlLang xmlSpace y y1 y2 yChannelSelector z zoomAndPan</code></pre></div>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u8a02\u7684 attribute\uff0c\u53ea\u8981\u5b83\u5011\u662f\u5b8c\u5168\u5c0f\u5beb\u7684\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-dom-elements.md\">Edit this page</a></p></div></article>", "path": "/react/dom-elements", "nav": ["/react/react-dom-server", "/react/events"]}, {"key": "SyntheticEvent", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u9019\u4efd\u53c3\u8003\u6307\u5357\u7d00\u9304\u4e86 <code class=\"language-javascript\">SyntheticEvent</code> \u9019\u500b\u5f62\u6210 React \u4e8b\u4ef6\u7cfb\u7d71\u7684 wrapper\u3002\u60f3\u4e86\u89e3\u66f4\u591a\uff0c\u8acb\u53c3\u8003<a href=\"/react/handling-events\">\u4e8b\u4ef6\u8655\u7406</a>\u3002</p>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/events#overview\"></a>\u6982\u89c0 </h2>\n<p>\u4f60\u7684 event handler \u5c07\u6703\u662f <code class=\"language-javascript\">SyntheticEvent</code> \u88ab\u50b3\u905e\u7684 instance\uff0c\u5b83\u662f\u4e00\u500b\u8de8\u700f\u89bd\u5668\u7684\u3001\u700f\u89bd\u5668\u539f\u751f\u4e8b\u4ef6\u7684 wrapper\u3002\u5b83\u548c\u700f\u89bd\u5668\u539f\u751f\u4e8b\u4ef6\u6709\u76f8\u540c\u7684\u4ecb\u9762\uff0c\u5305\u542b <code class=\"language-javascript\">stopPropagation()</code> \u548c <code class=\"language-javascript\">preventDefault()</code>\uff0c\u9664\u4e86\u539f\u751f\u4e8b\u4ef6\u5728\u6240\u6709\u7684\u700f\u89bd\u5668\u90fd\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u904b\u4f5c\u9019\u9ede\u4ee5\u5916\u3002</p>\n<p>\u5982\u679c\u4f60\u767c\u73fe\u56e0\u70ba\u67d0\u4e9b\u539f\u56e0\u4f60\u9700\u8981\u4f7f\u7528\u700f\u89bd\u5668\u7684\u5e95\u5c64\u4e8b\u4ef6\uff0c\u4f60\u53ea\u9700\u8981\u4f7f\u7528 <code class=\"language-javascript\">nativeEvent</code> \u9019\u500b attribute \u5373\u53ef\u3002Synthetic event \u4e0d\u540c\u65bc\u700f\u89bd\u5668\u7684 native event \u4e26\u4e0d\u6703\u76f4\u63a5 mapping\uff0c\u4f8b\u5982\u5728 <code class=\"language-javascript\">onMouseLeave</code> <code class=\"language-javascript\">event.nativeEvent</code> \u5c07\u6703\u6307\u5411\u5230 <code class=\"language-javascript\">mouseout</code> event\u3002\u7279\u5b9a mapping \u4e0d\u662f\u516c\u958b API \u7684\u4e00\u90e8\u5206\uff0c\u4e26\u4e14\u53ef\u4ee5\u96a8\u6642\u66f4\u6539\u3002\u6bcf\u500b <code class=\"language-javascript\">SyntheticEvent</code> object \u90fd\u6709\u4e0b\u5217\u7684 attribute\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">boolean bubbles\nboolean cancelable\nDOMEventTarget currentTarget\nboolean defaultPrevented\nnumber eventPhase\nboolean isTrusted\nDOMEvent nativeEvent\n<span class=\"token keyword\">void</span> <span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nboolean <span class=\"token function\">isDefaultPrevented</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nboolean <span class=\"token function\">isPropagationStopped</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">persist</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nDOMEventTarget target\nnumber timeStamp\nstring type</code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5f9e v17 \u958b\u59cb\uff0c<code class=\"language-javascript\">e.persist()</code> \u5c07\u4e0d\u6703\u518d\u6709\u4efb\u4f55\u4f5c\u7528\uff0c\u56e0\u70ba <code class=\"language-javascript\">SyntheticEvent</code> \u5df2\u4e0d\u518d\u88ab <a href=\"/react/legacy-event-pooling\">pool</a> \u4e86\u3002</p>\n</div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u622a\u81f3 v0.14 \u70ba\u6b62\uff0c\u5f9e event handler \u56de\u50b3 <code class=\"language-javascript\">false</code> \u4e26\u4e0d\u6703\u505c\u6b62\u4e8b\u4ef6\u5192\u6ce1\uff08event propagation\uff09\u3002\u56e0\u6b64\u4f60\u53ef\u4ee5\u8996\u60c5\u6cc1\u624b\u5beb\u89f8\u767c <code class=\"language-javascript\">e.stopPropagation()</code> \u6216 <code class=\"language-javascript\">e.preventDefault()</code>\u3002</p>\n</div>\n<h2 id=\"supported-events\"><a class=\"anchor\" href=\"/react/events#supported-events\"></a>\u652f\u63f4\u7684\u4e8b\u4ef6 </h2>\n<p>React \u5c07\u4e8b\u4ef6\u898f\u683c\u5316\uff0c\u5df2\u8b93\u5b83\u5011\u5728\u4e0d\u540c\u7684\u700f\u89bd\u5668\u4e2d\u6709\u3127\u81f4\u7684\u5c6c\u6027\u3002</p>\n<p>\u4ee5\u4e0b\u7684 event handler \u6703\u5728\u5192\u6ce1\u968e\u6bb5\u6642\u88ab\u4e00\u500b\u4e8b\u4ef6\u89f8\u767c\u3002\u5982\u679c\u4f60\u60f3\u8a3b\u518a\u6355\u7372\u968e\u6bb5\u7684 event handler\uff0c\u8acb\u5728\u4e8b\u4ef6\u540d\u7a31\u7684\u5f8c\u9762\u52a0\u4e0a <code class=\"language-javascript\">Capture</code>\u3002\u4f8b\u5982\uff0c\u5047\u8a2d\u4f60\u60f3\u5728\u6355\u7372\u968e\u6bb5\u6355\u6349 click \u4e8b\u4ef6\u7684\u8a71\uff0c\u4f60\u9700\u8981\u7528 <code class=\"language-javascript\">onClickCapture</code> \u800c\u4e0d\u662f <code class=\"language-javascript\">onClick</code>\uff1a</p>\n<ul>\n<li><a href=\"/react/events#clipboard-events\">Clipboard Events</a></li>\n<li><a href=\"/react/events#composition-events\">Composition Events</a></li>\n<li><a href=\"/react/events#keyboard-events\">Keyboard Events</a></li>\n<li><a href=\"/react/events#focus-events\">Focus Events</a></li>\n<li><a href=\"/react/events#form-events\">Form Events</a></li>\n<li><a href=\"/react/events#generic-events\">Generic Events</a></li>\n<li><a href=\"/react/events#mouse-events\">Mouse Events</a></li>\n<li><a href=\"/react/events#pointer-events\">Pointer Events</a></li>\n<li><a href=\"/react/events#selection-events\">Selection Events</a></li>\n<li><a href=\"/react/events#touch-events\">Touch Events</a></li>\n<li><a href=\"/react/events#ui-events\">UI Events</a></li>\n<li><a href=\"/react/events#wheel-events\">Wheel Events</a></li>\n<li><a href=\"/react/events#media-events\">Media Events</a></li>\n<li><a href=\"/react/events#image-events\">Image Events</a></li>\n<li><a href=\"/react/events#animation-events\">Animation Events</a></li>\n<li><a href=\"/react/events#transition-events\">Transition Events</a></li>\n<li><a href=\"/react/events#other-events\">Other Events</a></li>\n</ul>\n\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/events#reference\"></a>\u53c3\u8003 </h2>\n<h3 id=\"clipboard-events\"><a class=\"anchor\" href=\"/react/events#clipboard-events\"></a>\u526a\u8cbc\u677f\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onCopy onCut onPaste</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">DOMDataTransfer clipboardData</code></pre></div>\n\n<h3 id=\"composition-events\"><a class=\"anchor\" href=\"/react/events#composition-events\"></a>\u7d44\u5408\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onCompositionEnd onCompositionStart onCompositionUpdate</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">string data</code></pre></div>\n\n<h3 id=\"keyboard-events\"><a class=\"anchor\" href=\"/react/events#keyboard-events\"></a>\u9375\u76e4\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onKeyDown onKeyPress onKeyUp</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">boolean altKey\nnumber charCode\nboolean ctrlKey\nboolean <span class=\"token function\">getModifierState</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\nstring key\nnumber keyCode\nstring locale\nnumber location\nboolean metaKey\nboolean repeat\nboolean shiftKey\nnumber which</code></pre></div>\n<p><code class=\"language-javascript\">key</code> \u5c6c\u6027\u53ef\u4ee5\u63a5\u53d7 <a class=\"external-link\" href=\"https://www.w3.org/TR/uievents-key/#named-key-attribute-values\">DOM Level 3 Events spec</a> \u5167\u8a18\u9304\u7684\u4efb\u610f\u503c\u3002</p>\n\n<h3 id=\"focus-events\"><a class=\"anchor\" href=\"/react/events#focus-events\"></a>\u7126\u9ede\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onFocus onBlur</code></pre></div>\n<p>\u9019\u4e9b\u7126\u9ede\u4e8b\u4ef6\u5728 React DOM \u4e2d\u6240\u6709\u7684 element \u4e0a\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u4e0d\u9650\u65bc\u8868\u55ae element\u3002</p>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">DOMEventTarget relatedTarget</code></pre></div>\n<h4 id=\"onfocus\"><a class=\"anchor\" href=\"/react/events#onfocus\"></a>onFocus </h4>\n<p>\u7576 element\uff08\u6216\u662f element \u88e1\u9762\u7684 element\uff09\u53d7\u5230 focus \u6642\uff0c<code class=\"language-javascript\">onFocus</code> \u4e8b\u4ef6\u6703\u88ab\u547c\u53eb\u3002\u4f8b\u5982\uff0c\u4e0b\u65b9\u7684 <code class=\"language-javascript\">onFocus</code> \u4e8b\u4ef6\u6703\u5728\u7576\u4f7f\u7528\u8005\u9ede\u64ca\u4e00\u500b\u6587\u5b57\u8f38\u5165\u6642\u89f8\u767c\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n      <span class=\"token attr-name\">onFocus</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Focused on input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>onFocus is triggered when you click this input.<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"onblur\"><a class=\"anchor\" href=\"/react/events#onblur\"></a>onBlur </h4>\n<p>The <code class=\"language-javascript\">onBlur</code> event handler is called when focus has left the element (or left some element inside of it). For example, it\u2019s called when the user clicks outside of a focused text input.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n      <span class=\"token attr-name\">onBlur</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Triggered because this input lost focus'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>onBlur is triggered when you click this input and then you click outside of it.<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"detecting-focus-entering-and-leaving\"><a class=\"anchor\" href=\"/react/events#detecting-focus-entering-and-leaving\"></a>Detecting Focus Entering and Leaving </h4>\n<p>You can use the <code class=\"language-javascript\">currentTarget</code> and <code class=\"language-javascript\">relatedTarget</code> to differentiate if the focusing or blurring events originated from <em>outside</em> of the parent element. Here is a demo you can copy and paste that shows how to detect focusing a child, focusing the element itself, and focus entering or leaving the whole subtree.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n      <span class=\"token attr-name\">tabIndex</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">onFocus</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>currentTarget <span class=\"token operator\">===</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'focused self'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'focused child'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>relatedTarget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// Not triggered when swapping focus between children</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'focus entered self'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">onBlur</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>currentTarget <span class=\"token operator\">===</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'unfocused self'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'unfocused child'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>relatedTarget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// Not triggered when swapping focus between children</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'focus left self'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n    <span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<h3 id=\"form-events\"><a class=\"anchor\" href=\"/react/events#form-events\"></a>\u8868\u55ae\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onChange onInput onInvalid onReset onSubmit</code></pre></div>\n<p>\u60f3\u4e86\u89e3\u95dc\u65bc onChange \u4e8b\u4ef6\u7684\u8cc7\u8a0a\uff0c\u8acb\u53c3\u8003<a href=\"/react/forms\">\u8868\u55ae</a>\u3002</p>\n\n<h3 id=\"generic-events\"><a class=\"anchor\" href=\"/react/events#generic-events\"></a>Generic \u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onError onLoad</code></pre></div>\n\n<h3 id=\"mouse-events\"><a class=\"anchor\" href=\"/react/events#mouse-events\"></a>\u6ed1\u9f20\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onClick onContextMenu onDoubleClick onDrag onDragEnd onDragEnter onDragExit\nonDragLeave onDragOver onDragStart onDrop onMouseDown onMouseEnter onMouseLeave\nonMouseMove onMouseOut onMouseOver onMouseUp</code></pre></div>\n<p><code class=\"language-javascript\">onMouseEnter</code> \u548c <code class=\"language-javascript\">onMouseLeave</code> \u4e8b\u4ef6\u5f9e\u96e2\u958b\u7684 element \u5411\u6b63\u5728\u9032\u5165\u7684 element \u50b3\u64ad\uff0c\u800c\u4e0d\u662f\u6b63\u5e38\u7684\u5192\u6ce1\uff0c\u4e5f\u6c92\u6709\u6355\u7372\u968e\u6bb5\u3002</p>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">boolean altKey\nnumber button\nnumber buttons\nnumber clientX\nnumber clientY\nboolean ctrlKey\nboolean <span class=\"token function\">getModifierState</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\nboolean metaKey\nnumber pageX\nnumber pageY\nDOMEventTarget relatedTarget\nnumber screenX\nnumber screenY\nboolean shiftKey</code></pre></div>\n\n<h3 id=\"pointer-events\"><a class=\"anchor\" href=\"/react/events#pointer-events\"></a>\u6307\u6a19\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onPointerDown onPointerMove onPointerUp onPointerCancel onGotPointerCapture\nonLostPointerCapture onPointerEnter onPointerLeave onPointerOver onPointerOut</code></pre></div>\n<p><code class=\"language-javascript\">onPointerEnter</code> \u548c <code class=\"language-javascript\">onPointerLeave</code> \u4e8b\u4ef6\u5f9e\u96e2\u958b\u7684 element \u5411\u6b63\u5728\u9032\u5165\u7684 element \u50b3\u64ad\uff0c\u800c\u4e0d\u662f\u6b63\u5e38\u7684\u5192\u6ce1\uff0c\u4e5f\u6c92\u6709\u6355\u7372\u968e\u6bb5\u3002</p>\n<p>\u5c6c\u6027\uff1a</p>\n<p>\u5982\u540c\u5728 <a class=\"external-link\" href=\"https://www.w3.org/TR/pointerevents/\">W3 spec</a> \u5167\u5b9a\u7fa9\u7684\uff0c\u6307\u6a19\u4e8b\u4ef6\u662f<a href=\"/react/events#mouse-events\">\u6ed1\u9f20\u4e8b\u4ef6</a>\u7684\u5ef6\u4f38\uff0c\u4e26\u5e36\u6709\u4ee5\u4e0b\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">number pointerId\nnumber width\nnumber height\nnumber pressure\nnumber tangentialPressure\nnumber tiltX\nnumber tiltY\nnumber twist\nstring pointerType\nboolean isPrimary</code></pre></div>\n<p>\u95dc\u65bc\u8de8\u700f\u89bd\u5668\u652f\u63f4\u7684\u8aaa\u660e\uff1a</p>\n<p>\u76ee\u524d\u70ba\u6b62\uff0c\u4e26\u975e\u6240\u6709\u7684\u700f\u89bd\u5668\u90fd\u652f\u63f4\u6307\u6a19\u4e8b\u4ef6\uff08\u5728\u9019\u7bc7\u6587\u7ae0\u64b0\u5beb\u7684\u6642\u5019\uff0c\u652f\u63f4\u8a72\u4e8b\u4ef6\u7684\u700f\u89bd\u5668\u6709\uff1aChrome\u3001Firefox\u3001Edge \u4ee5\u53ca Internet Explorer\uff09\u3002React \u523b\u610f\u4e0d\u901a\u904e polyfill \u7684\u65b9\u5f0f\u652f\u63f4\u5176\u4ed6\u700f\u89bd\u5668\uff0c\u56e0\u70ba\u7b26\u5408\u6a19\u6e96\u7684 polyfill \u6703\u660e\u986f\u5730\u589e\u52a0 <code class=\"language-javascript\">react-dom</code> \u7684 bundle \u5927\u5c0f\u3002</p>\n<p>\u5982\u679c\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u9700\u8981\u6307\u6a19\u4e8b\u4ef6\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u52a0\u4e0a\u7b2c\u4e09\u65b9\u7684\u6307\u91dd\u4e8b\u4ef6 polyfill\u3002</p>\n\n<h3 id=\"selection-events\"><a class=\"anchor\" href=\"/react/events#selection-events\"></a>\u9078\u64c7\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onSelect</code></pre></div>\n\n<h3 id=\"touch-events\"><a class=\"anchor\" href=\"/react/events#touch-events\"></a>\u89f8\u6478\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onTouchCancel onTouchEnd onTouchMove onTouchStart</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">boolean altKey\nDOMTouchList changedTouches\nboolean ctrlKey\nboolean <span class=\"token function\">getModifierState</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\nboolean metaKey\nboolean shiftKey\nDOMTouchList targetTouches\nDOMTouchList touches</code></pre></div>\n\n<h3 id=\"ui-events\"><a class=\"anchor\" href=\"/react/events#ui-events\"></a>UI \u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onScroll</code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5f9e React 17 \u958b\u59cb\uff0c<code class=\"language-javascript\">onScroll</code> \u4e8b\u4ef6\u5c31\u4e0d\u662f\u5192\u6ce1\u4e86\uff0c\u9019\u8207\u700f\u89bd\u5668\u7684\u884c\u70ba\u76f8\u7b26\uff0c\u4e26\u4e14\u907f\u514d\u4e86\u7576\u5de2\u72c0\u6efe\u52d5\u5143\u4ef6\u89f8\u767c\u4e8b\u4ef6\u6642\uff0c\u5728\u9060\u8655 parent \u5143\u4ef6\u4e0a\u7684\u6df7\u4e82\u73fe\u8c61\u3002</p>\n</div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">number detail\nDOMAbstractView view</code></pre></div>\n\n<h3 id=\"wheel-events\"><a class=\"anchor\" href=\"/react/events#wheel-events\"></a>\u6efe\u8f2a\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onWheel</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">number deltaMode\nnumber deltaX\nnumber deltaY\nnumber deltaZ</code></pre></div>\n\n<h3 id=\"media-events\"><a class=\"anchor\" href=\"/react/events#media-events\"></a>\u5a92\u9ad4\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onAbort onCanPlay onCanPlayThrough onDurationChange onEmptied onEncrypted\nonEnded onError onLoadedData onLoadedMetadata onLoadStart onPause onPlay\nonPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend\nonTimeUpdate onVolumeChange onWaiting</code></pre></div>\n\n<h3 id=\"image-events\"><a class=\"anchor\" href=\"/react/events#image-events\"></a>\u5716\u7247\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onLoad onError</code></pre></div>\n\n<h3 id=\"animation-events\"><a class=\"anchor\" href=\"/react/events#animation-events\"></a>\u52d5\u756b\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onAnimationStart onAnimationEnd onAnimationIteration</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">string animationName\nstring pseudoElement\nfloat elapsedTime</code></pre></div>\n\n<h3 id=\"transition-events\"><a class=\"anchor\" href=\"/react/events#transition-events\"></a>\u904e\u6e21\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onTransitionEnd</code></pre></div>\n<p>\u5c6c\u6027\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">string propertyName\nstring pseudoElement\nfloat elapsedTime</code></pre></div>\n\n<h3 id=\"other-events\"><a class=\"anchor\" href=\"/react/events#other-events\"></a>\u5176\u4ed6\u4e8b\u4ef6 </h3>\n<p>\u4e8b\u4ef6\u540d\u7a31\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">onToggle</code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-events.md\">Edit this page</a></p></div></article>", "path": "/react/events", "nav": ["/react/dom-elements", "/react/test-utils"]}, {"key": "\u6e2c\u8a66\u5de5\u5177", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><strong>\u5982\u4f55 Import</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> ReactTestUtils <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/test-utils'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ES6</span>\n<span class=\"token keyword\">var</span> ReactTestUtils <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dom/test-utils'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ES5 with npm</span></code></pre></div>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/test-utils#overview\"></a>\u6982\u89c0 </h2>\n<p><code class=\"language-javascript\">ReactTestUtils</code> \u4f7f\u4f60\u53ef\u4ee5\u8f15\u9b06\u5728\u4f60\u9078\u64c7\u7684\u6e2c\u8a66\u6846\u67b6\u4e2d\u6e2c\u8a66 React component\u3002\u5728 Facebook\uff0c\u6211\u5011\u4f7f\u7528 <a class=\"external-link\" href=\"https://facebook.github.io/jest/\">Jest</a> \u4ee5\u65b9\u4fbf\u5730\u9032\u884c JavaScript \u6e2c\u8a66\u3002\u4f60\u53ef\u4ee5\u5f9e Jest \u7db2\u7ad9\u7684 <a class=\"external-link\" href=\"https://jestjs.io/docs/tutorial-react\">React \u6559\u5b78</a>\u5b78\u7fd2\u5982\u4f55\u4f7f\u7528 Jest\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n</div>\n<div class=\"blockquote\">\n<strong>\u6211\u5011\u63a8\u85a6\u4f7f\u7528 React Testing Library\uff0c\u5b83\u4fc3\u4f7f\u4f60\u5beb\u51fa\u7684\u6e2c\u8a66\u80fd\u50cf\u4f7f\u7528\u8005\u4e00\u6a23\u5730\u4f7f\u7528 component\u3002</strong>\n<p>\u5c0d\u65bc React &lt;= 16 \u7684\u7248\u672c\uff0c<a class=\"external-link\" href=\"https://airbnb.io/enzyme/\">Enzyme</a> \u7684\u6e2c\u8a66\u5de5\u5177\uff0c\u8b93\u4f60\u80fd\u8f15\u6613 assert\u3001\u64cd\u4f5c\u53ca\u904d\u6b77 React component \u7684\u8f38\u51fa\u3002</p>\n</div>\n<ul>\n<li><a href=\"/react/test-utils#act\"><code class=\"language-javascript\">act()</code></a></li>\n<li><a href=\"/react/test-utils#mockcomponent\"><code class=\"language-javascript\">mockComponent()</code></a></li>\n<li><a href=\"/react/test-utils#iselement\"><code class=\"language-javascript\">isElement()</code></a></li>\n<li><a href=\"/react/test-utils#iselementoftype\"><code class=\"language-javascript\">isElementOfType()</code></a></li>\n<li><a href=\"/react/test-utils#isdomcomponent\"><code class=\"language-javascript\">isDOMComponent()</code></a></li>\n<li><a href=\"/react/test-utils#iscompositecomponent\"><code class=\"language-javascript\">isCompositeComponent()</code></a></li>\n<li><a href=\"/react/test-utils#iscompositecomponentwithtype\"><code class=\"language-javascript\">isCompositeComponentWithType()</code></a></li>\n<li><a href=\"/react/test-utils#findallinrenderedtree\"><code class=\"language-javascript\">findAllInRenderedTree()</code></a></li>\n<li><a href=\"/react/test-utils#scryrendereddomcomponentswithclass\"><code class=\"language-javascript\">scryRenderedDOMComponentsWithClass()</code></a></li>\n<li><a href=\"/react/test-utils#findrendereddomcomponentwithclass\"><code class=\"language-javascript\">findRenderedDOMComponentWithClass()</code></a></li>\n<li><a href=\"/react/test-utils#scryrendereddomcomponentswithtag\"><code class=\"language-javascript\">scryRenderedDOMComponentsWithTag()</code></a></li>\n<li><a href=\"/react/test-utils#findrendereddomcomponentwithtag\"><code class=\"language-javascript\">findRenderedDOMComponentWithTag()</code></a></li>\n<li><a href=\"/react/test-utils#scryrenderedcomponentswithtype\"><code class=\"language-javascript\">scryRenderedComponentsWithType()</code></a></li>\n<li><a href=\"/react/test-utils#findrenderedcomponentwithtype\"><code class=\"language-javascript\">findRenderedComponentWithType()</code></a></li>\n<li><a href=\"/react/test-utils#renderintodocument\"><code class=\"language-javascript\">renderIntoDocument()</code></a></li>\n<li><a href=\"/react/test-utils#simulate\"><code class=\"language-javascript\">Simulate</code></a></li>\n</ul>\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/test-utils#reference\"></a>\u53c3\u8003\u8cc7\u6599 </h2>\n<h3 id=\"act\"><a class=\"anchor\" href=\"/react/test-utils#act\"></a><code class=\"language-javascript\">act()</code> </h3>\n<p>\u70ba\u4e86\u6e96\u5099\u8b93 component \u9032\u884c assert\uff0c\u5c07 render component \u53ca\u57f7\u884c\u66f4\u65b0\u7684\u7a0b\u5f0f\u78bc\u653e\u5728 <code class=\"language-javascript\">act()</code> \u4e2d\u3002\u9019\u8b93\u4f60\u7684\u6e2c\u8a66\u66f4\u8cbc\u8fd1 React \u5728\u700f\u89bd\u5668\u4e2d\u7684\u904b\u4f5c\u65b9\u5f0f\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5982\u679c\u4f60\u4f7f\u7528 <code class=\"language-javascript\">react-test-renderer</code>\uff0c\u5b83\u4e5f\u63d0\u4f9b\u884c\u70ba\u76f8\u540c\u7684 <code class=\"language-javascript\">act</code> function\u3002</p>\n</div>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u5047\u8a2d\u6211\u5011\u6709\u500b <code class=\"language-javascript\">Counter</code> component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          Click me\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u53ef\u4ee5\u9019\u6a23\u6e2c\u8a66\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/client'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/test-utils'</span><span class=\"token punctuation\">;</span></span><span class=\"token keyword\">import</span> Counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./Counter'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'can render and update a counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Test first render and componentDidMount</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Counter</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> label <span class=\"token operator\">=</span> container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'p'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 0 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 0 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Test second render and componentDidUpdate</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    button<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MouseEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">bubbles</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 1 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 1 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\u4e0d\u8981\u5fd8\u8a18\uff0c\u53ea\u6709\u5728 DOM container \u5df2\u52a0\u5230 <code class=\"language-javascript\">document</code> \u88e1\u9762\u6642\uff0c\u624d\u53ef\u4ee5 dispatch DOM event\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u5982 <a class=\"external-link\" href=\"https://github.com/kentcdodds/react-testing-library\"><code class=\"language-javascript\">react-testing-library</code></a> \u7684 helper \u4f86\u6e1b\u5c11 boilerplate \u7a0b\u5f0f\u78bc\u3002</li>\n<li><a href=\"/react/testing-recipes\"><code class=\"language-javascript\">recipes</code></a> \u8aaa\u660e\u6587\u4ef6\u5167\u5305\u542b\u4e86 <code class=\"language-javascript\">act()</code> \u7684\u8a73\u7d30\u8cc7\u8a0a\uff0c\u5305\u542b\u7bc4\u4f8b\u4ee5\u53ca\u7528\u6cd5\u3002</li>\n</ul>\n\n<h3 id=\"mockcomponent\"><a class=\"anchor\" href=\"/react/test-utils#mockcomponent\"></a><code class=\"language-javascript\">mockComponent()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">mockComponent</span><span class=\"token punctuation\">(</span>\n  componentClass<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>mockTagName<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u50b3\u905e\u4e00\u500b\u88ab mock \u7684 component module \u5230\u9019\u500b\u65b9\u6cd5\u5f8c\uff0c\u5b83\u6703\u589e\u52a0\u6709\u7528\u7684\u65b9\u6cd5\uff0c\u8b93\u5b83\u80fd\u505a\u70ba\u865b\u64ec\u7684 React component\u3002component \u4e0d\u6703\u50cf\u5e73\u5e38\u4e00\u6a23 render\uff0c\u5b83\u6703\u8b8a\u6210\u4e00\u500b\u7c21\u55ae\u7684 <code class=\"language-javascript\">&lt;div&gt;</code>\uff08\u6216\u5176\u4ed6\u6a19\u7c64\uff0c\u5982\u679c\u6709\u63d0\u4f9b <code class=\"language-javascript\">mockTagName</code>\uff09\uff0c\u5305\u542b\u4efb\u4f55\u63d0\u4f9b\u7684 children\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">mockComponent()</code> \u662f legacy API\u3002\u6211\u5011\u5efa\u8b70\u4ee5 <a class=\"external-link\" href=\"https://jestjs.io/docs/tutorial-react-native#mock-native-modules-using-jestmock\"><code class=\"language-javascript\">jest.mock()</code></a> \u4f5c\u70ba\u66ff\u4ee3\u3002</p>\n</div>\n\n<h3 id=\"iselement\"><a class=\"anchor\" href=\"/react/test-utils#iselement\"></a><code class=\"language-javascript\">isElement()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">isElement</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">element</code> \u662f React element \u7684\u8a71\u5c31\u56de\u50b3 <code class=\"language-javascript\">true</code>\u3002</p>\n\n<h3 id=\"iselementoftype\"><a class=\"anchor\" href=\"/react/test-utils#iselementoftype\"></a><code class=\"language-javascript\">isElementOfType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">isElementOfType</span><span class=\"token punctuation\">(</span>\n  element<span class=\"token punctuation\">,</span>\n  componentClass\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">element</code> \u662f type \u70ba <code class=\"language-javascript\">componentClass</code> \u7684 React element \u5c31\u56de\u50b3 <code class=\"language-javascript\">true</code>\u3002</p>\n\n<h3 id=\"isdomcomponent\"><a class=\"anchor\" href=\"/react/test-utils#isdomcomponent\"></a><code class=\"language-javascript\">isDOMComponent()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">isDOMComponent</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">instance</code> \u662f DOM component\uff08\u5982 <code class=\"language-javascript\">&lt;div&gt;</code> \u6216 <code class=\"language-javascript\">&lt;span&gt;</code>\uff09\u5c31\u56de\u50b3 <code class=\"language-javascript\">true</code>\u3002</p>\n\n<h3 id=\"iscompositecomponent\"><a class=\"anchor\" href=\"/react/test-utils#iscompositecomponent\"></a><code class=\"language-javascript\">isCompositeComponent()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">isCompositeComponent</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">instance</code> \u662f\u4f7f\u7528\u8005\u5b9a\u7fa9\u7684 component\uff0c\u4f8b\u5982 class \u6216 function\uff0c\u5c31\u56de\u50b3 <code class=\"language-javascript\">true</code>\u3002</p>\n\n<h3 id=\"iscompositecomponentwithtype\"><a class=\"anchor\" href=\"/react/test-utils#iscompositecomponentwithtype\"></a><code class=\"language-javascript\">isCompositeComponentWithType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">isCompositeComponentWithType</span><span class=\"token punctuation\">(</span>\n  instance<span class=\"token punctuation\">,</span>\n  componentClass\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c <code class=\"language-javascript\">instance</code> \u662f type \u70ba <code class=\"language-javascript\">componentClass</code> \u7684 component \u5c31\u56de\u50b3 <code class=\"language-javascript\">true</code>\u3002</p>\n\n<h3 id=\"findallinrenderedtree\"><a class=\"anchor\" href=\"/react/test-utils#findallinrenderedtree\"></a><code class=\"language-javascript\">findAllInRenderedTree()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">findAllInRenderedTree</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  test\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u904d\u6b77 <code class=\"language-javascript\">tree</code> \u4e2d\u7684\u6240\u6709 component\uff0c\u4e26\u6536\u96c6 <code class=\"language-javascript\">test(component)</code> \u70ba <code class=\"language-javascript\">true</code> \u7684\u6240\u6709 component\u3002\u9019\u500b\u65b9\u6cd5\u672c\u8eab\u4e0d\u662f\u90a3\u9ebc\u597d\u7528\uff0c\u4f46\u662f\u5b83\u88ab\u5176\u4ed6\u6e2c\u8a66\u5de5\u5177\u505a\u70ba\u57fa\u790e\u4f7f\u7528\u3002</p>\n\n<h3 id=\"scryrendereddomcomponentswithclass\"><a class=\"anchor\" href=\"/react/test-utils#scryrendereddomcomponentswithclass\"></a><code class=\"language-javascript\">scryRenderedDOMComponentsWithClass()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">scryRenderedDOMComponentsWithClass</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  className\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5728\u5df2\u7d93\u88ab render \u7684 tree \u4e2d\u5c0b\u627e\u6240\u6709 DOM element\uff0c\u56de\u50b3 class \u540d\u7a31\u7b26\u5408 <code class=\"language-javascript\">className</code> \u7684 DOM component\u3002</p>\n\n<h3 id=\"findrendereddomcomponentwithclass\"><a class=\"anchor\" href=\"/react/test-utils#findrendereddomcomponentwithclass\"></a><code class=\"language-javascript\">findRenderedDOMComponentWithClass()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">findRenderedDOMComponentWithClass</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  className\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u8207 <a href=\"/react/test-utils#scryrendereddomcomponentswithclass\"><code class=\"language-javascript\">scryRenderedDOMComponentsWithClass()</code></a> \u76f8\u4f3c\uff0c\u4e0d\u904e\u9810\u671f\u53ea\u6709\u4e00\u500b\u7d50\u679c\u3002\u5982\u679c\u7b26\u5408\u9810\u671f\u5247\u56de\u50b3\u90a3\u500b\u7d50\u679c\uff0c\u5426\u5247\u62cb\u51fa\u4f8b\u5916\u3002</p>\n\n<h3 id=\"scryrendereddomcomponentswithtag\"><a class=\"anchor\" href=\"/react/test-utils#scryrendereddomcomponentswithtag\"></a><code class=\"language-javascript\">scryRenderedDOMComponentsWithTag()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">scryRenderedDOMComponentsWithTag</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  tagName\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5728\u5df2\u7d93\u88ab render \u7684 tree \u4e2d\u5c0b\u627e\u6240\u6709 DOM element\uff0c\u56de\u50b3 tag \u540d\u7a31\u7b26\u5408 <code class=\"language-javascript\">tagName</code> \u7684 DOM component\u3002</p>\n\n<h3 id=\"findrendereddomcomponentwithtag\"><a class=\"anchor\" href=\"/react/test-utils#findrendereddomcomponentwithtag\"></a><code class=\"language-javascript\">findRenderedDOMComponentWithTag()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">findRenderedDOMComponentWithTag</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  tagName\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u8207 <a href=\"/react/test-utils#scryrendereddomcomponentswithtag\"><code class=\"language-javascript\">scryRenderedDOMComponentsWithTag()</code></a> \u76f8\u4f3c\uff0c\u4e0d\u904e\u9810\u671f\u53ea\u6709\u4e00\u500b\u7d50\u679c\u3002\u5982\u679c\u7b26\u5408\u9810\u671f\u5247\u56de\u50b3\u90a3\u500b\u7d50\u679c\uff0c\u5426\u5247\u62cb\u51fa\u4f8b\u5916\u3002</p>\n\n<h3 id=\"scryrenderedcomponentswithtype\"><a class=\"anchor\" href=\"/react/test-utils#scryrenderedcomponentswithtype\"></a><code class=\"language-javascript\">scryRenderedComponentsWithType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">scryRenderedComponentsWithType</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  componentClass\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5c0b\u627e\u6240\u6709 component type \u8207 <code class=\"language-javascript\">componentClass</code> \u76f8\u540c\u7684 instance\u3002</p>\n\n<h3 id=\"findrenderedcomponentwithtype\"><a class=\"anchor\" href=\"/react/test-utils#findrenderedcomponentwithtype\"></a><code class=\"language-javascript\">findRenderedComponentWithType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">findRenderedComponentWithType</span><span class=\"token punctuation\">(</span>\n  tree<span class=\"token punctuation\">,</span>\n  componentClass\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u8207 <a href=\"/react/test-utils#scryrenderedcomponentswithtype\"><code class=\"language-javascript\">scryRenderedComponentsWithType()</code></a> \u76f8\u4f3c\uff0c\u4e0d\u904e\u9810\u671f\u53ea\u6709\u4e00\u500b\u7d50\u679c\u3002\u5982\u679c\u7b26\u5408\u9810\u671f\u5247\u56de\u50b3\u90a3\u500b\u7d50\u679c\uff0c\u5426\u5247\u62cb\u51fa\u4f8b\u5916\u3002</p>\n\n<h3 id=\"renderintodocument\"><a class=\"anchor\" href=\"/react/test-utils#renderintodocument\"></a><code class=\"language-javascript\">renderIntoDocument()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">renderIntoDocument</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Render React element \u5230 document \u4e2d\u7368\u7acb\u7684 DOM node \u88e1\u3002<strong>\u9019\u500b function \u9700\u8981 DOM\u3002</strong>\u5b83\u7b49\u6548\u65bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> domContainer <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>domContainer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u5728 import <code class=\"language-javascript\">React</code> <strong>\u524d</strong>\uff0c\u4f60\u9700\u8981\u8b93 <code class=\"language-javascript\">window</code>\u3001<code class=\"language-javascript\">window.document</code> \u548c <code class=\"language-javascript\">window.document.createElement</code> \u5728\u5168\u57df\u53ef\u4ee5\u4f7f\u7528\u3002\u5426\u5247 React \u6703\u8a8d\u70ba\u5b83\u7121\u6cd5\u5b58\u53d6 DOM\uff0c\u50cf <code class=\"language-javascript\">setState</code> \u4e4b\u985e\u7684\u65b9\u6cd5\u4e5f\u5c07\u7121\u6cd5\u904b\u4f5c\u3002</p>\n</div>\n\n<h2 id=\"other-utilities\"><a class=\"anchor\" href=\"/react/test-utils#other-utilities\"></a>\u5176\u4ed6\u5de5\u5177 </h2>\n<h3 id=\"simulate\"><a class=\"anchor\" href=\"/react/test-utils#simulate\"></a><code class=\"language-javascript\">Simulate</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">Simulate<span class=\"token punctuation\">.</span><span class=\"token punctuation\">{</span>eventName<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span>\n  element<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>eventData<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5728 DOM node \u4e0a\u7528\u53ef\u9078\u7684 <code class=\"language-javascript\">eventData</code> \u4e8b\u4ef6\u8cc7\u6599\u6a21\u64ec event dispatch\u3002</p>\n<p><a href=\"/react/events#supported-events\">\u6bcf\u4e00\u500b React \u652f\u63f4\u7684\u4e8b\u4ef6</a>\u5728 <code class=\"language-javascript\">Simulate</code> \u90fd\u6709\u5c0d\u61c9\u7684\u65b9\u6cd5\u3002</p>\n<p><strong>\u9ede\u64ca element</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// &lt;button ref={(node) =&gt; this.button = node}&gt;...&lt;/button&gt;</span>\n<span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>button<span class=\"token punctuation\">;</span>\nReactTestUtils<span class=\"token punctuation\">.</span>Simulate<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>\u66f4\u6539\u8f38\u5165\u6b04\u4f4d\u7684\u503c\uff0c\u7136\u5f8c\u6309 ENTER \u9375\u3002</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// &lt;input ref={(node) =&gt; this.textInput = node} /&gt;</span>\n<span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>textInput<span class=\"token punctuation\">;</span>\nnode<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">'giraffe'</span><span class=\"token punctuation\">;</span>\nReactTestUtils<span class=\"token punctuation\">.</span>Simulate<span class=\"token punctuation\">.</span><span class=\"token function\">change</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nReactTestUtils<span class=\"token punctuation\">.</span>Simulate<span class=\"token punctuation\">.</span><span class=\"token function\">keyDown</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Enter\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">keyCode</span><span class=\"token operator\">:</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">which</span><span class=\"token operator\">:</span> <span class=\"token number\">13</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>\u4f60\u9700\u8981\u63d0\u4f9b\u6240\u6709\u5728\u4f60\u7684 component \u4e2d\u6709\u4f7f\u7528\u7684\u4e8b\u4ef6\u5c6c\u6027\uff08\u5982 keyCode\u3001which \u7b49\u7b49\uff09\uff0c\u56e0\u70ba React \u4e0d\u6703\u70ba\u4f60\u5efa\u7acb\u9019\u4e9b\u6771\u897f\u3002</p>\n</div>\n</div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/addons-test-utils.md\">Edit this page</a></p></div></article>", "path": "/react/test-utils", "nav": ["/react/events", "/react/test-renderer"]}, {"key": "Test Renderer", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><strong>\u5982\u4f55 Import</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> TestRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ES6</span>\n<span class=\"token keyword\">const</span> TestRenderer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ES5 with npm</span></code></pre></div>\n<h2 id=\"overview\"><a class=\"anchor\" href=\"/react/test-renderer#overview\"></a>\u6982\u89bd </h2>\n<p>\u9019\u500b package \u63d0\u4f9b\u4e86\u4e00\u500b React renderer\uff0c\u53ef\u4ee5\u88ab\u7528\u65bc render React component \u6210 pure JavaScript object\uff0c\u7121\u9700\u4f9d\u8cf4 DOM \u6216\u539f\u751f\u7684\u884c\u52d5\u88dd\u7f6e\u74b0\u5883\u3002</p>\n<p>\u57fa\u672c\u4e0a\uff0c\u9019\u500b package \u63d0\u4f9b\u7684\u4e3b\u8981\u529f\u80fd\u662f\u5728\u4e0d\u4f9d\u8cf4\u700f\u89bd\u5668\u6216 <a class=\"external-link\" href=\"https://github.com/tmpvar/jsdom\">jsdom</a> \u7684\u60c5\u6cc1\u4e0b\uff0c\u56de\u50b3\u67d0\u500b\u6642\u9593\u9ede\u7531 React DOM \u6216\u662f React Native component render \u51fa\u7684 view \u7d50\u69cb\uff08\u985e\u4f3c DOM tree\uff09snapshot\u3002</p>\n<p>\u7bc4\u4f8b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> TestRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Link</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> testRenderer <span class=\"token operator\">=</span> TestRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">page</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://www.facebook.com/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Facebook</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { type: 'a',</span>\n<span class=\"token comment\">//   props: { href: 'https://www.facebook.com/' },</span>\n<span class=\"token comment\">//   children: [ 'Facebook' ] }</span></code></pre></div>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 Jest \u7684 snapshot \u6e2c\u8a66\u529f\u80fd\u4f86\u81ea\u52d5\u5132\u5b58\u76ee\u524d JSON tree \u5230\u4e00\u500b\u6587\u4ef6\u4e2d\uff0c\u4e26\u5728\u6e2c\u8a66\u4e2d\u6aa2\u67e5\u5b83\u662f\u5426\u88ab\u4fee\u6539\uff1a<a class=\"external-link\" href=\"https://jestjs.io/docs/en/snapshot-testing\">\u4e86\u89e3\u66f4\u591a</a>\u3002</p>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u901a\u904e\u904d\u6b77\u8f38\u51fa\u4f86\u5c0b\u627e\u7279\u5b9a\u7684 node\uff0c\u4e26\u5c0d\u5b83\u5011\u9032\u884c assert\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> TestRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SubComponent</span></span> <span class=\"token attr-name\">foo</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bar<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">SubComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sub<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Sub</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> testRenderer <span class=\"token operator\">=</span> TestRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> testInstance <span class=\"token operator\">=</span> testRenderer<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findByType</span><span class=\"token punctuation\">(</span>SubComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findByProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">className</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sub\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Sub'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"testrenderer\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderer\"></a>TestRenderer </h3>\n<ul>\n<li><a href=\"/react/test-renderer#testrenderercreate\"><code class=\"language-javascript\">TestRenderer.create()</code></a></li>\n<li><a href=\"/react/test-renderer#testrendereract\"><code class=\"language-javascript\">TestRenderer.act()</code></a></li>\n</ul>\n<h3 id=\"testrenderer-instance\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderer-instance\"></a>TestRenderer instance </h3>\n<ul>\n<li><a href=\"/react/test-renderer#testrenderertojson\"><code class=\"language-javascript\">testRenderer.toJSON()</code></a></li>\n<li><a href=\"/react/test-renderer#testrenderertotree\"><code class=\"language-javascript\">testRenderer.toTree()</code></a></li>\n<li><a href=\"/react/test-renderer#testrendererupdate\"><code class=\"language-javascript\">testRenderer.update()</code></a></li>\n<li><a href=\"/react/test-renderer#testrendererunmount\"><code class=\"language-javascript\">testRenderer.unmount()</code></a></li>\n<li><a href=\"/react/test-renderer#testrenderergetinstance\"><code class=\"language-javascript\">testRenderer.getInstance()</code></a></li>\n<li><a href=\"/react/test-renderer#testrendererroot\"><code class=\"language-javascript\">testRenderer.root</code></a></li>\n</ul>\n<h3 id=\"testinstance\"><a class=\"anchor\" href=\"/react/test-renderer#testinstance\"></a>TestInstance </h3>\n<ul>\n<li><a href=\"/react/test-renderer#testinstancefind\"><code class=\"language-javascript\">testInstance.find()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancefindbytype\"><code class=\"language-javascript\">testInstance.findByType()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancefindbyprops\"><code class=\"language-javascript\">testInstance.findByProps()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancefindall\"><code class=\"language-javascript\">testInstance.findAll()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancefindallbytype\"><code class=\"language-javascript\">testInstance.findAllByType()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancefindallbyprops\"><code class=\"language-javascript\">testInstance.findAllByProps()</code></a></li>\n<li><a href=\"/react/test-renderer#testinstanceinstance\"><code class=\"language-javascript\">testInstance.instance</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancetype\"><code class=\"language-javascript\">testInstance.type</code></a></li>\n<li><a href=\"/react/test-renderer#testinstanceprops\"><code class=\"language-javascript\">testInstance.props</code></a></li>\n<li><a href=\"/react/test-renderer#testinstanceparent\"><code class=\"language-javascript\">testInstance.parent</code></a></li>\n<li><a href=\"/react/test-renderer#testinstancechildren\"><code class=\"language-javascript\">testInstance.children</code></a></li>\n</ul>\n<h2 id=\"reference\"><a class=\"anchor\" href=\"/react/test-renderer#reference\"></a>Reference </h2>\n<h3 id=\"testrenderercreate\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderercreate\"></a><code class=\"language-javascript\">TestRenderer.create()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">TestRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u900f\u904e\u50b3\u4f86\u7684 React element \u5efa\u7acb\u4e00\u500b <code class=\"language-javascript\">TestRenderer</code> instance\u3002\u5b83\u4e0d\u4f7f\u7528\u771f\u5be6\u7684 DOM\uff0c\u4f46\u662f\u5b83\u4f9d\u7136\u5c07 component tree \u5b8c\u6574\u5730 render \u5230\u8a18\u61b6\u9ad4\u4e2d\uff0c\u4ee5\u4fbf\u65bc\u4f60\u5c0d\u5b83\u9032\u884c assert\u3002\u56de\u50b3\u70ba\u4e00\u500b <a href=\"/react/test-renderer#testrenderer-instance\"><code class=\"language-javascript\">TestRenderer</code> instance</a>\u3002</p>\n<h3 id=\"testrendereract\"><a class=\"anchor\" href=\"/react/test-renderer#testrendereract\"></a><code class=\"language-javascript\">TestRenderer.act()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">TestRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">act</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u8fd1\u4f3c\u65bc <a href=\"/react/test-utils#act\"><code class=\"language-javascript\">\u6e2c\u8a66\u5de5\u5177</code> \u4e2d\u7684 <code class=\"language-javascript\">act()</code> helper</a>\uff0c<code class=\"language-javascript\">TestRenderer.act</code> \u6703\u70ba\u4e86 assertions \u6e96\u5099\u4e00\u500b component\u3002\u4f7f\u7528\u9019\u500b\u7248\u672c\u7684 <code class=\"language-javascript\">act()</code> \u4f86\u7d71\u5408 <code class=\"language-javascript\">TestRenderer.create</code> \u548c <code class=\"language-javascript\">testRenderer.update</code> \u7684\u4f7f\u7528\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>create<span class=\"token punctuation\">,</span> act<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">'./app.js'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// The component being tested</span>\n\n<span class=\"token comment\">// render the component</span>\n<span class=\"token keyword\">let</span> root<span class=\"token punctuation\">;</span> \n<span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  root <span class=\"token operator\">=</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// make assertions on root </span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// update with some different props</span>\n<span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  root<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// make assertions on root </span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"testrenderertojson\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderertojson\"></a><code class=\"language-javascript\">testRenderer.toJSON()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b\u88ab render \u7684 tree object\u3002\u8a72 tree \u50c5\u5305\u542b\u7279\u5b9a\u5e73\u53f0\u7684 node\uff0c\u4f8b\u5982 <code class=\"language-javascript\">&lt;div&gt;</code> \u6216 <code class=\"language-javascript\">&lt;View&gt;</code> \u548c\u5b83\u5011\u7684 props\uff0c\u4f46\u4e26\u4e0d\u5305\u542b\u4efb\u4f55\u4eba\u54e1\u64b0\u5beb\u7684 component\u3002\u9019\u5c0d\u65bc <a class=\"external-link\" href=\"https://facebook.github.io/jest/docs/en/snapshot-testing.html#snapshot-testing-with-jest\">snapshot \u6e2c\u8a66</a>\u975e\u5e38\u65b9\u4fbf\u3002</p>\n<h3 id=\"testrenderertotree\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderertotree\"></a><code class=\"language-javascript\">testRenderer.toTree()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">toTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b\u88ab render \u7684 tree object\u3002\u5b83\u8868\u793a\u7684\u5167\u5bb9\u6bd4 <code class=\"language-javascript\">toJSON()</code> \u63d0\u4f9b\u7684\u5167\u5bb9\u66f4\u52a0\u8a73\u7d30\uff0c\u4e26\u4e14\u5305\u542b\u4eba\u54e1\u64b0\u5beb\u7684 component\u3002\u9664\u975e\u4f60\u8981\u5728 test renderer \u4e4b\u4e0a\u64b0\u5beb\u81ea\u5df1\u7684 assertion library\uff0c\u5426\u5247\u4f60\u53ef\u80fd\u4e0d\u9700\u8981\u9019\u500b\u65b9\u6cd5\u3002</p>\n<h3 id=\"testrendererupdate\"><a class=\"anchor\" href=\"/react/test-renderer#testrendererupdate\"></a><code class=\"language-javascript\">testRenderer.update()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u900f\u904e\u65b0\u7684 root element \u53bb\u91cd\u65b0 render \u8a18\u61b6\u9ad4\u4e2d\u7684 tree\u3002\u5b83\u6a21\u64ec\u5728 root \u7684 React \u66f4\u65b0\u3002 \u5982\u679c\u65b0\u7684 element \u548c\u4e4b\u524d\u7684 element \u6709\u76f8\u540c\u7684 type \u548c key\uff0c\u8a72 tree \u5c07\u6703\u88ab\u66f4\u65b0\uff1b\u5426\u5247\uff0c\u5b83\u5c07\u91cd\u65b0 mount \u4e00\u500b\u65b0\u7684 tree\u3002</p>\n<h3 id=\"testrendererunmount\"><a class=\"anchor\" href=\"/react/test-renderer#testrendererunmount\"></a><code class=\"language-javascript\">testRenderer.unmount()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Unmount \u8a18\u61b6\u9ad4\u4e2d\u7684 tree\uff0c\u4e26\u89f8\u767c\u76f8\u5c0d\u61c9\u7684\u751f\u547d\u9031\u671f\u4e8b\u4ef6\u3002</p>\n<h3 id=\"testrenderergetinstance\"><a class=\"anchor\" href=\"/react/test-renderer#testrenderergetinstance\"></a><code class=\"language-javascript\">testRenderer.getInstance()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u5982\u679c\u53ef\u4ee5\u7684\u8a71\uff0c\u56de\u50b3\u8207 root element \u76f8\u5c0d\u61c9\u7684 instance\u3002\u5982\u679c root element \u662f function component\uff0c\u8a72\u65b9\u6cd5\u7121\u6548\uff0c\u56e0\u70ba function component \u6c92\u6709 instance\u3002</p>\n<h3 id=\"testrendererroot\"><a class=\"anchor\" href=\"/react/test-renderer#testrendererroot\"></a><code class=\"language-javascript\">testRenderer.root</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testRenderer<span class=\"token punctuation\">.</span>root</code></pre></div>\n<p>\u56de\u50b3 root \u300c\u6e2c\u8a66 instance\u300dobject\uff0c\u5b83\u5c0d\u65bc assert tree \u4e2d\u7684\u7279\u5b9a node \u5341\u5206\u6709\u7528\u3002\u4f60\u53ef\u4ee5\u5229\u7528\u5b83\u4f86\u5c0b\u627e\u5176\u4ed6\u66f4\u6df1\u5c64\u7684\u300c\u6e2c\u8a66 instance\u300d\u3002</p>\n<h3 id=\"testinstancefind\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefind\"></a><code class=\"language-javascript\">testInstance.find()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u4e00\u500b descendant \u6e2c\u8a66 instance\uff0c\u5176 <code class=\"language-javascript\">test(testInstance)</code> \u56de\u50b3 true\u3002\u5982\u679c\u627e\u5230\u4e0d\u53ea\u4e00\u500b\u6e2c\u8a66 instance\uff0c\u5c07\u6703\u62cb\u51fa\u932f\u8aa4\u3002</p>\n<h3 id=\"testinstancefindbytype\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefindbytype\"></a><code class=\"language-javascript\">testInstance.findByType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findByType</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u4e00\u500b\u8207\u6307\u5b9a <code class=\"language-javascript\">type</code> \u5339\u914d\u7684 descendant \u6e2c\u8a66 instance\u3002\u5982\u679c\u4e0d\u53ea\u6709\u4e00\u500b\u6e2c\u8a66 instance \u5339\u914d\u6307\u5b9a\u7684 <code class=\"language-javascript\">type</code>\uff0c\u5c07\u6703\u62cb\u51fa\u932f\u8aa4\u3002</p>\n<h3 id=\"testinstancefindbyprops\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefindbyprops\"></a><code class=\"language-javascript\">testInstance.findByProps()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findByProps</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u4e00\u500b\u8207\u6307\u5b9a <code class=\"language-javascript\">props</code> \u5339\u914d\u7684 descendant \u6e2c\u8a66 instance\u3002\u5982\u679c\u4e0d\u53ea\u6709\u4e00\u500b\u6e2c\u8a66 instance \u5339\u914d\u6307\u5b9a\u7684 <code class=\"language-javascript\">props</code>\uff0c\u5c07\u6703\u62cb\u51fa\u932f\u8aa4\u3002</p>\n<h3 id=\"testinstancefindall\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefindall\"></a><code class=\"language-javascript\">testInstance.findAll()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u6240\u6709\u7684 descendant \u6e2c\u8a66 instance\uff0c\u5176 <code class=\"language-javascript\">test(testInstance)</code> \u56de\u50b3 true\u3002</p>\n<h3 id=\"testinstancefindallbytype\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefindallbytype\"></a><code class=\"language-javascript\">testInstance.findAllByType()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findAllByType</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u6240\u6709\u8207\u6307\u5b9a <code class=\"language-javascript\">type</code> \u5339\u914d\u7684 descendant \u6e2c\u8a66 instance\u3002</p>\n<h3 id=\"testinstancefindallbyprops\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancefindallbyprops\"></a><code class=\"language-javascript\">testInstance.findAllByProps()</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span><span class=\"token function\">findAllByProps</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span></code></pre></div>\n<p>\u627e\u5230\u6240\u6709\u8207\u6307\u5b9a <code class=\"language-javascript\">props</code> \u5339\u914d\u7684 descendant \u6e2c\u8a66 instance\u3002</p>\n<h3 id=\"testinstanceinstance\"><a class=\"anchor\" href=\"/react/test-renderer#testinstanceinstance\"></a><code class=\"language-javascript\">testInstance.instance</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span>instance</code></pre></div>\n<p>\u8a72\u6e2c\u8a66 instance \u76f8\u5c0d\u61c9\u7684 component instance\u3002\u5b83\u53ea\u80fd\u7528\u65bc class component\uff0c\u56e0\u70ba function component \u6c92\u6709 instance\u3002\u5b83\u8207 component \u5167\u90e8\u7684 <code class=\"language-javascript\">this</code> \u503c\u5339\u914d\u3002</p>\n<h3 id=\"testinstancetype\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancetype\"></a><code class=\"language-javascript\">testInstance.type</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span>type</code></pre></div>\n<p>\u8a72\u6e2c\u8a66 instance \u76f8\u5c0d\u61c9\u7684 component \u985e\u578b\u3002\u4f8b\u5982\uff0c\u4e00\u500b <code class=\"language-javascript\">&lt;Button /&gt;</code> component \u7684\u985e\u578b\u70ba <code class=\"language-javascript\">Button</code>\u3002</p>\n<h3 id=\"testinstanceprops\"><a class=\"anchor\" href=\"/react/test-renderer#testinstanceprops\"></a><code class=\"language-javascript\">testInstance.props</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span>props</code></pre></div>\n<p>\u8a72\u6e2c\u8a66 instance \u76f8\u5c0d\u61c9\u7684 component props\u3002\u4f8b\u5982\uff0c\u4e00\u500b <code class=\"language-javascript\">&lt;Button size=\"small\" /&gt;</code> component \u7684 props \u70ba <code class=\"language-javascript\">{size: 'small'}</code>\u3002</p>\n<h3 id=\"testinstanceparent\"><a class=\"anchor\" href=\"/react/test-renderer#testinstanceparent\"></a><code class=\"language-javascript\">testInstance.parent</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span>parent</code></pre></div>\n<p>\u8a72\u6e2c\u8a66 instance \u7684 parent \u6e2c\u8a66 instance\u3002</p>\n<h3 id=\"testinstancechildren\"><a class=\"anchor\" href=\"/react/test-renderer#testinstancechildren\"></a><code class=\"language-javascript\">testInstance.children</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">testInstance<span class=\"token punctuation\">.</span>children</code></pre></div>\n<p>\u8a72\u6e2c\u8a66 instance \u7684 children \u6e2c\u8a66 instance\u3002</p>\n<h2 id=\"ideas\"><a class=\"anchor\" href=\"/react/test-renderer#ideas\"></a>\u6982\u5ff5 </h2>\n<p>\u4f60\u53ef\u4ee5\u628a <code class=\"language-javascript\">createNodeMock</code> function \u7576\u4f5c\u7b2c\u4e8c\u500b\u53c3\u6578\u50b3\u7d66 <code class=\"language-javascript\">TestRenderer.create</code>\uff0c\u505a\u70ba\u81ea\u8a02 mock \u7684 refs\u3002\n<code class=\"language-javascript\">createNodeMock</code> \u63a5\u53d7\u76ee\u524d element \u4f5c\u70ba\u53c3\u6578\uff0c\u4e26\u4e14\u56de\u50b3\u4e00\u500b mock \u7684 ref object\u3002\u9019\u5341\u5206\u6709\u5229\u65bc\u4f9d\u8cf4 refs component \u7684\u6e2c\u8a66\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> TestRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-test-renderer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>input <span class=\"token operator\">=</span> el<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> focused <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\nTestRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyComponent</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">createNodeMock</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// mock a focus function</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function-variable function\">focus</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n            focused <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>focused<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-test-renderer.md\">Edit this page</a></p></div></article>", "path": "/react/test-renderer", "nav": ["/react/test-utils", "/react/javascript-environment-requirements"]}, {"key": "JS \u74b0\u5883\u8981\u6c42", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u652f\u63f4\u6240\u6709\u73fe\u4ee3\u7684\u700f\u89bd\u5668\uff08Edge\u3001Firefox\u3001Chrome\u3001Safari\uff0c\u7b49\u7b49\uff09\u3002</p>\n<p>\u5982\u679c\u4f60\u652f\u63f4\u66f4\u820a\u7684\u700f\u89bd\u5668\u6216\u662f\u88dd\u7f6e\u50cf\u662f Internet Explorer\uff0c\u5b83\u5011\u6c92\u6709\u63d0\u4f9b\u73fe\u4ee3\u700f\u89bd\u5668\u529f\u80fd\uff0c\u6216\u662f\u4e0d\u5408\u898f\u7bc4\u7684\u5be6\u4f5c\uff0c\u8003\u616e\u5728\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f bundle \u5167\u5f15\u5165\u4e00\u500b\u5168\u57df\u7684 polyfill\u3002</p>\n<p>\u4ee5\u4e0b\u662f React 18 \u4f7f\u7528\u7684\u73fe\u4ee3 feature \u7684\u5217\u8868\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code class=\"language-javascript\">Promise</code></a></li>\n<li><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol\"><code class=\"language-javascript\">Symbol</code></a></li>\n<li><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\"><code class=\"language-javascript\">Object.assign</code></a></li>\n</ul>\n<p>\u9019\u4e9b\u529f\u80fd\u7684\u6b63\u78ba polyfill \u53d6\u6c7a\u65bc\u4f60\u7684\u74b0\u5883\u3002\u5c0d\u65bc\u8a31\u591a\u4f7f\u7528\u8005\uff0c\u4f60\u53ef\u4ee5\u8a2d\u5b9a\u4f60\u7684<a class=\"external-link\" href=\"https://github.com/browserslist/browserslist\">\u700f\u89bd\u5668\u5217\u8868</a>\u8a2d\u5b9a\u3002\u5c0d\u65bc\u5176\u4ed6\u4eba\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u76f4\u63a5 import \u50cf <a class=\"external-link\" href=\"https://github.com/zloirock/core-js\"><code class=\"language-javascript\">core-js</code></a> \u9019\u6a23\u7684 polyfill\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-javascript-environment-requirements.md\">Edit this page</a></p></div></article>", "path": "/react/javascript-environment-requirements", "nav": ["/react/test-renderer", "/react/glossary"]}, {"key": "\u8853\u8a9e\u8868", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h2 id=\"single-page-application\"><a class=\"anchor\" href=\"/react/glossary#single-page-application\"></a>\u55ae\u9801\u61c9\u7528\u7a0b\u5f0f </h2>\n<p>\u55ae\u9801\u61c9\u7528\u7a0b\u5f0f\u6703\u8f09\u5165\u4e00\u500b HTML \u9801\u9762\u548c\u5176\u4ed6\u6240\u9700\u8981\u7684\u8cc7\u6e90\uff08\u4f8b\u5982 JavaScript \u548c CSS\uff09\uff0c\u4e4b\u5f8c\u5728\u9801\u9762\u6216\u5f8c\u7e8c\u9801\u9762\u4e0a\u7684\u4e92\u52d5\u90fd\u4e0d\u9700\u8981\u5f80\u8fd4\u4f3a\u670d\u5668\uff0c\u9019\u8868\u793a\u8a72\u9801\u9762\u4e0d\u6703\u88ab\u91cd\u65b0\u8f09\u5165\u3002</p>\n<p>\u7e31\u4f7f\u4f60\u53ef\u4ee5\u7528 React \u4f86\u5efa\u7acb\u55ae\u9801\u61c9\u7528\u7a0b\u5f0f\uff0c\u4f46\u9019\u4e0d\u662f\u5fc5\u9700\u7684\u3002React \u4e5f\u53ef\u4ee5\u88ab\u7528\u5728\u73fe\u6709\u7db2\u7ad9\u7684\u4e00\u5c0f\u90e8\u5206\u4ee5\u589e\u5f37\u4ea4\u4e92\u6027\u3002\u7528 React \u7de8\u5beb\u7684\u4ee3\u78bc\u53ef\u4ee5\u8207\u4f3a\u670d\u5668 render (\u4f8b\u5982 PHP) \u7684 markup \u6216\u5176\u4ed6\u5ba2\u6236\u7aef library \u5b8c\u7f8e\u517c\u5bb9\u3002\u4e8b\u5be6\u4e0a\uff0cReact \u5728 Facebook \u4e2d\u4e5f\u662f\u9019\u6a23\u4f7f\u7528\u7684\u3002</p>\n<h2 id=\"es6-es2015-es2016-etc\"><a class=\"anchor\" href=\"/react/glossary#es6-es2015-es2016-etc\"></a>ES6\uff0cES2015\uff0cES2016\uff0c\u7b49 </h2>\n<p>\u9019\u4e9b\u7e2e\u7565\u8a5e\u90fd\u662f\u6307\u6700\u65b0\u7248\u672c\u7684 ECMAScript \u8a9e\u8a00\u898f\u7bc4\u6a19\u6e96\uff0c\u800c JavaScript \u8a9e\u8a00\u5c31\u662f\u5b83\u5011\u7684\u4e00\u500b\u5be6\u73fe\u3002ES6 \u7248\u672c\uff08\u4e5f\u88ab\u7a31\u70ba ES2015\uff09\u5305\u542b\u4e86\u8a31\u591a\u65b0\u7279\u6027\uff0c\u4f8b\u5982\uff1aarrow function\uff0cclass\uff0c\u6a23\u677f\u5b57\u9762\u503c\uff0c<code class=\"language-javascript\">let</code> \u8207 <code class=\"language-javascript\">const</code> \u8b8a\u6578\u8072\u660e\u3002\u4f60\u53ef\u4ee5\u5728<a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/ECMAScript#Versions\">\u9019\u88cf</a>\u4e86\u89e3\u66f4\u591a\u7248\u672c\u7684\u65b0\u7279\u6027\u3002</p>\n<h2 id=\"compilers\"><a class=\"anchor\" href=\"/react/glossary#compilers\"></a>\u7de8\u8b6f\u5668 </h2>\n<p>JavaScript \u7de8\u8b6f\u5668\u63a5\u53d7 JavaScript \u4ee3\u78bc\uff0c\u5c0d\u5176\u9032\u884c\u8f49\u63db\u4e26\u8fd4\u56de\u4e0d\u540c\u7684\u683c\u5f0f\u7684 JavaScript \u4ee3\u78bc\u3002\u6700\u5e38\u898b\u7684\u4f7f\u7528\u4f8b\u5b50\u662f\u628a ES6 \u8a9e\u6cd5\u8f49\u63db\u70ba\u4e00\u4e9b\u820a\u700f\u89bd\u5668\u80fd\u5920\u8fa8\u8b58\u7684\u8a9e\u6cd5\u3002<a class=\"external-link\" href=\"https://babeljs.io/\">Babel</a> \u662f React \u4e0a\u6700\u5e38\u7528\u7684\u7de8\u8b6f\u5668\u3002</p>\n<h2 id=\"bundlers\"><a class=\"anchor\" href=\"/react/glossary#bundlers\"></a>Bundler </h2>\n<p>Bundlers \u5c07 JavaScript \u548c CSS \u7a0b\u5f0f\u78bc\u4f5c\u70ba\u7368\u7acb\u7684\u6a21\u7d44\u64b0\u5beb\uff08\u901a\u5e38\u6709\u6578\u767e\u500b\uff09\uff0c\u4e26\u5c07\u5b83\u5011\u5408\u4f75\u6210\u6578\u500b\u6a94\u6848\u4e26\u91dd\u5c0d\u700f\u89bd\u5668\u9032\u884c\u6700\u4f73\u5316\u3002\u5728 React \u61c9\u7528\u7a0b\u5f0f\u5e38\u7528\u7684 bundlers \u5305\u62ec <a class=\"external-link\" href=\"https://webpack.js.org/\">Webpack</a> \u548c <a class=\"external-link\" href=\"http://browserify.org/\">Browserify</a>\u3002</p>\n<h2 id=\"package-managers\"><a class=\"anchor\" href=\"/react/glossary#package-managers\"></a>\u5957\u4ef6\u7ba1\u7406\u5de5\u5177 </h2>\n<p>\u5957\u4ef6\u7ba1\u7406\u5de5\u5177\u662f\u7528\u4f86\u7ba1\u7406\u9805\u76ee\u7684 dependency\u3002<a class=\"external-link\" href=\"https://www.npmjs.com/\">npm</a> \u548c <a class=\"external-link\" href=\"https://yarnpkg.com/\">Yarn</a> \u90fd\u662f\u5728 React \u4e0a\u5e38\u7528\u7684\u5957\u4ef6\u7ba1\u7406\u5de5\u5177\u3002\u5b83\u5011\u90fd\u662f\u4f7f\u7528\u76f8\u540c npm \u5957\u4ef6\u6ce8\u518a\u8868\u7684\u5ba2\u6236\u7aef\u3002</p>\n<h2 id=\"cdn\"><a class=\"anchor\" href=\"/react/glossary#cdn\"></a>CDN </h2>\n<p>CDN \u5373\u662f \u5167\u5bb9\u50b3\u905e\u7db2\u8def\u3002CDN \u5f9e\u5168\u7403\u5404\u5730\u7684\u4f3a\u670d\u5668\u63d0\u4f9b\u975c\u614b\u5167\u5bb9\u7684\u7de9\u5b58\u3002</p>\n<h2 id=\"jsx\"><a class=\"anchor\" href=\"/react/glossary#jsx\"></a>JSX </h2>\n<p>JSX \u662f\u4e00\u7a2e JavaScript \u8a9e\u6cd5\u7684\u64f4\u5c55\u3002\u5b83\u8ddf\u6a21\u677f\u8a9e\u8a00\u985e\u4f3c\uff0c\u4f46\u5177\u6709 JavaScript \u7684\u5168\u90e8\u529f\u80fd\u3002JSX \u6703\u88ab\u7de8\u8b6f\u70ba <code class=\"language-javascript\">React.createElement()</code>\uff0c\u7136\u5f8c\u8fd4\u56de\u88ab\u7a31\u70ba React element \u7684 JavaScript object\u3002JSX \u7684\u57fa\u672c\u7c21\u4ecb\u53ef\u4ee5\u53c3\u898b<a href=\"/react/introducing-jsx\">\u9019\u88cf</a>\uff0c\u66f4\u6df1\u5165\u7684\u6559\u7a0b\u53ef\u4ee5\u53c3\u898b<a href=\"/react/jsx-in-depth\">\u9019\u88cf</a>\u3002</p>\n<p>React DOM \u4f7f\u7528 camelCase \u4f86\u547d\u540d HTML \u5c6c\u6027\u540d\u7a31\u3002\u4f8b\u5982\uff0c<code class=\"language-javascript\">tabindex</code> \u5728 JSX \u4e2d\u5beb\u4f5c <code class=\"language-javascript\">tabIndex</code>\u3002\u800c <code class=\"language-javascript\">class</code> \u56e0\u70ba\u662f JavaScript \u4e2d\u7684\u4fdd\u7559\u5b57\uff0c\u6240\u4ee5\u5beb\u4f5c <code class=\"language-javascript\">className</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">My name is Clementine!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<h2 id=\"elements\"><a class=\"anchor\" href=\"/react/glossary#elements\"></a><a href=\"/react/rendering-elements\">Element</a> </h2>\n<p>React element \u662f React \u61c9\u7528\u7a0b\u5f0f\u7684\u5efa\u69cb\u6a21\u584a\u3002\u6709\u4eba\u53ef\u80fd\u6703\u5c07 element \u8ddf\u66f4\u5ee3\u70ba\u4eba\u77e5\u7684 component \u6982\u5ff5\u6df7\u6dc6\u3002element \u63cf\u8ff0\u4f60\u5728\u5c4f\u5e55\u4e0a\u770b\u5230\u751a\u9ebc\u3002React element \u662f\u4e0d\u53ef\u8b8a\u7684\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u901a\u5e38 element \u4e0d\u6703\u88ab\u76f4\u63a5\u4f7f\u7528\uff0c\u800c\u662f\u5728 component \u4e2d\u88ab\u8fd4\u56de\u3002</p>\n<h2 id=\"components\"><a class=\"anchor\" href=\"/react/glossary#components\"></a><a href=\"/react/components-and-props\">Components</a> </h2>\n<p>React component \u662f\u4e00\u6bb5\u5c0f\uff0c\u53ef\u91cd\u8907\u4f7f\u7528\u7684\u4ee3\u78bc\uff0c\u7528\u4f86\u8fd4\u56de\u4e00\u500b\u88ab render \u5728\u9801\u9762\u7684 React element\u3002\u6700\u7c21\u55ae\u7684 React component \u662f\u4e00\u500b\u666e\u901a\u7684 JavaScript function\uff0c\u8fd4\u56de\u4e00\u500b React element\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Component \u4e5f\u53ef\u4ee5\u662f ES6 class\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Welcome</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Component \u53ef\u4ee5\u5206\u89e3\u70ba\u4e0d\u540c\u7684\u529f\u80fd\u90e8\u4ef6\uff0c\u4e26\u5728\u5176\u4ed6 component \u4e2d\u4f7f\u7528\u3002Component \u53ef\u4ee5\u8fd4\u56de\u5176\u4ed6 component\uff0carray\uff0cstring \u548c number\u3002\u4e00\u500b\u5f88\u597d\u7684\u7d93\u9a57\u6cd5\u5247\u662f\uff0c\u5982\u679c\u4f60\u7684 UI \u4e2d\u6709\u4e00\u90e8\u4efd\u88ab\u91cd\u8907\u4f7f\u7528\u591a\u6b21\uff08Button\uff0cPanel\uff0cAvatar\uff09\uff0c\u6216\u81ea\u8eab\u5c31\u8db3\u5920\u8907\u96dc\uff08App\uff0cFeedStory\uff0cComment\uff09\uff0c\u9019\u4e9b\u90fd\u662f\u6210\u70ba\u53ef\u91cd\u8907\u4f7f\u7528 component \u7684\u597d\u9078\u64c7\u3002Component \u7684\u540d\u5b57\u5fc5\u9700\u4ee5\u5927\u5beb\u5b57\u6bcd\u958b\u59cb\uff08<code class=\"language-javascript\">&lt;Wrapper/&gt;</code> <strong>\u800c\u4e0d\u662f</strong> <code class=\"language-javascript\">&lt;wrapper/&gt;</code>\uff09\u3002\u53c3\u898b<a href=\"/react/components-and-props#rendering-a-component\">\u9019\u88cf</a>\u4f86\u4e86\u89e3\u66f4\u591a render component \u7684\u8cc7\u6599\u3002</p>\n<h3 id=\"props\"><a class=\"anchor\" href=\"/react/glossary#props\"></a><a href=\"/react/components-and-props\"><code class=\"language-javascript\">props</code></a> </h3>\n<p><code class=\"language-javascript\">props</code> \u662f React component \u7684\u8f38\u5165\u3002\u5b83\u5011\u662f\u5f9e\u7236 component \u50b3\u905e\u5230\u5b50 component \u7684\u6578\u64da\u3002</p>\n<p>\u8acb\u8a18\u8457 <code class=\"language-javascript\">props</code> \u662f\u53ea\u8b80\u7684\u3002\u4e0d\u61c9\u8a72\u4ee5\u4efb\u4f55\u65b9\u5f0f\u4f86\u4fee\u6539\u5b83\u5011\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u932f\u8aa4!</span>\nprops<span class=\"token punctuation\">.</span>number <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u9700\u8981\u4fee\u6539\u67d0\u4e9b\u6578\u503c\u4f86\u53cd\u6620\u7528\u6236\u8f38\u5165\u6216\u7db2\u7d61\u97ff\u61c9\uff0c\u8acb\u4f7f\u7528 <code class=\"language-javascript\">state</code> \u4f86\u4ee3\u66ff\u3002</p>\n<h3 id=\"propschildren\"><a class=\"anchor\" href=\"/react/glossary#propschildren\"></a><code class=\"language-javascript\">props.children</code> </h3>\n<p><code class=\"language-javascript\">props.children</code> \u5728\u6bcf\u500b component \u4e0a\u90fd\u53ef\u7528\u3002\u5b83\u5305\u542b component \u958b\u59cb\u81f3\u5b8c\u7d50\u6a19\u8a18\u4e4b\u9593\u7684\u5167\u5bb9\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Welcome</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello world!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Welcome</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5b57\u4e32 <code class=\"language-javascript\">Hello world!</code> \u5728 <code class=\"language-javascript\">Welcome</code> component \u53ef\u4ee5\u5728 <code class=\"language-javascript\">props.children</code> \u4e2d\u7372\u53d6\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4ee5 class \u5b9a\u7fa9\u7684 component\uff0c\u4f7f\u7528 <code class=\"language-javascript\">this.props.children</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Welcome</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"state\"><a class=\"anchor\" href=\"/react/glossary#state\"></a><a href=\"/react/state-and-lifecycle#adding-local-state-to-a-class\"><code class=\"language-javascript\">state</code></a> </h3>\n<p>\u7576\u4e00\u500b component \u8207\u5176\u76f8\u95dc\u7684\u6578\u64da\u6703\u96a8\u6642\u9593\u800c\u6539\u8b8a\uff0c\u5c31\u9700\u8981 <code class=\"language-javascript\">state</code>\u3002\u4f8b\u5982\uff0c\u4e00\u500b <code class=\"language-javascript\">Checkbox</code> component \u53ef\u80fd\u9700\u8981 <code class=\"language-javascript\">isChecked</code> \u7684 state\uff0c\u800c <code class=\"language-javascript\">NewFeed</code> component \u53ef\u80fd\u5e0c\u671b\u8ffd\u8e64 <code class=\"language-javascript\">fetchedPosts</code> \u5728\u5b83\u7684 state \u4e2d\u3002</p>\n<p><code class=\"language-javascript\">state</code> \u548c <code class=\"language-javascript\">props</code> \u6700\u4e3b\u8981\u7684\u5340\u5225\u662f <code class=\"language-javascript\">props</code> \u662f\u7531\u7236 component \u50b3\u905e\uff0c\u800c <code class=\"language-javascript\">state</code> \u662f\u7531 component \u672c\u8eab\u7ba1\u7406\u7684\u3002\u4e00\u500b component \u4e0d\u80fd\u6539\u8b8a\u81ea\u5df1\u7684 <code class=\"language-javascript\">props</code>\uff0c\u4f46\u5c31\u53ef\u4ee5\u6539\u8b8a\u81ea\u5df1\u7684 <code class=\"language-javascript\">state</code>\u3002</p>\n<p>\u5c0d\u65bc\u6bcf\u500b\u7279\u5b9a\u8b8a\u5316\u7684\u6578\u64da\uff0c\u61c9\u8a72\u53ea\u6709\u4e00\u500b component\u300c\u64c1\u6709\u300d\u5b83\u5728 state \u4e2d\u3002\u4e0d\u8981\u8a66\u5716\u540c\u6b65\u5169\u500b\u4e0d\u540c component \u7684 state\u3002\u53cd\u800c\uff0c\u628a <a href=\"/react/lifting-state-up\">state \u63d0\u5347</a>\u81f3\u6700\u63a5\u8fd1\u5b83\u5011\u7684\u5171\u540c ancestor\uff0c\u4e26\u628a\u5b83\u4ee5 props \u7684\u5f62\u5f0f\u50b3\u905e\u81f3\u5b83\u5011\u5169\u500b\u3002</p>\n<h2 id=\"lifecycle-methods\"><a class=\"anchor\" href=\"/react/glossary#lifecycle-methods\"></a><a href=\"/react/state-and-lifecycle#adding-lifecycle-methods-to-a-class\">\u751f\u547d\u9031\u671f\u65b9\u6cd5</a> </h2>\n<p>\u751f\u547d\u9031\u671f\u65b9\u6cd5\u662f\u7528\u4f86\u5728 component \u4e0d\u540c\u968e\u6bb5\u4f86\u57f7\u884c\u81ea\u8a02\u529f\u80fd\u3002\u4ee5\u4e0b\u7684\u4e8b\u4ef6\u90fd\u6709\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff1a\u7576 component \u88ab\u5efa\u7acb\u548c\u52a0\u5165\u5728 DOM \u88cf\uff08<a href=\"/react/react-component#mounting\">mounting</a>\uff09\uff0c\u7576 component \u66f4\u65b0\uff0c\u4ee5\u53ca\u5f9e DOM \u4e2d unmount \u6216\u79fb\u9664\u6642\u3002</p>\n<h2 id=\"controlled-\u8207-uncontrolled-components\"><a class=\"anchor\" href=\"/react/glossary#controlled-%E8%88%87-uncontrolled-components\"></a><a href=\"/react/forms#controlled-components\">Controlled</a> \u8207 <a href=\"/react/uncontrolled-components\">Uncontrolled Components</a></h2>\n<p>React \u6709\u5169\u500b\u4e0d\u540c\u7684\u65b9\u6848\u8655\u7406\u8868\u683c\u8f38\u5165\u3002</p>\n<p>\u8868\u683c\u8f38\u5165 element \u7684\u503c\u662f\u7531 React \u4f86\u63a7\u5236\uff0c\u5c31\u88ab\u7a31\u70ba <em>controlled component</em>\u3002\u7576\u7528\u6236\u8f38\u5165\u6578\u64da\u5230 controlled component\uff0c\u5c31\u6703\u89f8\u767c\u4e00\u500b event handler\uff0c\u4e26\u4e14\u7528\u4f60\u7684\u4ee3\u78bc\u6c7a\u5b9a\u8f38\u5165\u662f\u5426\u6709\u6548\uff08\u901a\u904e\u91cd\u65b0 render \u66f4\u65b0\u5f8c\u7684\u6578\u503c\uff09\u3002\u5982\u679c\u4f60\u4e0d\u91cd\u65b0 render\uff0c\u8868\u683c element \u5c07\u4fdd\u6301\u4e0d\u8b8a\u3002</p>\n<p>\u4e00\u500b <em>uncontrolled component</em> \u5c31\u50cf\u8868\u683c element \u4e00\u6a23\u5728 React \u4ee5\u5916\u5de5\u4f5c\u3002\u7576\u7528\u6236\u8f38\u5165\u6578\u64da\u5230\u4e00\u500b\u8868\u683c\u5217\uff08input box\uff0cdropdown \u7b49\uff09\u6642\uff0c\u4e0d\u9700\u8981 React \u8655\u7406\u4efb\u4f55\u6771\u897f\uff0c\u66f4\u65b0\u7684\u6578\u64da\u5c31\u6703\u88ab\u53cd\u6620\u51fa\u4f86\u3002\u4f46\u540c\u6642\u9019\u610f\u5473\u8457\u4f60\u4e0d\u80fd\u5f37\u8feb\u8868\u683c\u5217\u6709\u7279\u5b9a\u7684\u6578\u503c\u3002</p>\n<p>\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b\u4f60\u61c9\u8a72\u4f7f\u7528 controlled components\u3002</p>\n<h2 id=\"keys\"><a class=\"anchor\" href=\"/react/glossary#keys\"></a><a href=\"/react/lists-and-keys\">Keys</a> </h2>\n<p>key \u662f\u5efa\u7acb arrays of elements \u6642\uff0c\u4f60\u9700\u8981\u5305\u542b\u5728\u5167\u7684\u4e00\u500b\u7279\u6b8a\u7684 string attribute\u3002key \u5e6b\u52a9 React \u8fa8\u8a8d\u54ea\u4e9b\u9805\u76ee\u5df2\u66f4\u6539\u3001\u65b0\u589e\u6216\u79fb\u9664\u3002\u61c9\u8a72\u66ff array \u5167\u90e8\u7684 element \u63d0\u4f9b key\uff0c\u4ee5\u4f7f element \u5177\u6709\u7a69\u5b9a\u7684\u8eab\u4efd\u3002</p>\n<p>key \u53ea\u9700\u8981\u5728\u540c\u4e00\u500b array \u7684 sibling elements \u4e2d\u662f\u552f\u4e00\u7684\u3002\u5b83\u5011\u4e0d\u9700\u8981\u5728\u6574\u500b\u61c9\u7528\u7a0b\u5f0f\u6216\u751a\u81f3\u55ae\u4e00 component \u4e2d\u662f\u552f\u4e00\u7684\u3002</p>\n<p>\u4e0d\u8981\u5c07 <code class=\"language-javascript\">Math.random()</code> \u4e4b\u985e\u7684\u503c\u50b3\u7d66 key\u3002\u91cd\u8981\u7684\u662f\uff0ckey \u5728 re-render \u6642\u5177\u6709\u300c\u7a69\u5b9a\u7684\u8eab\u4efd\u300d\uff0c\u4ee5\u4fbf React \u53ef\u4ee5\u78ba\u5b9a\u9805\u76ee\u4f55\u6642\u65b0\u589e\u3001\u79fb\u9664\u6216\u91cd\u65b0\u6392\u5e8f\u3002\u7406\u60f3\u60c5\u6cc1\u4e0b\uff0ckey \u61c9\u8a72\u5c0d\u61c9\u5230\u4f86\u81ea\u65bc\u4f60\u7684\u8cc7\u6599\u4e2d\u552f\u4e00\u4e14\u7a69\u5b9a\u7684\u8eab\u4efd\u6a19\u8b58\uff0c\u4f8b\u5982 <code class=\"language-javascript\">post.id</code>\u3002</p>\n<h2 id=\"refs\"><a class=\"anchor\" href=\"/react/glossary#refs\"></a><a href=\"/react/refs-and-the-dom\">Refs</a> </h2>\n<p>React \u652f\u6301\u4e00\u500b\u53ef\u4ee5\u9644\u52a0\u5230\u4efb\u4f55 component \u7684\u7279\u6b8a attribute\u3002Ref attribute \u53ef\u4ee5\u662f\u7531 <a href=\"/react/react-api#reactcreateref\"><code class=\"language-javascript\">React.createRef()</code> function</a> \u8fd4\u56de\u7684 object\uff0c\u6216\u4e00\u500b callback function\uff0c\u6216\u4e00\u500b string (\u5728\u820a\u6709 API \u4e2d)\u3002\u7576 <code class=\"language-javascript\">ref</code> attribute \u662f callback function \u6642\uff0c\u8a72 function \u63a5\u53d7\u5e95\u5c64\u7684 DOM element \u6216 class instance\uff08\u8996\u4e4e element \u7684\u985e\u5225\uff09\u4f5c\u70ba\u53c3\u6578\u3002\u9019\u4f7f\u4f60\u53ef\u4ee5\u76f4\u63a5\u8a2a\u554f DOM element \u6216 component instance\u3002</p>\n<p>\u4e0d\u8981\u904e\u5ea6\u4f7f\u7528 ref\u3002\u5047\u82e5\u4f60\u767c\u73fe\u4f60\u5728\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7d93\u5e38\u4f7f\u7528 ref \u4f86\u300c\u5be6\u73fe\u67d0\u4e9b\u4e8b\u60c5\u300d\uff0c\u8acb\u8003\u616e\u5c0d <a href=\"/react/lifting-state-up\">\u7531\u4e0a\u800c\u4e0b\u7684\u6578\u64da\u6d41</a> \u66f4\u719f\u6089\u3002</p>\n<h2 id=\"events\"><a class=\"anchor\" href=\"/react/glossary#events\"></a><a href=\"/react/handling-events\">Events</a> </h2>\n<p>\u5728 React element \u4e2d\u8655\u7406 event \u6709\u4e00\u4e9b\u8a9e\u6cd5\u4e0a\u7684\u4e0d\u540c\uff1a</p>\n<ul>\n<li>React \u7684 event handler \u4ee5 camelCase \u4f86\u540d\u547d\uff0c\u800c\u4e0d\u662f\u5c0f\u5beb\u3002</li>\n<li>\u5728 JSX \u4f60\u9700\u8981\u50b3\u5165\u4e00\u500b function \u5230 event handler\uff0c\u800c\u4e0d\u662f\u4e00\u500b string\u3002</li>\n</ul>\n<h2 id=\"reconciliation\"><a class=\"anchor\" href=\"/react/glossary#reconciliation\"></a><a href=\"/react/reconciliation\">Reconciliation</a> </h2>\n<p>\u7576\u4e00\u500b component \u7684 props \u6216 stats \u6539\u8b8a\u6642\uff0cReact \u901a\u904e\u6bd4\u8f03\u65b0\u8fd4\u56de\u7684 element \u548c\u4e4b\u524d render \u7684\u4f86\u6c7a\u5b9a\u662f\u5426\u9700\u8981\u5be6\u969b\u7684 DOM \u66f4\u65b0\u3002\u7576\u5b83\u5011\u4e0d\u76f8\u7b49\u6642\uff0cReact \u5c07\u66f4\u65b0 DOM\u3002\u9019\u500b\u904e\u7a0b\u88ab\u7a31\u70ba\u300creconciliation\u300d\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/reference-glossary.md\">Edit this page</a></p></div></article>", "path": "/react/glossary", "nav": ["/react/javascript-environment-requirements", "/react/hooks-intro"]}]}, {"key": "Hooks", "values": [{"key": "1. Hook \u4ecb\u7d39", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5ba3\u544a\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\uff0c\u6211\u5011\u7a31\u4f5c\u70ba\u300c\b\bcount\u300d\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u65b0 function <code class=\"language-javascript\">useState</code> \u5c07\u6703\u662f\u6211\u5011\u5b78\u7fd2\u7684\u7b2c\u4e00\u500b\u300cHook\u300d\uff0c\u4e0d\u904e\u9019\u53ea\u662f\u4e00\u500b\u521d\u7aba\u7684\u7bc4\u4f8b\u3002\u5982\u679c\u9019\u73fe\u5728\u770b\u8d77\u4f86\u4e26\u4e0d\u5408\u7406\uff0c\u8acb\u5225\u64d4\u5fc3\uff01</p>\n<p><strong>\u4f60\u53ef\u4ee5\u958b\u59cb<a href=\"/react/hooks-overview\">\u5728\u4e0b\u4e00\u9801</a>\u5b78\u7fd2 Hook\u3002</strong>\u5728\u9019\u4e00\u9801\uff0c\u6211\u5011\u5c07\u6703\u7e7c\u7e8c\u89e3\u91cb\u70ba\u4ec0\u9ebc\u8981\u628a Hook \u52a0\u5230 React \u4ee5\u53ca\u4ed6\u5011\u5982\u4f55\u5e6b\u52a9\u4f60\u5beb\u51fa\u597d\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>React 16.8.0 \u662f\u7b2c\u4e00\u500b\u652f\u63f4 Hook \u7684\u7248\u672c\u3002\u5728\u5347\u7d1a\u6642\uff0c\u8a18\u5f97\u4e0d\u8981\u5fd8\u8a18\u5347\u7d1a\u6240\u6709\u7684\u5957\u4ef6\u5305\u62ec React DOM\u3002\nReact Native \u5247\u662f\u5df2\u5f9e <a class=\"external-link\" href=\"hhttps://reactnative.dev/blog/2019/03/12/releasing-react-native-059\">0.59 \u7684\u7248\u672c\u958b\u59cb</a>\u652f\u63f4 Hook\u3002</p>\n</div>\n<h2 id=\"video-introduction\"><a class=\"anchor\" href=\"/react/hooks-intro#video-introduction\"></a>\u4ecb\u7d39\u5f71\u7247 </h2>\n<p>\u5728 React Conf 2018\uff0cSophie Alpert \u548c Dan Abramov \u4ecb\u7d39\u4e86 Hook\uff0c\u63a5\u8457 Ryan Florence \u5c55\u793a\u4e86\u5982\u4f55\u7528\u5b83\u5011\u4f86\u91cd\u69cb\u61c9\u7528\u7a0b\u5f0f\u3002\u5728\u9019\u88e1\u89c0\u770b\u5f71\u7247\uff1a</p>\n<br/>\n<a class=\"external-link\" href=\"//www.youtube.com/embed/dpw9EHDh2bM\">link</a>\n<h2 id=\"no-breaking-changes\"><a class=\"anchor\" href=\"/react/hooks-intro#no-breaking-changes\"></a>\u6c92\u6709 Breaking Change </h2>\n<p>\u5728\u6211\u5011\u7e7c\u7e8c\u4e4b\u524d\uff0c\u8acb\u6ce8\u610f Hook \u662f\uff1a</p>\n<ul>\n<li><strong>\u5b8c\u5168\u81ea\u7531\u9078\u64c7\u4f7f\u7528\u3002</strong>\u4f60\u53ef\u4ee5\u5728\u5e7e\u500b component \u4e2d\u8a66\u7528 Hook \u800c\u4e0d\u7528\u91cd\u5beb\u4efb\u4f55\u65e2\u6709\u7684\u7a0b\u5f0f\u78bc\u3002\u4e0d\u904e\u5982\u679c\u4f60\u4e0d\u60f3\u8981\uff0c\u4e26\u4e0d\u9700\u8981\u73fe\u5728\u5b78\u7fd2\u6216\u4f7f\u7528 Hook\u3002</li>\n<li><strong>100% \u5411\u4e0b\u76f8\u5bb9\u3002</strong>Hook \u6c92\u6709\u4efb\u4f55 breaking change\u3002</li>\n<li><strong>\u73fe\u5728\u5373\u53ef\u4f7f\u7528\u3002</strong>\u96a8\u8457 v16.8.0 \u767c\u4f48\uff0c\u73fe\u5728\u5373\u53ef\u4f7f\u7528 Hook\u3002</li>\n</ul>\n<p><strong>\u76ee\u524d\u6c92\u6709\u8a08\u756b\u8981\u5f9e React \u79fb\u9664 class\u3002</strong> \u4f60\u53ef\u4ee5\u5728\u9019\u500b\u9801\u9762<a href=\"/react/hooks-intro#gradual-adoption-strategy\">\u4e0b\u9762\u7684\u7ae0\u7bc0</a>\u95b1\u8b80\u66f4\u591a\u8ddf\u9010\u6b65\u63a1\u7528 Hook \u6709\u95dc\u7684\u5167\u5bb9\u3002</p>\n<p><strong>Hook \u4e0d\u6703\u53d6\u4ee3\u4f60\u5c0d React \u6982\u5ff5\u7684\u4e86\u89e3\u3002</strong>\u76f8\u53cd\u7684\uff0cHook \u662f\u5c0d\u4f60\u5df2\u7d93\u719f\u6089\u7684 React \u6982\u5ff5\uff1aprops\u3001state\u3001context\u3001refs \u4ee5\u53ca lifecycle\uff0c\u63d0\u4f9b\u4e86\u4e00\u500b\u66f4\u76f4\u63a5\u7684 API\u3002\u6b63\u5982\u6211\u5011\u7a0d\u5f8c\u5c07\u5c55\u793a\u7684\u90a3\u6a23\uff0cHook \u9084\u63d0\u4f9b\u4e86\u4e00\u7a2e\u65b0\u7684\u5f37\u5927\u65b9\u5f0f\u4f86\u7d44\u5408\u4ed6\u5011\u3002</p>\n<p><strong>\u5982\u679c\u4f60\u53ea\u662f\u60f3\u8981\u958b\u59cb\u5b78\u7fd2 Hook\uff0c\u53ef\u4ee5\u81ea\u7531\u5730<a href=\"/react/hooks-overview\">\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u9801\uff01</a></strong>\u4f60\u4e5f\u53ef\u4ee5\u7e7c\u7e8c\u95b1\u8b80\u9019\u4e00\u9801\u4f86\u4e86\u89e3\u66f4\u591a\u95dc\u65bc\u6211\u5011\u70ba\u4ec0\u9ebc\u8981\u52a0\u5165 Hook\uff0c\u4ee5\u53ca\u6211\u5011\u5982\u4f55\u5728\u4e0d\u91cd\u5beb\u61c9\u7528\u7a0b\u5f0f\u7684\u60c5\u6cc1\u4e0b\u958b\u59cb\u4f7f\u7528\u5b83\u5011\u3002</p>\n<h2 id=\"motivation\"><a class=\"anchor\" href=\"/react/hooks-intro#motivation\"></a>\u52d5\u6a5f </h2>\n<p>Hook \u89e3\u6c7a\u4e86 React \u4e2d\u6211\u5011\u904e\u53bb\u4e94\u5e74\u5728\u7de8\u5beb\u8207\u7dad\u8b77\u6578\u842c\u500b component \u6642\u6240\u9047\u5230\u7684\u5404\u7a2e\u770b\u4f3c\u4e0d\u76f8\u95dc\u7684\u554f\u984c\u3002\u7121\u8ad6\u4f60\u662f\u5728\u5b78\u7fd2 React\u3001\u6bcf\u5929\u4f7f\u7528\u5b83\u3001\u9084\u662f\u66f4\u559c\u6b61\u6709\u8457\u76f8\u4f3c component \u6a21\u578b\u7684\u4e0d\u540c\u51fd\u5f0f\u5eab\uff0c\u4f60\u53ef\u80fd\u90fd\u6703\u767c\u73fe\u5176\u4e2d\u4e00\u4e9b\u554f\u984c\u3002</p>\n<h3 id=\"its-hard-to-reuse-stateful-logic-between-components\"><a class=\"anchor\" href=\"/react/hooks-intro#its-hard-to-reuse-stateful-logic-between-components\"></a>\u5728 Component \u4e4b\u9593\u91cd\u7528 Stateful \u7684\u908f\u8f2f\u5f88\u56f0\u96e3 </h3>\n<p>React \u6c92\u6709\u63d0\u4f9b\u4e00\u500b\u65b9\u6cd5\u4f86\u628a\u53ef\u91cd\u7528\u7684\u884c\u70ba\u300c\u9644\u52a0\u300d\u5230\u4e00\u500b component \u4e0a (\u8209\u4f8b\u4f86\u8aaa\uff0c\u628a\u5b83\u9023\u7d50\u5230\u4e00\u500b store)\u3002\u5982\u679c\u4f60\u5df2\u7d93\u4f7f\u7528 React \u4e00\u6bb5\u6642\u9593\uff0c\u4f60\u6216\u8a31\u6703\u719f\u6089\u50cf\u662f <a href=\"/react/render-props\">render props</a> \u4ee5\u53ca <a href=\"/react/higher-order-components\">higher-order components</a>\uff0c\u9019\u4e9b\u8a66\u8457\u89e3\u6c7a\u9019\u500b\u554f\u984c\u7684\u6a21\u5f0f\u3002\u4f46\u662f\u9019\u4e9b\u6a21\u5f0f\u8981\u6c42\u4f60\u5728\u4f7f\u7528\u5b83\u5011\u6642\u91cd\u65b0\u67b6\u69cb\u4f60\u7684 component\uff0c\u9019\u53ef\u80fd\u5f88\u9ebb\u7169\uff0c\u800c\u4e14\u4f7f\u7a0b\u5f0f\u78bc\u66f4\u96e3\u8ffd\u8e64\u3002\u5982\u679c\u4f60\u5728 React DevTools \u4e0a\u67e5\u770b\u4e00\u500b\u5178\u578b\u7684 React \u61c9\u7528\u7a0b\u5f0f\uff0c\u4f60\u5f88\u53ef\u80fd\u6703\u767c\u73fe\u4e00\u500b component \u7684\u300c\u5305\u88dd\u5730\u7344\u300d\uff0c\u88ab provider\u3001consumer\u3001higher-order component\u3001render props \u4ee5\u53ca\u5176\u4ed6\u62bd\u8c61\u7d66\u5c64\u5c64\u570d\u7e5e\u3002\u73fe\u5728\u6211\u5011\u53ef\u4ee5<a class=\"external-link\" href=\"https://github.com/facebook/react-devtools/pull/503\">\u5728 DevTools \u88e1\u628a\u5b83\u5011\u904e\u6ffe\u6389</a>\uff0c\u4e0d\u904e\u9019\u6307\u51fa\u4e86\u4e00\u500b\u66f4\u6839\u672c\u7684\u554f\u984c\uff1aReact \u9700\u8981\u4e00\u500b\u66f4\u597d\u7684 primitive \u4f86\u5171\u7528 stateful \u908f\u8f2f\u3002</p>\n<p>\u4f7f\u7528 Hook\uff0c\u4f60\u53ef\u4ee5\u5f9e component \u62bd\u53d6 stateful \u7684\u908f\u8f2f\uff0c\u5982\u6b64\u4e00\u4f86\u5b83\u5c31\u53ef\u4ee5\u7368\u7acb\u5730\u88ab\u6e2c\u8a66\u548c\u91cd\u8907\u4f7f\u7528\u3002<strong>Hook \u8b93\u4f60\u4e0d\u9700\u8981\u6539\u8b8a component \u968e\u5c64\u5c31\u80fd\u91cd\u7528 stateful \u7684\u908f\u8f2f\u3002</strong>\u9019\u8b93\u5728\u8a31\u591a component \u4e4b\u9593\u5171\u7528\u6216\u662f\u8207\u793e\u7fa4\u5171\u7528 Hook \u5f88\u7c21\u55ae\u3002</p>\n<p>\u6211\u5011\u5c07\u6703\u5728<a href=\"/react/hooks-custom\">\u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook</a> \u8a0e\u8ad6\u66f4\u591a\u76f8\u95dc\u5167\u5bb9\u3002</p>\n<h3 id=\"complex-components-become-hard-to-understand\"><a class=\"anchor\" href=\"/react/hooks-intro#complex-components-become-hard-to-understand\"></a>\u8907\u96dc\u7684 component \u8b8a\u5f97\u5f88\u96e3\u7406\u89e3 </h3>\n<p>\u6211\u5011\u6642\u5e38\u5fc5\u9808\u7dad\u8b77\u90a3\u4e9b\u4e00\u958b\u59cb\u975e\u5e38\u7c21\u55ae\uff0c\u4f46\u5f8c\u4f86\u8b8a\u6210\u5145\u6eff\u7121\u6cd5\u7ba1\u7406\u7684 stateful \u908f\u8f2f\u548c side effect \u7684 component\u3002\u6bcf\u500b lifecycle \u65b9\u6cd5\u5e38\u5e38\u5305\u542b\u4e0d\u76f8\u95dc\u7684\u908f\u8f2f\u6df7\u5408\u5728\u4e00\u8d77\u3002\u8209\u4f8b\u4f86\u8aaa\uff0ccomponent \u53ef\u80fd\u6703\u5728 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code> \u4e2d\u6293\u53d6\u8cc7\u6599\u3002\u4f46\u662f\uff0c\u540c\u4e00\u500b <code class=\"language-javascript\">componentDidMount</code> \u65b9\u6cd5\u53ef\u80fd\u4e5f\u5305\u542b\u4e00\u4e9b\u8a2d\u7f6e event listener \u7684\u4e0d\u76f8\u95dc\u908f\u8f2f\uff0c\u4e26\u5728 <code class=\"language-javascript\">componentWillUnmount</code> \u57f7\u884c\u6e05\u9664\u5b83\u5011\u3002\u6703\u4e00\u8d77\u6539\u8b8a\u4e14\u5f7c\u6b64\u76f8\u95dc\u7684\u7a0b\u5f0f\u78bc\u88ab\u62c6\u5206\uff0c\u4f46\u5b8c\u5168\u4e0d\u76f8\u95dc\u7684\u7a0b\u5f0f\u78bc\u537b\u653e\u5728\u540c\u4e00\u500b\u65b9\u6cd5\u88e1\u3002\u9019\u8b93\u5b83\u5f88\u5bb9\u6613\u88fd\u9020 bug \u548c\u4e0d\u4e00\u81f4\u6027\u3002</p>\n<p>\u5728\u8a31\u591a\u60c5\u6cc1\u4e0b\uff0c\u56e0\u70ba\u5230\u8655\u90fd\u662f stateful \u908f\u8f2f\uff0c\u4e0d\u53ef\u80fd\u628a\u9019\u4e9b component \u62c6\u5206\u6210\u66f4\u5c0f\u7684 component\u3002\u800c\u6e2c\u8a66\u5b83\u5011\u4e5f\u5f88\u56f0\u96e3\u3002\u9019\u662f\u8a31\u591a\u4eba\u504f\u611b\u628a React \u8ddf\u4e00\u500b\u7368\u7acb\u7684 state \u7ba1\u7406\u51fd\u5f0f\u5eab\u7d50\u5408\u7684\u5176\u4e2d\u4e00\u500b\u7406\u7531\u3002\u7136\u800c\uff0c\u9019\u5e38\u5e38\u5f15\u5165\u4e86\u592a\u591a\u7684\u62bd\u8c61\uff0c\u8981\u6c42\u4f60\u5728\u4e0d\u540c\u6a94\u6848\u9593\u8df3\u4f86\u8df3\u53bb\uff0c\u800c\u4e14\u8b93\u91cd\u7528 component \u66f4\u52a0\u56f0\u96e3\u3002</p>\n<p>\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c<strong>Hook \u8b93\u4f60\u628a\u4e00\u500b component \u62c6\u5206\u6210\u66f4\u5c0f\u7684 function\uff0c\u9019\u57fa\u65bc\u4ec0\u9ebc\u90e8\u5206\u662f\u76f8\u95dc\u7684\uff08\u50cf\u662f\u8a2d\u7f6e\u4e00\u500b subscription \u6216\u662f\u6293\u53d6\u8cc7\u6599\uff09</strong>\uff0c\u800c\u4e0d\u662f\u5f37\u5236\u57fa\u65bc lifecycle \u65b9\u6cd5\u4f86\u5206\u62c6\u3002\u4f60\u9084\u53ef\u4ee5\u9078\u64c7\u4f7f\u7528 reducer \u4f86\u7ba1\u7406 component \u7684\u5167\u90e8 state\uff0c\u4f7f\u5176\u66f4\u5177\u53ef\u9810\u6e2c\u6027\u3002</p>\n<p>\u6211\u5011\u5c07\u6703\u5728<a href=\"/react/hooks-effect#tip-use-multiple-effects-to-separate-concerns\">\u4f7f\u7528 Effect Hook</a> \u8a0e\u8ad6\u66f4\u591a\u76f8\u95dc\u5167\u5bb9\u3002</p>\n<h3 id=\"classes-confuse-both-people-and-machines\"><a class=\"anchor\" href=\"/react/hooks-intro#classes-confuse-both-people-and-machines\"></a>Class \u8b93\u4eba\u5011\u548c\u96fb\u8166\u540c\u6642\u611f\u5230\u56f0\u60d1 </h3>\n<p>\u9664\u4e86\u4f7f\u91cd\u7528\u3001\u7d44\u7e54\u7a0b\u5f0f\u78bc\u66f4\u52a0\u56f0\u96e3\u4ee5\u5916\uff0c\u6211\u5011\u767c\u73fe class \u53ef\u80fd\u662f\u5b78\u7fd2 React \u7684\u4e00\u5927\u969c\u7919\u3002\u4f60\u5fc5\u9808\u4e86\u89e3 <code class=\"language-javascript\">this</code> \u5728 JavaScript \u4e2d\u5982\u4f55\u904b\u4f5c\uff0c\u800c\u9019\u8ddf\u5b83\u5728\u5927\u90e8\u5206\u7a0b\u5f0f\u8a9e\u8a00\u4e2d\u7684\u904b\u4f5c\u65b9\u5f0f\u975e\u5e38\u4e0d\u540c\u3002\u4f60\u5fc5\u9808\u8a18\u5f97 bind \u90a3\u4e9b event handler\u3002\u5982\u679c\u6c92\u6709 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#public_instance_fields\">ES2022 public class fields</a>\uff0c\u64b0\u5beb\u7684\u7a0b\u5f0f\u78bc\u6703\u975e\u5e38\u7e41\u7463\u3002\u4eba\u5011\u53ef\u4ee5\u5f88\u597d\u7684\u7406\u89e3 props\u3001state \u4ee5\u53ca\u5f9e\u4e0a\u800c\u4e0b\u7684\u8cc7\u6599\u6d41\uff0c\u4f46\u4ecd\u7136\u5728\u8ddf class \u596e\u9b25\u3002React \u4e2d\u7684 function component \u548c class component \u4e4b\u9593\u7684\u5dee\u7570\u4ee5\u53ca\u4ec0\u9ebc\u6642\u5019\u8a72\u4f7f\u7528\u54ea\u4e00\u500b\uff0c\u751a\u81f3\u5728\u7d93\u9a57\u8c50\u5bcc\u7684 React \u958b\u767c\u8005\u4e4b\u9593\u4e5f\u5b58\u5728\u610f\u898b\u5206\u6b67\u3002</p>\n<p>\u6b64\u5916\uff0cReact \u5df2\u7d93\u51fa\u73fe\u4e86\u5927\u7d04\u4e94\u5e74\uff0c\u800c\u6211\u5011\u60f3\u8981\u78ba\u4fdd\u5b83\u5728\u4e0b\u4e00\u500b\u4e94\u5e74\u4fdd\u6301\u7af6\u722d\u529b\u3002\u5982\u540c <a class=\"external-link\" href=\"https://svelte.dev/\">Svelte</a>\u3001<a class=\"external-link\" href=\"https://angular.io/\">Angular</a>\u3001<a class=\"external-link\" href=\"https://glimmerjs.com/\">Glimmer</a>\uff0c\u4ee5\u53ca\u5176\u4ed6\u4eba\u6240\u5c55\u793a\u7684\uff0ccomponent \u7684<a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Ahead-of-time_compilation\">\u63d0\u524d\u7de8\u8b6f</a>\u6709\u5f88\u5927\u7684\u672a\u4f86\u6f5b\u529b\u3002\u7279\u5225\u662f\u5982\u679c\u5b83\u4e0d\u4fb7\u9650\u5728\u6a21\u677f\u4e0a\u3002\u6700\u8fd1\uff0c\u6211\u5011\u5728\u5be6\u9a57\u4f7f\u7528 <a class=\"external-link\" href=\"https://prepack.io/\">Prepack</a> \u4f86\u505a <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/7323\">component folding</a>\uff0c\u800c\u6211\u5011\u5df2\u7d93\u770b\u5230\u5927\u6709\u53ef\u70ba\u7684\u65e9\u671f\u7d50\u679c\u3002\u7136\u800c\uff0c\u6211\u5011\u767c\u73fe\u4f7f\u7528 class component \u6703\u9f13\u52f5\u4e00\u4e9b\u4e0d\u662f\u6545\u610f\u7684\u6a21\u5f0f\uff0c\u9019\u6703\u8b93\u9019\u4e9b\u6700\u4f73\u5316\u56de\u5230\u4e00\u689d\u6bd4\u8f03\u6162\u7684\u8def\u3002Class \u5728\u73fe\u5728\u7684\u5de5\u5177\u4e0a\u4e5f\u6709\u4e0d\u5c11\u554f\u984c\u3002\u4f8b\u5982\uff0cclass \u6c92\u6709\u8fa6\u6cd5\u5f88\u597d\u7684\u58d3\u7e2e\uff0c\u800c\u4e14\u5b83\u8b93 hot reload \u8b8a\u5f97\u8106\u5f31\u800c\u4e14\u4e0d\u53ef\u9760\u3002\u6211\u5011\u60f3\u8981\u63d0\u51fa\u4e00\u500b\u53ef\u4ee5\u8b93\u7a0b\u5f0f\u78bc\u66f4\u53ef\u80fd\u7559\u5728\u53ef\u6700\u4f73\u5316\u7684\u8def\u5f91\u4e0a\u7684 API\u3002</p>\n<p>\u70ba\u4e86\u89e3\u6c7a\u9019\u4e9b\u554f\u984c\uff0c<strong>Hook \u8b93\u4f60\u4e0d\u9700\u8981 class \u5c31\u80fd\u4f7f\u7528\u66f4\u591a React \u7684\u529f\u80fd\u3002</strong> \u5f9e\u6982\u5ff5\u4e0a\u4f86\u770b\uff0cReact component \u4e00\u76f4\u90fd\u66f4\u63a5\u8fd1 function\u3002Hook \u64c1\u62b1 function\uff0c\u4f46\u6c92\u6709\u72a7\u7272 React \u7684\u5be6\u969b\u7cbe\u795e\u3002Hook \u63d0\u4f9b\u53d6\u7528 imperative \u6280\u8853\u7684\u8fa6\u6cd5\u4e14\u4e0d\u8981\u6c42\u4f60\u5b78\u7fd2\u8907\u96dc\u7684 functional \u6216 reactive programming \u6280\u8853\u3002</p>\n<div class=\"blockquote\">\n<strong>\u7bc4\u4f8b</strong>\n<p><a href=\"/react/hooks-overview\">Hook \u7e3d\u89bd</a>\u662f\u4e00\u500b\u958b\u59cb\u5b78\u7fd2 Hook \u7684\u597d\u5730\u65b9\u3002</p>\n</div>\n<h2 id=\"gradual-adoption-strategy\"><a class=\"anchor\" href=\"/react/hooks-intro#gradual-adoption-strategy\"></a>\u9010\u6b65\u7684\u63a1\u7528\u7b56\u7565 </h2>\n<div class=\"blockquote\">\n<strong>\u9577\u8a71\u77ed\u8aaa\uff1a\u76ee\u524d\u6c92\u6709\u8a08\u756b\u8981\u5f9e React \u79fb\u9664 class\u3002</strong>\n</div>\n<p>\u6211\u5011\u77e5\u9053 React \u7684\u958b\u767c\u8005\u5011\u5c08\u6ce8\u5728\u4ea4\u4ed8\u7522\u54c1\uff0c\u6c92\u6709\u6642\u9593\u4ed4\u7d30\u53bb\u770b\u6bcf\u4e00\u500b\u88ab\u91cb\u51fa\u7684\u65b0 API\u3002Hook \u975e\u5e38\u65b0\uff0c\u6240\u4ee5\u5728\u8003\u616e\u5b78\u7fd2\u6216\u63a1\u7528\u5b83\u5011\u4e4b\u524d\uff0c\u7b49\u5f85\u66f4\u591a\u7bc4\u4f8b\u548c\u6559\u5b78\u53ef\u80fd\u6703\u66f4\u597d\u3002</p>\n<p>\u6211\u5011\u4e5f\u4e86\u89e3\u8981\u6dfb\u52a0\u4e00\u500b\u65b0\u7684 primitive \u5230 React \u7684\u6a19\u6e96\u975e\u5e38\u9ad8\u3002\u6211\u5011\u5df2\u7d93\u6e96\u5099\u4e86\u4e00\u500b<a class=\"external-link\" href=\"https://github.com/reactjs/rfcs/pull/68\">\u8a73\u76e1\u7684 RFC</a> \u7d66\u597d\u5947\u7684\u8b80\u8005\uff0c\u5b83\u85c9\u7531\u66f4\u591a\u7d30\u7bc0\u6df1\u5165\u63a2\u8a0e\u52d5\u6a5f\uff0c\u4e26\u91dd\u5c0d\u7279\u5b9a\u7684\u8a2d\u8a08\u6c7a\u7b56\u4ee5\u53ca\u5148\u95dc\u7684\u65e2\u6709\u6280\u8853\u63d0\u4f9b\u984d\u5916\u7684\u89c0\u9ede\u3002</p>\n<p><strong>\u81f3\u95dc\u91cd\u8981\u7684\u662f\uff0cHook \u53ef\u4ee5\u8207\u65e2\u6709\u7684\u7a0b\u5f0f\u78bc\u4e00\u8d77\u904b\u4f5c\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u9010\u6b65\u63a1\u7528\u5b83\u5011\u3002</strong> \u4e0d\u7528\u6025\u8457\u8f49\u63db\u5230 Hook\u3002\u6211\u5011\u5efa\u8b70\u907f\u514d\u4efb\u4f55\u300c\u5de8\u5927\u7684\u6539\u5beb\u300d\uff0c\u5c24\u5176\u662f\u90a3\u4e9b\u65e2\u6709\u3001\u8907\u96dc\u7684 class component\u3002\u8981\u958b\u59cb\u300c\u5f9e Hook \u7684\u89d2\u5ea6\u601d\u8003\u300d\u9700\u8981\u4e00\u4e9b\u601d\u7dad\u4e0a\u7684\u8f49\u8b8a\u3002\u6839\u64da\u6211\u5011\u7684\u7d93\u9a57\uff0c\u6700\u597d\u5148\u5728\u65b0\u7684\u4e14\u91cd\u8981\u6027\u8f03\u4f4e\u7684 component \u4e2d\u7df4\u7fd2\u4f7f\u7528 Hook\uff0c\u4e26\u78ba\u4fdd\u5718\u968a\u4e2d\u7684\u6bcf\u500b\u4eba\u90fd\u4e0d\u6703\u5c0d\u5b83\u611f\u5230\u4e0d\u8212\u670d\u3002\u5728\u4f60\u5617\u8a66\u4e86 Hook \u4e4b\u5f8c\uff0c\u8acb\u81ea\u7531\u5730<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/new\">\u7d66\u6211\u5011\u4e00\u4e9b\u56de\u994b</a>\uff0c\u4e0d\u7ba1\u662f\u6b63\u9762\u7684\u9084\u662f\u8ca0\u9762\u7684\u53ef\u4ee5\u3002</p>\n<p>\u6211\u5011\u6709\u610f\u8b93 Hook \u80fd\u6db5\u84cb class \u6240\u6709\u65e2\u6709\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u4f46<strong>\u6211\u5011\u6703\u5728\u53ef\u898b\u7684\u672a\u4f86\u7e7c\u7e8c\u652f\u63f4 class component\u3002</strong>\u5728 Facebook \u88e1\uff0c\u6211\u5011\u6709\u6578\u4ee5\u842c\u8a08\u7684 component \u662f\u7528 class \u5beb\u7684\uff0c\u800c\u6211\u5011\u7d55\u5c0d\u6c92\u6709\u8a08\u5283\u8981\u6539\u5beb\u5b83\u5011\u3002\u53d6\u800c\u4ee3\u4e4b\uff0c\u6211\u5011\u958b\u59cb\u5728\u65b0\u7684\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528 Hook \u4e26\u8b93\u5b83\u5011\u8ddf class \u5171\u5b58\u3002</p>\n<h2 id=\"frequently-asked-questions\"><a class=\"anchor\" href=\"/react/hooks-intro#frequently-asked-questions\"></a>\u5e38\u898b\u554f\u984c </h2>\n<p>\u6211\u5011\u6e96\u5099\u4e86\u4e00\u500b <a href=\"/react/hooks-faq\">Hook \u7684\u5e38\u898b\u554f\u984c\u9801\u9762</a>\u4f86\u56de\u7b54 Hook \u6700\u5e38\u898b\u5230\u7684\u554f\u984c\u3002</p>\n<h2 id=\"next-steps\"><a class=\"anchor\" href=\"/react/hooks-intro#next-steps\"></a>\u4e0b\u4e00\u6b65 </h2>\n<p>\u770b\u5230\u9019\u9801\u7684\u6700\u5f8c\u9762\uff0c\u4f60\u61c9\u8a72\u5df2\u7d93\u5927\u81f4\u4e86\u89e3 Hook \u6b63\u5728\u89e3\u6c7a\u4ec0\u9ebc\u554f\u984c\uff0c\u4e0d\u904e\u8a31\u591a\u7d30\u7bc0\u4f60\u53ef\u80fd\u90fd\u9084\u4e0d\u5927\u6e05\u695a\u3002\u5225\u64d4\u5fc3\uff01<strong>\u8b93\u6211\u5011\u99ac\u4e0a\u524d\u5f80<a href=\"/react/hooks-overview\">\u4e0b\u4e00\u9801</a>\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u90a3\u88e1\u958b\u59cb\u85c9\u7531\u7bc4\u4f8b\u5b78\u7fd2 Hook\u3002</strong></p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-intro.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-intro", "nav": ["/react/glossary", "/react/hooks-overview"]}, {"key": "2. Hook \u6982\u89c0", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p>Hook <a href=\"/react/hooks-intro#no-breaking-changes\">\u5411\u5f8c\u517c\u5bb9</a>\u3002\u9019\u4e00\u9801\u63d0\u4f9b Hook \u7684\u7c21\u4ecb\u7d66\u6709\u7d93\u9a57\u7684 React \u4f7f\u7528\u8005\u5011\u3002\u9019\u662f\u4e00\u500b\u5feb\u7bc0\u594f\u7684\u7c21\u4ecb\uff0c\u5982\u679c\u4f60\u6709\u7591\u60d1\uff0c\u770b\u4e00\u4e0b\u9ec3\u8272\u6846\u6846\u5982\u4e0b\uff1a</p>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u95b1\u8b80 <a href=\"/react/hooks-intro#motivation\">Hook \u4ecb\u7d39\u7684\u52d5\u6a5f\u90e8\u5206</a>\u4f86\u4e86\u89e3\u70ba\u4ec0\u9ebc\u6211\u5011\u5c07 Hook \u52a0\u5165 React\u3002</p>\n</div>\n<p><strong>\u2191\u2191\u2191 \u6bcf\u4e00\u500b\u7ae0\u7bc0\u7d50\u675f\u90fd\u6709\u4e00\u500b\u9ec3\u8272\u6846\u6846\u50cf\u9019\u6a23\u3002</strong> \u4ed6\u5011\u9023\u5230\u8a73\u7d30\u89e3\u91cb\u3002</p>\n<h2 id=\"state-hook\"><a class=\"anchor\" href=\"/react/hooks-overview#state-hook\"></a>\ud83d\udccc State Hook </h2>\n<p>\u9019\u500b\u7bc4\u4f8b render \u4e00\u500b\u8a08\u6578\u5668\u3002\u7576\u4f60\u6309\u4e0b\u6309\u9215\uff0c\u4ed6\u6703\u589e\u52a0\u6578\u503c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5ba3\u544a\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\uff0c\u6211\u5011\u53eb\u4ed6\u300ccount\u300d</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u88e1\uff0cuseState \u662f\u4e00\u500b <em>Hook</em> \uff08\u6211\u5011\u99ac\u4e0a\u6703\u804a\u5230\u4ed6\u662f\u4ec0\u9ebc\u610f\u601d\uff09\u3002\u6211\u5011\u5728 function component \u4e2d\u547c\u53eb\u4ed6\u5011\u7528\u4f86\u52a0\u5165\u4e00\u4e9b local state\u3002React \u6703\u5728\u91cd\u65b0 render \u7684\u9801\u9762\u4e4b\u9593\u4fdd\u7559\u9019\u4e9b state\u3002<code class=\"language-javascript\">useState</code> \u56de\u50b3\u4e00\u7d44\u6578\u503c\uff1a<em>\u76ee\u524d</em> state \u6578\u503c\u548c\u4e00\u500b\u53ef\u4ee5\u8b93\u4f60\u66f4\u65b0 state \u7684 function\u3002\u4f60\u53ef\u4ee5\u5f9e event handler \u6216\u5176\u4ed6\u5730\u65b9\u547c\u53eb\u9019\u500b function \u4f86\u66f4\u65b0\u4ed6\u3002\u5f88\u985e\u4f3c <code class=\"language-javascript\">this.setState</code> \u5728 class \u7576\u4e2d\u7684\u7528\u6cd5\uff0c\u9664\u4e86\u4ed6\u4e0d\u6703\u5c07\u820a\u7684\u8207\u65b0\u7684 state \u5408\u4f75\u5728\u4e00\u8d77\u3002\uff08\u6211\u5011\u5c07\u6703\u5728<a href=\"/react/hooks-state\">\u4f7f\u7528 State Hook</a> \u4e2d\u793a\u7bc4\u4e00\u500b\u7bc4\u4f8b\u6bd4\u8f03 <code class=\"language-javascript\">useState</code> \u8207 <code class=\"language-javascript\">this.state</code>\u3002\uff09</p>\n<p><code class=\"language-javascript\">useState</code> \u552f\u4e00\u7684 argument \u662f\u521d\u59cb\u72c0\u614b\u3002\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4ed6\u662f <code class=\"language-javascript\">0</code> \u56e0\u70ba\u6211\u5011\u7684\u8a08\u6578\u5668\u5f9e\u96f6\u958b\u59cb\u3002\u6ce8\u610f\u4e0d\u50cf <code class=\"language-javascript\">this.state</code>\uff0cstate \u5728\u9019\u88e1\u4e0d\u9700\u8981\u4e00\u5b9a\u662f object\uff0c\u96d6\u7136\u4f60\u8981\u4e5f\u53ef\u4ee5\u3002\u521d\u59cb\u72c0\u614b argument \u53ea\u6709\u5728\u7b2c\u4e00\u6b21 render \u7684\u6642\u5019\u6703\u88ab\u7528\u5230\u3002</p>\n<h4 id=\"declaring-multiple-state-variables\"><a class=\"anchor\" href=\"/react/hooks-overview#declaring-multiple-state-variables\"></a>\u5ba3\u544a\u591a\u500b state \u8b8a\u6578 </h4>\n<p>\u4f60\u53ef\u4ee5\u5728\u4e00\u500b component \u4e2d\u4f7f\u7528 State Hook \u4e0d\u53ea\u4e00\u6b21\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ExampleWithManyStates</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u5ba3\u544a\u591a\u500b state \u8b8a\u6578!</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>age<span class=\"token punctuation\">,</span> setAge<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>fruit<span class=\"token punctuation\">,</span> setFruit<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'banana'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> setTodos<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'Learn Hooks'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring\">\u9663\u5217\u89e3\u69cb\u8ce6\u503c</a>\u8a9e\u6cd5\u8b93\u6211\u5011\u53ef\u4ee5\u7d66\u7528\u547c\u53eb <code class=\"language-javascript\">useState</code> \u5ba3\u544a\u7684 state \u8b8a\u6578\u4e0d\u540c\u7684\u540d\u5b57\uff0c\u9019\u4e9b\u540d\u5b57\u4e0d\u662f <code class=\"language-javascript\">useState</code> API \u7684\u4e00\u90e8\u4efd\u3002\u76f8\u53cd\u5730\uff0cReact \u5047\u8a2d\u5982\u679c\u4f60\u547c\u53eb <code class=\"language-javascript\">useState</code> \u591a\u6b21\uff0c\u4f60\u5728\u6bcf\u6b21 render \u7528\u540c\u6a23\u7684\u9806\u5e8f\u3002\u6211\u5011\u4e4b\u5f8c\u5c07\u6703\u56de\u4f86\u8a0e\u8ad6\u70ba\u4ec0\u9ebc\u53ef\u4ee5\u9019\u6a23\u505a\u8207\u4ec0\u9ebc\u6642\u5019\u4ed6\u5f88\u6709\u7528\u3002</p>\n<h4 id=\"but-what-is-a-hook\"><a class=\"anchor\" href=\"/react/hooks-overview#but-what-is-a-hook\"></a>\u4f46\u662f\u4ec0\u9ebc\u662f Hook? </h4>\n<p>Hook \u662f function\uff0c\u4ed6\u8b93\u4f60\u53ef\u4ee5\u5f9e function component\u300chook into\u300dReact state \u8207\u751f\u547d\u9031\u671f\u529f\u80fd\u3002Hook \u5728 class \u88e1\u9762\u6c92\u6709\u8fa6\u6cd5\u7528\u2014\u2014\u4ed6\u5011\u8b93\u4f60\u4e0d\u7528 class \u5c31\u80fd\u4f7f\u7528 React\u3002\uff08\u6211\u5011<a href=\"/react/hooks-intro#gradual-adoption-strategy\">\u4e0d\u5efa\u8b70</a>\u4f60\u901a\u5bb5\u91cd\u5beb\u73fe\u5b58\u7684 component \u4f46\u662f\u5982\u679c\u4f60\u60f3\u8981\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u958b\u59cb\u5728\u65b0\u7684 component \u7576\u4e2d\u4f7f\u7528\u3002\uff09</p>\n<p>React \u63d0\u4f9b\u4e00\u4e9b\u5167\u5efa Hook \u50cf\u662f <code class=\"language-javascript\">useState</code>\u3002\u4f60\u4e5f\u53ef\u4ee5\u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook \u7528\u4f86\u5728\u4e0d\u540c\u7684 component \u4e4b\u9593\u91cd\u8907\u4f7f\u7528 stateful \u908f\u8f2f\u3002\u6211\u5011\u5148\u4f86\u770b\u770b\u5167\u5efa Hook\u3002</p>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u4f60\u53ef\u4ee5\u5728<a href=\"/react/hooks-state\">\u4f7f\u7528 State Hook</a> \u4e86\u89e3\u66f4\u591a State Hook\u3002</p>\n</div>\n<h2 id=\"effect-hook\"><a class=\"anchor\" href=\"/react/hooks-overview#effect-hook\"></a>\u26a1\ufe0f Effect Hook </h2>\n<p>\u4f60\u5f9e\u524d\u53ef\u80fd\u5728 React component \u505a\u904e fetch \u8cc7\u6599\u3001\u8a02\u95b1\u3001\u6216\u624b\u52d5\u6539\u8b8a DOM\u3002\u6211\u5011\u7a31\u9019\u4e9b\u64cd\u4f5c\u300cside effect\u300d\uff08\u6216\u7c21\u7a31 effect\uff09\u56e0\u70ba\u4ed6\u5011\u53ef\u4ee5\u5f71\u97ff\u5176\u4ed6 component \u4e14\u5728 render \u671f\u9593\u7121\u6cd5\u5b8c\u6210\u3002</p>\n<p>Effect Hook <code class=\"language-javascript\">useEffect</code> \u5728 function component \u4e2d\u52a0\u5165\u904b\u4f5c side effect \u7684\u80fd\u529b\u3002\u4ed6\u548c <code class=\"language-javascript\">componentDidMount</code>\uff0c<code class=\"language-javascript\">componentDidUpdate</code>\uff0c\u8207 <code class=\"language-javascript\">componentWillUnmount</code> \u6709\u8457\u540c\u6a23\u7684\u5b97\u65e8\uff0c\u4f46\u6574\u5408\u9032\u4e00\u500b\u55ae\u4e00\u7684 API\u3002\uff08\u6211\u5011\u5c07\u5728<a href=\"/react/hooks-effect\">\u4f7f\u7528 Effect Hook</a> \u4e2d\u7528\u7bc4\u4f8b\u6bd4\u8f03 <code class=\"language-javascript\">useEffect</code> \u548c\u9019\u4e9b\u65b9\u6cd5\u3002\uff09</p>\n<p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u9019\u500b component \u5728 React \u66f4\u65b0 DOM \u4e4b\u5f8c\u8a2d\u5b9a\u6587\u4ef6\u6a19\u984c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u8207 componentDidMount \u548c componentDidUpdate \u985e\u4f3c\uff1a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u4f7f\u7528\u700f\u89bd\u5668 API \u66f4\u65b0\u6587\u4ef6\u6a19\u984c</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u7576\u4f60\u547c\u53eb <code class=\"language-javascript\">useEffect</code> \u6642\uff0c\u4f60\u544a\u8a34 React \u5237\u65b0 DOM \u8b8a\u52d5\u4e4b\u5f8c\u57f7\u884c\u4f60\u7684 \u300ceffect\u300d\u3002Effect \u5728 component \u88e1\u9762\u88ab\u5ba3\u544a\u6240\u4ee5\u4ed6\u5011\u6709\u6b0a\u9650\u8a2a\u554f\u4ed6\u7684 props \u548c state\u3002\u9810\u8a2d\u4e4b\u4e0b\uff0cReact \u5728\u6bcf\u4e00\u6b21 render \u4e4b\u5f8c\u57f7\u884c effect \u2014\u2014 <em>\u5305\u62ec</em>\u7b2c\u4e00\u6b21 render\u3002\uff08\u6211\u5011\u6703\u5728<a href=\"/react/hooks-effect\">\u4f7f\u7528 Effect Hook</a> \u505a\u66f4\u591a\u4ed6\u548c class lifecycle \u7684\u6bd4\u8f03\u3002\uff09</p>\n<p>Effect \u53ef\u4ee5\u900f\u904e\u56de\u50b3\u4e00\u500b function \u9078\u64c7\u6027\u7684\u5b9a\u7fa9\u5982\u4f55\u300c\u6e05\u7406\u300d\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u9019\u500b component \u4f7f\u7528 effect \u4f86\u8a02\u95b1\u670b\u53cb\u7684\u4e0a\u7dda\u72c0\u614b\uff0c\u4e26\u5728\u53d6\u6d88\u8a02\u95b1\u4e4b\u5f8c\u6e05\u7406\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u7576 component unmount \u548c\u91cd\u65b0\u904b\u884c effect \u7684\u6642\u5019\uff0cReact \u6703\u53d6\u6d88\u8a02\u95b1\u6211\u5011\u7684 <code class=\"language-javascript\">ChatAPI</code> \u56e0\u70ba\u4e00\u9023\u4e32\u4f9d\u5e8f\u7684 render\u3002\uff08\u5982\u679c\u4f60\u60f3\u7684\u8a71\uff0c\u5982\u679c\u6211\u5011\u50b3\u905e\u7d66 <code class=\"language-javascript\">ChatAPI</code> \u7684 <code class=\"language-javascript\">props.friend.id</code> \u6c92\u6709\u6539\u8b8a\uff0c\u6709\u8fa6\u6cd5<a href=\"/react/hooks-effect#tip-optimizing-performance-by-skipping-effects\">\u544a\u8a34 React \u8df3\u904e\u91cd\u65b0\u8a02\u95b1</a>\u3002\uff09</p>\n<p>\u5c31\u50cf\u662f <code class=\"language-javascript\">useState</code> \u4e00\u6a23\uff0c\u4f60\u53ef\u4ee5\u5728\u4e00\u500b component \u4e2d\u4f7f\u7528\u8d85\u904e\u4e00\u500b effect\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatusWithCounter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>Hook \u8b93\u4f60\u5728 component \u4e2d\u900f\u904e\u5f7c\u6b64\u76f8\u95dc\u7684\u90e8\u5206\u7d44\u7e54 side effect\uff08\u50cf\u662f\u52a0\u5165\u6216\u79fb\u9664\u8a02\u95b1\uff09\uff0c\u800c\u4e0d\u662f\u5f37\u8feb\u6839\u64da\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5206\u6563\u5404\u8655\u3002</p>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u4f60\u53ef\u4ee5\u5728<a href=\"/react/hooks-effect\">\u4f7f\u7528 Effect Hook</a> \u4e86\u89e3\u66f4\u591a Effect Hook\u3002</p>\n</div>\n<h2 id=\"rules-of-hooks\"><a class=\"anchor\" href=\"/react/hooks-overview#rules-of-hooks\"></a>\u270c\ufe0f Hook \u7684\u898f\u5247 </h2>\n<p>Hook \u662f JavaScript function\uff0c\u4f46\u662f\u4ed6\u5011\u5f37\u52a0\u4e86\u5169\u689d\u984d\u5916\u7684\u898f\u5247\uff1a</p>\n<ul>\n<li>\u53ea\u5728<strong>\u6700\u4e0a\u5c64</strong>\u547c\u53eb Hook\u3002\u4e0d\u8981\u5728\u8ff4\u5708\u3001\u5224\u65b7\u5f0f\u3001\u6216\u662f\u5d4c\u5957 function \u4e2d\u547c\u53eb Hook\u3002</li>\n<li>\u53ea\u5728 <strong>React function component</strong> \u547c\u53eb Hook\u3002\u4e0d\u8981\u5728\u4e00\u822c JavaScript function \u4e2d\u547c\u53eb Hook\u3002\uff08\u53ea\u6709\u4e00\u500b\u5176\u4ed6\u6709\u6548\u7684\u5730\u65b9\u53ef\u4ee5\u547c\u53eb Hook\u2014\u2014\u4f60\u81ea\u5df1\u7684\u5ba2\u88fd\u5316 Hook\u3002\u6211\u5011\u99ac\u4e0a\u6703\u5b78\u5230\u4ed6\u5011\u3002\uff09</li>\n</ul>\n<p>\u6211\u5011\u63d0\u4f9b\u4e86\u4e00\u500b <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\">linter plugin</a> \u81ea\u52d5\u5f37\u5236\u5957\u7528\u9019\u4e9b\u898f\u5247\u3002\u6211\u5011\u4e86\u89e3\u9019\u4e9b\u898f\u5247\u7b2c\u4e00\u773c\u770b\u8d77\u4f86\u5f88\u591a\u9650\u5236\u6216\u662f\u5f88\u8b93\u4eba\u7591\u60d1\uff0c\u4f46\u662f\u4ed6\u5011\u662f\u8b93 Hook \u6210\u529f\u904b\u4f5c\u7684\u5fc5\u8981\u689d\u4ef6\u3002</p>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u4f60\u53ef\u4ee5\u5728 <a href=\"/react/hooks-rules\">Hook \u7684\u898f\u5247</a>\u4e86\u89e3\u66f4\u591a Hook \u7684\u898f\u5247\u3002</p>\n</div>\n<h2 id=\"building-your-own-hooks\"><a class=\"anchor\" href=\"/react/hooks-overview#building-your-own-hooks\"></a>\ud83d\udca1 \u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook </h2>\n<p>\u6709\u6642\u5019\uff0c\u6211\u5011\u60f3\u8981\u5728 component \u4e4b\u9593\u91cd\u8907\u4f7f\u7528\u67d0\u4e9b stateful \u908f\u8f2f\u3002\u50b3\u7d71\u4e0a\uff0c\u9019\u500b\u554f\u984c\u6709\u5169\u7a2e\u71b1\u9580\u7684\u7b54\u6848\uff1a<a href=\"/react/higher-order-components\">higher-order components</a> \u8207 <a href=\"/react/render-props\">render props</a>\u3002\u5ba2\u88fd\u5316 Hook \u8b93\u4f60\u4e0d\u7528\u5728\u4f60\u7684 tree \u4e2d\u52a0\u5165\u66f4\u591a component \u5c31\u80fd\u505a\u5230\u3002</p>\n<p>\u5728\u9019\u4e00\u9801\u524d\u9762\uff0c\u6211\u5011\u63d0\u5230 <code class=\"language-javascript\">FriendStatus</code> component \u547c\u53eb <code class=\"language-javascript\">useState</code> \u8207 <code class=\"language-javascript\">useEffect</code> Hook \u4f86\u8a02\u95b1\u670b\u53cb\u7684\u7dda\u4e0a\u72c0\u614b\u3002\u5047\u5982\u6211\u5011\u4e5f\u60f3\u8981\u5728\u53e6\u4e00\u500b component \u91cd\u8907\u4f7f\u7528\u9019\u500b\u8a02\u95b1\u908f\u8f2f\u3002</p>\n<p>\u9996\u5148\uff0c\u6211\u5011\u62bd\u96e2\u9019\u500b\u908f\u8f2f\u5230\u5ba2\u88fd\u5316 Hook <code class=\"language-javascript\">useFriendState</code> \u4e4b\u4e2d\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4ed6\u63a5\u6536 <code class=\"language-javascript\">friendID</code> \u505a\u70ba argument \u4e14\u56de\u50b3\u6211\u5011\u7684\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\u3002</p>\n<p>\u73fe\u5728\u6211\u5011\u5728\u5169\u500b component \u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'black'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u5169\u500b component \u7684 state \u662f\u5b8c\u5168\u7368\u7acb\u7684\u3002Hook \u662f\u4e00\u7a2e\u91cd\u8907\u4f7f\u7528 <em>stateful \u908f\u8f2f</em>\u7684\u65b9\u5f0f\uff0c\u4e0d\u662f state \u672c\u8eab\u3002\u5be6\u969b\u4e0a\uff0c\u6bcf\u4e00\u6b21\u547c\u53eb\u4e00\u500b Hook \u90fd\u6709\u4e00\u500b\u5b8c\u5168\u7368\u7acb\u4e14\u9694\u96e2\u7684 state \u2014\u2014 \u6240\u4ee5\u4f60\u751a\u81f3\u53ef\u4ee5\u5728\u4e00\u500b component \u4f7f\u7528\u540c\u4e00\u500b\u5ba2\u88fd\u5316 Hook \u5169\u6b21\u3002</p>\n<p>\u5ba2\u88fd\u5316 Hook \u6bd4\u8f03\u50cf\u6163\u4f8b\u800c\u4e0d\u662f\u529f\u80fd\uff0c\u5982\u679c\u4e00\u500b function \u7684\u540d\u5b57\u662f\u300c<code class=\"language-javascript\">use</code>\u300d\u958b\u982d\u4e14\u4ed6\u547c\u53eb\u5176\u4ed6 Hook\uff0c\u6211\u5011\u5c07\u4ed6\u7a31\u4e4b\u70ba\u5ba2\u88fd\u5316 Hook\u3002\u4f7f\u7528 Hook \u6642\uff0c<code class=\"language-javascript\">useSomething</code>\u7684\u547d\u540d\u6163\u4f8b\u662f\u6211\u5011\u7684 linter plugin \u5982\u4f55\u80fd\u5920\u5728\u7a0b\u5f0f\u78bc\u4e2d\u627e\u5230 bug \u7684\u539f\u56e0\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u5beb\u5ba2\u88fd\u5316 Hook \u6db5\u84cb\u5ee3\u6cdb\u5730\u4f7f\u7528\u6848\u4f8b\u50cf\u662f\u8868\u55ae\u8655\u7406\u3001\u52d5\u756b\u3001\u5ba3\u544a\u5f0f\u8a02\u95b1\u3001\u8a08\u6642\u5668\u548c\u8a31\u591a\u6211\u5011\u53ef\u80fd\u6c92\u6709\u60f3\u5230\u7684\u3002\u6211\u5011\u5f88\u8208\u596e\u770b\u5230 React \u793e\u7fa4\u6703\u60f3\u5230\u4ec0\u9ebc\u6a23\u7684 Hook\u3002</p>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u4f60\u53ef\u4ee5\u5728<a href=\"/react/hooks-custom\">\u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook</a> \u4e86\u89e3\u66f4\u591a\u5ba2\u88fd\u5316 Hook\u3002</p>\n</div>\n<h2 id=\"other-hooks\"><a class=\"anchor\" href=\"/react/hooks-overview#other-hooks\"></a>\ud83d\udd0c \u5176\u4ed6 Hook </h2>\n<p>\u9084\u6709\u4e00\u4e9b\u6bd4\u8f03\u5c11\u7528\u7684\u5167\u5efa Hook \u4f60\u53ef\u80fd\u6703\u89ba\u5f97\u5f88\u6709\u7528\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c<a href=\"/react/hooks-reference#usecontext\"><code class=\"language-javascript\">useContext</code></a> \u8b93\u4f60\u4e0d\u9700\u8981\u5de2\u72c0\u5316\u5c31\u53ef\u4ee5\u8a02\u95b1 React context\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> locale <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LocaleContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>ThemeContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a> \u8b93\u4f60\u5728\u8907\u96dc\u7684 component \u4e2d\u7528 reducer \u7ba1\u7406 local state\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Todos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>todosReducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u8a73\u7d30\u89e3\u91cb</strong>\n<p>\u4f60\u53ef\u4ee5\u5728 <a href=\"/react/hooks-reference\">Hook API \u53c3\u8003</a>\u4e86\u89e3\u66f4\u591a\u6240\u6709\u7684\u5167\u5efa Hook\u3002</p>\n</div>\n<h2 id=\"next-steps\"><a class=\"anchor\" href=\"/react/hooks-overview#next-steps\"></a>\u4e0b\u4e00\u6b65 </h2>\n<p>\u547c\uff01\u8b1b\u5f88\u5feb\uff01\u5982\u679c\u6709\u4ec0\u9ebc\u8b93\u4f60\u89ba\u5f97\u6c92\u9053\u7406\u6216\u662f\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u7d30\u7bc0\uff0c\u4f60\u53ef\u4ee5\u95b1\u8b80\u4e0b\u4e00\u9801\uff0c\u5f9e <a href=\"/react/hooks-state\">State Hook</a> \u6587\u4ef6\u958b\u59cb\u3002</p>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u770b\u770b <a href=\"/react/hooks-reference\">Hook API reference</a> \u8207 <a href=\"/react/hooks-faq\">Hook \u5e38\u898b\u554f\u984c</a>\u3002</p>\n<p>\u6700\u5f8c\uff0c\u4e0d\u8981\u6f0f\u4e86 <a href=\"/react/hooks-intro\">Hook \u4ecb\u7d39\u9801\u9762</a>\uff0c\u9019\u88e1\u89e3\u91cb\u4e86<em>\u70ba\u4ec0\u9ebc</em>\u6211\u5011\u52a0\u5165\u4e86 Hook \u8207\u6211\u5011\u5982\u4f55\u548c class \u4e00\u8d77\u4f7f\u7528\u2014\u2014\u4e0d\u7528\u91cd\u5beb\u6211\u5011\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-overview.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-overview", "nav": ["/react/hooks-intro", "/react/hooks-state"]}, {"key": "3. \u4f7f\u7528 State Hook", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p><a href=\"/react/hooks-intro\">\u4ecb\u7d39 Hook</a> \u4f7f\u7528\u904e\u9019\u500b\u7bc4\u4f8b\u8b93\u6211\u5011\u719f\u6089 Hook\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5ba3\u544a\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\uff0c\u6211\u5011\u7a31\u4f5c\u70ba\u300c\b\bcount\u300d\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u6703\u85c9\u7531\u5728\u540c\u6a23\u7684\u7bc4\u4f8b\u4e2d\u4f7f\u7528 class \u6642\u6709\u4ec0\u9ebc\u5dee\u5225\u4f86\u5b78\u7fd2 Hook\u3002</p>\n<h2 id=\"equivalent-class-example\"><a class=\"anchor\" href=\"/react/hooks-state#equivalent-class-example\"></a>\u76f8\u7b49\u7684 Class \u7bc4\u4f8b </h2>\n<p>\u5982\u679c\u4f60\u4ee5\u524d\u5728 React \u4e2d\u4f7f\u7528\u904e class\uff0c\u9019\u6bb5\u7a0b\u5f0f\u61c9\u8a72\u5c0d\u4f60\u4e0d\u964c\u751f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          Click me\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>State \u5f9e <code class=\"language-javascript\">{ count: 0 }</code> \u958b\u59cb\uff0c\u7576\u4f7f\u7528\u8005\u9ede\u64ca\u6309\u9215\u6642\uff0c\u6211\u5011\u85c9\u7531\u547c\u53eb <code class=\"language-javascript\">this.setState()</code> \u589e\u52a0 <code class=\"language-javascript\">state.count</code>\u3002\u5728\u9019\u3127\u6574\u9801\uff0c\u6211\u5011\u6703\u4f7f\u7528\u9019\u500b class \u4e2d\u7684\u7247\u6bb5\u4f86\u8aaa\u660e\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f60\u4e5f\u8a31\u6703\u597d\u5947\u6211\u5011\u70ba\u4ec0\u9ebc\u8981\u7528\u4e00\u500b\u8a08\u6578\u5668\uff0c\u800c\u4e0d\u662f\u4e00\u500b\u66f4\u5be6\u969b\u7684\u4f8b\u5b50\u3002\u5176\u5be6\u7576\u6211\u5011\u9084\u5728\u5b78\u7fd2\u600e\u9ebc\u4f7f\u7528 Hook \u7684\u6642\u5019\uff0c\u9019\u6709\u52a9\u65bc\u6211\u5011\u5c08\u6ce8\u5728 API \u4e0a\u9762\u3002</p>\n</div>\n<h2 id=\"hooks-and-function-components\"><a class=\"anchor\" href=\"/react/hooks-state#hooks-and-function-components\"></a>Hook \u548c Function Component </h2>\n<p>\u63d0\u9192\u4e00\u4e0b\uff0c\u5728 React \u4e2d function component \u770b\u8d77\u4f86\u50cf\u9019\u6a23\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Example</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u4f60\u53ef\u4ee5\u5728\u9019\u88e1\u4f7f\u7528 Hook\uff01</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6216\u662f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u4f60\u53ef\u4ee5\u5728\u9019\u88e1\u4f7f\u7528 Hook\uff01</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4e5f\u8a31\u4f60\u77e5\u9053\u5b83\u66fe\u88ab\u7a31\u4f5c\u300cstateless component\u300d\u3002\u4f46\u56e0\u70ba\u73fe\u5728\u9019\u4e9b component \u4e5f\u53ef\u4ee5\u4f7f\u7528 React state \u4e86\uff0c\u6211\u5011\u6703\u6bd4\u8f03\u559c\u6b61\u300cfunction component\u300d\u9019\u500b\u7a31\u547c\u3002</p>\n<p>Hook <strong>\u4e0d\u6703</strong>\u5728 class \u88e1\u904b\u4f5c\u3002\u4f46\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f86\u53d6\u4ee3 class\u3002</p>\n<h2 id=\"whats-a-hook\"><a class=\"anchor\" href=\"/react/hooks-state#whats-a-hook\"></a>\u4ec0\u9ebc\u662f Hook\uff1f </h2>\n<p>\u5c31\u5f9e React \u5f15\u5165 <code class=\"language-javascript\">useState</code> \u4f86\u958b\u59cb\u65b0\u7684\u7bc4\u4f8b\u5427\uff1a \b</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u4ec0\u9ebc\u662f Hook\uff1f</strong>Hook \u662f\u4e00\u500b\u8b93\u4f60\u53ef\u4ee5\u4f7f\u7528 React \u5404\u9805\u529f\u80fd\u7684\u7279\u6b8a function\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c<code class=\"language-javascript\">useState</code> \u662f\u4e00\u500b\u8b93\u4f60\u589e\u52a0 React state \u5230 function component \u7684 Hook\u3002\u5728\u5f8c\u9762\u7684\u7ae0\u7bc0\u6211\u5011\u6703\u5b78\u7fd2\u5176\u4ed6 Hook\u3002</p>\n<p><strong>\u4ec0\u9ebc\u6642\u5019\u8a72\u4f7f\u7528 Hook\uff1f</strong>\u4ee5\u524d\u7576\u4f60\u5beb\u4e00\u500b function component \u9700\u8981\u589e\u52a0\u4e00\u4e9b state \u6642\uff0c\u4f60\u5fc5\u9808\u8f49\u63db\u6210 class\u3002\u73fe\u5728\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728 function component \u4e2d\u4f7f\u7528 Hook\u3002\u6211\u5011\u73fe\u5728\u5c31\u4f86\u8a66\u8a66\u770b\u5427\uff01</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u95dc\u65bc\u5728 component \u4e2d\u54ea\u88e1\u53ef\u4ee5\u4f7f\u7528 Hook\uff0c\u6709\u4e00\u4e9b\u7279\u5225\u7684\u898f\u5247\u3002\u6211\u5011\u6703\u5728 <a href=\"/react/hooks-rules\">Hook \u7684\u898f\u5247</a>\u4e2d\u5b78\u7fd2\u3002</p>\n</div>\n<h2 id=\"declaring-a-state-variable\"><a class=\"anchor\" href=\"/react/hooks-state#declaring-a-state-variable\"></a>\u5ba3\u544a\u4e00\u500b State \u8b8a\u6578 </h2>\n<p>\u5728 class \u4e2d\uff0c\u85c9\u7531\u5728 constructor \u8a2d\u5b9a <code class=\"language-javascript\">this.state</code> \u6210 <code class=\"language-javascript\">{ count: 0 }</code> \u628a <code class=\"language-javascript\">count</code> \u9019\u500b state \u8d77\u59cb\u503c\u8a2d\u70ba <code class=\"language-javascript\">0</code>\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728 function component \u4e2d\uff0c\u6211\u5011\u6c92\u6709 <code class=\"language-javascript\">this</code>\uff0c\u6240\u4ee5\u6211\u5011\u6c92\u8fa6\u6cd5\u6307\u5b9a\u6216\u8b80\u53d6 <code class=\"language-javascript\">this.state</code>\u3002\u76f8\u53cd\u5730\uff0c\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u5728 component \u4e2d\u547c\u53eb <code class=\"language-javascript\">useState</code> Hook\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5ba3\u544a\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\uff0c\u6211\u5011\u7a31\u4f5c\u70ba\u300c\b\bcount\u300d\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><strong>\u547c\u53eb <code class=\"language-javascript\">useState</code> \u505a\u4e86\u4ec0\u9ebc\uff1f</strong>\u5b83\u5ba3\u544a\u4e86\u4e00\u500b\u300cstate \u8b8a\u6578\u300d\u3002\u6211\u5011\u7684\u8b8a\u6578\u53eb\u505a <code class=\"language-javascript\">count</code>\uff0c\u4e5f\u53ef\u4ee5\u6709\u5176\u4ed6\u7a31\u547c\uff0c\u50cf\u662f <code class=\"language-javascript\">banana</code>\u3002\u9019\u662f\u4e00\u500b\u5728 function \u547c\u53eb\u4e2d\u300c\u4fdd\u7559\u300d\u8b8a\u6578\u7684\u65b9\u6cd5\uff0d<code class=\"language-javascript\">useState</code> \u5c31\u50cf\u662f class \u4e2d <code class=\"language-javascript\">this.state</code> \u7684\u529f\u80fd\u4e00\u6a23\u3002\u4e00\u822c\u60c5\u6cc1\u4e0b\uff0c\u8b8a\u6578\u6703\u5728 function \u7d50\u675f\u6642\u300c\u6d88\u5931\u300d\uff0c\u4f46 state \u8b8a\u6578\u6703\u88ab React \u4fdd\u7559\u8d77\u4f86\u3002</p>\n<p><strong>\u6211\u5011\u50b3\u5165\u4ec0\u9ebc\u53c3\u6578\u7d66 <code class=\"language-javascript\">useState</code>\uff1f</strong>\u552f\u4e00\u9700\u8981\u50b3\u5165 <code class=\"language-javascript\">useState()</code> Hook \u7684\u53c3\u6578\u5c31\u662f state \u7684\u8d77\u59cb\u503c\u3002\u4e0d\u50cf class\uff0c\u9019\u500b state \u4e0d\u9700\u8981\u662f\u4e00\u500b object\u3002\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u6211\u5011\u6240\u9700\u7684 number \u6216\u662f string\u3002\u5728\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u53ea\u9700\u8981\u4e00\u500b number \u8a18\u9304\u4f7f\u7528\u8005\u9ede\u64ca\u4e86\u591a\u5c11\u6b21\uff0c\u6240\u4ee5\u6211\u5011\u50b3\u5165 <code class=\"language-javascript\">0</code> \u4f86\u7576\u4f5c\u8d77\u59cb\u503c\u3002\uff08\u5982\u679c\u8981\u5728 state \u5132\u5b58\u5169\u500b\u4e0d\u540c\u7684\u503c\uff0c\u53ef\u4ee5\u547c\u53eb <code class=\"language-javascript\">useState()</code> \u5169\u6b21\u3002\uff09</p>\n<p><strong><code class=\"language-javascript\">useState</code> \u56de\u50b3\u4e86\u4ec0\u9ebc\uff1f</strong>\u5b83\u56de\u50b3\u4e86\u4e00\u5c0d\u503c\uff1a\u76ee\u524d\u7684 state \u8ddf\u4e00\u500b\u53ef\u4ee5\u66f4\u65b0 state \u7684 function\u3002\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u6211\u5011\u5beb <code class=\"language-javascript\">const [count, setCount] = useState()</code> \u7684\u539f\u56e0\u3002\u9664\u4e86\u4f60\u662f\u76f4\u63a5\u62ff\u5230\u4e00\u5c0d\uff0c\u9019\u8ddf class \u4e2d\u7684 <code class=\"language-javascript\">this.state.count</code> \u548c <code class=\"language-javascript\">this.setState</code> \u5f88\u985e\u4f3c\u3002\u5982\u679c\u4f60\u5c0d\u6211\u5011\u7528\u7684\u8a9e\u6cd5\u4e0d\u719f\u6089\uff0c\u6211\u5011\u7a0d\u5f8c\u6703\u5728<a href=\"/react/hooks-state#tip-what-do-square-brackets-mean\">\u672c\u9801\u7684\u5e95\u90e8</a>\u8a0e\u8ad6\u5b83\u3002</p>\n<p>\u73fe\u5728\u6211\u5011\u77e5\u9053 <code class=\"language-javascript\">useState</code> Hook \u505a\u4e86\u4ec0\u9ebc\uff0c\u6211\u5011\u7684\u7bc4\u4f8b\u6703\u770b\u8d77\u4f86\u66f4\u6709\u611f\u89ba\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5ba3\u544a\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\uff0c\u6211\u5011\u7a31\u4f5c\u70ba\u300c\b\bcount\u300d\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>\u6211\u5011\u5ba3\u544a\u4e86\u4e00\u500b\u53eb\u505a <code class=\"language-javascript\">count</code> \u7684 state \u8b8a\u6578\uff0c\u4e26\u5c07\u8d77\u59cb\u503c\u8a2d\u6210\u4e86 <code class=\"language-javascript\">0</code>\u3002React \u5728 re-render \u9593\u6703\u8a18\u4f4f\u76ee\u524d\u7684\u503c\uff0c\u4e26\u5c07\u5b83\u63d0\u4f9b\u7d66\u6211\u5011\u7684 function\u3002\u5982\u679c\u6211\u5011\u9700\u8981\u66f4\u65b0\u76ee\u524d\u7684 <code class=\"language-javascript\">count</code>\uff0c\u6211\u5011\u53ef\u4ee5\u547c\u53eb <code class=\"language-javascript\">setCount</code>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f60\u4e5f\u8a31\u6703\u597d\u5947\uff1a\u70ba\u4ec0\u9ebc <code class=\"language-javascript\">useState</code> \u4e0d\u53eb\u505a <code class=\"language-javascript\">createState</code>\uff1f</p>\n<p>state \u53ea\u6703\u5728\u7b2c\u4e00\u6b21 render \u6642\u88ab\u5efa\u7acb\uff0c\u6240\u4ee5\u300cCreate\u300d\u4e26\u4e0d\u6703\u6bd4\u8f03\u7cbe\u6e96\u3002\u800c\u5728\u5176\u5f8c\u7684 render\uff0c<code class=\"language-javascript\">useState</code> \u53ea\u6703\u7d66\u6211\u5011\u76ee\u524d\u7684 state\u3002\u4e0d\u7136\u9019\u5c31\u4e0d\u53eb\u505a state \u5566\uff01\u53e6\u5916\u9084\u6709\u4e00\u500b\u7406\u7531\uff0c\u70ba\u4ec0\u9ebc Hook <em>\u7e3d\u662f</em>\u4ee5 <code class=\"language-javascript\">use</code> \u8d77\u982d\u3002\u6211\u5011\u7a0d\u5f8c\u6703\u5728 <a href=\"/react/hooks-rules\">Hook \u898f\u5247</a>\u4e2d\u4e86\u89e3\u3002</p>\n</div>\n<h2 id=\"reading-state\"><a class=\"anchor\" href=\"/react/hooks-state#reading-state\"></a>\u8b80\u53d6 State </h2>\n<p>\u5728 class \u4e2d\u6211\u5011\u8981\u986f\u793a\u76ee\u524d\u7684\u8a08\u6578\uff0c\u6211\u5011\u4f7f\u7528 <code class=\"language-javascript\">this.state.count</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5728 function \u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code class=\"language-javascript\">count</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<h2 id=\"updating-state\"><a class=\"anchor\" href=\"/react/hooks-state#updating-state\"></a>\u66f4\u65b0 State </h2>\n<p>\u5728 class \u4e2d\uff0c\u6211\u5011\u9700\u8981\u547c\u53eb <code class=\"language-javascript\">this.setState()</code> \u4f86\u66f4\u65b0 <code class=\"language-javascript\">count</code> state\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    Click me</span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>\u5728 function \u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u6709 <code class=\"language-javascript\">setCount</code> \u548c <code class=\"language-javascript\">count</code> \u8b8a\u6578\uff0c\u6240\u4ee5\u6211\u5011\u4e0d\u9700\u8981 <code class=\"language-javascript\">this</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">    Click me</span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<h2 id=\"recap\"><a class=\"anchor\" href=\"/react/hooks-state#recap\"></a>\u7e3d\u7d50 </h2>\n<p>\u6211\u5011\u4f86<strong>\u4e00\u884c\u4e00\u884c\u7e3d\u7d50\u4e00\u4e0b\u6211\u5011\u5b78\u4e86\u4ec0\u9ebc</strong>\uff0c\u4e26\u78ba\u8a8d\u6211\u5011\u90fd\u61c2\u4e86\u3002</p>\n<!--\n  I'm not proud of this line markup. Please somebody fix this.\n  But if GitHub got away with it for years we can cheat.\n-->\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"> <span class=\"token number\">1</span><span class=\"token operator\">:</span>  <span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n <span class=\"token number\">3</span><span class=\"token operator\">:</span>  <span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token number\">4</span><span class=\"token operator\">:</span>    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span> <span class=\"token number\">5</span><span class=\"token operator\">:</span>\n <span class=\"token number\">6</span><span class=\"token operator\">:</span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n <span class=\"token number\">7</span><span class=\"token operator\">:</span>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\"> 8:        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\"> 9:        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">10:         Click me</span>\n<span class=\"token plain-text\">11:        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">12:      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token number\">13</span><span class=\"token operator\">:</span>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">14</span><span class=\"token operator\">:</span>  <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><strong>\u7b2c\u4e00\u884c\uff1a</strong>\u6211\u5011\u5f9e React \u5f15\u5165 <code class=\"language-javascript\">useState</code> Hook\u3002\u5b83\u8b93\u6211\u5011\u53ef\u4ee5\u5728 function component \u4fdd\u7559 local state\u3002</li>\n<li><strong>\u7b2c\u56db\u884c\uff1a</strong>\u5728 <code class=\"language-javascript\">Example</code> component \u88e1\uff0c\u6211\u5011\u547c\u53eb <code class=\"language-javascript\">useState</code> Hook \u5ba3\u544a\u4e86\u4e00\u500b\u65b0\u7684 state \u8b8a\u6578\u3002\u4e26\u56de\u50b3\u4e86\u4e00\u5c0d\u7531\u6211\u5011\u547d\u540d\u7684\u503c\u3002\u6211\u5011\u5c07\u4ee3\u8868\u9ede\u64ca\u6578\u7684\u8b8a\u6578\u547d\u540d\u70ba <code class=\"language-javascript\">count</code>\u3002\u6211\u5011\u5c07\u8d77\u59cb\u503c\u8a2d\u70ba <code class=\"language-javascript\">0</code> \u4e26\u50b3\u5165 <code class=\"language-javascript\">useState</code> \u7576\u4f5c\u552f\u4e00\u53c3\u6578\u3002\u7b2c\u4e8c\u500b\u56de\u50b3\u7684\u503c\u662f\u500b\u53ef\u4ee5\u66f4\u65b0 <code class=\"language-javascript\">count</code> \u7684 function\uff0c\u6240\u4ee5\u6211\u5011\u547d\u540d\u70ba <code class=\"language-javascript\">setCount</code>\u3002</li>\n<li><strong>\u7b2c\u4e5d\u884c\uff1a</strong>\u7576\u4f7f\u7528\u8005\u9ede\u64ca\uff0c\u6211\u5011\u5c31\u547c\u53eb <code class=\"language-javascript\">setCount</code> \u4e26\u50b3\u5165\u65b0\u7684\u503c\u3002\u7136\u5f8c React \u5c31\u6703 re-render <code class=\"language-javascript\">Example</code> component\uff0c\u4e26\u50b3\u5165\u65b0\u7684 <code class=\"language-javascript\">count</code> \u503c\u3002</li>\n</ul>\n<p>\u5225\u6025\uff01\u4e5f\u8a31\u4f60\u9700\u8981\u597d\u597d\u6d88\u5316\u4e00\u756a\u3002\u5982\u679c\u9084\u662f\u6709\u4e9b\u4e0d\u61c2\uff0c\u4f60\u53ef\u4ee5\u8a66\u8457\u518d\u5c07\u4e0a\u9762\u90a3\u6bb5\u7a0b\u5f0f\u5f9e\u982d\u5230\u5c3e\u770b\u4e00\u4e0b\u3002\u6211\u5011\u4fdd\u8b49\u4e00\u65e6\u4f60\u8a66\u8457\u628a class \u7684 state \u904b\u4f5c\u65b9\u5f0f\u300c\u907a\u5fd8\u300d\uff0c\u9019\u4e00\u5207\u6703\u5408\u7406\u8d77\u4f86\u3002</p>\n<h3 id=\"tip-what-do-square-brackets-mean\"><a class=\"anchor\" href=\"/react/hooks-state#tip-what-do-square-brackets-mean\"></a>\u63d0\u793a\uff1a\u65b9\u62ec\u865f\u4ee3\u8868\u4ec0\u9ebc? </h3>\n<p>\u4f60\u4e5f\u8a31\u6ce8\u610f\u5230\u4e86\uff0c\u7576\u6211\u5011\u5ba3\u544a state \u8b8a\u6578\u6642\u4f7f\u7528\u4e86\u65b9\u62ec\u865f\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u7b49\u865f\u5de6\u908a\u7684\u4e26\u4e0d\u662f React \u7684 API\u3002\u4f60\u53ef\u4ee5\u547d\u540d\u4f60\u81ea\u5df1\u7684 state \u8b8a\u6578\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>fruit<span class=\"token punctuation\">,</span> setFruit<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'banana'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u500b JavaScript \u8a9e\u6cd5\u53eb\u505a<a class=\"external-link\" href=\"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#%E9%99%A3%E5%88%97%E8%A7%A3%E6%A7%8B\">\u9663\u5217\u89e3\u69cb\u8ce6\u503c</a>\u3002\u9019\u4ee3\u8868\u6211\u5011\u5ba3\u544a\u4e86\u5169\u500b\u65b0\u7684\u8b8a\u6578 <code class=\"language-javascript\">fruit</code> \u548c <code class=\"language-javascript\">setFruit</code>\uff0c<code class=\"language-javascript\">fruit</code> \u88ab\u8a2d\u70ba <code class=\"language-javascript\">useState</code> \u56de\u50b3\u7684\u7b2c\u4e00\u500b\u503c\uff0c<code class=\"language-javascript\">setFruit</code> \u5247\u662f\u7b2c\u4e8c\u500b\u3002\u8ddf\u4e0b\u9762\u9019\u6bb5\u7a0b\u5f0f\u76f8\u540c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">var</span> fruitStateVariable <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'banana'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u56de\u50b3\u4e00\u5c0d\u503c</span>\n  <span class=\"token keyword\">var</span> fruit <span class=\"token operator\">=</span> fruitStateVariable<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u7b2c\u4e00\u500b\u503c</span>\n  <span class=\"token keyword\">var</span> setFruit <span class=\"token operator\">=</span> fruitStateVariable<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u7b2c\u4e8c\u500b\u503c</span></code></pre></div>\n<p>\u7576\u6211\u5011\u4f7f\u7528 <code class=\"language-javascript\">useState</code> \u5ba3\u544a state \u8b8a\u6578\uff0c\u4ed6\u6703\u56de\u50b3\u4e00\u5c0d\u5728 array \u88e1\u7684\u503c\u3002\u7b2c\u4e00\u500b\u503c\u662f\u76ee\u524d state \u7684\u503c\uff0c\u7b2c\u4e8c\u500b\u662f\u4e00\u500b\u53ef\u4ee5\u66f4\u65b0 state \u7684 function\u3002\u56e0\u70ba\u5b83\u5011\u6709\u7279\u6b8a\u7684\u610f\u7fa9\uff0c\u53ea\u7528 <code class=\"language-javascript\">[0]</code> \u548c <code class=\"language-javascript\">[1]</code> \u4f86\u5b58\u53d6\u5b83\u5011\u7684\u8a71\u6703\u4ee4\u4eba\u56f0\u60d1\u3002\u6240\u4ee5\u6211\u5011\u4f7f\u7528\u9663\u5217\u89e3\u69cb\u8ce6\u503c\u4f86\u547d\u540d\u5b83\u5011\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f60\u4e5f\u8a31\u6703\u597d\u5947\u65e2\u7136\u6211\u5011\u6c92\u6709\u50b3\u5165\u4efb\u4f55\u6771\u897f\u50cf\u662f <code class=\"language-javascript\">this</code>\uff0cReact \u8981\u600e\u9ebc\u77e5\u9053\u54ea\u500b component \u5c0d\u61c9\u5230\u54ea\u500b <code class=\"language-javascript\">useState</code>\u3002\u6211\u5011\u6703\u5728 FAQ \u7ae0\u7bc0\u89e3\u7b54<a href=\"/react/hooks-faq#how-does-react-associate-hook-calls-with-components\">\u9019\u500b\u554f\u984c</a>\u548c\u5176\u4ed6\u554f\u984c\u3002</p>\n</div>\n<h3 id=\"tip-using-multiple-state-variables\"><a class=\"anchor\" href=\"/react/hooks-state#tip-using-multiple-state-variables\"></a>\u63d0\u793a: \u4f7f\u7528\u591a\u500b State \u8b8a\u6578 </h3>\n<p>\u628a state \u8b8a\u6578\u5ba3\u544a\u6210\u4e00\u5c0d <code class=\"language-javascript\">[something, setSomething]</code> \u540c\u6642\u4e5f\u5f88\u4fbf\u5229\uff0c\u56e0\u70ba\u5982\u679c\u60f3\u8981\u4f7f\u7528\u8d85\u904e\u4e00\u500b state \u8b8a\u6578\uff0c\u9019\u80fd\u8b93\u6211\u5011\u5c0d\u4e0d\u540c\u7684 state \u8b8a\u6578\u6709<em>\u4e0d\u540c</em>\u7684\u547d\u540d</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ExampleWithManyStates</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u5ba3\u544a\u591a\u500b state \u8b8a\u6578\uff01</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>age<span class=\"token punctuation\">,</span> setAge<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>fruit<span class=\"token punctuation\">,</span> setFruit<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'banana'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> setTodos<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'Learn Hooks'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u7684 component \u4e2d\uff0c\u6211\u5011\u7684 local \u8b8a\u6578\u6709 <code class=\"language-javascript\">age</code>\u3001<code class=\"language-javascript\">fruit</code> \u548c <code class=\"language-javascript\">todos</code>\uff0c\u800c\u4e14\u6211\u5011\u53ef\u4ee5\u55ae\u7368\u66f4\u65b0\u5b83\u5011\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">function</span> <span class=\"token function\">handleOrangeClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \u985e\u4f3c\u65bc this.setState({ fruit: 'orange' })</span>\n    <span class=\"token function\">setFruit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'orange'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4f60<strong>\u4e0d\u9700\u8981</strong>\u4f7f\u7528\u5f88\u591a state \u8b8a\u6578\u3002state \u8b8a\u6578\u53ef\u4ee5\u662f object \u6216\u662f array\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u628a\u76f8\u95dc\u7684\u8cc7\u6599\u653e\u5728\u4e00\u8d77\u3002\u7136\u800c\uff0c\u4e0d\u50cf class \u88e1\u7684 <code class=\"language-javascript\">this.setState</code> \u6703\u5408\u4f75\u539f\u672c\u7684 state\uff0c\u9019\u88e1\u66f4\u65b0 state \u8b8a\u6578\u6703\u76f4\u63a5<em>\u53d6\u4ee3</em>\u3002</p>\n<p>\u6211\u5011\u5728 <a href=\"/react/hooks-faq#should-i-use-one-or-many-state-variables\">FAQ \u7ae0\u7bc0</a> \u63d0\u4f9b\u66f4\u591a\u62c6\u5206\u7368\u7acb\u7684 state \u8b8a\u6578\u7684\u5efa\u8b70\u3002</p>\n<h2 id=\"next-steps\"><a class=\"anchor\" href=\"/react/hooks-state#next-steps\"></a>\u4e0b\u4e00\u6b65 </h2>\n<p>\u5728\u9019\u4e00\u9801\uff0c\u6211\u5011\u5b78\u7fd2\u4e86\u5176\u4e2d\u4e00\u500b React \u63d0\u4f9b\u7684 Hook\uff0d<code class=\"language-javascript\">useState</code>\u3002\u6211\u5011\u6709\u6642\u4e5f\u7a31\u5b83\u505a\u300cState Hook\u300d\u3002\u524d\u6240\u672a\u6709\u5730\uff0c\u5b83\u8b93\u6211\u5011\u80fd\u5920\u589e\u52a0 local state \u5230 React function component\uff01</p>\n<p>\u6211\u5011\u540c\u6642\u4e5f\u77ad\u89e3\u4e86\u66f4\u591a\u4ec0\u9ebc\u662f Hook\u3002Hook \u662f\u53ef\u4ee5\u8b93\u4f60\u5728 function component \u4f7f\u7528 React \u5404\u9805\u529f\u80fd\u7684 function\u3002\u9084\u6709\u66f4\u591a Hook \u6211\u5011\u9084\u6c92\u8a8d\u8b58\uff0c\u800c Hook \u7684\u540d\u5b57\u90fd\u6703\u4ee5 <code class=\"language-javascript\">use</code> \u8d77\u982d\u3002</p>\n<p><strong>\u73fe\u5728\u6211\u5011\u7e7c\u7e8c<a href=\"/react/hooks-effect\">\u5b78\u7fd2\u4e0b\u500b Hook\uff1a<code class=\"language-javascript\">useEffect</code></a>\u3002</strong> \u5c31\u50cf class \u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u5b83\u8b93\u4f60\u80fd\u5920\u5728 component \u4f7f\u7528 side effect\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-state.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-state", "nav": ["/react/hooks-overview", "/react/hooks-effect"]}, {"key": "4. \u4f7f\u7528 Effect Hook", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p><em>Effect Hook</em> \u8b93\u4f60\u53ef\u4ee5\u4f7f\u7528 function component \u4e2d\u7684 side effect\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u76f8\u4f3c\u65bc componentDidMount \u548c componentDidUpdate:</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u4f7f\u7528\u700f\u89bd\u5668 API \u66f4\u65b0\u6587\u4ef6\u6a19\u984c</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u7bc4\u4f8b\u57fa\u65bc<a href=\"/react/hooks-state\">\u4e0a\u4e00\u9801\u7684\u8a08\u6578\u5668\u7bc4\u4f8b</a>\uff0c\u4f46\u662f\u6211\u5011\u589e\u52a0\u4e86\u4e00\u500b\u65b0\u7684\u529f\u80fd\uff1a\u6211\u5011\u628a\u7db2\u9801\u6a19\u984c\u8a2d\u5b9a\u70ba\u5305\u542b\u9ede\u64ca\u6b21\u6578\u7684\u81ea\u8a02\u8a0a\u606f\u3002</p>\n<p>\u8cc7\u6599 fetch\u3001\u8a2d\u5b9a subscription\u3001\u6216\u624b\u52d5\u6539\u8b8a React component \u4e2d\u7684 DOM \u90fd\u662f side effect \u7684\u7bc4\u4f8b\u3002\u7121\u8ad6\u4f60\u662f\u5426\u7fd2\u6163\u5c07\u9019\u4e9b\u64cd\u4f5c\u7a31\u70ba\u300cside effect\u300d\uff08\u6216\u7c21\u7a31\u300ceffect\u300d\uff09\uff0c\u4f60\u4e4b\u524d\u53ef\u80fd\u5df2\u7d93\u5728 component \u4e2d\u57f7\u884c\u4e86\u9019\u4e9b\u64cd\u4f5c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u5982\u679c\u4f60\u719f\u6089 React class \u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u628a <code class=\"language-javascript\">useEffect</code> \u8996\u70ba <code class=\"language-javascript\">componentDidMount</code>\uff0c<code class=\"language-javascript\">componentDidUpdate</code> \u548c <code class=\"language-javascript\">componentWillUnmount</code> \u7684\u7d44\u5408\u3002</p>\n</div>\n<p>React component \u6709\u5169\u7a2e\u5e38\u898b\u7684 side effect\uff1a\u4e00\u7a2e\u4e0d\u9700\u8981\u57f7\u884c\u6e05\u9664\uff0c\u53e6\u4e00\u7a2e\u5247\u9700\u8981\u3002\u8b93\u6211\u5011\u4ed4\u7d30\u770b\u770b\u5b83\u5011\u5340\u5225\u3002</p>\n<h2 id=\"effects-without-cleanup\"><a class=\"anchor\" href=\"/react/hooks-effect#effects-without-cleanup\"></a>\u7121\u9700\u6e05\u9664\u7684 Effect </h2>\n<p>\u6709\u6642\u5019\uff0c\u6211\u5011\u5e0c\u671b<strong>\u5728 React \u66f4\u65b0 DOM \u4e4b\u5f8c\u57f7\u884c\u4e00\u4e9b\u984d\u5916\u7684\u7a0b\u5f0f\u78bc\u3002</strong>\u7db2\u8def\u8acb\u6c42\u3001\u624b\u52d5\u8b8a\u66f4 DOM\u3001\u548c logging\uff0c\u5b83\u5011\u90fd\u662f\u7121\u9700\u6e05\u9664 effect \u7684\u5e38\u898b\u7bc4\u4f8b\u3002\u6211\u5011\u4e4b\u6240\u4ee5\u9019\u6a23\u8aaa\uff0c\u662f\u56e0\u70ba\u6211\u5011\u53ef\u4ee5\u57f7\u884c\u5b83\u5011\uff0c\u4e26\u7acb\u5373\u5fd8\u8a18\u5b83\u5011\u3002\u8b93\u6211\u5011\u6bd4\u8f03\u4e00\u4e0b class \u548c Hooks \u5982\u4f55\u8b93\u6211\u5011\u8868\u9054\u9019\u6a23\u7684 side effect\u3002</p>\n<h3 id=\"example-using-classes\"><a class=\"anchor\" href=\"/react/hooks-effect#example-using-classes\"></a>\u4f7f\u7528 Class \u7684\u7bc4\u4f8b </h3>\n<p>\u5728 React class component \u4e2d\uff0c<code class=\"language-javascript\">render</code> \u65b9\u6cd5\u672c\u8eab\u4e0d\u61c9\u8a72\u89f8\u767c side effect\u3002\u9019\u592a\u65e9\u4e86 \u2014 \u6211\u5011\u901a\u5e38\u5e0c\u671b\u5728 React \u66f4\u65b0 DOM <em>\u4e4b\u5f8c</em>\u57f7\u884c\u6211\u5011\u7684 effect\u3002</p>\n<p>\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u5728 React class \u4e2d\uff0c\u6211\u5011\u5c07 side effect \u653e\u5165 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code>\u3002\u56de\u5230\u6211\u5011\u7684\u7bc4\u4f8b\uff0c\u9019\u662f\u4e00\u500b React class component \u7684\u8a08\u6578\u5668\uff0c\u5b83\u5728 React \u5c0d DOM \u9032\u884c\u8b8a\u66f4\u5f8c\u7acb\u5373\u66f4\u65b0\u7db2\u9801\u6a19\u984c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          Click me</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f<strong>\u6211\u5011\u5982\u4f55\u5fc5\u9808\u5728 class \u4e2d\u8907\u88fd\u9019\u5169\u500b\u751f\u547d\u9031\u671f\u65b9\u6cd5\u4e4b\u9593\u7684\u7a0b\u5f0f\u78bc\u3002</strong></p>\n<p>\u9019\u662f\u56e0\u70ba\u5728\u8a31\u591a\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u5e0c\u671b\u57f7\u884c\u76f8\u540c\u7684 side effect\uff0c\u7121\u8ad6 component \u662f\u525b\u88ab mount \u9084\u662f\u5df2\u7d93\u88ab\u66f4\u65b0\u3002\u6982\u5ff5\u4e0a\uff0c\u6211\u5011\u5e0c\u671b\u5b83\u5728\u6bcf\u6b21 render \u4e4b\u5f8c\u767c\u751f \u2014 \u4f46\u662f React class component \u6c92\u6709\u9019\u6a23\u7684\u65b9\u6cd5\u3002\u6211\u5011\u53ef\u4ee5\u63d0\u53d6\u4e00\u500b\u55ae\u7368\u7684\u65b9\u6cd5\uff0c\u4f46\u6211\u5011\u4ecd\u7136\u9700\u8981\u5728\u5169\u500b\u5730\u65b9\u547c\u53eb\u5b83\u3002</p>\n<p>\u73fe\u5728\u4f86\u770b\u770b\u6211\u5011\u53ef\u4ee5\u5982\u4f55\u4f7f\u7528 <code class=\"language-javascript\">useEffect</code> Hook \u505a\u540c\u6a23\u7684\u4e8b\u60c5\u3002</p>\n<h3 id=\"example-using-hooks\"><a class=\"anchor\" href=\"/react/hooks-effect#example-using-hooks\"></a>\u4f7f\u7528 Hook \u7684\u7bc4\u4f8b </h3>\n<p>\u6211\u5011\u5df2\u7d93\u5728\u672c\u9801\u9802\u90e8\u770b\u5230\u4e86\u9019\u500b\u7bc4\u4f8b\uff0c\u4f46\u8b93\u6211\u5011\u4f86\u4ed4\u7d30\u770b\u770b\u5b83\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Click me</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><code class=\"language-javascript\">useEffect</code> \u6709\u4ec0\u9ebc\u4f5c\u7528\uff1f</strong> \u900f\u904e\u4f7f\u7528\u9019\u500b Hook\uff0c\u4f60\u544a\u8a34 React \u4f60\u7684 component \u9700\u8981\u5728 render \u5f8c\u505a\u4e00\u4e9b\u4e8b\u60c5\u3002React \u5c07\u8a18\u4f4f\u4f60\u50b3\u905e\u7684 function\uff08\u6211\u5011\u5c07\u5176\u7a31\u70ba\u300ceffect\u300d\uff09\uff0c\u4e26\u5728\u57f7\u884c DOM \u66f4\u65b0\u4e4b\u5f8c\u547c\u53eb\u5b83\u3002 \u5728\u9019\u500b effect \u4e2d\uff0c\u6211\u5011\u8a2d\u5b9a\u4e86\u7db2\u9801\u7684\u6a19\u984c\uff0c\u4f46\u6211\u5011\u4e5f\u53ef\u4ee5\u57f7\u884c\u8cc7\u6599\u63d0\u53d6\u6216\u547c\u53eb\u5176\u4ed6\u547d\u4ee4\u5f0f API\u3002</p>\n<p><strong>\u70ba\u4ec0\u9ebc\u5728 component \u5167\u90e8\u547c\u53eb <code class=\"language-javascript\">useEffect</code>\uff1f</strong> \u5728 component \u4e2d\u653e\u7f6e <code class=\"language-javascript\">useEffect</code> \u8b93\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u5f9e effect \u4e2d\u5b58\u53d6 <code class=\"language-javascript\">count</code> state \u8b8a\u6578\uff08\u6216\u4efb\u4f55 props\uff09\u3002\u6211\u5011\u4e0d\u9700\u8981\u7279\u6b8a\u7684 API \u4f86\u8b80\u53d6\u5b83 \u2014 \u5b83\u5df2\u7d93\u5728 function \u7bc4\u570d\u5167\u4e86\u3002 Hook \u64c1\u62b1 JavaScript closure\uff0c\u4e26\u907f\u514d\u5728 JavaScript \u5df2\u7d93\u63d0\u4f9b\u89e3\u6c7a\u65b9\u6848\u7684\u60c5\u6cc1\u4e0b\u5f15\u5165 React \u7279\u5b9a\u7684 API\u3002</p>\n<p><strong>\u6bcf\u6b21 render \u5f8c\u90fd\u6703\u57f7\u884c <code class=\"language-javascript\">useEffect</code> \u55ce\uff1f</strong> \u662f\u7684\uff01\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5728\u7b2c\u4e00\u500b render <em>\u548c</em>\u96a8\u5f8c\u6bcf\u4e00\u500b\u66f4\u65b0\u4e4b\u5f8c\u57f7\u884c\u3002\uff08\u6211\u5011\u7a0d\u5f8c\u6703\u8ac7\u5230<a href=\"/react/hooks-effect#tip-optimizing-performance-by-skipping-effects\">\u5982\u4f55\u81ea\u5b9a\u7fa9</a>\u3002\uff09\u4f60\u53ef\u80fd\u6703\u767c\u73fe\u628a effect \u60f3\u6210\u767c\u751f\u5728\u300crender \u4e4b\u5f8c\u300d\u66f4\u70ba\u5bb9\u6613\uff0c\u800c\u4e0d\u662f\u8003\u616e\u300cmount\u300d\u548c\u300c\u66f4\u65b0\u300d\u3002 React \u4fdd\u8b49 DOM \u5728\u57f7\u884c effect \u6642\u5df2\u88ab\u66f4\u65b0\u3002</p>\n<h3 id=\"detailed-explanation\"><a class=\"anchor\" href=\"/react/hooks-effect#detailed-explanation\"></a>\u8a73\u7d30\u8aaa\u660e </h3>\n<p>\u73fe\u5728\u6211\u5011\u5c0d effect \u6709\u4e86\u66f4\u591a\u7684\u4e86\u89e3\uff0c\u61c9\u8a72\u53ef\u4ee5\u7406\u89e3\u9019\u5e7e\u884c\u7a0b\u5f0f\u78bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u5ba3\u544a <code class=\"language-javascript\">count</code> state \u8b8a\u6578\uff0c\u7136\u5f8c\u544a\u8a34 React \u6211\u5011\u9700\u8981\u4f7f\u7528\u4e00\u500b effect\u3002\u6211\u5011\u5c07\u4e00\u500b function \u50b3\u5165\u7d66 <code class=\"language-javascript\">useEffect</code> Hook\u3002\u6211\u5011\u50b3\u5165\u7684\u9019\u500b function <em>\u5c31\u662f</em>\u6211\u5011\u7684 effect\u3002\u5728 effect \u5167\u90e8\uff0c\u6211\u5011\u4f7f\u7528\u700f\u89bd\u5668 API <code class=\"language-javascript\">document.title</code> \u8a2d\u5b9a\u4e86\u7db2\u9801\u6a19\u984c\u3002\u6211\u5011\u53ef\u4ee5\u8b80\u53d6 effect \u4e2d\u6700\u65b0\u7684 <code class=\"language-javascript\">count</code>\uff0c\u56e0\u70ba\u5b83\u5728\u6211\u5011 function \u7684\u7bc4\u570d\u5167\u3002\u7576 React render \u6211\u5011\u7684 component \u6642\uff0c\u5b83\u6703\u8a18\u4f4f\u6211\u5011\u4f7f\u7528\u7684 effect\uff0c\u7136\u5f8c\u5728\u66f4\u65b0 DOM \u5f8c\u57f7\u884c\u6211\u5011\u7684 effect\u3002\u6bcf\u6b21 render \u90fd\u662f\u9019\u6a23\uff0c\u5305\u62ec\u7b2c\u4e00\u6b21\u3002</p>\n<p>\u6709\u7d93\u9a57\u7684 JavaScript \u958b\u767c\u4eba\u54e1\u53ef\u80fd\u6703\u6ce8\u610f\u5230\uff0c\u50b3\u905e\u7d66 <code class=\"language-javascript\">useEffect</code> \u7684 function \u5728\u6bcf\u6b21 render \u6642\u90fd\u6703\u6709\u6240\u4e0d\u540c\u3002\u9019\u662f\u523b\u610f\u7684\u3002\u5be6\u969b\u4e0a\uff0c\u9019\u662f\u8b93\u6211\u5011\u53ef\u4ee5\u5f9e effect \u5167\u90e8\u8b80\u53d6 <code class=\"language-javascript\">count</code> \u6578\u503c\uff0c\u4e14\u4e0d\u5fc5\u64d4\u5fc3\u6578\u503c\u904e\u6642\u7684\u539f\u56e0\u3002\u6bcf\u6b21\u91cd\u65b0 render \u6642\uff0c\u6211\u5011\u90fd\u6703\u5b89\u6392\u4e00\u500b <em>different</em> effect \u4f86\u66ff\u4ee3\u4e0a\u4e00\u500b\u3002\u5728\u67d0\u7a2e\u7a0b\u5ea6\u4e0a\uff0c\u9019\u4f7f effect \u7684\u884c\u70ba\u66f4\u50cf\u662f render \u7d50\u679c\u7684\u4e00\u90e8\u5206 \u2014 \u6bcf\u500b effect \u90fd\u300c\u5c6c\u65bc\u300d\u7279\u5b9a\u7684 render\u3002\u6211\u5011\u5c07<a href=\"/react/hooks-effect#explanation-why-effects-run-on-each-update\">\u5728\u672c\u9801\u7a0d\u5f8c</a>\u66f4\u6e05\u695a\u5730\u770b\u5230\u70ba\u4ec0\u9ebc\u9019\u5f88\u6709\u7528\u3002</p>\n<div class=\"blockquote\">\n<strong>\u63d0\u793a</strong>\n<p>\u8207 <code class=\"language-javascript\">componentDidMount</code> \u6216 <code class=\"language-javascript\">componentDidUpdate</code> \u4e0d\u540c\uff0c\u4f7f\u7528 <code class=\"language-javascript\">useEffect</code> \u5b89\u6392\u7684 effect \u4e0d\u6703\u963b\u6b62\u700f\u89bd\u5668\u66f4\u65b0\u87a2\u5e55\u3002\u9019\u4f7f\u4f60\u7684\u61c9\u7528\u7a0b\u5f0f\u611f\u89ba\u8d77\u4f86\u97ff\u61c9\u66f4\u5feb\u3002\u5927\u591a\u6578 effect \u4e0d\u9700\u8981\u540c\u6b65\u767c\u751f\u3002\u5728\u5c11\u898b\u7684\u9700\u8981\u540c\u6b65\u767c\u751f\u7684\u60c5\u6cc1\u4e0b\uff08\u4f8b\u5982\u6e2c\u91cf layout\uff09\uff0c\u6709\u53e6\u5916\u4e00\u500b <a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a> Hook\uff0c\u5b83\u7684 API \u8207 <code class=\"language-javascript\">useEffect</code> \u76f8\u540c\u3002</p>\n</div>\n<h2 id=\"effects-with-cleanup\"><a class=\"anchor\" href=\"/react/hooks-effect#effects-with-cleanup\"></a>\u9700\u8981\u6e05\u9664\u7684 Effect </h2>\n<p>\u5148\u524d\uff0c\u6211\u5011\u7406\u89e3\u4e86\u600e\u6a23\u8868\u9054\u4e0d\u9700\u8981\u4efb\u4f55\u6e05\u9664\u7684 side effect\u3002\u4f46\u662f\uff0c\u6709\u4e9b effect \u9700\u8981\u3002\u4f8b\u5982\uff0c<strong>\u6211\u5011\u53ef\u80fd\u60f3\u8981\u8a2d\u5b9a</strong>\u5c0d\u67d0\u4e9b\u5916\u90e8\u8cc7\u6599\u4f86\u6e90\u7684 subscription\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8acb\u52d9\u5fc5\u9032\u884c\u6e05\u9664\uff0c\u4ee5\u514d\u9020\u6210 memory leak\uff01\u8b93\u6211\u5011\u6bd4\u8f03\u4e00\u4e0b\u6211\u5011\u53ef\u4ee5\u5982\u4f55\u7528 class \u548c Hook \u505a\u5230\u9019\u4e00\u9ede\u3002</p>\n<h3 id=\"example-using-classes-1\"><a class=\"anchor\" href=\"/react/hooks-effect#example-using-classes-1\"></a>\u4f7f\u7528 Class \u7684\u7bc4\u4f8b </h3>\n<p>\u5728 React class \u4e2d\uff0c\u4f60\u901a\u5e38\u6703\u5728 <code class=\"language-javascript\">componentDidMount</code> \u4e2d\u8a2d\u5b9a\u4e00\u500b subscription\uff0c\u7136\u5f8c\u5728 <code class=\"language-javascript\">componentWillUnmount</code> \u4e2d\u628a\u5b83\u6e05\u9664\u3002\u4f8b\u5982\uff0c\u5047\u8a2d\u6211\u5011\u6709\u4e00\u500b <code class=\"language-javascript\">ChatAPI</code> module \u53ef\u8b93\u6211\u5011\u8a02\u95b1\u670b\u53cb\u7684\u7dda\u4e0a\u72c0\u614b\u3002\u6211\u5011\u53ef\u80fd\u6703\u9019\u6a23\u7528 class \u4f86\u8a02\u95b1\u548c\u986f\u793a\u8a72\u72c0\u614b\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">FriendStatus</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">isOnline</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">isOnline</span><span class=\"token operator\">:</span> status<span class=\"token punctuation\">.</span>isOnline</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8acb\u6ce8\u610f <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentWillUnmount</code> \u9700\u8981\u5982\u4f55\u76f8\u4e92\u547c\u61c9\u3002\u751f\u547d\u9031\u671f\u65b9\u6cd5\u8feb\u4f7f\u6211\u5011\u62c6\u958b\u9019\u500b\u908f\u8f2f\uff0c\u5373\u4f7f\u6982\u5ff5\u4e0a\u5b83\u5011\u7684\u7a0b\u5f0f\u78bc\u90fd\u8207\u540c\u4e00\u500b effect \u76f8\u95dc\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u654f\u92b3\u7684\u8b80\u8005\u53ef\u80fd\u6703\u6ce8\u610f\u5230\uff0c\u8981\u505a\u5230\u5b8c\u5168\u6b63\u78ba\uff0c\u9019\u500b\u7bc4\u4f8b\u9084\u9700\u8981 <code class=\"language-javascript\">componentDidUpdate</code>\u3002\u6211\u5011\u73fe\u5728\u5c07\u66ab\u6642\u5ffd\u7565\u9019\u4e00\u9ede\uff0c\u4f46\u5728\u9019\u9801\u7684<a href=\"/react/hooks-effect#explanation-why-effects-run-on-each-update\">\u7a0d\u5f8c\u90e8\u5206</a>\u6211\u5011\u6703\u518d\u6b21\u8a0e\u8ad6\u9019\u9ede\u3002</p>\n</div>\n<h3 id=\"example-using-hooks-1\"><a class=\"anchor\" href=\"/react/hooks-effect#example-using-hooks-1\"></a>\u4f7f\u7528 Hook \u7684\u7bc4\u4f8b </h3>\n<p>\u8b93\u6211\u5011\u770b\u770b\u5982\u4f55\u4f7f\u7528 Hook \u64b0\u5beb\u9019\u500b component\u3002</p>\n<p>\u4f60\u53ef\u80fd\u6703\u8a8d\u70ba\u6211\u5011\u9700\u8981\u4e00\u500b\u55ae\u7368\u7684 effect \u4f86\u57f7\u884c\u6e05\u9664\u3002\u4f46\u662f\u65b0\u589e\u548c\u79fb\u9664 subscription \u7684\u7a0b\u5f0f\u78bc\u7dca\u5bc6\u76f8\u95dc\uff0c\u56e0\u6b64 <code class=\"language-javascript\">useEffect</code> \u7684\u8a2d\u8a08\u5728\u5c07\u5176\u4fdd\u6301\u5728\u4e00\u8d77\u3002\u5982\u679c\u4f60\u7684 effect \u56de\u50b3\u4e86\u4e00\u500b function\uff0cReact \u5c07\u5728\u9700\u8981\u6e05\u9664\u6642\u57f7\u884c\u5b83\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u6307\u5b9a\u5982\u4f55\u5728\u9019\u500b effect \u4e4b\u5f8c\u57f7\u884c\u6e05\u9664\uff1a</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">cleanup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u70ba\u4ec0\u9ebc\u6211\u5011\u5f9e effect \u4e2d\u56de\u50b3\u4e00\u500b function\uff1f</strong> \u9019\u662f effect \u7684\u53ef\u9078\u6e05\u9664\u6a5f\u5236\u3002\u6bcf\u500b effect \u90fd\u53ef\u4ee5\u56de\u50b3\u4e00\u500b\u6703\u5728\u5b83\u4e4b\u5f8c\u57f7\u884c\u6e05\u9664\u7684 function\u3002\u9019\u4f7f\u6211\u5011\u53ef\u4ee5\u628a\u65b0\u589e\u548c\u79fb\u9664 subscription \u7684\u908f\u8f2f\u5f7c\u6b64\u4fdd\u6301\u9760\u8fd1\u3002\u5b83\u5011\u90fd\u5c6c\u65bc\u540c\u4e00\u500b effect\uff01</p>\n<p><strong>React \u5230\u5e95\u4ec0\u9ebc\u6642\u5019\u6703\u6e05\u9664 effect\uff1f</strong> \u5728 component unmount \u6642\uff0cReact \u6703\u57f7\u884c\u6e05\u9664\u3002\u4f46\u662f\uff0c\u6b63\u5982\u6211\u5011\u4e4b\u524d\u770b\u5230\u7684\uff0ceffect \u6703\u5728\u6bcf\u500b render \u4e2d\u57f7\u884c\uff0c\u800c\u4e0d\u50c5\u50c5\u662f\u4e00\u6b21\u3002\u9019\u662f\u70ba\u4ec0\u9ebc React <em>\u9084</em>\u53ef\u4ee5\u5728\u4e0b\u6b21\u57f7\u884c effect \u4e4b\u524d\u6e05\u9664\u524d\u4e00\u500b render \u7684 effect \u7684\u539f\u56e0\u3002\u6211\u5011\u6703\u5728\u4e0b\u9762\u8a0e\u8ad6<a href=\"/react/hooks-effect#explanation-why-effects-run-on-each-update\">\u70ba\u4ec0\u9ebc\u9019\u6709\u52a9\u65bc\u907f\u514d bug</a> \u4ee5\u53ca<a href=\"/react/hooks-effect#tip-optimizing-performance-by-skipping-effects\">\u5982\u679c\u51fa\u73fe\u6548\u80fd\u554f\u984c\uff0c\u5982\u4f55\u9078\u64c7\u9000\u51fa\u6b64\u884c\u70ba</a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u6211\u5011\u4e0d\u5fc5\u5f9e effect \u4e2d\u56de\u50b3\u547d\u540d\u4e86\u7684 function\u3002\u6211\u5011\u5728\u9019\u88e1\u5c07\u5176\u7a31\u70ba <code class=\"language-javascript\">cleanup</code> \u4ee5\u660e\u78ba\u5b83\u7684\u76ee\u7684\uff0c\u4f46\u662f\u4f60\u53ef\u4ee5\u56de\u50b3 arrow function \u6216\u8005\u53eb\u5b83\u5225\u7684\u540d\u5b57\u3002</p>\n</div>\n<h2 id=\"recap\"><a class=\"anchor\" href=\"/react/hooks-effect#recap\"></a>\u7e3d\u7d50 </h2>\n<p>\u6211\u5011\u770b\u5230\u4e86 <code class=\"language-javascript\">useEffect</code> \u53ef\u4ee5\u8b93\u6211\u5011\u5728 component render \u5f8c\u8868\u9054\u4e0d\u540c\u985e\u578b\u7684 side effect\u3002\u67d0\u4e9b effect \u53ef\u80fd\u9700\u8981\u9032\u884c\u6e05\u9664\uff0c\u56e0\u6b64\u5b83\u5011\u56de\u50b3\u4e00\u500b function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5176\u4ed6 effect \u53ef\u80fd\u6c92\u6709\u6e05\u9664\u7684\u968e\u6bb5\uff0c\u4e26\u4e14\u4e0d\u56de\u50b3\u4efb\u4f55\u5167\u5bb9\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Effect Hook \u901a\u904e\u55ae\u500b API \u7d71\u4e00\u4e86\u9019\u5169\u7a2e\u4f7f\u7528\u60c5\u5883\u3002</p>\n\n<p><strong>\u5982\u679c\u4f60\u5c0d Effect Hook \u7684\u57f7\u884c\u65b9\u5f0f\u6709\u4e0d\u932f\u7684\u7406\u89e3\uff0c\u6216\u8005\u611f\u5230\u4e0d\u77e5\u6240\u63aa\uff0c\u4f60\u53ef\u4ee5\u7acb\u5373\u8df3\u5230<a href=\"/react/hooks-rules\">\u4e0b\u4e00\u9801\u6709\u95dc Hook \u7684\u898f\u5247</a>\u3002</strong></p>\n\n<h2 id=\"tips-for-using-effects\"><a class=\"anchor\" href=\"/react/hooks-effect#tips-for-using-effects\"></a>\u4f7f\u7528 Effect \u7684\u63d0\u793a </h2>\n<p>\u6211\u5011\u5c07\u5728\u9019\u4e00\u9801\u7e7c\u7e8c\u6df1\u5165\u7814\u7a76 <code class=\"language-javascript\">useEffect</code> \u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u6709\u7d93\u9a57\u7684 React \u4f7f\u7528\u8005\u53ef\u80fd\u6703\u5c0d\u9019\u4e9b\u611f\u5230\u597d\u5947\u3002\u4e0d\u8981\u89ba\u5f97\u73fe\u5728\u4e00\u5b9a\u8981\u53bb\u7814\u7a76\u5b83\u5011\u3002\u4f60\u53ef\u4ee5\u96a8\u6642\u56de\u4f86\u6b64\u9801\u9762\u4f86\u4e86\u89e3\u6709\u95dc Effect Hook \u7684\u66f4\u591a\u8a73\u7d30\u8cc7\u8a0a\u3002</p>\n<h3 id=\"tip-use-multiple-effects-to-separate-concerns\"><a class=\"anchor\" href=\"/react/hooks-effect#tip-use-multiple-effects-to-separate-concerns\"></a>\u63d0\u793a: \u4f7f\u7528\u591a\u500b Effect \u4f86\u5206\u96e2\u95dc\u6ce8\u9ede </h3>\n<p>\u5c0d\u65bc Hook\uff0c\u6211\u5011\u5728<a href=\"/react/hooks-intro#complex-components-become-hard-to-understand\">\u52d5\u6a5f</a>\u4e2d\u6982\u8ff0\u7684\u554f\u984c\u4e4b\u4e00\u662f class \u751f\u547d\u9031\u671f\u65b9\u6cd5\u901a\u5e38\u5305\u542b\u4e0d\u76f8\u95dc\u7684\u908f\u8f2f\uff0c\u4f46\u662f\u76f8\u95dc\u7684\u908f\u8f2f\u537b\u88ab\u5206\u6210\u4e86\u5e7e\u500b\u65b9\u6cd5\u3002\u9019\u662f\u4e00\u500b\u7d50\u5408\u4e86\u524d\u9762\u7bc4\u4f8b\u4e2d\u7684\u8a08\u6578\u5668\u548c\u597d\u53cb\u72c0\u614b\u6307\u793a\u5668\u908f\u8f2f\u7684 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">FriendStatusWithCounter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">isOnline</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">isOnline</span><span class=\"token operator\">:</span> status<span class=\"token punctuation\">.</span>isOnline\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u6ce8\u610f\u8a2d\u5b9a <code class=\"language-javascript\">document.title</code> \u7684\u908f\u8f2f\u662f\u5982\u4f55\u5728 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code> \u4e4b\u9593\u5206\u914d\u7684\u3002subscription \u7684\u908f\u8f2f\u4e5f\u5206\u4f48\u5728 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentWillUnmount</code> \u4e4b\u9593\u3002\u800c\u4e14 <code class=\"language-javascript\">componentDidMount</code> \u5305\u542b\u4e86\u5169\u500b\u5de5\u4f5c\u7684\u7a0b\u5f0f\u78bc\u3002</p>\n<p>\u90a3\u9ebc\uff0cHook \u53ef\u4ee5\u600e\u9ebc\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff1f\u5c31\u50cf<a href=\"/react/hooks-state#tip-using-multiple-state-variables\">\u4f60\u53ef\u4ee5\u591a\u6b21\u4f7f\u7528 <em>State</em> Hook</a>\uff0c\u4f60\u540c\u6a23\u53ef\u4ee5\u7528\u591a\u500b effect\u3002\u9019\u4f7f\u6211\u5011\u53ef\u4ee5\u5c07\u7121\u95dc\u7684\u908f\u8f2f\u5206\u70ba\u4e0d\u540c\u7684 effect\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatusWithCounter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Hook \u8b93\u6211\u5011\u6839\u64da\u7a0b\u5f0f\u78bc\u7684\u4f5c\u7528\u4f86\u62c6\u5206\u7a0b\u5f0f\u78bc</strong>\uff0c\u800c\u4e0d\u662f\u7528\u751f\u547d\u9031\u671f\u65b9\u6cd5\u7684\u540d\u5b57\u3002React \u5c07\u6309\u7167\u6307\u5b9a\u7684\u9806\u5e8f\u57f7\u884c component \u6240\u4f7f\u7528\u7684<em>\u6bcf\u4e00\u500b</em> effect\u3002</p>\n<h3 id=\"explanation-why-effects-run-on-each-update\"><a class=\"anchor\" href=\"/react/hooks-effect#explanation-why-effects-run-on-each-update\"></a>\u89e3\u91cb\uff1a\u70ba\u4ec0\u9ebc Effect \u5728\u6bcf\u6b21\u66f4\u65b0\u6642\u57f7\u884c </h3>\n<p>\u5982\u679c\u4f60\u7fd2\u6163\u4e86 class\uff0c\u90a3\u9ebc\u4f60\u53ef\u80fd\u60f3\u77e5\u9053\u70ba\u4ec0\u9ebc effect \u7684\u6e05\u9664\u968e\u6bb5\u6703\u5728\u6bcf\u6b21\u91cd\u65b0 render \u5f8c\u767c\u751f\uff0c\u800c\u4e0d\u50c5\u50c5\u662f\u5728 unmounting \u904e\u7a0b\u4e2d\u767c\u751f\u4e00\u6b21\u3002\u8b93\u6211\u5011\u770b\u4e00\u500b\u5be6\u969b\u7684\u7bc4\u4f8b\uff0c\u770b\u770b\u70ba\u4ec0\u9ebc\u9019\u7a2e\u8a2d\u8a08\u53ef\u4ee5\u5e6b\u6211\u5011\u5beb\u51fa bug \u66f4\u5c11\u7684 component\u3002</p>\n<p>\u5728<a href=\"/react/hooks-effect#example-using-classes-1\">\u672c\u9801\u524d\u9762</a>\uff0c\u6211\u5011\u4ecb\u7d39\u4e86\u4e00\u500b <code class=\"language-javascript\">FriendStatus</code> component \u7684\u7bc4\u4f8b\uff0c\u9019\u500b component \u986f\u793a\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\u3002\u6211\u5011\u7684 class \u5f9e <code class=\"language-javascript\">this.props</code> \u4e2d\u6293\u53d6 <code class=\"language-javascript\">friend.id</code>\uff0c\u5728 component mount \u5f8c\u8a02\u95b1\u597d\u53cb\u72c0\u614b\uff0c\u4e26\u5728 unmount \u671f\u9593\u53d6\u6d88\u8a02\u95b1\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u4f46\u662f\u5982\u679c component \u986f\u793a\u5728\u87a2\u5e55\u4e0a\u6642\uff0c<code class=\"language-javascript\">friend</code> prop \u767c\u751f\u8b8a\u5316</strong>\uff0c\u6703\u767c\u751f\u4ec0\u9ebc\u5462\uff1f\u6211\u5011\u7684 component \u5c07\u7e7c\u7e8c\u986f\u793a\u5176\u4ed6\u597d\u53cb\u7684\u7dda\u4e0a\u72c0\u614b\u3002\u9019\u662f\u4e00\u500b bug\u3002Unmount \u6642\uff0c\u7531\u65bc\u53d6\u6d88\u8a02\u95b1\u7684\u547c\u53eb\u6703\u4f7f\u7528\u932f\u8aa4\u7684\u670b\u53cb ID\uff0c\u56e0\u6b64\u4e5f\u6703\u5c0e\u81f4 memory leak \u6216 crash\u3002</p>\n<p>\u5728 class component \u4e2d\uff0c\u6211\u5011\u9700\u8981\u52a0\u5165 <code class=\"language-javascript\">componentDidUpdate</code> \u4f86\u8655\u7406\u9019\u7a2e\u60c5\u6cc1\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u5f9e\u5148\u524d\u7684 friend.id \u53d6\u6d88\u8a02\u95b1</span></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      prevProps<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u8a02\u95b1\u4e0b\u4e00\u500b friend.id</span></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleStatusChange\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5fd8\u8a18\u6b63\u78ba\u8655\u7406 <code class=\"language-javascript\">componentDidUpdate</code> \u662f React \u61c9\u7528\u7a0b\u5f0f\u4e2d\u5e38\u898b\u7684 bug \u4f86\u6e90\u3002</p>\n<p>\u73fe\u5728\u8003\u616e\u9019\u500b\u4f7f\u7528 Hook \u7684 component \u7248\u672c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5b83\u6c92\u6709\u53d7\u9019\u500b bug \u7684\u56f0\u64fe\u3002\uff08\u4f46\u6211\u5011\u4e5f\u6c92\u6709\u5c0d\u5b83\u9032\u884c\u4efb\u4f55\u66f4\u6539\u3002\uff09</p>\n<p>\u56e0\u70ba <code class=\"language-javascript\">useEffect</code> \u6703<em>\u9810\u8a2d</em>\u8655\u7406\u66f4\u65b0\uff0c\u6240\u4ee5\u6c92\u6709\u5c08\u9580\u7528\u65bc\u8655\u7406\u66f4\u65b0\u7684\u7a0b\u5f0f\u78bc\u3002\u5728\u61c9\u7528\u4e0b\u4e00\u500b effect \u4e4b\u524d\uff0c\u5b83\u5c07\u6e05\u9664\u4e4b\u524d\u7684 effect\u3002\u70ba\u4e86\u8aaa\u660e\u9019\u4e00\u9ede\uff0c\u4e0b\u9762\u662f\u9019\u500b component \u96a8\u6642\u9593\u63a8\u79fb\u53ef\u80fd\u7522\u751f\u7684\u4e00\u7cfb\u5217\u8a02\u95b1\u548c\u53d6\u6d88\u8a02\u95b1\u7684\u547c\u53eb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// Mount with { friend: { id: 100 } } props</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// \u57f7\u884c\u7b2c\u4e00\u500b effect</span>\n\n<span class=\"token comment\">// Update with { friend: { id: 200 } } props</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u6e05\u9664\u524d\u4e00\u500b effect</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// \u57f7\u884c\u4e0b\u4e00\u500b effect</span>\n\n<span class=\"token comment\">// Update with { friend: { id: 300 } } props</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u6e05\u9664\u524d\u4e00\u500b effect</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// \u57f7\u884c\u4e0b\u4e00\u500b effect</span>\n\n<span class=\"token comment\">// Unmount</span>\nChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u6e05\u9664\u6700\u5f8c\u4e00\u500b effect</span></code></pre></div>\n<p>\u6b64\u884c\u70ba\u9810\u8a2d\u78ba\u4fdd\u7a0b\u5f0f\u78bc\u4e00\u81f4\u6027\uff0c\u4e26\u9632\u6b62 class component \u4e2d\u5e38\u898b\u7684\u7531\u65bc\u7f3a\u5c11\u66f4\u65b0\u908f\u8f2f\u800c\u5c0e\u81f4\u7684 bug\u3002</p>\n<h3 id=\"tip-optimizing-performance-by-skipping-effects\"><a class=\"anchor\" href=\"/react/hooks-effect#tip-optimizing-performance-by-skipping-effects\"></a>\u63d0\u793a\uff1a\u901a\u904e\u5ffd\u7565 Effect \u4f86\u6700\u4f73\u5316\u6548\u80fd </h3>\n<p>\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u6b21 render \u5f8c\u6e05\u9664\u6216\u57f7\u884c effect \u53ef\u80fd\u6703\u5c0e\u81f4\u6548\u80fd\u554f\u984c\u3002\u5728 class component \u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u901a\u904e\u5728 <code class=\"language-javascript\">componentDidUpdate</code> \u5167\u90e8\u7684 <code class=\"language-javascript\">prevProps</code> \u6216 <code class=\"language-javascript\">prevState</code> \u64b0\u5beb\u4e00\u500b\u984d\u5916\u7684\u6bd4\u5c0d\u689d\u4ef6\u4f86\u89e3\u6c7a\u6b64\u554f\u984c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">.</span>count <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u8981\u6c42\u5f88\u5e38\u898b\uff0c\u6240\u4ee5\u5df2\u5167\u5efa\u5728 <code class=\"language-javascript\">useEffect</code> \u7684 Hook API \u4e2d\u3002\u5982\u679c\u5728\u91cd\u65b0 render \u4e4b\u9593\u67d0\u4e9b\u503c\u6c92\u6709\u6539\u8b8a\uff0c\u4f60\u53ef\u4ee5\u8b93 React \u5ffd\u7565 effect\u3002\u70ba\u6b64\uff0c\u8acb\u5c07 array \u4f5c\u70ba\u53ef\u9078\u7684\u7b2c\u4e8c\u500b\u53c3\u6578\u50b3\u905e\u7d66 <code class=\"language-javascript\">useEffect</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u50c5\u5728\u8a08\u6578\u66f4\u6539\u6642\u624d\u91cd\u65b0\u57f7\u884c effect</span></span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07 <code class=\"language-javascript\">[count]</code> \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u50b3\u905e\u3002\u9019\u662f\u4ec0\u9ebc\u610f\u601d\uff1f\u5982\u679c <code class=\"language-javascript\">count</code> \u662f <code class=\"language-javascript\">5</code>\uff0c\u7136\u5f8c\u6211\u5011\u7684 component \u91cd\u65b0 render\uff0c<code class=\"language-javascript\">count</code> \u4ecd\u7136\u7b49\u65bc <code class=\"language-javascript\">5</code>\uff0cReact \u5c07\u6bd4\u5c0d\u524d\u4e00\u500b render \u7684 <code class=\"language-javascript\">[5]</code> \u548c\u4e0b\u4e00\u500b render \u7684 <code class=\"language-javascript\">[5]</code>\u3002\u56e0\u70ba array \u4e2d\u7684\u6bcf\u4e00\u9805\u90fd\u76f8\u540c\uff08<code class=\"language-javascript\">5 === 5</code>\uff09\uff0c\u6240\u4ee5 React \u5c07\u5ffd\u7565\u9019\u500b effect\u3002\u90a3\u5c31\u662f\u6211\u5011\u7684\u6700\u4f73\u5316\u3002</p>\n<p>\u7576\u6211\u5011 render \u6642\u5c07 <code class=\"language-javascript\">count</code> \u66f4\u65b0\u70ba <code class=\"language-javascript\">6</code>\uff0cReact \u5c07\u6bd4\u5c0d\u524d\u4e00\u500b render \u7684 array <code class=\"language-javascript\">[5]</code> \u8207\u4e0b\u4e00\u500b render \u7684 array <code class=\"language-javascript\">[6]</code>\u3002\u9019\u6b21\uff0cReact \u5c07\u91cd\u65b0\u57f7\u884c effect\uff0c\u56e0\u70ba <code class=\"language-javascript\">5 !== 6</code>\u3002\u5982\u679c array \u4e2d\u6709\u591a\u500b\u9805\u76ee\uff0c\u5373\u4f7f\u5176\u4e2d\u4e00\u9805\u4e0d\u540c\uff0cReact \u4e5f\u6703\u91cd\u65b0\u57f7\u884c effect\u3002</p>\n<p>\u9019\u4e5f\u9069\u7528\u65bc\u6709\u6e05\u9664\u968e\u6bb5\u7684 effect\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u50c5\u5728 props.friend.id \u6539\u8b8a\u6642\u91cd\u65b0\u8a02\u95b1</span></span></code></pre></div>\n<p>\u672a\u4f86\uff0c\u7b2c\u4e8c\u500b\u53c3\u6578\u53ef\u80fd\u6703\u900f\u904e build-time transformation \u81ea\u52d5\u88ab\u52a0\u5165\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u6b64\u6700\u4f73\u5316\uff0c\u8acb\u78ba\u4fdd array \u5305\u62ec\u4e86 <strong>component \u7bc4\u570d\u5167\u96a8\u6642\u9593\u8b8a\u5316\u4e26\u88ab effect \u7528\u5230\u7684\u6240\u6709\u503c\uff08\u4f8b\u5982 props \u548c state\uff09</strong>\u3002\u5426\u5247\uff0c\u4f60\u7684\u7a0b\u5f0f\u78bc\u5c07\u5f15\u7528\u5148\u524d render \u4e2d\u7684\u820a\u503c\u3002\u4e86\u89e3\u66f4\u591a<a href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\">\u5982\u4f55\u8655\u7406 function</a> \u548c<a href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\">\u5982\u679c array \u7d93\u5e38\u8b8a\u5316\u7684\u8a71\u8a72\u600e\u9ebc\u8fa6</a>\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3\u57f7\u884c\u4e00\u500b effect \u4e26\u4e14\u50c5\uff08\u5728 mount \u548c unmount \u6642\uff09\u5c07\u5176\u6e05\u9664\u4e00\u6b21\uff0c\u5247\u53ef\u4ee5\u50b3\u905e\u4e00\u500b\u7a7a array\uff08<code class=\"language-javascript\">[]</code>\uff09\u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u3002\u9019\u544a\u8a34 React \u4f60\u7684 effect \u4e0d\u4f9d\u8cf4\u65bc<em>\u4efb\u4f55</em> props \u6216 state \u7684\u503c\uff0c\u56e0\u6b64\u5b83\u4e0d\u9700\u8981\u91cd\u65b0\u57f7\u884c\u3002\u9019\u4e0d\u5c6c\u65bc\u7279\u6b8a\u60c5\u6cc1 \u2014 \u4f9d\u8cf4\u9805\u76ee array \u4e00\u76f4\u9019\u6a23\u5de5\u4f5c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u5982\u679c\u4f60\u50b3\u905e\u4e00\u500b\u7a7a array\uff08[]\uff09\uff0ceffect \u4e2d\u7684 props \u548c state \u59cb\u7d42\u5177\u6709\u5176\u521d\u59cb\u503c\u3002\u5118\u7ba1\u5c07 []\u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u50b3\u905e\u66f4\u63a5\u8fd1\u65bc\u6211\u5011\u719f\u6089\u7684 componentDidMount \u548c componentWillUnmount \u7684\u6a21\u5f0f\uff0c\u4f46\u901a\u5e38\u6709\u66f4\u597d\u7684\u89e3\u6c7a\u65b9\u6848\u53ef\u4ee5\u907f\u514d\u904e\u65bc\u983b\u7e41\u5730\u91cd\u65b0\u57f7\u884c effect\u3002\u53e6\u5916\uff0c\u5225\u5fd8\u4e86 React \u5728\u700f\u89bd\u5668\u7e6a\u88fd\u5b8c\u6210\u4e4b\u5f8c\u624d\u5ef6\u9072\u57f7\u884c useEffect\uff0c\u6240\u4ee5\u505a\u984d\u5916\u7684\u5de5\u4f5c\u6c92\u6709\u5f88\u5927\u7684\u554f\u984c\u3002</strong>\n</div>\n<p>\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> \u898f\u5247\u4f5c\u70ba\u6211\u5011 <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> package \u7684\u4e00\u90e8\u5206\u3002\u7576\u4e0d\u6b63\u78ba\u5730\u6307\u5b9a\u4f9d\u8cf4\u6642\uff0c\u5b83\u6703\u767c\u51fa\u8b66\u544a\uff0c\u4e26\u63d0\u51fa\u4fee\u6539\u5efa\u8b70\u3002</p>\n</div>\n<h2 id=\"next-steps\"><a class=\"anchor\" href=\"/react/hooks-effect#next-steps\"></a>\u4e0b\u4e00\u6b65 </h2>\n<p>\u606d\u559c\uff01\u9019\u4e00\u9801\u5f88\u9577\uff0c\u4f46\u662f\u5e0c\u671b\u8b80\u5230\u6700\u5f8c\uff0c\u4f60\u7d55\u5927\u591a\u6578\u7684\u554f\u984c\u90fd\u6709\u4e86\u7b54\u6848\u3002\u4f60\u5df2\u7d93\u5b78\u904e State Hook \u548c Effect Hook\uff0c\u628a\u5169\u8005\u7d50\u5408\u8d77\u4f86\uff0c\u4f60\u5df2\u7d93\u80fd\u505a\u5230<em>\u5f88\u591a</em>\u6771\u897f\u3002\u5b83\u5011\u6db5\u84cb\u4e86 class \u7684\u7d55\u5927\u591a\u6578\u7684\u4f7f\u7528\u6848\u4f8b \u2014 \u5982\u679c\u6c92\u6709\u6db5\u84cb\u5230\uff0c<a href=\"/react/hooks-reference\">\u984d\u5916\u7684 Hook</a> \u6216\u8a31\u6703\u5e6b\u5230\u4f60\u3002</p>\n<p>\u6211\u5011\u4e5f\u958b\u59cb\u770b\u5230 Hook \u5982\u4f55\u89e3\u6c7a<a href=\"/react/hooks-intro#motivation\">\u52d5\u6a5f</a>\u4e2d\u6982\u8ff0\u7684\u554f\u984c\u3002\u6211\u5011\u5df2\u7d93\u770b\u5230\u4e86 effect \u6e05\u9664\u5982\u4f55\u907f\u514d\u5728 <code class=\"language-javascript\">componentDidUpdate</code> \u548c <code class=\"language-javascript\">componentWillUnmount</code> \u4e2d\u91cd\u8907\uff0c\u5982\u4f55\u4f7f\u76f8\u95dc\u7a0b\u5f0f\u78bc\u66f4\u7dca\u5bc6\u5730\u7d50\u5408\u5728\u4e00\u8d77\uff0c\u4e26\u5e6b\u52a9\u6211\u5011\u907f\u514d bug\u3002\u6211\u5011\u9084\u770b\u5230\u4e86\u6211\u5011\u53ef\u4ee5\u5982\u4f55\u6839\u64da effect \u7684\u76ee\u7684\u4f86\u5340\u5206 effect\uff0c\u9019\u662f\u6211\u5011\u5728 class \u4e2d\u6839\u672c\u7121\u6cd5\u505a\u5230\u7684\u3002</p>\n<p>\u73fe\u5728\uff0c\u4f60\u53ef\u80fd\u6703\u8cea\u7591 Hook \u7684\u5de5\u4f5c\u65b9\u5f0f\u3002 React \u600e\u9ebc\u77e5\u9053\u54ea\u500b <code class=\"language-javascript\">useState</code> \u547c\u53eb\u5c0d\u61c9\u65bc re-render \u4e4b\u9593\u7684\u54ea\u500b state \u8b8a\u6578\uff1fReact \u5982\u4f55\u5728\u6bcf\u6b21\u66f4\u65b0\u4e2d\u300c\u5339\u914d\u300d\u4e0a\u4e00\u500b\u548c\u4e0b\u4e00\u500b effect\uff1f<strong>\u5728\u4e0b\u4e00\u9801\uff0c\u6211\u5011\u6703\u5b78\u7fd2 <a href=\"/react/hooks-rules\">Hook \u7684\u898f\u5247</a> \u2014 \u5b83\u5011\u5c0d\u65bc Hook \u7684\u6b63\u5e38\u57f7\u884c\u81f3\u95dc\u91cd\u8981\u3002</strong></p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-effect.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-effect", "nav": ["/react/hooks-state", "/react/hooks-rules"]}, {"key": "5. Hook \u7684\u898f\u5247", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u65b0\u52a0\u5165\u7684\u529f\u80fd\uff0c\u5b83\u5011\u8b93\u4f60\u53ef\u4ee5\u4e0d\u7528\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u8207\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p>Hook \u662f JavaScript function\uff0c\u7576\u4f60\u4f7f\u7528\u5b83\u5011\u6642\u9700\u8981\u9075\u5b88\u5169\u500b\u898f\u5247\u3002\u6211\u5011\u63d0\u4f9b\u4e86\u4e00\u500b <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\">linter plugin</a> \u4f86\u81ea\u52d5\u5316\u5730\u5be6\u884c\u9019\u4e9b\u898f\u5247\uff1a</p>\n<h3 id=\"only-call-hooks-at-the-top-level\"><a class=\"anchor\" href=\"/react/hooks-rules#only-call-hooks-at-the-top-level\"></a>\u53ea\u5728\u6700\u4e0a\u5c64\u547c\u53eb Hook </h3>\n<p><strong>\u4e0d\u8981\u5728\u8ff4\u5708\u3001\u689d\u4ef6\u5f0f\u6216\u662f\u5de2\u72c0\u7684 function \u5167\u547c\u53eb Hook\u3002</strong>\u76f8\u53cd\u7684\uff0c\u5728\u4efb\u4f55 early return \u4e4b\u524d\uff0c\u8acb\u5728 React function top level \u4f7f\u7528 Hook\u3002\u85c9\u7531\u9075\u5faa\u9019\u4e9b\u898f\u5247\uff0c\u4f60\u53ef\u4ee5\u78ba\u4fdd\u7576\u6bcf\u6b21\u4e00\u500b component render \u6642 Hook \u90fd\u4f9d\u7167\u6b63\u78ba\u7684\u9806\u5e8f\u88ab\u547c\u53eb\u3002\u6b63\u662f\u9019\u500b\u4f7f\u5f97 React \u6709\u8fa6\u6cd5\u5728\u591a\u500b <code class=\"language-javascript\">useState</code> \u548c <code class=\"language-javascript\">useEffect</code> \u547c\u53eb\u9593\uff0c\u6b63\u78ba\u5730\u4fdd\u6301 Hook \u7684 state\u3002 (\u5982\u679c\u4f60\u611f\u5230\u597d\u5947\uff0c\u6211\u5011\u5c07\u5728<a href=\"/react/hooks-rules#explanation\">\u4e0b\u65b9</a>\u6df1\u5165\u7684\u89e3\u91cb\u5b83\u3002)</p>\n<h3 id=\"only-call-hooks-from-react-functions\"><a class=\"anchor\" href=\"/react/hooks-rules#only-call-hooks-from-react-functions\"></a>\u53ea\u5728 React Function \u4e2d\u547c\u53eb Hook </h3>\n<p><strong>\u5225\u5728\u4e00\u822c\u7684 JavaScript function \u4e2d\u547c\u53eb Hook\u3002</strong>\u76f8\u53cd\u7684\uff0c\u4f60\u53ef\u4ee5\uff1a</p>\n<ul>\n<li>\u2705 \u5728 React function component \u4e2d\u547c\u53eb Hook\u3002</li>\n<li>\u2705 \u5728\u81ea\u5b9a\u7fa9\u7684 Hook \u4e2d\u547c\u53eb Hook\u3002\uff08\u6211\u5011\u5c07\u6703<a href=\"/react/hooks-custom\">\u5728\u4e0b\u4e00\u9801</a>\u4e86\u89e3\u5b83\u5011\uff09\u3002</li>\n</ul>\n<p>\u900f\u904e\u9075\u5faa\u9019\u4e9b\u898f\u5247\uff0c\u4f60\u78ba\u4fdd\u4e86\u5728 component \u4e2d\u6240\u6709\u7684 stateful \u908f\u8f2f\u5728\u5176\u539f\u59cb\u78bc\u4e2d\u53ef\u4ee5\u6e05\u695a\u5730\u88ab\u770b\u898b\u3002</p>\n<h2 id=\"eslint-plugin\"><a class=\"anchor\" href=\"/react/hooks-rules#eslint-plugin\"></a>ESLint Plugin </h2>\n<p>\u6211\u5011\u767c\u4f48\u4e86\u4e00\u500b ESLint plugin \u53eb\u505a <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> \u4f86\u5f37\u5236\u65bd\u884c\u9019\u5169\u500b\u898f\u5247\u3002\u5982\u679c\u4f60\u60f3\u5617\u8a66\u7684\u8a71\uff0c\u53ef\u4ee5\u5c07\u9019\u500b plugin \u52a0\u5165\u5230\u4f60\u7684\u5c08\u6848\u4e2d:</p>\n<p><a href=\"/react/create-a-new-react-app#create-react-app\">Create React App</a> \u9810\u8a2d\u5305\u542b\u6b64 plugin\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-bash\"><code class=\"language-javascript\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> eslint-plugin-react-hooks --save-dev</code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u4f60\u7684 ESLint \u914d\u7f6e</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token string\">\"react-hooks\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token string-property property\">\"react-hooks/rules-of-hooks\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// \u6aa2\u67e5 Hook \u7684\u898f\u5247</span>\n    <span class=\"token string-property property\">\"react-hooks/exhaustive-deps\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"warn\"</span> <span class=\"token comment\">// \u6aa2\u67e5 effect \u7684\u76f8\u4f9d\u6027</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u4f60\u73fe\u5728\u53ef\u4ee5\u5148\u8df3\u904e\uff0c\u4e0b\u4e00\u9801\u5c07\u89e3\u91cb\u5982\u4f55\u6253\u9020<a href=\"/react/hooks-custom\">\u4f60\u81ea\u5df1\u7684 Hook</a>\u3002</strong>\u5728\u9019\u9801\uff0c\u6211\u5011\u5c07\u6703\u7e7c\u7e8c\u89e3\u91cb\u9019\u4e9b\u898f\u5247\u80cc\u5f8c\u7684\u539f\u56e0\u3002</p>\n<h2 id=\"explanation\"><a class=\"anchor\" href=\"/react/hooks-rules#explanation\"></a>\u89e3\u8aaa </h2>\n<p>\u5982\u6211\u5011<a href=\"/react/hooks-state#tip-using-multiple-state-variables\">\u5148\u524d\u6240\u5b78\u5230\u7684</a>\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u55ae\u4e00\u7684 component \u4e2d\u4f7f\u7528\u591a\u500b State \u6216 Effect Hook\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 1. \u4f7f\u7528 name state \u8b8a\u6578</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 2. \u4f7f\u7528\u4e00\u500b effect \u4f86\u4fdd\u5b58\u8868\u55ae</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">persistForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'formData'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 3. \u4f7f\u7528 surname state \u8b8a\u6578</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 4. \u4f7f\u7528\u4e00\u500b effect \u4f86\u66f4\u65b0\u6a19\u984c</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">updateTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> name <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> surname<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6240\u4ee5 React \u662f\u5982\u4f55\u77e5\u9053\u54ea\u500b state \u8981\u5c0d\u61c9\u5230\u54ea\u500b <code class=\"language-javascript\">useState</code> \u7684\u547c\u53eb\uff1f\u7b54\u6848\u662f <strong>React \u4ef0\u8cf4\u65bc Hook \u88ab\u547c\u53eb\u7684\u9806\u5e8f</strong>\u3002\u6211\u5011\u7684\u7bc4\u4f8b\u80fd\u57f7\u884c\u662f\u56e0\u70ba\u5728\u6bcf\u4e00\u6b21\u7684 render \u4e2d Hook \u90fd\u662f\u4f9d\u7167\u4e00\u6a23\u7684\u9806\u5e8f\u88ab\u547c\u53eb\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// ------------</span>\n<span class=\"token comment\">// \u7b2c\u4e00\u6b21 render</span>\n<span class=\"token comment\">// ------------</span>\n<span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\">// 1. \u7528 'Mary' \u4f86\u521d\u59cb\u5316 name state \u8b8a\u6578</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>persistForm<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// 2. \u589e\u52a0\u4e00\u500b effect \u4f86\u4fdd\u5b58\u8868\u55ae</span>\n<span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\">// 3. \u7528 'Poppins' \u4f86\u521d\u59cb\u5316 surname state \u8b8a\u6578</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>updateTitle<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// 4. \u589e\u52a0\u4e00\u500b effect \u4f86\u66f4\u65b0\u6a19\u984c</span>\n\n<span class=\"token comment\">// -------------</span>\n<span class=\"token comment\">// \u7b2c\u4e8c\u6b21 render</span>\n<span class=\"token comment\">// -------------</span>\n<span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\">// 1. \u8b80\u53d6 name state \u8b8a\u6578 (\u53c3\u6578\u88ab\u5ffd\u7565\u4e86)</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>persistForm<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// 2. \u66ff\u63db\u4e86\u7528\u4f86\u4fdd\u5b58\u8868\u55ae\u7684 effect</span>\n<span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\">// 3. \u8b80\u53d6 surname state \u8b8a\u6578 (\u53c3\u6578\u88ab\u5ffd\u7565\u4e86)</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>updateTitle<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// 4. \u66ff\u63db\u4e86\u7528\u4f86\u66f4\u65b0\u6a19\u984c\u7684 effect</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u53ea\u8981 Hook \u5728 render \u6642\u88ab\u547c\u53eb\u7684\u9806\u5e8f\u662f\u4e00\u81f4\u7684\uff0cReact \u53ef\u4ee5\u5c07\u4e00\u4e9b local state \u548c\u5b83\u5011\u4e00\u4e00\u806f\u7e6b\u5728\u4e00\u8d77\u3002\u4f46\u5982\u679c\u6211\u5011\u628a\u4e00\u500b Hook \u547c\u53eb\uff08\u4f8b\u5982\uff0c<code class=\"language-javascript\">persistForm</code> effect\uff09\u653e\u5728\u689d\u4ef6\u5f0f\u4e2d\u6703\u767c\u751f\u4ec0\u9ebc\u4e8b\u5462\uff1f</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token comment\">// \ud83d\udd34 \u6211\u5011\u9055\u53cd\u4e86\u7b2c\u4e00\u500b\u898f\u5247\uff0c\u5728\u689d\u4ef6\u5f0f\u4e2d\u4f7f\u7528 Hook</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">persistForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'formData'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b <code class=\"language-javascript\">name !== ''</code> \u689d\u4ef6\u5f0f\u5728\u521d\u6b21 render \u6642\u70ba <code class=\"language-javascript\">true</code>\uff0c\u6240\u4ee5\u6211\u5011\u57f7\u884c\u4e86\u6b64 Hook\u3002\u7136\u800c\uff0c\u5728\u4e0b\u4e00\u6b21 render \u6642\u4f7f\u7528\u8005\u53ef\u80fd\u6e05\u9664\u4e86\u8868\u55ae\uff0c\u4f7f\u5f97\u689d\u4ef6\u5f0f\u8b8a\u70ba <code class=\"language-javascript\">false</code>\u3002\u800c\u73fe\u5728\u6211\u5011\u5728 render \u671f\u9593\u8df3\u904e\u4e86\u9019\u4e00\u500b Hook\uff0cHook \u7684\u547c\u53eb\u9806\u5e8f\u6709\u6240\u4e0d\u540c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\">// 1. \u8b80\u53d6 name state \u8b8a\u6578 (\u53c3\u6578\u88ab\u5ffd\u7565\u4e86)</span>\n<span class=\"token comment\">// useEffect(persistForm)  // \ud83d\udd34 \u9019\u500b Hook \u88ab\u8df3\u904e\u4e86\uff01</span>\n<span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\">// \ud83d\udd34 2 (\u4f46\u4e4b\u524d\u662f 3). \u672a\u80fd\u8b80\u53d6 surname state \u8b8a\u6578</span>\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>updateTitle<span class=\"token punctuation\">)</span>     <span class=\"token comment\">// \ud83d\udd34 3 (\u4f46\u4e4b\u524d\u662f 4). \u672a\u80fd\u53d6\u4ee3 effect</span></code></pre></div>\n<p>React \u4e0d\u6703\u77e5\u9053\u7b2c\u4e8c\u500b <code class=\"language-javascript\">useState</code> Hook \u547c\u53eb\u56de\u50b3\u4ec0\u9ebc\u3002React \u9810\u671f\u5728\u9019\u500b component \u4e2d\u7684\u7b2c\u4e8c\u500b Hook \u547c\u53eb\u548c <code class=\"language-javascript\">persistForm</code> effect \u662f\u76f8\u5c0d\u61c9\u7684\uff0c\u5c31\u5982\u540c\u5728\u524d\u4e00\u6b21\u7684 render \u4e00\u6a23\uff0c\u4f46\u5b83\u4e0d\u518d\u4e00\u6a23\u4e86\u3002\u5f9e\u90a3\u6642\u8d77\uff0c\u5728\u6211\u5011\u8df3\u904e\u7684\u90a3\u500b Hook \u5f8c\u9762\uff0c\u6bcf\u4e0b\u4e00\u500b Hook \u547c\u53eb\u90fd\u6703 shift \u4e00\u500b\uff0c\u5c0e\u81f4 bug \u7684\u767c\u751f\u3002</p>\n<p><strong>\u9019\u5c31\u662f\u70ba\u4f55\u5fc5\u9808\u5728\u6211\u5011\u7684 component \u4e4b\u4e0a\u5c64\u4f86\u547c\u53eb Hook\u3002</strong> \u5982\u679c\u6211\u5011\u60f3\u8981\u6709\u689d\u4ef6\u5730\u57f7\u884c effect\uff0c\u6211\u5011\u53ef\u4ee5\u628a\u90a3\u500b\u689d\u4ef6\u5f0f\u653e\u5728\u6211\u5011\u7684 Hook <em>\u88e1</em>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">persistForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// \ud83d\udc4d \u6211\u5011\u4e0d\u518d\u9055\u53cd\u7b2c\u4e00\u500b\u898f\u5247</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'formData'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>\u6ce8\u610f\u4f60\u4e0d\u9700\u8981\u64d4\u5fc3\u9019\u500b\u554f\u984c\uff0c\u5982\u679c\u4f60\u4f7f\u7528<a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\">\u63d0\u4f9b\u7684 lint \u898f\u5247</a>\u3002</strong>\u4f46\u73fe\u5728\u4f60\u4e5f\u4e86\u89e3<em>\u70ba\u4f55</em> Hook \u662f\u9019\u6a23\u904b\u4f5c\u7684\uff0c\u548c\u9019\u4e9b\u7528\u4f86\u907f\u514d\u800c\u5236\u5b9a\u7684\u898f\u5247\u3002</p>\n<h2 id=\"next-steps\"><a class=\"anchor\" href=\"/react/hooks-rules#next-steps\"></a>\u4e0b\u4e00\u6b65 </h2>\n<p>\u6700\u5f8c, \u6211\u5011\u6e96\u5099\u597d\u5b78\u7fd2<a href=\"/react/hooks-custom\">\u64b0\u5beb\u4f60\u81ea\u5df1\u7684 Hook</a>\uff01\u81ea\u5b9a\u7fa9\u7684 Hook \u8b93\u4f60\u80fd\u7d50\u5408\u7531 React \u63d0\u4f9b\u7684 Hook \u5230\u4f60\u81ea\u5df1\u7684\u62bd\u8c61\u5316\u4e2d\uff0c\u800c\u4e14\u5728\u4e0d\u540c\u7684 component \u9593\u91cd\u8907\u4f7f\u7528\u76f8\u540c\u7684 stateful \u908f\u8f2f\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-rules.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-rules", "nav": ["/react/hooks-effect", "/react/hooks-custom"]}, {"key": "6. \u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p>\u6253\u9020\u4f60\u81ea\u5df1\u7684 Hook \u53ef\u4ee5\u5c07 component \u908f\u8f2f\u63d0\u53d6\u5230\u53ef\u91cd\u8907\u4f7f\u7528\u7684 function \u4e2d\u3002</p>\n<p>\u7576\u6211\u5011\u5728\u5b78\u7fd2\u95dc\u65bc<a href=\"/react/hooks-effect#example-using-hooks-1\">\u4f7f\u7528 Effect Hook</a> \u6642\uff0c\u6211\u5011\u5f9e\u4e00\u500b\u804a\u5929\u61c9\u7528\u7a0b\u5f0f\u770b\u5230\u9019\u500b component \uff0c\u986f\u793a\u4e00\u689d\u8a0a\u606f\u8aaa\u660e\u670b\u53cb\u662f\u5426\u9084\u5728\u7dda\u4e0a\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\uff0c\u8b93\u6211\u5011\u7684\u804a\u5929\u61c9\u7528\u7a0b\u5f0f\u4e5f\u6709\u4e00\u500b\u806f\u7e6b\u5217\u8868\uff0c\u800c\u4e14\u60f3\u8981\u900f\u904e\u7da0\u8272\u4f86 render \u5728\u7dda\u4e0a\u7684\u4f7f\u7528\u8005\u540d\u7a31\u3002\u6211\u5011\u53ef\u4ee5\u5f9e\u4e0a\u65b9\u8907\u88fd\u4e26\u8cbc\u4e0a\u76f8\u4f3c\u7684\u908f\u8f2f\u5230 <code class=\"language-javascript\">FriendListItem</code> component \uff0c\u4f46\u5b83\u4e26\u4e0d\u7406\u60f3\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">FriendListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'black'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u76f8\u53cd\u7684\uff0c\u6211\u5011\u60f3\u8981\u5728 <code class=\"language-javascript\">FriendStatus</code> \u548c <code class=\"language-javascript\">FriendListItem</code> \u5171\u4eab\u9019\u500b\u908f\u8f2f\u3002</p>\n<p>\u7fd2\u6163\u4e0a\uff0c\u6211\u5011\u6709\u5169\u7a2e\u5e38\u7528\u7684\u65b9\u5f0f\u5728 component \u4f86\u5171\u4eab stateful \u908f\u8f2f\uff1a<a href=\"/react/render-props\">render props</a> \u548c <a href=\"/react/higher-order-components\">higher-order component</a>\u3002\u6211\u5011\u73fe\u5728\u5c07\u770b\u5230 Hook \u5982\u4f55\u5728\u4e0d\u5f37\u8feb tree \u52a0\u5165\u66f4\u591a component \u7684\u60c5\u6cc1\u4e0b\uff0c\u89e3\u6c7a\u8a31\u591a\u76f8\u540c\u7684\u554f\u984c\u3002</p>\n<h2 id=\"extracting-a-custom-hook\"><a class=\"anchor\" href=\"/react/hooks-custom#extracting-a-custom-hook\"></a>\u63d0\u53d6\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook </h2>\n<p>\u7576\u6211\u5011\u60f3\u8981\u5171\u4eab\u908f\u8f2f\u5728\u5169\u500b JavaScript function \u4e4b\u9593\u6642\uff0c\u6211\u5011\u63d0\u53d6\u5b83\u6210\u70ba\u7b2c\u4e09\u500b function\u3002Component \u548c Hook \u5169\u8005\u90fd\u662f function\uff0c\u6240\u4ee5\u9019\u4e5f\u9069\u7528\u65bc\u5b83\u5011\uff01</p>\n<p><strong>\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook \u662f\u4ee5\u300c<code class=\"language-javascript\">use</code>\u300d\u70ba\u958b\u982d\u547d\u540d\u7684 JavaScript function\uff0c\u800c\u4e14\u5b83\u53ef\u80fd\u4e5f\u547c\u53eb\u5176\u4ed6\u7684 Hook\u3002</strong>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u662f\u6211\u5011\u7b2c\u4e00\u500b\u5b57\u5b9a\u7fa9\u7684 <code class=\"language-javascript\">useFriendStatus</code> Hook\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">handleStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u88e1\u6c92\u6709\u65b0\u52a0\u5165\u7684\u6771\u897f \u2014 \u908f\u8f2f\u662f\u8907\u88fd\u65bc\u4e0a\u65b9\u7684 component\u3002\u5c31\u50cf\u5728 component \u5167\u4e00\u6a23\uff0c\u78ba\u4fdd\u53ea\u5728\u81ea\u5b9a\u7fa9\u7684 Hook \u9802\u5c64\u7121\u689d\u4ef6\u7684\u547c\u53eb\u5176\u4ed6 Hook\u3002</p>\n<p>\u4e0d\u50cf React component\uff0c\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook \u4e0d\u9700\u8981\u4e00\u500b\u7279\u5b9a\u7684\u5ba3\u544a\u3002\u6211\u5011\u53ef\u4ee5\u6c7a\u5b9a\u5b83\u9700\u8981\u63a5\u53d7\u4ec0\u9ebc\u53c3\u6578\uff0c\u4ee5\u53ca\u5b83\u61c9\u8a72\u56de\u50b3\u4ec0\u9ebc\uff08\u5982\u679c\u6709\u7684\u8a71\uff09\u3002\u63db\u53e5\u8a71\u8aaa\uff0c\u5b83\u5c31\u50cf\u4e00\u500b\u666e\u901a\u7684 function\u3002\u5b83\u7684\u547d\u540d\u958b\u982d\u61c9\u8a72\u7e3d\u662f\u70ba <code class=\"language-javascript\">use</code>\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u4e00\u773c\u5c31\u770b\u51fa <a href=\"/react/hooks-rules\">Hook \u7684\u898f\u5247</a>\u9069\u7528\u65bc\u5b83\u3002</p>\n<p>\u6211\u5011\u7684 <code class=\"language-javascript\">useFriendStatus</code> Hook \u76ee\u7684\u662f\u8a02\u95b1\u6211\u5011\u670b\u53cb\u7684\u72c0\u614b\u3002\u9019\u4e5f\u662f\u70ba\u4ec0\u9ebc\u5b83\u63a5\u53d7 <code class=\"language-javascript\">friendID</code> \u4f5c\u70ba\u4e00\u500b\u53c3\u6578\uff0c\u4e26\u56de\u50b3\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\uff0c\u8b93\u6211\u5011\u4f86\u770b\u5982\u4f55\u4f7f\u7528\u6211\u5011\u81ea\u5b9a\u7fa9\u7684 Hook\u3002</p>\n<h2 id=\"using-a-custom-hook\"><a class=\"anchor\" href=\"/react/hooks-custom#using-a-custom-hook\"></a>\u4f7f\u7528\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook </h2>\n<p>\u5728\u4e00\u958b\u59cb\u7684\u6642\u5019\uff0c\u6211\u5011\u7684\u76ee\u6a19\u662f\u5f9e <code class=\"language-javascript\">FriendStatus</code> \u548c <code class=\"language-javascript\">FriendListItem</code> component \u4e2d\u79fb\u9664\u91cd\u8907\u7684\u908f\u8f2f\u3002\u9019\u5169\u8005\u90fd\u60f3\u8981\u77e5\u9053\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\u3002</p>\n<p>\u73fe\u5728\uff0c\u6211\u5011\u63d0\u53d6\u4e86\u908f\u8f2f\u5230 <code class=\"language-javascript\">useFriendStatus</code> hook\uff0c\u6211\u5011\u53ef\u4ee5<em>\u4f7f\u7528\u5b83\uff1a</em></p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Loading...'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FriendListItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'black'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u9019\u500b\u7a0b\u5f0f\u78bc\u76f8\u7b49\u65bc\u539f\u59cb\u7684\u7bc4\u4f8b\u55ce\uff1f</strong>\u662f\u7684\uff0c\u5b83\u5011\u57f7\u884c\u7684\u65b9\u5f0f\u662f\u76f8\u540c\u7684\u3002\u5982\u679c\u4f60\u4ed4\u7d30\u770b\u7684\u8a71\uff0c\u4f60\u6703\u6ce8\u610f\u5230\u6211\u5011\u6c92\u6709\u6539\u8b8a\u4efb\u4f55\u7684\u884c\u70ba\u3002\u6211\u5011\u6240\u505a\u7684\u53ea\u662f\u5728\u5169\u500b function \u4e2d\u63d0\u53d6\u5171\u540c\u7684\u7a0b\u5f0f\u78bc\u8b93\u5b83\u6210\u70ba\u4e00\u500b\u7368\u7acb\u7684 function\u3002<strong>\u81ea\u5b9a\u7fa9\u7684 Hook \u662f\u81ea\u7136\u9075\u5faa Hook \u8a2d\u8a08\u7684\u898f\u7bc4\uff0c\u800c\u4e0d\u662f React \u7684\u529f\u80fd\u3002</strong></p>\n<p><strong>\u8acb\u554f\u6211\u5fc5\u9808\u4ee5\u300c<code class=\"language-javascript\">use</code>\u300d\u958b\u982d\u547d\u540d\u6211\u81ea\u5b9a\u7fa9\u7684 Hook \u55ce\uff1f</strong>\u8acb\u9019\u9ebc\u505a\u3002\u9019\u500b\u898f\u7bc4\u975e\u5e38\u7684\u91cd\u8981\u3002\u6c92\u6709\u5b83\u7684\u8a71\uff0c\u6211\u5011\u7121\u6cd5\u81ea\u52d5\u7684\u6aa2\u67e5\u9055\u53cd <a href=\"/react/hooks-rules\">Hook \u898f\u5247</a>\u7684\u884c\u70ba\uff0c\u56e0\u70ba\u6211\u5011\u7121\u6cd5\u5224\u65b7\u67d0\u500b function \u4e2d\u662f\u5426\u5305\u542b\u5c0d Hook \u7684\u547c\u53eb\u3002</p>\n<p><strong>\u8acb\u554f\u5169\u500b component \u4f7f\u7528\u76f8\u540c\u7684 Hook \u662f\u5171\u4eab state \u7684\u55ce\uff1f</strong>\u4e0d\u662f\u7684\u3002\u81ea\u5b9a\u7fa9\u7684 Hook \u6709\u4e00\u500b\u6a5f\u5236\u91cd\u8907\u4f7f\u7528 <em>stateful \u908f\u8f2f</em>\uff08\u4f8b\u5982\u8a2d\u5b9a\u8a02\u95b1\u4e26\u8a18\u4f4f\u76ee\u524d\u7684\u503c\uff09\uff0c\u4f46\u6bcf\u6b21\u4f60\u4f7f\u7528\u81ea\u5b9a\u7fa9\u7684 Hook \u6642\uff0c\u6240\u6709\u5167\u90e8\u7684 state \u548c effect \u90fd\u662f\u5b8c\u5168\u7368\u7acb\u7684</p>\n<p><strong>\u81ea\u5b9a\u7fa9\u7684 Hook \u662f\u5982\u4f55\u9694\u96e2 state \u7684\uff1f</strong> \u6bcf\u500b<em>\u547c\u53eb</em> Hook \u7684\u90fd\u6703\u5f97\u5230\u7368\u7acb\u7684 state\u3002\u56e0\u70ba\u6211\u5011\u76f4\u63a5\u547c\u53eb <code class=\"language-javascript\">useFriendStatus</code>\uff0c\u5f9e React \u7684\u89d2\u5ea6\u4f86\u770b\uff0c\u6211\u5011\u7684 component \u53ea\u547c\u53eb <code class=\"language-javascript\">useState</code> \u548c <code class=\"language-javascript\">useEffect</code>\u3002\u6b63\u5982\u6211\u5011<a href=\"/react/hooks-effect#tip-use-multiple-effects-to-separate-concerns\">\u4e4b\u524d</a>\u6240<a href=\"/react/hooks-state#tip-using-multiple-state-variables\">\u7406\u89e3</a>\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u4e00\u500b component \u547c\u53eb <code class=\"language-javascript\">useState</code> \u548c <code class=\"language-javascript\">useEffect</code> \u591a\u6b21\uff0c\u800c\u4e14\u5b83\u5011\u90fd\u662f\u5b8c\u5168\u7368\u7acb\u7684\u3002</p>\n<h3 id=\"tip-pass-information-between-hooks\"><a class=\"anchor\" href=\"/react/hooks-custom#tip-pass-information-between-hooks\"></a>\u63d0\u793a\uff1a\u5728 Hook \u4e4b\u9593\u50b3\u905e\u8cc7\u8a0a </h3>\n<p>\u7531\u65bc Hook \u662f function\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u5b83\u5011\u4e4b\u9593\u50b3\u905e\u8cc7\u8a0a\u3002</p>\n<p>\u70ba\u4e86\u8aaa\u660e\u9019\u9ede\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u6211\u5011\u5047\u8a2d\u7684\u804a\u5929\u7bc4\u4f8b\u4e2d\u7684\u53e6\u4e00\u500b component\u3002\u9019\u662f\u4e00\u500b\u804a\u5929\u8a0a\u606f\u6536\u4ef6\u4eba\u7684\u9078\u64c7\u5668\uff0c\u986f\u793a\u76ee\u524d\u9078\u64c7\u7684\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> friendList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Phoebe'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Rachel'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Ross'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ChatRecipientPicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Circle</span></span> <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isRecipientOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span>\n        <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>recipientID<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setRecipientID</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>friendList<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friend</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u5c07\u76ee\u524d\u9078\u64c7\u7684\u670b\u53cb ID \u5b58\u5728 <code class=\"language-javascript\">recipientID</code> state \u8b8a\u6578\u4e2d\uff0c\u5982\u679c\u4f7f\u7528\u8005\u5728 <code class=\"language-javascript\">&lt;select&gt;</code> \u9078\u64c7\u5668\u4e2d\u9078\u64c7\u4e0d\u540c\u7684\u4f7f\u7528\u8005\u5b83\u5c07\u6703\u66f4\u65b0\u3002</p>\n<p>\u56e0\u70ba\u547c\u53eb\u4e86 <code class=\"language-javascript\">useState</code> Hook \u70ba\u6211\u5011\u63d0\u4f9b\u4e86 <code class=\"language-javascript\">recipientID</code> state \u8b8a\u6578\u7684\u6700\u65b0\u503c\uff0c\u6211\u5011\u53ef\u4ee5\u5c07\u5b83\u4f5c\u70ba\u8b8a\u6578\u50b3\u905e\u5230\u6211\u5011\u81ea\u5b9a\u7fa9\u7684 <code class=\"language-javascript\">useFriendStatus</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u8b93\u6211\u5011\u77e5\u9053<em>\u76ee\u524d\u9078\u64c7\u7684</em>\u670b\u53cb\u662f\u5426\u5728\u7dda\u4e0a\u3002\u5982\u679c\u6211\u5011\u9078\u64c7\u4e0d\u540c\u7684\u670b\u53cb\u4e26\u66f4\u65b0 <code class=\"language-javascript\">recipientID</code> state \u8b8a\u6578\uff0c\u6211\u5011\u7684 <code class=\"language-javascript\">useFriendStatus</code> Hook \u5c07\u6703\u5f9e\u5148\u524d\u9078\u64c7\u7684\u670b\u53cb\u4e2d\u53d6\u6d88\u8a02\u95b1\uff0c\u4e26\u8a02\u95b1\u6700\u65b0\u9078\u64c7\u7684\u72c0\u614b\u3002</p>\n<h2 id=\"useyourimagination\"><a class=\"anchor\" href=\"/react/hooks-custom#useyourimagination\"></a><code class=\"language-javascript\">useYourImagination()</code> </h2>\n<p>\u81ea\u5b9a\u7fa9\u7684 Hook \u63d0\u4f9b\u4e86\u5171\u4eab\u908f\u8f2f\u7684\u9748\u6d3b\u6027\uff0c\u9019\u5728\u4ee5\u524d\u7684 React component \u662f\u4e0d\u53ef\u80fd\u7684\u3002\u4f60\u53ef\u4ee5\u64b0\u5beb\u81ea\u5b9a\u7fa9\u7684 Hook \u6db5\u84cb\u5ee3\u6cdb\u7684\u5834\u666f\uff0c\u50cf\u662f\u8868\u683c\u8655\u7406\u3001\u52d5\u756b\u3001\u9673\u8ff0\u5f0f\u8a02\u95b1\uff08Declarative Subscription\uff09\u3001\u8a08\u6642\u5668\u9084\u6709\u66f4\u591a\u6211\u5011\u6c92\u6709\u8003\u616e\u904e\u7684\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u4f60\u53ef\u4ee5\u6253\u9020\u8207 React \u7684\u5167\u5efa\u4e00\u6a23\u6613\u65bc\u4f7f\u7528\u7684 Hook\u3002</p>\n<p>\u76e1\u91cf\u4e0d\u8981\u904e\u65e9\u5730\u52a0\u5165\u62bd\u8c61\u3002\u73fe\u5728 function component \u53ef\u4ee5\u505a\u66f4\u591a\u7684\u4e8b\uff0c\u5728\u4f60 codebase \u4e2d\u7684 function component \u7a0b\u5f0f\u78bc\u5e73\u5747\u53ef\u80fd\u90fd\u6703\u8b8a\u5f97\u66f4\u9577\u3002\u9019\u90fd\u662f\u6b63\u5e38\u7684 \u2014 \u4e0d\u8981\u89ba\u5f97\u4f60<em>\u5fc5\u9808</em>\u99ac\u4e0a\u628a\u5b83\u62c6\u5206\u6210 Hook\u3002\u4f46\u6211\u5011\u4e5f\u9f13\u52f5\u4f60\u958b\u59cb\u767c\u73fe\u81ea\u5b9a\u7fa9\u7684 Hook \u53ef\u4ee5\u96b1\u85cf\u7c21\u55ae interface \u80cc\u5f8c\u7684\u8907\u96dc\u908f\u8f2f\u60c5\u6cc1\uff0c\u6216\u8005\u5e6b\u5fd9\u89e3\u958b\u4e00\u500b\u6df7\u4e82\u7684 component\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u6709\u4e00\u500b\u8907\u96dc\u7684 component\uff0c\u5b83\u5305\u542b\u8a31\u591a\u4ee5\u4e00\u500b\u7279\u6b8a\u76ee\u7684\uff08ad-hoc\uff09\u65b9\u5f0f\u4f86\u7ba1\u7406\u7684 local state\u3002<code class=\"language-javascript\">useState</code> \u6c92\u8fa6\u6cd5\u8b93\u66f4\u65b0\u908f\u8f2f\u96c6\u4e2d\u5316\uff0c\u6240\u4ee5\u4f60\u53ef\u80fd\u66f4\u50be\u5411\u5c07\u5176\u5beb\u70ba <a class=\"external-link\" href=\"https://redux.js.org/\">Redux</a> \u7684 reducer\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">todosReducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'add'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">completed</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ... \u5176\u4ed6 action ...</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Reducer \u662f\u975e\u5e38\u65b9\u4fbf\u65bc\u7368\u7acb\u6e2c\u8a66\u7684\uff0c\u800c\u4e14\u53ef\u4ee5\u8868\u9054\u8907\u96dc\u7684\u66f4\u65b0\u908f\u8f2f\u3002\u5982\u679c\u6709\u9700\u8981\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u5c07\u5b83\u5011\u62c6\u6210\u66f4\u5c0f\u7684 reducer\u3002\u7136\u800c\uff0c\u4f60\u53ef\u80fd\u4e5f\u559c\u6b61\u4f7f\u7528 React local state \u7684\u597d\u8655\uff0c\u6216\u8005\u4f60\u4e0d\u60f3\u8981\u5b89\u88dd\u5176\u4ed6\u7684\u51fd\u5f0f\u5eab\u3002</p>\n<p>\u90a3\u9ebc\uff0c\u5982\u679c\u6211\u5011\u53ef\u4ee5\u64b0\u5beb\u4e00\u500b <code class=\"language-javascript\">useReducer</code> Hook\uff0c\u8b93\u6211\u5011\u7528 reducer \u7ba1\u7406 component \u7684 <em>local</em> state \u5462\uff1f \u5b83\u7684\u7c21\u5316\u7248\u672c\u770b\u8d77\u4f86\u5982\u4e0b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">reducer<span class=\"token punctuation\">,</span> initialState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> nextState <span class=\"token operator\">=</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>nextState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\u6211\u5011\u5728\u5176\u4ed6\u7684 component \u4f7f\u7528\u5b83\uff0c\u8b93 reducer \u9a45\u52d5\u5b83\u7684 state \u7ba1\u7406\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Todos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>todosReducer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleAddClick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'add'</span><span class=\"token punctuation\">,</span> text <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u8907\u96dc\u7684 component \u4e2d\u4f7f\u7528 reducer \u7ba1\u7406 local state \u7684\u9700\u6c42\u5f88\u5e38\u898b\uff0c\u6211\u5011\u5df2\u7d93\u5c07 <code class=\"language-javascript\">useReducer</code> Hook \u5167\u5efa\u5728 React \u4e2d\u3002\u4f60\u53ef\u4ee5\u5728 <a href=\"/react/hooks-reference\">Hooks API \u53c3\u8003</a>\u4e2d\u627e\u5230\u5b83\u8207\u5176\u4ed6\u5167\u5efa\u7684 Hook\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-custom.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-custom", "nav": ["/react/hooks-rules", "/react/hooks-reference"]}, {"key": "7. Hook API \u53c3\u8003", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hook</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p>\u672c\u9801\u9762\u63cf\u8ff0 React \u4e2d\u5167\u5efa Hook \u7684 API\u3002</p>\n<p>\u5982\u679c\u4f60\u525b\u958b\u59cb\u63a5\u89f8 Hook\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u5148\u67e5\u95b1 <a href=\"/react/hooks-overview\">Hook \u6982\u8ad6</a>\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728 <a href=\"/react/hooks-faq\">Hook \u5e38\u898b\u554f\u984c</a>\u4e2d\u627e\u5230\u6709\u7528\u7684\u8cc7\u8a0a\u3002</p>\n<ul>\n<li>\n<p><a href=\"/react/hooks-reference#basic-hooks\">\u57fa\u790e\u7684 Hook</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code></a></li>\n<li><a href=\"/react/hooks-reference#useeffect\"><code class=\"language-javascript\">useEffect</code></a></li>\n<li><a href=\"/react/hooks-reference#usecontext\"><code class=\"language-javascript\">useContext</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/react/hooks-reference#additional-hooks\">\u984d\u5916\u7684 Hook</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a></li>\n<li><a href=\"/react/hooks-reference#usecallback\"><code class=\"language-javascript\">useCallback</code></a></li>\n<li><a href=\"/react/hooks-reference#usememo\"><code class=\"language-javascript\">useMemo</code></a></li>\n<li><a href=\"/react/hooks-reference#useref\"><code class=\"language-javascript\">useRef</code></a></li>\n<li><a href=\"/react/hooks-reference#useimperativehandle\"><code class=\"language-javascript\">useImperativeHandle</code></a></li>\n<li><a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a></li>\n<li><a href=\"/react/hooks-reference#usedebugvalue\"><code class=\"language-javascript\">useDebugValue</code></a></li>\n<li><a href=\"/react/hooks-reference#usedeferredvalue\"><code class=\"language-javascript\">useDeferredValue</code></a></li>\n<li><a href=\"/react/hooks-reference#usetransition\"><code class=\"language-javascript\">useTransition</code></a></li>\n<li><a href=\"/react/hooks-reference#useid\"><code class=\"language-javascript\">useId</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/react/hooks-reference#library-hooks\">Library Hooks</a></p>\n<ul>\n<li><a href=\"/react/hooks-reference#usesyncexternalstore\"><code class=\"language-javascript\">useSyncExternalStore</code></a></li>\n<li><a href=\"/react/hooks-reference#useinsertioneffect\"><code class=\"language-javascript\">useInsertionEffect</code></a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"basic-hooks\"><a class=\"anchor\" href=\"/react/hooks-reference#basic-hooks\"></a>\u57fa\u790e\u7684 Hook </h2>\n<h3 id=\"usestate\"><a class=\"anchor\" href=\"/react/hooks-reference#usestate\"></a><code class=\"language-javascript\">useState</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b state \u7684\u503c\uff0c\u4ee5\u53ca\u66f4\u65b0 state \u7684 function\u3002</p>\n<p>\u5728\u9996\u6b21 render \u6642\uff0c\u56de\u50b3\u7684 <code class=\"language-javascript\">state</code> \u7684\u503c\u6703\u8ddf\u7b2c\u4e00\u500b\u53c3\u6578\uff08<code class=\"language-javascript\">initialState</code>\uff09\u4e00\u6a23\u3002</p>\n<p><code class=\"language-javascript\">setState</code> function \u662f\u7528\u4f86\u66f4\u65b0 state\u3002\u5b83\u63a5\u6536\u4e00\u500b\u65b0\u7684 state \u4e26\u5c07 component \u7684\u91cd\u65b0 render \u6392\u9032\u968a\u5217\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>newState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u5f8c\u7e8c\u7684\u91cd\u65b0 render\uff0c<code class=\"language-javascript\">useState</code> \u56de\u50b3\u7684\u7b2c\u4e00\u500b\u503c\u5fc5\u5b9a\u6703\u662f\u6700\u5f8c\u66f4\u65b0\u7684 state\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>React \u78ba\u4fdd <code class=\"language-javascript\">setState</code> function \u672c\u8eab\u662f\u7a69\u5b9a\u7684\uff0c\u800c\u4e14\u4e0d\u6703\u5728\u91cd\u65b0 render \u6642\u6539\u8b8a\u3002\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u53ef\u4ee5\u5b89\u5168\u5730\u5f9e <code class=\"language-javascript\">useEffect</code> \u6216 <code class=\"language-javascript\">useCallback</code> \u7684\u4f9d\u8cf4\u5217\u8868\u7701\u7565\u5b83\u3002</p>\n</div>\n<h4 id=\"functional-updates\"><a class=\"anchor\" href=\"/react/hooks-reference#functional-updates\"></a>\u51fd\u6578\u5f0f\u66f4\u65b0 </h4>\n<p>\u5982\u679c\u65b0\u7684 state \u662f\u7528\u5148\u524d\u7684 state \u8a08\u7b97\u51fa\uff0c\u4f60\u53ef\u4ee5\u50b3\u905e\u4e00\u500b function \u5230 <code class=\"language-javascript\">setState</code>\u3002\u8a72 function \u5c07\u63a5\u6536\u5148\u524d\u7684 state\uff0c\u4e26\u56de\u50b3\u4e00\u500b\u5df2\u66f4\u65b0\u7684\u503c\u3002\u4e0b\u5217\u7684\u8a08\u7b97\u5668 component \u7bc4\u4f8b\u793a\u7bc4\u4e86 <code class=\"language-javascript\">setState</code> \u7684\u5169\u7a2e\u7528\u6cd5\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>initialCount<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>initialCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      Count: </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>initialCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Reset</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=&gt;</span> prevCount <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">-</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=&gt;</span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">+</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u300c+\u300d\u548c\u300c-\u300d\u6309\u9215\u4f7f\u7528\u4e86\u51fd\u6578\u5f0f\u5f62\u5f0f\uff0c\u56e0\u70ba\u88ab\u66f4\u65b0\u7684\u503c\u662f\u57fa\u65bc\u5148\u524d\u7684\u503c\u3002\u4f46\u662f\u300cReset\u300d\u6309\u9215\u5247\u4f7f\u7528\u666e\u901a\u5f62\u5f0f\uff0c\u56e0\u70ba\u5b83\u7e3d\u662f\u628a count \u8a2d\u5b9a\u56de\u521d\u59cb\u503c\u3002</p>\n<p>\u5982\u679c\u4f60\u7684 update \u51fd\u5f0f\u56de\u50b3\u8207\u76ee\u524d\u7684 state \u76f8\u540c\u7684\u503c\uff0c\u5f8c\u7e8c\u7684 render \u5c07\u6703\u88ab\u5b8c\u6574\u8df3\u904e\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u8207 class component \u7684 <code class=\"language-javascript\">setState</code> \u65b9\u6cd5\u4e0d\u540c\uff0c<code class=\"language-javascript\">useState</code> \u4e0d\u6703\u81ea\u52d5\u5408\u4f75\u66f4\u65b0 object\u3002\u4f60\u53ef\u4ee5\u7528\u51fd\u6578\u5f0f\u66f4\u65b0\u7684\u5f62\u5f0f\u7d50\u5408 object spread \u8a9e\u6cd5\u4f86\u9054\u5230\u76f8\u540c\u6548\u679c\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevState</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u4e5f\u53ef\u4ee5\u4f7f\u7528 Object.assign</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>prevState<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>updatedValues<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u53e6\u4e00\u500b\u9078\u64c7\u662f <code class=\"language-javascript\">useReducer</code>\uff0c\u5b83\u66f4\u9069\u5408\u7528\u65bc\u7ba1\u7406\u6709\u591a\u500b\u5b50\u6578\u503c\u7684 state object\u3002</p>\n</div>\n<h4 id=\"lazy-initial-state\"><a class=\"anchor\" href=\"/react/hooks-reference#lazy-initial-state\"></a>\u60f0\u6027\u521d\u59cb state </h4>\n<p><code class=\"language-javascript\">initialState</code> \u53c3\u6578\u53ea\u6703\u5728\u521d\u59cb render \u6642\u4f7f\u7528\uff0c\u5728\u5f8c\u7e8c render \u6642\u6703\u88ab\u5ffd\u7565\u3002\u5982\u679c\u521d\u59cb state \u9700\u8981\u901a\u904e\u8907\u96dc\u7684\u8a08\u7b97\u4f86\u7372\u5f97\uff0c\u4f60\u53ef\u4ee5\u50b3\u5165\u4e00\u500b function\uff0c\u8a72 function \u53ea\u6703\u5728\u521d\u59cb render \u6642\u88ab\u8abf\u7528\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token function\">someExpensiveComputation</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> initialState<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4 id=\"bailing-out-of-a-state-update\"><a class=\"anchor\" href=\"/react/hooks-reference#bailing-out-of-a-state-update\"></a>\u8df3\u904e state \u66f4\u65b0 </h4>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u8207\u76ee\u524d state \u76f8\u540c\u503c\u4f86\u66f4\u65b0 State Hook\uff0cReact \u5c07\u6703\u8df3\u904e\u5b50 component \u7684 render \u53ca effect \u7684\u57f7\u884c\u3002\uff08React \u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description\"><code class=\"language-javascript\">Object.is</code></a>\u4f86\u6bd4\u8f03\u3002\uff09</p>\n<p>\u8acb\u6ce8\u610f React \u53ef\u80fd\u4ecd\u9700\u8981\u5728\u8df3\u904e render \u4e4b\u524d render \u8a72 component\u3002\u9019\u4e0d\u61c9\u8a72\u662f\u500b\u554f\u984c\uff0c\u56e0\u70ba React \u4e0d\u6703\u4e0d\u5fc5\u8981\u5730\u300c\u6df1\u5165\u300d\u5230 component tree \u4e2d\u3002\u5982\u679c\u4f60\u5728 render \u7576\u4e2d\u57f7\u884c\u4e86\u6602\u8cb4\u7684\u8a08\u7b97\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">useMemo</code> \u4f86\u6700\u4f73\u5316\u3002</p>\n<h4 id=\"batching-of-state-updates\"><a class=\"anchor\" href=\"/react/hooks-reference#batching-of-state-updates\"></a>Batching of state updates </h4>\n<p>React may group several state updates into a single re-render to improve performance. Normally, this improves performance and shouldn\u2019t affect your application\u2019s behavior.</p>\n<p>Before React 18, only updates inside React event handlers were batched. Starting with React 18, <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2022/03/08/react-18-upgrade-guide.html#automatic-batching\">batching is enabled for all updates by default</a>. Note that React makes sure that updates from several <em>different</em> user-initiated events \u2014 for example, clicking a button twice \u2014 are always processed separately and do not get batched. This prevents logical mistakes.</p>\n<p>In the rare case that you need to force the DOM update to be applied synchronously, you may wrap it in <a href=\"/react/react-dom#flushsync\"><code class=\"language-javascript\">flushSync</code></a>. However, this can hurt performance so do this only where needed.</p>\n<h3 id=\"useeffect\"><a class=\"anchor\" href=\"/react/hooks-reference#useeffect\"></a><code class=\"language-javascript\">useEffect</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>didUpdate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u63a5\u53d7\u4e00\u500b\u5305\u542b\u6307\u4ee4\u5f0f\uff0c\u4e14\u53ef\u80fd\u6709\u526f\u4f5c\u7528\u7a0b\u5f0f\u78bc\u7684 function\u3002</p>\n<p>\u5728 function component\uff08\u6307\u7684\u662f React \u7684 render \u968e\u6bb5\uff09\u7684 function \u5167\uff0cmutation\u3001subscription\u3001timer\u3001\u65e5\u8a8c\u8a18\u9304\u3001\u4ee5\u53ca\u5176\u4ed6 side effect \u662f\u4e0d\u88ab\u5141\u8a31\u7684\u3002\u56e0\u70ba\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u5bb9\u6613\u6df7\u6dc6\u7684 bug \u548c\u4e0d\u4e00\u81f4\u7684 UI\u3002</p>\n<p>\u76f8\u53cd\u7684\uff0c\u4f7f\u7528 <code class=\"language-javascript\">useEffect</code>\u3002\u50b3\u905e\u5230 <code class=\"language-javascript\">useEffect</code> \u7684 function \u6703\u5728 render \u5230\u87a2\u5e55\u4e4b\u5f8c\u57f7\u884c\u3002\u53ef\u4ee5\u628a effect \u770b\u4f5c React \u5f9e\u7d14\u51fd\u5f0f\u4e16\u754c\u901a\u5f80\u6307\u4ee4\u5f0f\u4e16\u754c\u7684\u8df3\u812b\u65b9\u5f0f\u3002</p>\n<p>\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0ceffect \u6703\u5728\u6bcf\u4e00\u500b\u5b8c\u6574 render \u5f8c\u57f7\u884c\uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u9078\u64c7\u5b83\u5011\u5728<a href=\"/react/hooks-reference#conditionally-firing-an-effect\">\u67d0\u4e9b\u503c\u6539\u8b8a\u7684\u6642\u5019</a>\u624d\u57f7\u884c\u3002</p>\n<h4 id=\"cleaning-up-an-effect\"><a class=\"anchor\" href=\"/react/hooks-reference#cleaning-up-an-effect\"></a>\u6e05\u9664\u4e00\u500b effect </h4>\n<p>\u901a\u5e38\u4f86\u8aaa\uff0c\u5728 component \u96e2\u958b\u87a2\u5e55\u4e4b\u524d\u9700\u8981\u6e05\u9664 effect \u6240\u5efa\u7acb\u7684\u8cc7\u6e90\uff0c\u4f8b\u5982\u50cf\u662f subscription \u6216\u8a08\u6642\u5668\u7684 ID\u3002\u8981\u505a\u5230\u9019\u4e00\u9ede\uff0c\u50b3\u905e\u5230 <code class=\"language-javascript\">useEffect</code> \u7684 function \u53ef\u4ee5\u56de\u50b3\u4e00\u500b\u6e05\u9664\u7684 function\u3002\u4f8b\u5982\uff0c\u8981\u5efa\u7acb\u4e00\u500b subscription\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> subscription <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Clean up the subscription</span>\n    subscription<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u6e05\u9664 function \u6703\u5728 component \u5f9e UI \u88ab\u79fb\u9664\u524d\u57f7\u884c\uff0c\u4f86\u9632\u6b62 memory leak\u3002\u6b64\u5916\uff0c\u5982\u679c component render \u4e86\u6578\u6b21\uff08\u5b83\u5011\u901a\u5e38\u6703\u9019\u6a23\uff09\uff0c\u5728<strong>\u57f7\u884c\u4e0b\u4e00\u500b effect \u524d\uff0c\u4e0a\u4e00\u500b effect \u5c31\u5df2\u88ab\u6e05\u9664</strong>\u3002\u5728\u4e0a\u8ff0\u7684\u4f8b\u5b50\u4e2d\uff0c\u610f\u5473\u8457\u6bcf\u4e00\u6b21\u66f4\u65b0\u90fd\u6703\u5efa\u7acb\u4e00\u500b\u65b0 subscription\u3002\u8981\u907f\u514d\u6bcf\u6b21\u66f4\u65b0\u90fd\u89f8\u767c effect \u7684\u57f7\u884c\uff0c\u8acb\u53c3\u95b1\u4e0b\u4e00\u500b\u7ae0\u7bc0\u3002</p>\n<h4 id=\"timing-of-effects\"><a class=\"anchor\" href=\"/react/hooks-reference#timing-of-effects\"></a>Effect \u7684\u6642\u6a5f </h4>\n<p>\u8207 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code> \u4e0d\u540c\uff0c\u5728\u5ef6\u9072\u4e8b\u4ef6\u671f\u9593\uff0c\u50b3\u905e\u7d66 <code class=\"language-javascript\">useEffect</code> \u7684 function \u6703\u5728 layout \u548c render <strong>\u4e4b\u5f8c</strong>\u89f8\u767c\u3002\u9019\u4f7f\u5b83\u9069\u7528\u65bc\u5f88\u591a\u5e38\u898b\u7684 side effect\uff0c\u4f8b\u5982\u8a2d\u5b9a subscription \u548c event handler\uff0c\u56e0\u70ba\u7d55\u5927\u90e8\u4efd\u7684\u5de5\u4f5c\u90fd\u4e0d\u61c9\u8a72\u963b\u7919\u700f\u89bd\u5668\u66f4\u65b0\u665d\u9762\u3002</p>\n<p>\u7136\u800c\uff0c\u4e0d\u662f\u6240\u6709\u7684 effect \u90fd\u53ef\u4ee5\u88ab\u5ef6\u5f8c\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u8005\u53ef\u898b\u7684 DOM \u6539\u8b8a\u5fc5\u9808\u5728\u4e0b\u4e00\u6b21\u7e6a\u88fd\u4e4b\u524d\u540c\u6b65\u89f8\u767c\uff0c\u9019\u6a23\u4f7f\u7528\u8005\u624d\u4e0d\u6703\u611f\u89ba\u5230\u8996\u89ba\u4e0d\u4e00\u81f4\u3002\uff08\u6982\u5ff5\u4e0a\u985e\u4f3c\u88ab\u52d5\u548c\u4e3b\u52d5 event listener \u7684\u5340\u5225\u3002\uff09\u70ba\u9019\u985e\u578b\u7684 effect\uff0cReact \u63d0\u4f9b\u4e86\u4e00\u500b\u984d\u5916\u7684 <a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a> Hook\u3002\u5b83\u548c <code class=\"language-javascript\">useEffect</code> \u7684\u7d50\u69cb\u76f8\u540c\uff0c\u53ea\u662f\u57f7\u884c\u7684\u6642\u6a5f\u4e0d\u540c\u800c\u5df2\u3002</p>\n<p>\u6b64\u5916\uff0c\u5f9e React 18 \u958b\u59cb\uff0c\u50b3\u7d66 <code class=\"language-javascript\">useEffect</code> \u7684 function \u5c07\u5728 layout \u548c paint <strong>\u4e4b\u524d</strong> \u540c\u6b65\u7684\u89f8\u767c\uff0c\u7576\u5b83\u662f\u4e00\u500b\u96e2\u6563\u7684\u4f7f\u7528\u8005\u8f38\u5165\uff08\u50cf\u662f\u9ede\u64ca\uff09\u6216\u7576\u5b83\u662f\u4e00\u500b\u88ab wrap \u5728 <a href=\"/react/react-dom#flushsync\"><code class=\"language-javascript\">flushSync</code></a> \u7684\u66f4\u65b0\u7d50\u679c\u3002\u9019\u500b\u884c\u70ba\u8b93 event system \u6216 <a href=\"/react/react-dom#flushsync\"><code class=\"language-javascript\">flushSync</code></a> \u7684 caller \u89c0\u5bdf effect \u7684\u7d50\u679c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u9019\u53ea\u6703\u5f71\u97ff\u50b3\u905e\u7d66 <code class=\"language-javascript\">useEffect</code> \u7684 function \u7684\u88ab\u547c\u53eb\u6642\u9593 - \u5728\u9019\u4e9b effect \u4e2d\u5b89\u6392\u7684\u66f4\u65b0\u4ecd\u7136\u6703\u88ab\u5ef6\u9072\u3002\u9019\u8207 <a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a> \u4e0d\u540c\uff0c\u5f8c\u8005\u6703\u89f8\u767c function \u4e26\u7acb\u5373\u8655\u7406\u5176\u66f4\u65b0\u3002</p>\n</div>\n<p>\u96d6\u7136 <code class=\"language-javascript\">useEffect</code> \u6703\u88ab\u5ef6\u9072\u76f4\u5230\u700f\u89bd\u5668\u7e6a\u5236\u5b8c\u6210\uff0c\u4f46\u6703\u4fdd\u8b49\u5728\u4efb\u4f55\u65b0 render \u524d\u57f7\u884c\u3002React \u6703\u5728\u958b\u59cb\u65b0\u4e00\u500b\u66f4\u65b0\u524d\u5237\u65b0\u4e0a\u4e00\u8f2a render \u7684 effect\u3002</p>\n<h4 id=\"conditionally-firing-an-effect\"><a class=\"anchor\" href=\"/react/hooks-reference#conditionally-firing-an-effect\"></a>\u6709\u689d\u4ef6\u7684\u89f8\u767c effect </h4>\n<p>effect \u7684\u9810\u8a2d\u884c\u70ba\u662f\u5728\u6bcf\u6b21\u5b8c\u6210 render \u5f8c\u89f8\u767c effect\u3002\u9019\u6a23\u7684\u8a71\uff0c\u5982\u679c\u5176\u4e2d\u4e00\u500b\u4f9d\u8cf4\u6709\u6539\u8b8a\uff0c\u5247\u6703\u91cd\u65b0\u5efa\u7acb\u4e00\u500b effect\u3002</p>\n<p>\u7136\u800c\uff0c\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u9019\u53ef\u80fd\u77ef\u6789\u904e\u6b63\uff0c\u4f8b\u5982\u5728\u4e0a\u4e00\u7ae0\u7bc0\u7684 subscription \u7bc4\u4f8b\u3002\u6211\u5011\u53ea\u9700\u8981\u5728 <code class=\"language-javascript\">source</code> prop \u6539\u8b8a\u5f8c\u624d\u91cd\u65b0\u5efa\u7acb subscription\uff0c\u800c\u4e0d\u9700\u8981\u5728\u6bcf\u6b21\u66f4\u65b0\u5f8c\u3002</p>\n<p>\u8981\u5be6\u73fe\u9019\u4e00\u9ede\uff0c\u53ef\u4ee5\u5411 <code class=\"language-javascript\">useEffect</code> \u50b3\u905e\u7b2c\u4e8c\u500b\u53c3\u6578\uff0c\u5b83\u662f\u8a72 effect \u6240\u4f9d\u8cf4\u7684\u503c array\u3002\u6211\u5011\u66f4\u65b0\u5f8c\u7684\u7bc4\u4f8b\u5982\u4e0b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> subscription <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      subscription<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u73fe\u5728\u53ea\u6709\u7576 <code class=\"language-javascript\">props.source</code> \u6539\u8b8a\u6642\u624d\u6703\u91cd\u65b0\u5efa\u7acb subscription\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u82e5\u4f60\u4f7f\u7528\u9019\u500b\u6700\u4f73\u5316\u7684\u65b9\u5f0f\uff0c\u8acb\u78ba\u4fdd\u8a72 array \u5305\u542b\u4e86<strong>\u6240\u6709\u5728\u8a72 component \u4e2d\u6703\u96a8\u6642\u9593\u800c\u8b8a\u7684\u503c\uff08\u4f8b\u5982 props \u548c state\uff09\u4ee5\u53ca\u5728\u8a72 effect \u6240\u4f7f\u7528\u5230\u7684\u503c\u3002</strong>\u5426\u5247\uff0c\u4f60\u7684\u7a0b\u5f0f\u78bc\u6703\u5f15\u7528\u5148\u524d render \u7684\u820a\u8b8a\u6578\u3002\u4e86\u89e3\u66f4\u591a<a href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\">\u5982\u4f55\u8655\u7406 function</a> \u548c\u7576 <a href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\">array \u7684\u503c\u983b\u7e41\u8b8a\u5316\u6642</a>\u7684\u8655\u7406\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3 effect \u53ea\u57f7\u884c\u548c\u6e05\u9664\u4e00\u6b21\uff08\u5728 mount \u548c unmount\uff09\uff0c\u4f60\u53ef\u4ee5\u50b3\u905e\u4e00\u500b\u7a7a\u7684 array \uff08<code class=\"language-javascript\">[]</code>\uff09\u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u3002\u9019\u544a\u8a22 React \u4f60\u7684 effect \u6c92\u6709\u4f9d\u8cf4<em>\u4efb\u4f55</em>\u5728 props \u6216 state \u7684\u503c\uff0c\u6240\u4ee5\u5b83\u6c38\u9060\u4e0d\u9700\u88ab\u518d\u6b21\u57f7\u884c\u3002\u9019\u4e26\u4e0d\u662f\u4e00\u500b\u7279\u6b8a\u8655\u7406 \u2014 \u5b83\u4f9d\u7136\u9075\u5faa\u4f9d\u8cf4 array \u7684\u904b\u4f5c\u65b9\u5f0f\u3002</p>\n<p>\u5982\u679c\u4f60\u50b3\u5165\u4e86\u4e00\u500b\u7a7a\u7684 array\uff08<code class=\"language-javascript\">[]</code>\uff09\uff0ceffect \u5167\u90e8\u7684 props \u548c state \u5c31\u4e00\u76f4\u64c1\u6709\u5176\u521d\u59cb\u503c\u3002\u5118\u7ba1\u50b3\u5165 <code class=\"language-javascript\">[]</code> \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u6709\u9ede\u985e\u4f3c <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentWillUnmount</code> \u7684\u601d\u7dad\u6a21\u5f0f\uff0c\u4f46\u5176\u5be6\u6709<a href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\">\u66f4\u597d\u7684</a><a href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\">\u65b9\u6cd5</a>\u4f86\u907f\u514d\u904e\u65bc\u983b\u7e41\u5730\u91cd\u8907\u57f7\u884c effect\u3002\u800c\u4e14\uff0c\u4e0d\u8981\u5fd8\u8a18 React \u6703\u5ef6\u5f8c\u57f7\u884c <code class=\"language-javascript\">useEffect</code> \u76f4\u81f3\u700f\u89bd\u5668\u5b8c\u6210\u7e6a\u5236\uff0c\u6240\u4ee5\u984d\u5916\u7684\u5de5\u4f5c\u4e5f\u4e0d\u6703\u662f\u592a\u5927\u554f\u984c\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> \u4e2d\u7684 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> \u898f\u5247\u3002\u5b83\u6703\u5728\u4f9d\u8cf4\u932f\u8aa4\u6642\u767c\u51fa\u8b66\u544a\u4e26\u63d0\u51fa\u4fee\u6b63\u5efa\u8b70\u3002</p>\n</div>\n<p>\u4f9d\u8cf4 array \u4e26\u4e0d\u4f5c\u70ba\u50b3\u5230 effect function \u7684\u53c3\u6578\u3002\u4f46\u5f9e\u6982\u5ff5\u4e0a\u4f86\u8aac\uff0c\u9019\u662f\u5b83\u6240\u4ee3\u8868\u7684\uff1a\u6240\u6709\u5728 effect function \u4e2d\u5f15\u7528\u7684\u503c\u90fd\u61c9\u8a72\u51fa\u73fe\u5728\u4f9d\u8cf4 array \u4e2d\u3002\u5728\u672a\u4f86\uff0c\u4e00\u500b\u8db3\u5920\u5148\u9032\u7684\u7de8\u8b6f\u5668\u53ef\u4ee5\u81ea\u52d5\u5efa\u7acb\u9019\u500b array\u3002</p>\n<h3 id=\"usecontext\"><a class=\"anchor\" href=\"/react/hooks-reference#usecontext\"></a><code class=\"language-javascript\">useContext</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>MyContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u63a5\u6536\u4e00\u500b context object\uff08<code class=\"language-javascript\">React.createContext</code> \u7684\u56de\u50b3\u503c\uff09\u4e26\u56de\u50b3\u8a72 context \u76ee\u524d\u7684\u503c\u3002Context \u76ee\u524d\u7684\u503c\u662f\u53d6\u6c7a\u65bc\u7531\u4e0a\u5c64 component \u8ddd\u96e2\u6700\u8fd1\u7684 <code class=\"language-javascript\">&lt;MyContext.Provider&gt;</code> \u7684 <code class=\"language-javascript\">value</code> prop\u3002</p>\n<p>\u7576 component \u4e0a\u5c64\u6700\u8fd1\u7684 <code class=\"language-javascript\">&lt;MyContext.Provider&gt;</code> \u66f4\u65b0\u6642\uff0c\u8a72 hook \u6703\u89f8\u767c\u91cd\u65b0 render\uff0c\u4e26\u4f7f\u7528\u6700\u65b0\u50b3\u905e\u5230 <code class=\"language-javascript\">MyContext</code> \u7684 context <code class=\"language-javascript\">value</code> \u50b3\u9001\u5230 <code class=\"language-javascript\">MyContext</code> provider\u3002\u5373\u4fbf ancestor \u4f7f\u7528 <a href=\"/react/react-api#reactmemo\"><code class=\"language-javascript\">React.memo</code></a> \u6216 <a href=\"/react/react-component#shouldcomponentupdate\"><code class=\"language-javascript\">shouldComponentUpdate</code></a>\uff0c\u91cd\u65b0 render \u4ecd\u7136\u5f9e\u4f7f\u7528 <code class=\"language-javascript\">useContext</code> \u7684 component \u672c\u8eab\u958b\u59cb\u3002</p>\n<p>\u4e0d\u8981\u5fd8\u8a18 <code class=\"language-javascript\">useContext</code> \u7684\u53c3\u6578\u5fc5\u9700\u70ba <em>context object \u81ea\u5df1</em>\uff1a</p>\n<ul>\n<li><strong>\u6b63\u78ba:</strong> <code class=\"language-javascript\">useContext(MyContext)</code></li>\n<li><strong>\u932f\u8aa4:</strong> <code class=\"language-javascript\">useContext(MyContext.Consumer)</code></li>\n<li><strong>\u932f\u8aa4:</strong> <code class=\"language-javascript\">useContext(MyContext.Provider)</code></li>\n</ul>\n<p>\u547c\u53eb <code class=\"language-javascript\">useContext</code> \u7684 component \u7e3d\u662f\u6703\u5728 context \u503c\u66f4\u65b0\u6642\u91cd\u65b0 render\u3002\u5982\u679c\u91cd\u65b0 render component \u7684\u64cd\u4f5c\u5f88\u6602\u8cb4\uff0c\u4f60\u53ef\u4ee5<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/15156#issuecomment-474590693\">\u900f\u904e memoization \u4f86\u6700\u4f73\u5316</a>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5047\u82e5\u4f60\u5728\u63a5\u89f8 hook \u524d\u5df2\u719f\u6089 context API\uff0c<code class=\"language-javascript\">useContext(MyContext)</code> \u5c31\u76f8\u7b49\u65bc class \u4e2d\u7684 <code class=\"language-javascript\">static contextType = MyContext</code> \u6216 <code class=\"language-javascript\">&lt;MyContext.Consumer&gt;</code>\u3002</p>\n<p><code class=\"language-javascript\">useContext(MyContext)</code> \u53ea\u80fd\u8b93\u4f60<em>\u8b80\u53d6</em> context \u53ca\u8a02\u95b1\u5176\u8b8a\u66f4\u3002\u4f60\u4ecd\u7136\u9700\u8981\u5728 tree \u7684\u4e0a\u5c64\u4f7f\u7528<code class=\"language-javascript\">&lt;MyContext.Provider&gt;</code> \u4f86\u63d0\u4f9b context \u7684\u503c\u3002</p>\n</div>\n<p><strong>\u8207 Context.Provider \u653e\u5728\u4e00\u8d77</strong></p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> themes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">light</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">foreground</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#000000\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#eeeeee\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">dark</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">foreground</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#ffffff\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#222222\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span>themes<span class=\"token punctuation\">.</span>light<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>themes<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toolbar</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeContext.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Toolbar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemedButton</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ThemedButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>ThemeContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>background<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>foreground <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      I am styled by theme context!</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6b64\u70ba\u4f7f\u7528 Hook \u4fee\u6539\u4e4b\u524d <a href=\"/react/context\">Context Advanced Guide</a> \u4e2d\u7684\u7bc4\u4f8b\uff0c\u4f60\u53ef\u4ee5\u5728\u90a3\u88e1\u4e86\u89e3\u66f4\u591a Context \u7684\u8cc7\u8a0a\uff0c\u50cf\u662f\u4f55\u6642\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528 Context\u3002</p>\n<h2 id=\"additional-hooks\"><a class=\"anchor\" href=\"/react/hooks-reference#additional-hooks\"></a>\u984d\u5916\u7684 Hooks </h2>\n<p>\u4ee5\u4e0b\u7684 Hook\uff0c\u6709\u4e9b\u662f\u4e0a\u4e00\u7bc0\u4e2d\u57fa\u790e\u7684 Hook \u7684\u8b8a\u7570\uff0c\u6709\u4e9b\u5247\u662f\u5728\u7279\u6b8a\u60c5\u6cc1\u4e0b\u4f7f\u7528\u3002\u4e0d\u7528\u7279\u5730\u9810\u5148\u5b78\u7fd2\u5b83\u5011\u3002</p>\n<h3 id=\"usereducer\"><a class=\"anchor\" href=\"/react/hooks-reference#usereducer\"></a><code class=\"language-javascript\">useReducer</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">,</span> initialArg<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code></a> \u7684\u66ff\u4ee3\u65b9\u6848\u3002\u63a5\u53d7\u4e00\u500b <code class=\"language-javascript\">(state, action) =&gt; newState</code> \u7684 reducer\uff0c\u7136\u5f8c\u56de\u50b3\u73fe\u5728\u7684 state \u4ee5\u53ca\u5176\u914d\u5957\u7684 <code class=\"language-javascript\">dispatch</code> \u65b9\u6cd5\u3002\uff08\u5982\u679c\u4f60\u719f\u6089 Redux\uff0c\u4f60\u5df2\u7d93\u77e5\u9053\u9019\u5982\u4f55\u904b\u4f5c\u3002\uff09</p>\n<p>\u7576\u4f60\u9700\u8981\u8907\u96dc\u7684 state \u908f\u8f2f\u800c\u4e14\u5305\u62ec\u591a\u500b\u5b50\u6578\u503c\u6216\u4e0b\u4e00\u500b state \u4f9d\u8cf4\u4e4b\u524d\u7684 state\uff0c<code class=\"language-javascript\">useReducer</code> \u6703\u6bd4 <code class=\"language-javascript\">useState</code> \u66f4\u9069\u7528\u3002\u800c\u4e14 <code class=\"language-javascript\">useReducer</code> \u53ef\u4ee5\u8b93\u4f60\u89f8\u767c\u6df1\u5c64\u66f4\u65b0\u7684 component \u4f5c\u6548\u80fd\u7684\u6700\u4f73\u5316\uff0c\u56e0\u70ba<a href=\"/react/hooks-faq#how-to-avoid-passing-callbacks-down\">\u4f60\u53ef\u4ee5\u50b3\u905e dispatch \u800c\u4e0d\u662f callback</a>\u3002</p>\n<p>\u4ee5\u4e0b\u662f\u7528 reducer \u91cd\u5beb <a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code></a> \u4e00\u7bc0\u7684\u7bc4\u4f8b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'increment'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'decrement'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">,</span> initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      Count: </span><span class=\"token punctuation\">{</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'decrement'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">-</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'increment'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">+</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>React \u78ba\u4fdd <code class=\"language-javascript\">dispatch</code> function \u672c\u8eab\u662f\u7a69\u5b9a\u7684\uff0c\u800c\u4e14\u4e0d\u6703\u5728\u91cd\u65b0 render \u6642\u6539\u8b8a\u3002\u9019\u5c31\u70ba\u4ec0\u9ebc\u53ef\u4ee5\u5b89\u5168\u5730\u5f9e <code class=\"language-javascript\">useEffect</code> \u6216 <code class=\"language-javascript\">useCallback</code> \u7684\u4f9d\u8cf4\u5217\u8868\u7701\u7565\u5b83\u3002</p>\n</div>\n<h4 id=\"specifying-the-initial-state\"><a class=\"anchor\" href=\"/react/hooks-reference#specifying-the-initial-state\"></a>\u6307\u5b9a\u521d\u59cb state </h4>\n<p>\u6709\u5169\u7a2e\u4e0d\u540c\u521d\u59cb\u5316 <code class=\"language-javascript\">useReducer</code> state \u7684\u65b9\u6cd5\u3002\u4f60\u53ef\u4ee5\u6839\u64da\u4f7f\u7528\u5834\u666f\u9078\u64c7\u4efb\u4f55\u4e00\u7a2e\u3002\u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u5c31\u662f\u628a\u521d\u59cb state \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\u50b3\u5165\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>\n    reducer<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> initialCount<span class=\"token punctuation\">}</span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>React \u4e0d\u4f7f\u7528 <code class=\"language-javascript\">state = initialState</code> \u9019\u500b\u7531 Redux \u63a8\u5ee3\u958b\u4f86\u7684\u53c3\u6578\u6163\u4f8b\u3002\u521d\u59cb\u503c\u6709\u6642\u9700\u8981\u4f9d\u8cf4\u65bc prop\uff0c\u56e0\u6b64\u9700\u8981\u5728\u547c\u53eb Hook \u6642\u6307\u5b9a\u3002\u5982\u679c\u4f60\u8f03\u504f\u611b\u4e0a\u8ff0\u7684\u6163\u4f8b\uff0c\u4f60\u53ef\u4ee5\u547c\u53eb <code class=\"language-javascript\">useReducer(reducer, undefined, reducer)</code> \u4f86\u6478\u64ec Redux \u7684\u884c\u70ba\uff0c\u4f46\u9019\u662f\u4e0d\u9f13\u52f5\u7684\u3002</p>\n</div>\n<h4 id=\"lazy-initialization\"><a class=\"anchor\" href=\"/react/hooks-reference#lazy-initialization\"></a>\u60f0\u6027\u521d\u59cb\u5316 </h4>\n<p>\u4f60\u4e5f\u53ef\u4ee5\u60f0\u6027\u7684\u5efa\u7acb\u521d\u59cb state\u3002\u4f60\u53ef\u4ee5\u50b3\u5165 <code class=\"language-javascript\">init</code> function \u4f5c\u70ba\u7b2c\u4e09\u500b\u53c3\u6578\u3002\u521d\u59cb\u7684 state \u6703\u88ab\u8a2d\u5b9a\u70ba <code class=\"language-javascript\">init(initialArg)</code>\u3002</p>\n<p>\u9019\u6a23\u8b93\u4f60\u53ef\u4ee5\u5c07\u8a08\u7b97\u521d\u59cb state \u7684\u908f\u8f2f\u63d0\u53d6\u5230 reducer \u5916\u3002\u800c\u4e14\u4e5f\u65b9\u4fbf\u4e86\u5c07\u4f86\u8655\u7406\u91cd\u7f6e state \u7684 action\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">initialCount</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> initialCount<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'increment'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'decrement'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">case</span> <span class=\"token string\">'reset'</span><span class=\"token operator\">:</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>initialCount<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">,</span> initialCount<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      Count: </span><span class=\"token punctuation\">{</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'reset'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">payload</span><span class=\"token operator\">:</span> initialCount<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">        Reset</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'decrement'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">-</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'increment'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">+</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"bailing-out-of-a-dispatch\"><a class=\"anchor\" href=\"/react/hooks-reference#bailing-out-of-a-dispatch\"></a>\u8df3\u904e dispatch </h4>\n<p>\u5982\u679c\u4f60\u5728 Reducer Hook \u56de\u50b3\u7684\u503c\u8207\u76ee\u524d\u7684 state \u76f8\u540c\uff0cReact \u5c07\u6703\u8df3\u904e child component \u7684 render \u53ca effect \u7684\u57f7\u884c\u3002\uff08React \u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description\"><code class=\"language-javascript\">Object.is</code></a>\u4f86\u6bd4\u8f03\u3002\uff09</p>\n<p>\u8acb\u6ce8\u610f React \u53ef\u80fd\u4ecd\u9700\u8981\u5728\u8df3\u904e render \u4e4b\u524d render \u8a72 component\u3002\u9019\u4e0d\u61c9\u8a72\u662f\u500b\u554f\u984c\uff0c\u56e0\u70ba React \u4e0d\u6703\u4e0d\u5fc5\u8981\u5730\u300c\u6df1\u5165\u300d\u5230 tree \u4e2d\u3002\u5982\u679c\u4f60\u5728 render \u7576\u4e2d\u57f7\u884c\u4e86\u6602\u8cb4\u7684\u8a08\u7b97\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">useMemo</code> \u4f86\u6700\u4f73\u5316\u3002</p>\n<h3 id=\"usecallback\"><a class=\"anchor\" href=\"/react/hooks-reference#usecallback\"></a><code class=\"language-javascript\">useCallback</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> memoizedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Memoization\">memoized</a> \u7684 callback\u3002</p>\n<p>\u50b3\u905e\u4e00\u500b inline callback \u53ca\u4f9d\u8cf4 array\u3002<code class=\"language-javascript\">useCallback</code> \u6703\u56de\u50b3\u8a72 callback \u7684 memoized \u7248\u672c\uff0c\u5b83\u50c5\u5728\u4f9d\u8cf4\u6539\u8b8a\u6642\u624d\u6703\u66f4\u65b0\u3002\u7576\u50b3\u905e callback \u5230\u5df2\u7d93\u6700\u4f73\u5316\u7684 child component \u6642\u975e\u5e38\u6709\u7528\uff0c\u9019\u4e9b child component \u4f9d\u8cf4\u65bc\u5f15\u7528\u76f8\u7b49\u6027\u4f86\u9632\u6b62\u4e0d\u5fc5\u8981\u7684 render\uff08\u4f8b\u5982\uff0c<code class=\"language-javascript\">shouldComponentUpdate</code>\uff09</p>\n<p><code class=\"language-javascript\">useCallback(fn, deps)</code> \u76f8\u7b49\u65bc <code class=\"language-javascript\">useMemo(() =&gt; fn, deps)</code>\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f9d\u8cf4 array \u4e26\u4e0d\u4f5c\u70ba\u50b3\u5230 callback \u7684\u53c3\u6578\u3002\u4f46\u5f9e\u6982\u5ff5\u4e0a\u4f86\u8aac\uff0c\u9019\u662f\u5b83\u6240\u4ee3\u8868\u7684\uff1a\u6240\u6709\u5728 callback \u4e2d\u5f15\u7528\u7684\u503c\u90fd\u61c9\u8a72\u51fa\u73fe\u5728\u4f9d\u8cf4 array \u4e2d\u3002\u5728\u672a\u4f86\uff0c\u4e00\u500b\u8db3\u5920\u5148\u9032\u7684\u7de8\u8b6f\u5668\u53ef\u4ee5\u81ea\u52d5\u5efa\u7acb\u9019\u500b array\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> \u4e2d\u7684 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> \u898f\u5247\u3002\u5b83\u6703\u5728\u4f9d\u8cf4\u932f\u8aa4\u6642\u767c\u51fa\u8b66\u544a\u4e26\u63d0\u51fa\u4fee\u6b63\u5efa\u8b70\u3002</p>\n</div>\n<h3 id=\"usememo\"><a class=\"anchor\" href=\"/react/hooks-reference#usememo\"></a><code class=\"language-javascript\">useMemo</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> memoizedValue <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">computeExpensiveValue</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Memoization\">memoized</a> \u7684\u503c\u3002</p>\n<p>\u50b3\u905e\u4e00\u500b\u300c\u5efa\u7acb\u300dfunction \u53ca\u4f9d\u8cf4 array\u3002<code class=\"language-javascript\">useMemo</code> \u53ea\u6703\u5728\u4f9d\u8cf4\u6539\u8b8a\u6642\u624d\u91cd\u65b0\u8a08\u7b97 memoized \u7684\u503c\u3002\u9019\u500b\u6700\u4f73\u5316\u53ef\u4ee5\u907f\u514d\u5728\u6bcf\u6b21 render \u90fd\u9032\u884c\u6602\u8cb4\u7684\u8a08\u7b97\u3002</p>\n<p>\u8981\u8b39\u8a18\u50b3\u5230 <code class=\"language-javascript\">useMemo</code> \u7684 function \u6703\u5728 render \u671f\u9593\u57f7\u884c\u3002\u4e0d\u8981\u505a\u4e00\u4e9b\u901a\u5e38\u4e0d\u6703\u5728 render \u671f\u9593\u505a\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\uff0c\u8655\u7406 side effect \u5c6c\u65bc <code class=\"language-javascript\">useEffect</code>\uff0c\u800c\u4e0d\u662f <code class=\"language-javascript\">useMemo</code>\u3002</p>\n<p>\u5982\u679c\u6c92\u6709\u63d0\u4f9b array\uff0c\u6bcf\u6b21 render \u6642\u90fd\u6703\u8a08\u7b97\u65b0\u7684\u503c\u3002</p>\n<p><strong>\u4f60\u53ef\u4ee5\u628a <code class=\"language-javascript\">useMemo</code> \u4f5c\u70ba\u6548\u80fd\u6700\u4f73\u5316\u7684\u624b\u6bb5\uff0c\u4f46\u8acb\u4e0d\u8981\u628a\u5b83\u7576\u4f5c\u6210\u8a9e\u610f\u4e0a\u7684\u4fdd\u8b49\u3002</strong>\u5728\u5c07\u4f86\uff0cReact \u53ef\u80fd\u6703\u9078\u64c7\u300c\u5fd8\u8a18\u300d\u67d0\u4e9b\u4e4b\u524d\u5df2 memorize \u7684\u503c\u4e26\u5728\u4e0b\u4e00\u6b21 render \u6642\u91cd\u65b0\u8a08\u7b97\uff0c\u4f8b\u5982\uff0c\u70ba\u5df2\u96e2\u958b\u87a2\u5e55\u7684 component \u91cb\u653e\u8a18\u61b6\u9ad4\u3002\u5148\u64b0\u5beb\u6c92\u6709 <code class=\"language-javascript\">useMemo</code> \u4e5f\u53ef\u57f7\u884c\u7684\u4ee3\u78bc \u2014 \u7136\u5f8c\u518d\u52a0\u5165\u5b83\u4f86\u505a\u6548\u80fd\u6700\u4f73\u5316\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u4f9d\u8cf4 array \u4e26\u4e0d\u4f5c\u70ba\u50b3\u5230 function \u7684\u53c3\u6578\u3002\u4f46\u5f9e\u6982\u5ff5\u4e0a\u4f86\u8aac\uff0c\u9019\u662f\u5b83\u6240\u4ee3\u8868\u7684\uff1a\u6240\u6709\u5728 callback \u4e2d\u5f15\u7528\u7684\u503c\u90fd\u61c9\u8a72\u51fa\u73fe\u5728\u4f9d\u8cf4 array \u4e2d\u3002\u5728\u672a\u4f86\uff0c\u4e00\u500b\u8db3\u5920\u5148\u9032\u7684\u7de8\u8b6f\u5668\u53ef\u4ee5\u81ea\u52d5\u5efa\u7acb\u9019\u500b array\u3002</p>\n<p>\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> \u4e2d\u7684 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> \u898f\u5247\u3002\u5b83\u6703\u5728\u4f9d\u8cf4\u932f\u8aa4\u6642\u767c\u51fa\u8b66\u544a\u4e26\u63d0\u51fa\u4fee\u6b63\u5efa\u8b70\u3002</p>\n</div>\n<h3 id=\"useref\"><a class=\"anchor\" href=\"/react/hooks-reference#useref\"></a><code class=\"language-javascript\">useRef</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> refContainer <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span>initialValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">useRef</code> \u56de\u50b3\u4e00\u500b mutable \u7684 ref object\uff0c<code class=\"language-javascript\">.current</code> \u5c6c\u6027\u88ab\u521d\u59cb\u70ba\u50b3\u5165\u7684\u53c3\u6578\uff08<code class=\"language-javascript\">initialValue</code>\uff09\u3002\u56de\u50b3\u7684 object \u5728 component \u7684\u751f\u547d\u9031\u671f\u5c07\u4fdd\u6301\u4e0d\u8b8a\u3002</p>\n<p>\u4e00\u500b\u5e38\u898b\u7684\u4f7f\u7528\u60c5\u5883\u5c31\u662f\u547d\u4ee4\u5f0f\u7684\u8a2a\u554f child component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">TextInputWithFocusButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputEl <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onButtonClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// `current` points to the mounted text input element</span>\n    inputEl<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>inputEl<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onButtonClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Focus the input</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u672c\u8cea\u4e0a\uff0c<code class=\"language-javascript\">useRef</code> \u5c31\u50cf\u4e00\u500b\u53ef\u4ee5\u6301\u6709 mutable \u7684\u503c\u5728 <code class=\"language-javascript\">.current</code> \u5c6c\u6027\u7684\u300c\u76d2\u5b50\u300d\u3002</p>\n<p>\u4f60\u61c9\u8a72\u719f\u6089 ref\uff0c\u5b83\u4e00\u7a2e\u4e3b\u8981\u662f\u7528\u4f86<a href=\"/react/refs-and-the-dom\">\u8a2a\u554f DOM</a> \u7684\u65b9\u5f0f\u3002\u5982\u679c\u4f60\u5728 React \u4e2d\u4ee5 <code class=\"language-javascript\">&lt;div ref={myRef} /&gt;</code> \u50b3\u5165 ref object\uff0c\u7121\u8ad6\u7bc0\u9ede\u5982\u4f55\u6539\u8b8a\uff0cReact \u90fd\u6703\u5c07\u5176 <code class=\"language-javascript\">.current</code> \u5c6c\u6027\u8a2d\u70ba\u76f8\u61c9\u7684 DOM \u7bc0\u9ede\u3002</p>\n<p>\u7136\u800c\uff0c<code class=\"language-javascript\">useRef()</code> \u6bd4 <code class=\"language-javascript\">ref</code> \u5c6c\u6027\u66f4\u6709\u7528\u3002\u5b83\u53ef\u4ee5<a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">\u5f88\u65b9\u4fbf\u5730\u6301\u6709\u4efb\u4f55 mutable \u7684\u503c</a>\uff0c\u8ddf class \u4e2d\u7684 instance field \u985e\u4f3c\u3002</p>\n<p>\u9019\u662f\u56e0\u70ba <code class=\"language-javascript\">useRef()</code> \u6703\u5efa\u7acb\u4e00\u500b\u666e\u901a\u7684 JavaScript object\u3002<code class=\"language-javascript\">useRef()</code> \u548c\u81ea\u5efa\u4e00\u500b <code class=\"language-javascript\">{current: ...}</code> object \u7684\u552f\u4e00\u4e0d\u540c\u662f\uff0c<code class=\"language-javascript\">useRef</code> \u5728\u6bcf\u6b21 render \u6642\u90fd\u6703\u7d66\u4f60\u540c\u4e00\u500b\u7684 ref object\u3002</p>\n<p>\u8acb\u8a18\u4f4f <code class=\"language-javascript\">useRef</code> \u5728\u5176\u5167\u5bb9\u6709\u8b8a\u5316\u6642\u4e26<em>\u4e0d\u6703</em>\u901a\u77e5\u4f60\u3002\u8b8a\u66f4 <code class=\"language-javascript\">.current</code> \u5c6c\u6027\u4e0d\u6703\u89f8\u767c\u91cd\u65b0 render\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728 React \u7d81\u5b9a\u6216\u89e3\u7d81 DOM \u7bc0\u9ede\u7684 ref \u6642\u57f7\u884c\u7a0b\u5f0f\u78bc\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u4f7f\u7528 <a href=\"/react/hooks-faq#how-can-i-measure-a-dom-node\">callback ref</a> \u4f86\u5be6\u73fe\u3002</p>\n<h3 id=\"useimperativehandle\"><a class=\"anchor\" href=\"/react/hooks-reference#useimperativehandle\"></a><code class=\"language-javascript\">useImperativeHandle</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useImperativeHandle</span><span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">,</span> createHandle<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>deps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">useImperativeHandle</code> \u53ef\u4ee5\u8b93\u4f7f\u7528 <code class=\"language-javascript\">ref</code> \u6642\u80fd\u5411\u7236 component \u66b4\u9732\u81ea\u5b9a\u7fa9\u7684 instance \u503c\u3002\u4e00\u5982\u65e2\u5f80\uff0c\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b\u61c9\u907f\u514d\u4f7f\u7528 ref \u7684\u547d\u4ee4\u5f0f\u4ee3\u78bc\u3002<code class=\"language-javascript\">useImperativeHandle</code> \u61c9\u8207 <a href=\"/react/react-api#reactforwardref\"><code class=\"language-javascript\">forwardRef</code></a> \u4e00\u540c\u4f7f\u7528\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">FancyInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> ref</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputRef <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useImperativeHandle</span><span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">focus</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      inputRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>inputRef<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">...</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nFancyInput <span class=\"token operator\">=</span> <span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span>FancyInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0crender <code class=\"language-javascript\">&lt;FancyInput ref={inputRef} /&gt;</code> \u7684\u7236 component \u80fd\u547c\u53eb <code class=\"language-javascript\">inputRef.current.focus()</code>\u3002</p>\n<h3 id=\"uselayouteffect\"><a class=\"anchor\" href=\"/react/hooks-reference#uselayouteffect\"></a><code class=\"language-javascript\">useLayoutEffect</code> </h3>\n<p>\u8207\u5ba3\u544a <code class=\"language-javascript\">useEffect</code> \u672c\u8eab\u76f8\u540c\uff0c\u4f46\u5b83\u6703\u5728\u6240\u6709 DOM \u6539\u8b8a\u5f8c\uff0c\u540c\u6b65\u8abf\u7528\u3002\u4f7f\u7528\u5b83\u4f86\u8b80\u53d6 DOM layout \u4e26\u540c\u6b65\u91cd\u65b0 render\u3002\u5728\u700f\u89bd\u5668\u57f7\u884c\u7e6a\u88fd\u4e4b\u524d\uff0c<code class=\"language-javascript\">useLayoutEffect</code> \u5167\u90e8\u7684\u66f4\u65b0\u5c07\u88ab\u540c\u6b65\u5237\u65b0\u3002</p>\n<p>\u76e1\u53ef\u80fd\u4f7f\u7528\u6a19\u6e96\u7684 <code class=\"language-javascript\">useEffect</code> \u4f86\u907f\u514d\u963b\u7919\u8996\u89ba\u4e0a\u7684\u66f4\u65b0\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u5982\u679c\u4f60\u662f\u5f9e class component migrate \u7a0b\u5f0f\u78bc\uff0c\u8acb\u6ce8\u610f <code class=\"language-javascript\">useLayoutEffect</code> \u8207 <code class=\"language-javascript\">componentDidMount</code> \u548c <code class=\"language-javascript\">componentDidUpdate</code> \u7684\u547c\u53eb\u6642\u6a5f\u662f\u4e00\u6a23\u3002\u4e0d\u904e\uff0c<strong>\u6211\u5011\u5efa\u8b70\u5148\u4f7f\u7528 <code class=\"language-javascript\">useEffect</code></strong>\uff0c\u53ea\u7576\u5b83\u6709\u554f\u984c\u6642\u624d\u5617\u8a66\u4f7f\u7528 <code class=\"language-javascript\">useLayoutEffect</code>\u3002</p>\n<p>\u5982\u679c\u4f60\u4f7f\u7528\u4f3a\u670d\u5668 render\uff0c\u8acb\u8a18\u4f4f <code class=\"language-javascript\">useLayoutEffect</code> \u6216 <code class=\"language-javascript\">useEffect</code> <em>\u5747\u4e0d\u6703</em>\u57f7\u884c\uff0c\u76f4\u5230 JavaScript \u5b8c\u6210\u8f09\u5165\u3002\u9019\u662f\u70ba\u4ec0\u9ebc\u5728\u4f3a\u670d\u5668 render \u7684 component \u5305\u542b <code class=\"language-javascript\">useLayoutEffect</code> \u6642 React \u6703\u767c\u51fa\u8b66\u544a\u3002\u8981\u89e3\u6c7a\u9019\u554f\u984c\uff0c\u628a\u8a72\u908f\u8f2f\u642c\u5230 <code class=\"language-javascript\">useEffect</code> \u88e1\uff08\u5982\u679c\u9996\u6b21 render \u4e0d\u9700\u8981\u8a72\u908f\u8f2f\uff09\uff0c\u6216\u628a component \u5ef6\u9072\u5230\u5ba2\u6236\u7aef\u5b8c\u6210 render \u5f8c\u624d\u51fa\u73fe\uff08\u5982\u679c\u76f4\u5230 <code class=\"language-javascript\">useLayoutEffect</code> \u57f7\u884c\u524d HTML \u90fd\u6703\u932f\u4e82\u7684\u60c5\u6cc1\u4e0b\uff09\u3002</p>\n<p>\u8981\u5728\u4f3a\u670d\u5668 render \u7684 HTML \u6392\u9664\u9700\u8981 layout effect \u7684 component\uff0c\u53ef\u4ee5\u5229\u7528 <code class=\"language-javascript\">showChild &amp;&amp; &lt;Child /&gt;</code> \u9032\u884c\u689d\u4ef6 render\uff0c\u4e26\u4f7f\u7528 <code class=\"language-javascript\">useEffect(() =&gt; { setShowChild(true); }, [])</code> \u4f86\u5ef6\u9072\u986f\u793a\u3002\u9019\u6a23\uff0cUI \u5c31\u4e0d\u6703\u5728\u5b8c\u6210 render \u4e4b\u524d\u986f\u793a\u932f\u4e82\u4e86\u3002</p>\n</div>\n<h3 id=\"usedebugvalue\"><a class=\"anchor\" href=\"/react/hooks-reference#usedebugvalue\"></a><code class=\"language-javascript\">useDebugValue</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useDebugValue</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">useDebugValue</code> \u53ef\u4ee5\u7528\u4f86\u5728 React DevTools \u4e2d\u986f\u793a\u81ea\u8a02\u7fa9 hook \u7684\u6a19\u7c64\u3002</p>\n<p>\u4f8b\u5982\uff0c\u5728<a href=\"/react/hooks-custom\">\u300c\u6253\u9020\u4f60\u7684 Hook\u300d</a>\u4e2d\u63d0\u53ca\u7684 <code class=\"language-javascript\">useFriendStatus</code> \u81ea\u5b9a\u7fa9 Hook\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Show a label in DevTools next to this Hook</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// e.g. \"FriendStatus: Online\"</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useDebugValue</span><span class=\"token punctuation\">(</span>isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'Online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'Offline'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u6211\u5011\u4e0d\u5efa\u8b70\u5728\u6bcf\u500b\u81ea\u5b9a\u7fa9 Hook \u90fd\u52a0\u4e0a debug \u503c\u3002\u5b83\u5728\u81ea\u5b9a\u7fa9 Hook \u7684\u5171\u4eab\u51fd\u5f0f\u5eab\u4e2d\u624d\u662f\u6700\u6709\u50f9\u503c\u7684\u3002</p>\n</div>\n<h4 id=\"defer-formatting-debug-values\"><a class=\"anchor\" href=\"/react/hooks-reference#defer-formatting-debug-values\"></a>\u5ef6\u9072\u683c\u5f0f\u5316 Debug Value </h4>\n<p>\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u683c\u5f0f\u5316\u4e00\u500b\u986f\u793a\u503c\u53ef\u80fd\u6703\u662f\u6602\u8cb4\u7684\u64cd\u4f5c\u3002\u9664\u975e\u5be6\u969b\u6aa2\u67e5 Hook\uff0c\u5426\u5247\u6c92\u6709\u5fc5\u8981\u3002</p>\n<p>\u56e0\u6b64\uff0c<code class=\"language-javascript\">useDebugValue</code> \u63a5\u53d7\u4e00\u500b\u683c\u5f0f\u5316 function \u4f5c\u70ba\u53ef\u9078\u7684\u7b2c\u4e8c\u500b\u53c3\u6578\u3002\u8a72 function \u53ea\u6709\u5728 Hook \u88ab\u6aa2\u67e5\u6642\u624d\u6703\u88ab\u547c\u53eb\u3002\u5b83\u63a5\u53d7 debug \u503c\u4f5c\u70ba\u53c3\u6578\uff0c\u7136\u5f8c\u56de\u50b3\u4e00\u500b\u88ab\u683c\u5f0f\u5316\u7684\u986f\u793a\u503c\u3002</p>\n<p>\u4f8b\u5982\uff0c\u4e00\u500b\u56de\u50b3 <code class=\"language-javascript\">Date</code> \u503c\u7684\u81ea\u5b9a\u7fa9 Hook \u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u7684\u683c\u5f0f\u5316 function \u4f86\u907f\u514d\u4e0d\u5fc5\u8981\u5730\u547c\u53eb <code class=\"language-javascript\">toDateString</code> function\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useDebugValue</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">,</span> <span class=\"token parameter\">date</span> <span class=\"token operator\">=&gt;</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">toDateString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"usedeferredvalue\"><a class=\"anchor\" href=\"/react/hooks-reference#usedeferredvalue\"></a><code class=\"language-javascript\">useDeferredValue</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> deferredValue <span class=\"token operator\">=</span> <span class=\"token function\">useDeferredValue</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">useDeferredValue</code> \u63a5\u53d7\u4e00\u500b\u503c\uff0c\u4e26\u4e14\u56de\u50b3\u503c\u7684\u65b0\u62f7\u8c9d\uff0c\u65b0\u7684\u62f7\u8c9d\u6703\u88ab\u63a8\u9072\u5230\u66f4\u7dca\u6025\u7684\u66f4\u65b0\u3002\u5982\u679c\u76ee\u524d\u7684 render \u662f\u7dca\u6025\u66f4\u65b0\u7684\u7d50\u679c\uff0c\u50cf\u662f\u4f7f\u7528\u8005\u8f38\u5165\uff0cReact \u5c07\u6703\u56de\u50b3\u5148\u524d\u7684\u503c\uff0c\u4e26\u63a5\u8457\u5728\u7dca\u6025\u66f4\u65b0\u5b8c\u6210\u5f8c\uff0crender \u65b0\u7684\u503c\u3002</p>\n<p>\u9019\u500b hook \u985e\u4f3c user-space \u7684 hook\uff0c\u88ab\u7528\u5728 deboucing \u6216 throttiling \u4f86\u5ef6\u9072\u66f4\u65b0\u3002\u4f7f\u7528 <code class=\"language-javascript\">useDeferredValue</code> \u7684\u597d\u8655\u662f React \u5c07\u6703\u5728\u5176\u4ed6\u5de5\u4f5c\u5b8c\u6210\u5f8c\uff0c\u7acb\u5373\u9032\u884c\u66f4\u65b0\uff08\u800c\u4e0d\u662f\u7b49\u5f85\u4e00\u500b\u4efb\u610f\u7684\u6642\u9593\uff09\uff0c\u50cf\u662f <a href=\"/react/react-api#starttransition\"><code class=\"language-javascript\">startTransition</code></a>\uff0c\u5ef6\u9072\u7684\u503c\u53ef\u4ee5\u66ab\u505c\u800c\u4e0d\u6703\u89f8\u767c\u4e00\u500b\u73fe\u6709\u5167\u5bb9\u7684 unexpected fallback\u3002</p>\n<h4 id=\"memoizing-deferred-children\"><a class=\"anchor\" href=\"/react/hooks-reference#memoizing-deferred-children\"></a>Memoizing \u5ef6\u9072\u7684 Children </h4>\n<p><code class=\"language-javascript\">useDeferredValue</code> \u53ea\u5ef6\u9072\u4f60\u50b3\u9001\u7d66\u5b83\u7684\u503c\u3002\u5982\u679c\u4f60\u60f3\u8981\u9632\u6b62\u4e00\u500b child component \u5728\u4e00\u500b\u7dca\u6025\u66f4\u65b0\u4e2d\u4e0d\u65b7\u91cd\u65b0 render\uff0c\u4f60\u5fc5\u9808 \u4f7f\u7528 <a href=\"/react/react-api#reactmemo\"><code class=\"language-javascript\">React.memo</code></a> \u6216 <a href=\"/react/hooks-reference#usememo\"><code class=\"language-javascript\">React.useMemo</code></a> \u4f86 memoize component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Typeahead</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> <span class=\"token function\">useSearchQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> deferredQuery <span class=\"token operator\">=</span> <span class=\"token function\">useDeferredValue</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Memoizing tells React to only re-render when deferredQuery changes,</span>\n  <span class=\"token comment\">// not when query changes.</span>\n  <span class=\"token keyword\">const</span> suggestions <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SearchSuggestions</span></span> <span class=\"token attr-name\">query</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>deferredQuery<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>deferredQuery<span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SearchInput</span></span> <span class=\"token attr-name\">query</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>query<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Loading results...<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>suggestions<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Memoizing children \u544a\u8a34 React \u5b83\u53ea\u9700\u8981\u5728 <code class=\"language-javascript\">deferredQuery</code> \u91cd\u65b0 render\uff0c\u800c\u4e0d\u662f\u5728 <code class=\"language-javascript\">query</code> \u6539\u8b8a\u6642\u3002\u9019\u500b\u8b66\u544a\u4e0d\u662f <code class=\"language-javascript\">useDeferredValue</code> \u7368\u6709\u7684\uff0c\u5b83\u8207\u4f60\u4f7f\u7528\u7684 debouncing \u6216 throttling \u985e\u4f3c\u7684 hook \u4f7f\u7528\u7684\u6a21\u5f0f\u76f8\u540c\u3002</p>\n<h3 id=\"usetransition\"><a class=\"anchor\" href=\"/react/hooks-reference#usetransition\"></a><code class=\"language-javascript\">useTransition</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isPending<span class=\"token punctuation\">,</span> startTransition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u56de\u50b3\u4e00\u500b transition pending \u72c0\u614b\u7684 stateful \u503c\uff0c\u4ee5\u53ca\u4e00\u500b\u555f\u52d5 function\u3002</p>\n<p><code class=\"language-javascript\">startTransition</code> lets you mark updates in the provided callback as transitions:\n\u8b93\u4f60\u5728\u63d0\u4f9b\u7684 callback \u4e2d\u6a19\u8a18\u66f4\u65b0\u70ba transitions\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-javascript\">isPending</code> \u8868\u793a\u7576\u4e00\u500b transition \u662f active \u6642\u986f\u793a pending state\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isPending<span class=\"token punctuation\">,</span> startTransition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=&gt;</span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>isPending <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Spinner</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p>Updates in a transition yield to more urgent updates such as clicks.</p>\n<p>Updates in a transition will not show a fallback for re-suspended content. This allows the user to continue interacting with the current content while rendering the update.</p>\n</div>\n<h3 id=\"useid\"><a class=\"anchor\" href=\"/react/hooks-reference#useid\"></a><code class=\"language-javascript\">useId</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">useId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">useId</code> is a hook for generating unique IDs that are stable across the server and client, while avoiding hydration mismatches.</p>\n<div class=\"blockquote\">\n<strong>Note</strong>\n<p><code class=\"language-javascript\">useId</code> is <strong>not</strong> for generating <a href=\"/react/lists-and-keys#keys\">keys in a list</a>. Keys should be generated from your data.</p>\n</div>\n<p>For a basic example, pass the <code class=\"language-javascript\">id</code> directly to the elements that need it:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Checkbox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">useId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">htmlFor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Do you like React?</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>react<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>For multiple IDs in the same component, append a suffix using the same <code class=\"language-javascript\">id</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">NameFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">useId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">htmlFor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id <span class=\"token operator\">+</span> <span class=\"token string\">'-firstName'</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">First Name</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id <span class=\"token operator\">+</span> <span class=\"token string\">'-firstName'</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">htmlFor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id <span class=\"token operator\">+</span> <span class=\"token string\">'-lastName'</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Last Name</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id <span class=\"token operator\">+</span> <span class=\"token string\">'-lastName'</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">useId</code> generates a string that includes the <code class=\"language-javascript\">:</code> token. This helps ensure that the token is unique, but is not supported in CSS selectors or APIs like <code class=\"language-javascript\">querySelectorAll</code>.</p>\n<p><code class=\"language-javascript\">useId</code> supports an <code class=\"language-javascript\">identifierPrefix</code> to prevent collisions in multi-root apps. To configure, see the options for <a href=\"/react/react-dom-client#hydrateroot\"><code class=\"language-javascript\">hydrateRoot</code></a> and <a href=\"/react/react-dom-server\"><code class=\"language-javascript\">ReactDOMServer</code></a>.</p>\n</div>\n<h2 id=\"library-hooks\"><a class=\"anchor\" href=\"/react/hooks-reference#library-hooks\"></a>Library Hooks </h2>\n<p>The following Hooks are provided for library authors to integrate libraries deeply into the React model, and are not typically used in application code.</p>\n<h3 id=\"usesyncexternalstore\"><a class=\"anchor\" href=\"/react/hooks-reference#usesyncexternalstore\"></a><code class=\"language-javascript\">useSyncExternalStore</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token function\">useSyncExternalStore</span><span class=\"token punctuation\">(</span>subscribe<span class=\"token punctuation\">,</span> getSnapshot<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> getServerSnapshot<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">useSyncExternalStore</code> is a hook recommended for reading and subscribing from external data sources in a way that\u2019s compatible with concurrent rendering features like selective hydration and time slicing.</p>\n<p>This method returns the value of the store and accepts three arguments:</p>\n<ul>\n<li><code class=\"language-javascript\">subscribe</code>: function to register a callback that is called whenever the store changes.</li>\n<li><code class=\"language-javascript\">getSnapshot</code>: function that returns the current value of the store.</li>\n<li><code class=\"language-javascript\">getServerSnapshot</code>: function that returns the snapshot used during server rendering.</li>\n</ul>\n<p>The most basic example simply subscribes to the entire store:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token function\">useSyncExternalStore</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">.</span>subscribe<span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">.</span>getSnapshot<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>However, you can also subscribe to a specific field:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> selectedField <span class=\"token operator\">=</span> <span class=\"token function\">useSyncExternalStore</span><span class=\"token punctuation\">(</span>\n  store<span class=\"token punctuation\">.</span>subscribe<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>selectedField<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>When server rendering, you must serialize the store value used on the server, and provide it to <code class=\"language-javascript\">useSyncExternalStore</code>. React will use this snapshot during hydration to prevent server mismatches:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> selectedField <span class=\"token operator\">=</span> <span class=\"token function\">useSyncExternalStore</span><span class=\"token punctuation\">(</span>\n  store<span class=\"token punctuation\">.</span>subscribe<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>selectedField<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token constant\">INITIAL_SERVER_SNAPSHOT</span><span class=\"token punctuation\">.</span>selectedField<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">getSnapshot</code> must return a cached value. If getSnapshot is called multiple times in a row, it must return the same exact value unless there was a store update in between.</p>\n<p>A shim is provided for supporting multiple React versions published as <code class=\"language-javascript\">use-sync-external-store/shim</code>. This shim will prefer <code class=\"language-javascript\">useSyncExternalStore</code> when available, and fallback to a user-space implementation when it\u2019s not.</p>\n<p>As a convenience, we also provide a version of the API with automatic support for memoizing the result of getSnapshot published as <code class=\"language-javascript\">use-sync-external-store/with-selector</code>.</p>\n</div>\n<h3 id=\"useinsertioneffect\"><a class=\"anchor\" href=\"/react/hooks-reference#useinsertioneffect\"></a><code class=\"language-javascript\">useInsertionEffect</code> </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useInsertionEffect</span><span class=\"token punctuation\">(</span>didUpdate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The signature is identical to <code class=\"language-javascript\">useEffect</code>, but it fires synchronously <em>before</em> all DOM mutations. Use this to inject styles into the DOM before reading layout in <a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a>. Since this hook is limited in scope, this hook does not have access to refs and cannot schedule updates.</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f\uff1a</strong>\n<p><code class=\"language-javascript\">useInsertionEffect</code> should be limited to css-in-js library authors. Prefer <a href=\"/react/hooks-reference#useeffect\"><code class=\"language-javascript\">useEffect</code></a> or <a href=\"/react/hooks-reference#uselayouteffect\"><code class=\"language-javascript\">useLayoutEffect</code></a> instead.</p>\n</div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-reference.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-reference", "nav": ["/react/hooks-custom", "/react/hooks-faq"]}, {"key": "8. Hook \u5e38\u898b\u554f\u984c", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p><em>Hooks</em> \u662f React 16.8 \u4e2d\u589e\u52a0\u7684\u65b0\u529f\u80fd\u3002\u5b83\u8b93\u4f60\u4e0d\u5fc5\u5beb class \u5c31\u80fd\u4f7f\u7528 state \u4ee5\u53ca\u5176\u4ed6 React \u7684\u529f\u80fd\u3002</p>\n<p>\u9019\u4e00\u9801\u6703\u89e3\u7b54\u4e00\u4e9b\u95dc\u65bc <a href=\"/react/hooks-overview\">Hook</a> \u5e38\u898b\u7684\u554f\u984c\u3002</p>\n<!--\n  if you ever need to regenerate this, this snippet in the devtools console might help:\n\n  $$('.anchor').map(a =>\n    `${' '.repeat(2 * +a.parentNode.nodeName.slice(1))}` +\n    `[${a.parentNode.textContent}](${a.getAttribute('href')})`\n  ).join('\\n')\n-->\n<ul>\n<li>\n<p><strong><a href=\"/react/hooks-faq#adoption-strategy\">\u63a1\u7528\u7b56\u7565</a></strong></p>\n<ul>\n<li><a href=\"/react/hooks-faq#which-versions-of-react-include-hooks\">React \u54ea\u4e00\u500b\u7248\u672c\u4e2d\u5305\u542b Hook\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#do-i-need-to-rewrite-all-my-class-components\">\u6211\u9700\u8981\u91cd\u5beb\u6240\u6709\u7684 Class component \u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-can-i-do-with-hooks-that-i-couldnt-with-classes\">\u6211\u53ef\u4ee5\u5728 Hook \u505a\u4ec0\u9ebc\u662f\u6211\u5728 Class \u6240\u4e0d\u80fd\u505a\u7684\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-much-of-my-react-knowledge-stays-relevant\">Hook \u8207\u6211\u7684 React \u77e5\u8b58\u6709\u591a\u5c11\u4fdd\u6301\u76f8\u95dc\u6027\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#should-i-use-hooks-classes-or-a-mix-of-both\">\u6211\u61c9\u8a72\u4f7f\u7528 Hook\u3001Class \u6216\u662f\u5169\u8005\u517c\u5177\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#do-hooks-cover-all-use-cases-for-classes\">Hook \u5305\u542b\u6240\u6709 Class \u7684\u4f7f\u7528\u60c5\u5883\u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#do-hooks-replace-render-props-and-higher-order-components\">Hook \u53ef\u4ee5\u53d6\u4ee3 Render Props \u548c Higher-Order Component \u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-do-hooks-mean-for-popular-apis-like-redux-connect-and-react-router\">Hook \u5c0d\u65bc Redux connect() \u548c React Router \u7b49\u7b49\u5176\u4ed6\u6d41\u884c\u7684 API \u610f\u5473\u8457\u4ec0\u9ebc\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#do-hooks-work-with-static-typing\">Hook \u53ef\u4ee5\u4f7f\u7528\u975c\u614b\u578b\u5225\u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-test-components-that-use-hooks\">\u5982\u4f55\u6e2c\u8a66\u4f7f\u7528 Hook \u7684 component\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-exactly-do-the-lint-rules-enforce\">Lint \u898f\u5247\u7a76\u7adf\u5f37\u5236\u4e86\u4e9b\u4ec0\u9ebc\uff1f</a></li>\n</ul>\n</li>\n<li>\n<p><strong><a href=\"/react/hooks-faq#from-classes-to-hooks\">\u5f9e Class \u5230 Hook</a></strong></p>\n<ul>\n<li><a href=\"/react/hooks-faq#how-do-lifecycle-methods-correspond-to-hooks\">\u751f\u547d\u9031\u671f\u65b9\u6cd5\u8207 Hook \u5982\u4f55\u5c0d\u61c9\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-can-i-do-data-fetching-with-hooks\">\u6211\u5982\u4f55\u4f7f\u7528 Hook fetch \u8cc7\u6599\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">\u662f\u5426\u6709\u985e\u4f3c Instance \u8b8a\u6578\u7684\u6771\u897f\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#should-i-use-one-or-many-state-variables\">\u6211\u61c9\u8a72\u4f7f\u7528\u4e00\u500b\u6216\u662f\u591a\u500b state \u8b8a\u6578\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#can-i-run-an-effect-only-on-updates\">\u6211\u53ef\u4ee5\u53ea\u5728\u66f4\u65b0\u6642\u57f7\u884c effect \u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-get-the-previous-props-or-state\">\u5982\u4f55\u53d6\u5f97\u5148\u524d\u7684 prop \u6216 state\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#why-am-i-seeing-stale-props-or-state-inside-my-function\">\u70ba\u4ec0\u9ebc\u6211\u5728 function \u5167\u770b\u5230\u820a\u7684 prop \u6216 state\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-do-i-implement-getderivedstatefromprops\">\u6211\u8a72\u5982\u4f55\u5be6\u4f5c getDerivedStateFromProps\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#is-there-something-like-forceupdate\">\u6709\u985e\u4f3c forceUpdate \u7684\u6771\u897f\u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#can-i-make-a-ref-to-a-function-component\">\u6211\u53ef\u4ee5\u5c0d function component \u5efa\u7acb\u4e00\u500b ref \u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-can-i-measure-a-dom-node\">\u6211\u8a72\u5982\u4f55\u6e2c\u91cf\u4e00\u500b DOM node\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-does-const-thing-setthing--usestate-mean\">const [thing, setThing] = useState() \u662f\u4ec0\u9ebc\u610f\u601d\uff1f</a></li>\n</ul>\n</li>\n<li>\n<p><strong><a href=\"/react/hooks-faq#performance-optimizations\">\u6548\u80fd\u6700\u4f73\u5316</a></strong></p>\n<ul>\n<li><a href=\"/react/hooks-faq#can-i-skip-an-effect-on-updates\">\u6211\u53ef\u4ee5\u5728\u66f4\u65b0\u6642\u5ffd\u7565 effect \u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\">\u5728\u4f9d\u8cf4\u9805\u76ee\u7684\u5217\u8868\u4e2d\u5ffd\u7565 function \u662f\u5b89\u5168\u7684\u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\">\u5982\u679c\u6211\u7684 effect \u4f9d\u8cf4\u9805\u76ee\u7d93\u5e38\u8b8a\u5316\u7684\u8a71\u8a72\u600e\u9ebc\u8fa6\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-do-i-implement-shouldcomponentupdate\">\u6211\u8a72\u5982\u4f55\u5be6\u4f5c shouldComponentUpdate\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-memoize-calculations\">\u5982\u4f55 memoize \u8a08\u7b97\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-create-expensive-objects-lazily\">\u5982\u4f55\u5ef6\u9072\u5efa\u7acb\u6602\u8cb4\u7684 object\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#are-hooks-slow-because-of-creating-functions-in-render\">\u5728 render \u6642\u5efa\u7acb function\uff0cHooks \u6703\u8b8a\u6162\u55ce\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-avoid-passing-callbacks-down\">\u5982\u4f55\u907f\u514d\u5411\u4e0b\u50b3\u905e callback\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#how-to-read-an-often-changing-value-from-usecallback\">\u5982\u4f55\u5f9e useCallback \u8b80\u53d6\u4e00\u500b\u7d93\u5e38\u8b8a\u5316\u7684\u503c\uff1f</a></li>\n</ul>\n</li>\n<li>\n<p><strong><a href=\"/react/hooks-faq#under-the-hood\">\u6df1\u5165\u7406\u89e3</a></strong></p>\n<ul>\n<li><a href=\"/react/hooks-faq#how-does-react-associate-hook-calls-with-components\">React \u5982\u4f55\u5c07 Hook \u547c\u53eb\u8207 component \u95dc\u806f\uff1f</a></li>\n<li><a href=\"/react/hooks-faq#what-is-the-prior-art-for-hooks\">Hook \u73fe\u6709\u7684\u6280\u8853\u662f\u4ec0\u9ebc\uff1f</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"adoption-strategy\"><a class=\"anchor\" href=\"/react/hooks-faq#adoption-strategy\"></a>\u63a1\u7528\u7b56\u7565 </h2>\n<h3 id=\"which-versions-of-react-include-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#which-versions-of-react-include-hooks\"></a>React \u54ea\u4e00\u500b\u7248\u672c\u4e2d\u5305\u542b Hook\uff1f </h3>\n<p>\u5f9e 16.8.0 \u958b\u59cb\uff0cReact \u5305\u542b\u4e00\u500b\u7a69\u5b9a\u7684 React Hooks \u5be6\u4f5c\uff1a</p>\n<ul>\n<li>React DOM</li>\n<li>React Native</li>\n<li>React DOM Server</li>\n<li>React Test Renderer</li>\n<li>React Shallow Renderer</li>\n</ul>\n<p>\u6ce8\u610f\uff0c\u82e5\u8981<strong>\u555f\u52d5 Hook\uff0c\u6240\u6709 React package \u9700\u8981\u5347\u7d1a\u5230 16.8.0 \u6216\u662f\u66f4\u9ad8\u7684\u7248\u672c</strong>\u3002\u4f8b\u5982\u4f60\u5fd8\u4e86\u5347\u7d1a React DOM\uff0cHook \u5c07\u7121\u6cd5\u6b63\u5e38\u57f7\u884c\u3002</p>\n<p><a class=\"external-link\" href=\"https://reactnative.dev/blog/2019/03/12/releasing-react-native-059\">React Native 0.59</a> \u4ee5\u4e0a\u7684\u7248\u672c\u652f\u63f4 Hooks\u3002</p>\n<h3 id=\"do-i-need-to-rewrite-all-my-class-components\"><a class=\"anchor\" href=\"/react/hooks-faq#do-i-need-to-rewrite-all-my-class-components\"></a>\u6211\u9700\u8981\u91cd\u5beb\u6240\u6709\u7684 Class component \u55ce\uff1f </h3>\n<p>\u4e0d\u9700\u8981\u3002React <a href=\"/react/hooks-intro#gradual-adoption-strategy\">\u6c92\u6709\u8a08\u5283</a>\u79fb\u9664 class \u2014 \u6211\u5011\u9700\u8981\u8b93\u7522\u54c1\u4fdd\u6301\u904b\u4f5c\uff0c\u91cd\u5beb\u7684\u6210\u672c\u5f88\u9ad8\uff0c\u6211\u5011\u5efa\u8b70\u4f60\u5728\u65b0\u7684\u7a0b\u5f0f\u78bc\u4e2d\u5617\u8a66 Hook\u3002</p>\n<h3 id=\"what-can-i-do-with-hooks-that-i-couldnt-with-classes\"><a class=\"anchor\" href=\"/react/hooks-faq#what-can-i-do-with-hooks-that-i-couldnt-with-classes\"></a>\u6211\u53ef\u4ee5\u5728 Hook \u505a\u4ec0\u9ebc\u662f\u6211\u5728 Class \u6240\u4e0d\u80fd\u505a\u7684\uff1f </h3>\n<p>Hook \u5728 component \u4e4b\u9593\u63d0\u4f9b\u5f37\u5927\u800c\u5bcc\u6709\u8868\u73fe\u529b\u7684\u65b0\u65b9\u5f0f\u4f86\u91cd\u8907\u4f7f\u7528\u529f\u80fd\u3002\u5728<a href=\"/react/hooks-custom\">\u300c\u6253\u9020\u4f60\u7684 Hook\u300d</a>\u63d0\u4f9b\u4e86\u4e00\u500b\u53ef\u884c\u7684\u65b9\u5f0f\u3002<a class=\"external-link\" href=\"https://medium.com/@dan_abramov/making-sense-of-react-hooks-fdbde8803889\">\u9019\u7bc7\u6587\u7ae0</a>\u662f\u7531 React \u6838\u5fc3\u5718\u968a\u6210\u54e1\u6df1\u5165\u7814\u7a76 Hook \u89e3\u9396\u7684\u65b0\u529f\u80fd\u3002</p>\n<h3 id=\"how-much-of-my-react-knowledge-stays-relevant\"><a class=\"anchor\" href=\"/react/hooks-faq#how-much-of-my-react-knowledge-stays-relevant\"></a>Hook \u8207\u6211\u7684 React \u77e5\u8b58\u6709\u591a\u5c11\u4fdd\u6301\u76f8\u95dc\u6027\uff1f </h3>\n<p>Hook \u5df2\u7d93\u6709\u8a31\u591a\u4f60\u77e5\u9053\u7684\u65b9\u5f0f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 React \u7684\u529f\u80fd \u2014 \u50cf\u662f state\u3001lifecycle\u3001context \u4ee5\u53ca ref\u3002\u57fa\u672c\u4e0a\u5b83\u5011\u4e26\u6c92\u6709\u6539\u8b8a React \u7684\u904b\u4f5c\u65b9\u5f0f\uff0c\u800c\u4e14\u4f60\u5c0d\u65bc component\u3001prop \u4ee5\u53ca\u4e0a\u81f3\u4e0b\u7684\u8cc7\u6599\u6d41\u4e86\u89e3\u4e5f\u4e00\u6a23\u91cd\u8981\u3002</p>\n<p>Hook \u7684\u78ba\u6709\u5b83\u672c\u8eab\u7684\u5b78\u7fd2\u66f2\u7dda\u3002\u5982\u679c\u5728\u9019\u4efd\u6587\u4ef6\u4e2d\u7f3a\u6f0f\u4e86\u4e9b\u4ec0\u9ebc\uff0c<a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/issues/new\">\u63d0\u51fa\u4e00\u500b issue</a>\uff0c\u6211\u5011\u5c07\u6703\u5617\u8a66\u5e6b\u52a9\u4f60\u3002</p>\n<h3 id=\"should-i-use-hooks-classes-or-a-mix-of-both\"><a class=\"anchor\" href=\"/react/hooks-faq#should-i-use-hooks-classes-or-a-mix-of-both\"></a>\u6211\u61c9\u8a72\u4f7f\u7528 Hook\u3001Class \u6216\u662f\u5169\u8005\u517c\u5177\uff1f </h3>\n<p>\u7576\u4f60\u6e96\u5099\u597d\u6642\uff0c\u6211\u5011\u9f13\u52f5\u958b\u59cb\u4f7f\u7528 Hook \u64b0\u5beb\u4f60\u65b0\u7684 component\u3002\u78ba\u4fdd\u4f60\u5718\u968a\u7684\u6210\u54e1\u5011\u4f7f\u7528 Hook \u4e26\u719f\u6089\u672c\u6587\u4ef6\u3002\u6211\u5011\u4e26\u4e0d\u9f13\u52f5\u4f60\u91cd\u5beb\u73fe\u6709\u7684 class component \u6210 Hook\uff0c\u9664\u975e\u4f60\u5df2\u7d93\u8a08\u5283\u91cd\u5beb\u5b83\u5011\uff08\u4f8b\u5982\uff1a\u4fee\u6b63 bug\uff09\u3002</p>\n<p>\u4f60\u4e0d\u53ef\u4ee5\u5728 class component <em>\u5167</em>\u4f7f\u7528 Hook\uff0c\u4f46\u4f60\u7d55\u5c0d\u53ef\u4ee5\u5728\u55ae\u500b tree \u4e2d\u5c07 class \u548c function component \u8207 Hook \u6df7\u5408\u4f7f\u7528\u3002\u7121\u8ad6\u662f class \u6216 function component\uff0c\u4f7f\u7528 Hook \u662f\u8a72 component \u5be6\u4f5c\u7684\u7d30\u7bc0\u3002\u5f9e\u9577\u9060\u4f86\u770b\uff0c\u6211\u5011\u671f\u5f85 Hook \u53ef\u4ee5\u662f\u5927\u5bb6\u64b0\u5beb React component \u7684\u4e3b\u8981\u65b9\u5f0f\u3002</p>\n<h3 id=\"do-hooks-cover-all-use-cases-for-classes\"><a class=\"anchor\" href=\"/react/hooks-faq#do-hooks-cover-all-use-cases-for-classes\"></a>Hook \u5305\u542b\u6240\u6709 Class \u7684\u4f7f\u7528\u60c5\u5883\u55ce\uff1f </h3>\n<p>\u6211\u5011\u7684\u76ee\u6a19\u662f\u8b93 Hook \u76e1\u5feb\u80fd\u6db5\u84cb class \u7684\u6240\u6709\u4f7f\u7528\u60c5\u5883\u3002\u5c0d\u65bc\u4e0d\u5e38\u898b\u7684 <code class=\"language-javascript\">getSnapshotBeforeUpdate</code> \u548c <code class=\"language-javascript\">componentDidCatch</code> \u7684\u751f\u547d\u9031\u671f\u4e26\u6c92\u6709\u7b49\u50f9\u7684 Hook \u65b9\u5f0f\uff0c\u4f46\u6211\u5011\u8a08\u5283\u5f88\u5feb\u6703\u52a0\u5165\u5b83\u5011\u3002</p>\n<h3 id=\"do-hooks-replace-render-props-and-higher-order-components\"><a class=\"anchor\" href=\"/react/hooks-faq#do-hooks-replace-render-props-and-higher-order-components\"></a>Hook \u53ef\u4ee5\u53d6\u4ee3 Render Props \u548c Higher-Order Component \u55ce\uff1f </h3>\n<p>\u6211\u5011\u601d\u8003 Hook \u662f\u4e00\u500b\u66f4\u7c21\u55ae\u7684\u65b9\u5f0f\u4f86\u63d0\u4f9b\u9019\u500b\u4f7f\u7528\u60c5\u5883\u3002\u9019\u5169\u7a2e\u6a21\u5f0f\u4ecd\u7136\u6709\u5b83\u7684\u7528\u8655\uff08\u4f8b\u5982\uff1a\u4e00\u500b virtual scroller component \u53ef\u80fd\u6709\u4e00\u500b <code class=\"language-javascript\">renderItem</code> prop\uff0c\u6216\u662f\u4e00\u500b virtual container component \u53ef\u80fd\u6709\u5b83\u672c\u8eab\u7684 DOM \u7d50\u69cb\uff09\u3002\u4f46\u5728\u5927\u90e8\u5206\u7684\u60c5\u6cc1\u4e0b\uff0cHook \u5c31\u53ef\u4ee5\u6eff\u8db3\u4e86\uff0c\u800c\u4e14\u53ef\u4ee5\u5e6b\u52a9\u4f60\u6e1b\u5c11\u5728 tree \u5167\u7684\u5de2\u72c0 component\u3002</p>\n<h3 id=\"what-do-hooks-mean-for-popular-apis-like-redux-connect-and-react-router\"><a class=\"anchor\" href=\"/react/hooks-faq#what-do-hooks-mean-for-popular-apis-like-redux-connect-and-react-router\"></a>Hook \u5c0d\u65bc Redux <code class=\"language-javascript\">connect()</code> \u548c React Router \u7b49\u7b49\u5176\u4ed6\u6d41\u884c\u7684 API \u610f\u5473\u8457\u4ec0\u9ebc\uff1f </h3>\n<p>\u4f60\u53ef\u4ee5\u7e7c\u7e8c\u4f7f\u7528\u8207\u4ee5\u5f80\u5b8c\u5168\u76f8\u540c\u7684 API\uff1b\u5b83\u5011\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002</p>\n<p>React Redux \u5f9e v7.1.0 <a class=\"external-link\" href=\"https://react-redux.js.org/api/hooks\">\u652f\u63f4 Hooks API</a> \u4e26\u63d0\u4f9b\u50cf\u662f <code class=\"language-javascript\">useDispatch</code> \u6216 <code class=\"language-javascript\">useSelector</code> \u7684 hooks\u3002</p>\n<p>React Router \u5f9e v5.1 \u7248\u672c\u5f8c<a class=\"external-link\" href=\"https://reacttraining.com/react-router/web/api/Hooks\">\u652f\u63f4 Hooks</a>\u3002</p>\n<p>\u5176\u4ed6\u50cf\u662f React Router \u53ef\u80fd\u5728\u672a\u4f86\u6703\u652f\u63f4 Hooks\u3002</p>\n<h3 id=\"do-hooks-work-with-static-typing\"><a class=\"anchor\" href=\"/react/hooks-faq#do-hooks-work-with-static-typing\"></a>Hook \u53ef\u4ee5\u4f7f\u7528\u975c\u614b\u578b\u5225\u55ce\uff1f </h3>\n<p>Hook \u7684\u8a2d\u8a08\u8003\u616e\u5230\u4e86\u975c\u614b\u578b\u5225\u3002\u56e0\u70ba\u5b83\u5011\u662f function\uff0c\u6bd4 Higher-Order Component \u7b49\u5176\u4ed6\u6a21\u5f0f\u7684 component \u66f4\u5bb9\u6613\u6b63\u78ba\u7684\u5b9a\u7fa9\u3002\u6700\u65b0\u7684 Flow \u548c TypeScript \u5b9a\u7fa9\u5305\u542b\u5c0d React Hook \u7684\u652f\u63f4\u3002</p>\n<p>\u91cd\u8981\u7684\u662f\uff0c\u5982\u679c\u4f60\u60f3\u8981\u4ee5\u67d0\u7a2e\u56b4\u683c\u7684\u65b9\u5f0f\u5b9a\u7fa9 React API\uff0c\u81ea\u8a02\u7684 Hook \u8b93\u4f60\u6709\u6b0a\u5229\u9650\u5236\u3002React \u70ba\u4f60\u63d0\u4f9b\u4e86 primitive\uff0c\u4f46\u4f60\u53ef\u4ee5\u5c07\u5b83\u8207\u6211\u5011\u63d0\u4f9b\u7684\u65b9\u5f0f\uff0c\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u7d44\u5408\u5728\u4e00\u8d77\u3002</p>\n<h3 id=\"how-to-test-components-that-use-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-test-components-that-use-hooks\"></a>\u5982\u4f55\u6e2c\u8a66\u4f7f\u7528 Hook \u7684 component\uff1f </h3>\n<p>\u5f9e React \u7684\u89d2\u5ea6\u4f86\u770b\uff0c\u4f7f\u7528 Hook \u7684 component \u5c31\u53ea\u662f\u4e00\u500b\u6b63\u5e38\u7684 component\u3002\u5982\u679c\u4f60\u7684\u6e2c\u8a66\u65b9\u6848\u4e0d\u4f9d\u8cf4\u5728 React \u5167\u90e8\uff0c\u6e2c\u8a66\u4f7f\u7528 Hook \u7684 component \u901a\u5e38\u8207\u4f60\u6e2c\u8a66 component \u7684\u65b9\u5f0f\u76f8\u540c\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p><a href=\"/react/testing-recipes\">\u6e2c\u8a66\u65b9\u6cd5</a>\u5305\u542b\u8a31\u591a\u7bc4\u4f8b\uff0c\u8b93\u4f60\u53ef\u4ee5\u8907\u88fd\u8cbc\u4e0a\u3002</p>\n</div>\n<p>\u4f8b\u5982\uff0c\u5982\u679c\u6211\u5011\u6709\u4e00\u500b\u8a08\u6578\u5668 component\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Click me\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6211\u5011\u5c07\u6703\u4f7f\u7528 React DOM \u6e2c\u8a66\u5b83\u3002\u70ba\u4e86\u78ba\u4fdd\u5b83\u5728\u700f\u89bd\u5668\u767c\u751f\u7684\u884c\u70ba\uff0c\u6211\u5011\u5c07\u6703\u628a\u7a0b\u5f0f\u78bc\u900f\u904e\u547c\u53eb  <code class=\"language-javascript\">ReactTestUtils.act()</code> \u4f86 render \u548c\u66f4\u65b0\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/client'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/test-utils'</span><span class=\"token punctuation\">;</span></span><span class=\"token keyword\">import</span> Counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./Counter'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'can render and update a counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u7b2c\u4e00\u6b21\u6e2c\u8a66 render \u548c effect</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Counter</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> label <span class=\"token operator\">=</span> container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'p'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 0 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 0 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// \u7b2c\u4e8c\u6b21\u6e2c\u8a66 render \u548c effect</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    button<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MouseEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">bubbles</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 1 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked 1 times'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5c0d  <code class=\"language-javascript\">act()</code>\u7684\u547c\u53eb\u4e5f\u6703\u66f4\u65b0\u5b83\u5167\u90e8\u7684 effect\u3002</p>\n<p>\u5982\u679c\u4f60\u9700\u8981\u6e2c\u8a66\u81ea\u5b9a\u7fa9\u7684 Hook\uff0c\u4f60\u53ef\u4ee5\u900f\u904e\u5728\u6e2c\u8a66\u4e2d\u5efa\u7acb\u4f60\u7684 component\uff0c\u4e26\u5f9e\u4e2d\u4f7f\u7528 Hook\u3002\u63a5\u8457\u4f60\u53ef\u4ee5\u6e2c\u8a66\u4f60\u64b0\u5beb\u7684 component\u3002</p>\n<p>\u70ba\u4e86\u6e1b\u5c11 boilerplate\uff0c\u6211\u5011\u63a8\u85a6\u4f7f\u7528 <a class=\"external-link\" href=\"https://testing-library.com/react\"><code class=\"language-javascript\">react-testing-library</code></a>\uff0c\u5b83\u7684\u8a2d\u8a08\u7406\u5ff5\u662f\u9f13\u52f5\u4f60\u64b0\u5beb\u50cf\u4f7f\u7528\u8005\u5728\u4f7f\u7528 component \u7684\u6e2c\u8a66\u3002</p>\n<p>\u66f4\u591a\u8cc7\u8a0a\uff0c\u8acb\u53c3\u8003<a href=\"/react/testing-recipes\">\u6e2c\u8a66\u65b9\u6cd5</a>\u3002</p>\n<h3 id=\"what-exactly-do-the-lint-rules-enforce\"><a class=\"anchor\" href=\"/react/hooks-faq#what-exactly-do-the-lint-rules-enforce\"></a><a class=\"external-link\" href=\"(https://www.npmjs.com/package/eslint-plugin-react-hooks)\">Lint \u898f\u5247</a>\u7a76\u7adf\u5f37\u5236\u4e86\u4e9b\u4ec0\u9ebc\uff1f </h3>\n<p>\u6211\u5011\u63d0\u4f9b\u4e00\u500b <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\">ESLint plugin</a> \u5f37\u5236 <a href=\"/react/hooks-rules\">Hook \u7684\u898f\u5247</a> \u4f86\u907f\u514d bug\u3002\u5b83\u5047\u8a2d\u4efb\u4f55\u4ee5\u300c<code class=\"language-javascript\">use</code>\u300d\u70ba\u958b\u982d\u7684 function \u548c\u7dca\u8ddf\u5728\u5b83\u4e4b\u5f8c\u7684\u5927\u5beb\u5b57\u6bcd\u662f Hook\u3002\u6211\u5011\u8a8d\u77e5\u5230\u9019\u500b\u555f\u767c\u5f0f\u7684\u641c\u5c0b\u4e0d\u662f\u5b8c\u7f8e\u800c\u4e14\u53ef\u80fd\u6709\u4e00\u4e9b\u8aa4\u5224\uff0c\u4f46\u662f\u5982\u679c\u6c92\u6709\u4e00\u500b\u5168\u751f\u614b\u7cfb\u7d71\u7684\u6163\u4f8b\uff0c\u5c31\u6c92\u6709\u8fa6\u6cd5\u8b93 Hook \u826f\u597d\u7684\u904b\u4f5c \u2014 \u800c\u4e14\uff0c\u8f03\u9577\u7684\u547d\u540d\u6703\u963b\u7919\u4eba\u5011\u63a1\u7528 Hook \u6216\u662f\u9075\u5faa\u6163\u4f8b\u3002</p>\n<p>\u7279\u5225\u662f\uff0c\u8a72\u898f\u7bc4\u5f37\u5236\u57f7\u884c\uff1a</p>\n<ul>\n<li>\u547c\u53eb Hook \u8981\u9ebc\u662f\u5728\u4e00\u500b <code class=\"language-javascript\">PascalCase</code> function\uff08\u5047\u8a2d\u662f\u4e00\u500b component\uff09\u5167\uff0c\u6216\u8005\u662f\u5176\u4ed6 <code class=\"language-javascript\">useSomething</code>  function \uff08\u5047\u8a2d\u662f\u4e00\u500b\u5b57\u5b9a\u7fa9\u7684 Hook\uff09\u3002</li>\n<li>\u5728\u6bcf\u6b21\u7684 render \u4e0a\u4ee5\u76f8\u540c\u7684\u9806\u5e8f\u547c\u53eb Hook\u3002</li>\n</ul>\n<p>\u9019\u88e1\u9084\u6709\u4e00\u4e9b\u555f\u767c\u5f0f\u7684\u65b9\u6cd5\uff0c\u7576\u6211\u5011\u767c\u73fe\u932f\u8aa4\u4e26\u5fae\u8abf\u898f\u5247\u4ee5\u5e73\u8861\u907f\u514d\u8aa4\u5224\u6642\uff0c\u9019\u4e9b\u898f\u5247\u53ef\u80fd\u6703\u96a8\u8457\u6642\u9593\u800c\u6539\u8b8a\u3002</p>\n<h2 id=\"from-classes-to-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#from-classes-to-hooks\"></a>\u5f9e Class \u5230 Hook </h2>\n<h3 id=\"how-do-lifecycle-methods-correspond-to-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#how-do-lifecycle-methods-correspond-to-hooks\"></a>\u751f\u547d\u9031\u671f\u65b9\u6cd5\u8207 Hook \u5982\u4f55\u5c0d\u61c9\uff1f </h3>\n<ul>\n<li><code class=\"language-javascript\">constructor</code>\uff1aFunction component \u4e0d\u9700\u8981 constructor\u3002\u4f60\u53ef\u4ee5\u5728\u547c\u53eb <a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code></a> \u6642\u521d\u59cb\u5316 state\u3002\u5982\u679c\u521d\u59cb\u5316 state \u7684\u64cd\u4f5c\u4ee3\u50f9\u5f88\u9ad8\uff0c\u4f60\u53ef\u4ee5\u50b3\u905e\u4e00\u500b  function \u5230 <code class=\"language-javascript\">useState</code>\u3002</li>\n<li><code class=\"language-javascript\">getDerivedStateFromProps</code>\uff1a\u6539\u70ba<a href=\"/react/hooks-faq#how-do-i-implement-getderivedstatefromprops\">\u5728 render</a> \u6642\u5b89\u6392\u66f4\u65b0\u3002</li>\n<li><code class=\"language-javascript\">shouldComponentUpdate</code>\uff1a\u53c3\u8003 <code class=\"language-javascript\">React.memo</code> <a href=\"/react/hooks-faq#how-do-i-implement-shouldcomponentupdate\">\u5982\u4e0b</a>\u3002</li>\n<li><code class=\"language-javascript\">render</code>\uff1a\u9019\u662f function component body \u672c\u8eab\u3002</li>\n<li><code class=\"language-javascript\">componentDidMount</code>\u3001<code class=\"language-javascript\">componentDidUpdate</code>\u3001<code class=\"language-javascript\">componentWillUnmount</code>\uff1a<a href=\"/react/hooks-reference#useeffect\"><code class=\"language-javascript\">useEffect</code> Hook</a> \u53ef\u4ee5\u8868\u9054\u9019\u4e9b\u6240\u6709\u7684\u7d44\u5408\uff08\u5305\u542b<a href=\"/react/hooks-faq#can-i-skip-an-effect-on-updates\">\u5c11\u898b</a>\u548c<a href=\"/react/hooks-faq#can-i-run-an-effect-only-on-updates\">\u5e38\u898b</a>\uff09\u7684\u60c5\u6cc1</li>\n<li><code class=\"language-javascript\">getSnapshotBeforeUpdate</code>\u3001<code class=\"language-javascript\">componentDidCatch</code> \u548c <code class=\"language-javascript\">getDerivedStateFromError</code>\uff1a\u73fe\u5728\u6c92\u6709 Hook \u7b49\u50f9\u65bc\u9019\u4e9b\u65b9\u6cd5\uff0c\uff0c\u4f46\u662f\u5b83\u5011\u672a\u4f86\u5f88\u5feb\u6703\u88ab\u52a0\u5165\u3002</li>\n</ul>\n<h3 id=\"how-can-i-do-data-fetching-with-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#how-can-i-do-data-fetching-with-hooks\"></a>\u6211\u5982\u4f55\u4f7f\u7528 Hook fetch \u8cc7\u6599\uff1f </h3>\n<p>\u9019\u88e1\u6709\u4e00\u500b<a class=\"external-link\" href=\"https://codesandbox.io/s/jvvkoo8pq3\">\u7bc4\u4f8b</a>\u8b93\u4f60\u53ef\u4ee5\u958b\u59cb\u3002\u60f3\u8981\u5b78\u7fd2\u66f4\u591a\uff0c\u95b1\u8b80\u9019\u7bc7\u95dc\u65bc\u4f7f\u7528 Hook fetch \u8cc7\u6599\u7684<a class=\"external-link\" href=\"https://www.robinwieruch.de/react-hooks-fetch-data/\">\u6587\u7ae0</a>\u3002</p>\n<h3 id=\"is-there-something-like-instance-variables\"><a class=\"anchor\" href=\"/react/hooks-faq#is-there-something-like-instance-variables\"></a>\u662f\u5426\u6709\u985e\u4f3c Instance \u8b8a\u6578\u7684\u6771\u897f\uff1f </h3>\n<p>\u662f\u7684\uff01<a href=\"/react/hooks-reference#useref\"><code class=\"language-javascript\">useRef()</code></a> Hook \u4e0d\u53ea\u662f\u91dd\u5c0d DOM \u7684 ref\u3002\u300cref\u300dobject \u662f\u4e00\u500b generic container\uff0c\u5176 <code class=\"language-javascript\">current</code> \u5c6c\u6027\u662f\u53ef\u8b8a\u7684\uff0c\u53ef\u4ee5\u4fdd\u5b58\u4efb\u4f55\u503c\uff0c\u985e\u4f3c\u65bc class \u4e0a\u7684 instance \u5c6c\u6027\u3002</p>\n<p>\u4f60\u53ef\u4ee5\u5f9e <code class=\"language-javascript\">useEffect</code> \u5167\u64b0\u5beb\u5b83\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> intervalRef <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    intervalRef<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>intervalRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u6211\u5011\u60f3\u8981\u8a2d\u5b9a\u4e00\u500b\u8a08\u6642\u5668\uff0c\u6211\u5011\u4e0d\u9700\u8981 ref\uff08<code class=\"language-javascript\">id</code> \u53ef\u80fd\u662f\u5728 effect\uff09\uff0c\u4f46\u662f\u5982\u679c\u6211\u5011\u60f3\u8981\u5f9e\u4e00\u500b event handler \u6e05\u9664\u5b9a\u6642\u5668\u5b83\u6703\u5f88\u6709\u5e6b\u52a9\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleCancelClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>intervalRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u6982\u5ff5\u4e0a\uff0c\u4f60\u53ef\u4ee5\u5c07 ref \u8996\u70ba\u985e\u4f3c\u65bc class \u4e2d instance \u7684\u8b8a\u6578\u3002\u9664\u975e\u4f60\u6b63\u5728\u505a<a href=\"/react/hooks-faq#how-to-create-expensive-objects-lazily\">\u5ef6\u9072\u521d\u59cb\u5316</a>\uff0c\u907f\u514d\u5728 render \u6642\u8a2d\u5b9a ref \u2014 \u9019\u53ef\u80fd\u6703\u9020\u6210\u975e\u9810\u671f\u7684\u884c\u70ba\u3002\u76f8\u53cd\u7684\uff0c\u901a\u5e38\u4f60\u6703\u5728 event handler \u548c effect \u4e2d\u4fee\u6539 ref\u3002</p>\n<h3 id=\"should-i-use-one-or-many-state-variables\"><a class=\"anchor\" href=\"/react/hooks-faq#should-i-use-one-or-many-state-variables\"></a>\u6211\u61c9\u8a72\u4f7f\u7528\u4e00\u500b\u6216\u662f\u591a\u500b state \u8b8a\u6578\uff1f </h3>\n<p>\u5982\u679c\u4f60\u539f\u4f86\u662f\u4f7f\u7528 class component\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u8981\u547c\u53eb <code class=\"language-javascript\">useState()</code> \u4e26\u4e00\u6b21\u653e\u5165\u6240\u6709\u7684 state \u5230\u4e00\u500b object\uff0c\u4f60\u60f3\u8981\u7684\u8a71\u53ef\u4ee5\u9019\u9ebc\u505a\u3002\u9019\u88e1\u662f\u4e00\u500b\u96a8\u8457\u6ed1\u9f20\u79fb\u52d5\u7684 component \u7bc4\u4f8b\u3002\u6211\u5011\u4fdd\u6301\u5b83\u7684\u4f4d\u7f6e\u548c\u5927\u5c0f\u5728 local state \u5167\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Box</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u73fe\u5728\u6211\u5011\u60f3\u8981\u64b0\u5beb\u4e00\u4e9b\u908f\u8f2f\uff0c\u7576\u4f7f\u7528\u8005\u79fb\u52d5\u6ed1\u9f20\u6642\uff0c\u6539\u8b8a <code class=\"language-javascript\">left</code> \u548c <code class=\"language-javascript\">top</code>\u3002\u6ce8\u610f\u6211\u5011\u5982\u4f55\u624b\u52d5\u5408\u4f75\u9019\u4e9b\u6b04\u4f4d\u81f3\u5148\u524d\u7684 state object\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token comment\">// ...</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">handleWindowMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u4f7f\u7528\u5c55\u958b\u904b\u7b97\u5b50\u300c...state\u300d\u78ba\u4fdd\u6211\u5011\u4e0d\u6703\u300c\u6f0f\u6389\u300dwidth \u548c height</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>pageX<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>pageY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// \u6ce8\u610f\uff1a\u9019\u500b\u5be6\u4f5c\u662f\u76f8\u7576\u7c21\u5316\u7684</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handleWindowMouseMove<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handleWindowMouseMove<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u9019\u662f\u56e0\u70ba\u7576\u6211\u5011\u66f4\u65b0 state \u8b8a\u6578\u6642\uff0c\u6211\u5011<em>\u66ff\u63db</em>\u5b83\u7684\u503c\u3002\u9019\u8207 class \u4e2d\u7684<code class=\"language-javascript\">this.setState</code>\u4e0d\u540c\uff0c\u5c07\u88ab\u66f4\u65b0\u7684\u6b04\u4f4d<em>\u5408\u4f75</em>\u5230 object \u4e2d\u3002</p>\n<p>\u5982\u679c\u4f60\u6f0f\u6389\u4e86\u81ea\u52d5\u5408\u4f75\uff0c\u4f60\u53ef\u4ee5\u64b0\u5beb\u4e00\u500b\u81ea\u8a02\u7684 <code class=\"language-javascript\">useLegacyState</code> Hook \u4f86\u5408\u4f75 object state \u7684\u66f4\u65b0\u3002\u7136\u800c\uff0c<strong>\u6211\u5011\u5efa\u8b70\u6839\u64da\u54ea\u4e9b\u503c\u662f\u8da8\u65bc\u4e00\u8d77\u8b8a\u5316\u7684\uff0c\u62c6\u5206\u70ba\u591a\u500b state \u8b8a\u6578</strong></p>\n<p>\u4f8b\u5982\uff0c\u6211\u5011\u53ef\u4ee5\u62c6\u5206 component state \u6210 <code class=\"language-javascript\">position</code> \u548c <code class=\"language-javascript\">size</code> object\uff0c\u4e26\u7e3d\u662f\u66ff\u63db <code class=\"language-javascript\">position</code> \u800c\u4e0d\u9700\u8981\u5408\u4f75\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Box</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>position<span class=\"token punctuation\">,</span> setPosition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>size<span class=\"token punctuation\">,</span> setSize<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">handleWindowMouseMove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>pageX<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>pageY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>\u5206\u96e2\u7368\u7acb\u7684 state \u8b8a\u6578\u4e5f\u6709\u53e6\u4e00\u500b\u597d\u8655\u3002\u7a0d\u5f8c\u53ef\u4ee5\u8f15\u9b06\u5730\u5c07\u4e00\u4e9b\u76f8\u95dc\u908f\u8f2f\u63d0\u53d6\u5230\u81ea\u5b9a\u7fa9\u7684 Hook \u4e2d\uff0c\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Box</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> position <span class=\"token operator\">=</span> <span class=\"token function\">useWindowPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>size<span class=\"token punctuation\">,</span> setSize<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useWindowPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>position<span class=\"token punctuation\">,</span> setPosition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">left</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> position<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\u6211\u5011\u662f\u5982\u4f55\u79fb\u52d5 <code class=\"language-javascript\">position</code> state \u8b8a\u6578\u7684 <code class=\"language-javascript\">useState</code> \u547c\u53eb\uff0c\u4e26\u4e14\u5728\u4e0d\u6539\u8b8a\u6211\u5011\u7a0b\u5f0f\u78bc\u7684\u60c5\u6cc1\u4e0b\uff0c\u5c07\u76f8\u95dc effect \u5beb\u5230\u81ea\u5b9a\u7fa9\u7684 Hook\u3002\u5982\u679c\u6240\u6709\u7684 state \u5728\u4e00\u500b\u55ae\u4e00\u7684 object\uff0c\u63d0\u53d6\u5b83\u6703\u8b8a\u5f97\u56f0\u96e3\u3002</p>\n<p>\u4ee5\u4e0a\u5169\u8005\u90fd\u5c07\u6240\u6709 state \u653e\u5230\u5404\u81ea\u7684 <code class=\"language-javascript\">useState</code>\uff0c\u4e26\u53ef\u4ee5\u88ab\u547c\u53eb\u3002\u7576\u4f60\u5728\u9019\u5169\u500b\u6975\u7aef\u4e4b\u9593\u627e\u5230\u5e73\u8861\u6642\uff0ccomponent \u5f80\u5f80\u6700\u5177\u53ef\u8b80\u6027\uff0c\u4e26\u4e14\u5c07\u76f8\u95dc state \u8b8a\u6210\u4e00\u4e9b\u7368\u7acb\u7684 state \u8b8a\u6578\u3002\u5982\u679c state \u908f\u8f2f\u8b8a\u5f97\u8907\u96dc\uff0c\u6211\u5011\u63a8\u85a6<a href=\"/react/hooks-reference#usereducer\">\u7528 reducer \u7ba1\u7406</a>\u6216\u8005\u662f\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook\u3002</p>\n<h3 id=\"can-i-run-an-effect-only-on-updates\"><a class=\"anchor\" href=\"/react/hooks-faq#can-i-run-an-effect-only-on-updates\"></a>\u6211\u53ef\u4ee5\u53ea\u5728\u66f4\u65b0\u6642\u57f7\u884c effect \u55ce\uff1f </h3>\n<p>\u9019\u662f\u4e00\u500b\u7279\u6b8a\u7684\u60c5\u6cc1\uff0c\u5982\u679c\u4f60\u6709\u9700\u8981\u7684\u8a71\uff0c\u53ef\u4ee5<a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">\u4f7f\u7528 mutable ref</a> \u4f86\u624b\u52d5\u7684\u5132\u5b58\u5c0d\u61c9\u65bc\u7b2c\u4e00\u6b21\u6216\u662f\u5f8c\u7e8c\u7684 render\uff0c\u7136\u5f8c\u6aa2\u67e5\u5728\u4f60 effect \u5167\u7684 flag\u3002\uff08\u5982\u679c\u4f60\u767c\u73fe\u81ea\u5df1\u7d93\u5e38\u9019\u6a23\u505a\uff0c\u53ef\u4ee5\u70ba\u5176\u5efa\u7acb\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 Hook\u3002\uff09</p>\n<h3 id=\"how-to-get-the-previous-props-or-state\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-get-the-previous-props-or-state\"></a>\u5982\u4f55\u53d6\u5f97\u5148\u524d\u7684 prop \u6216 state\uff1f </h3>\n<p>\u6709\u5169\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u80fd\u60f3\u53d6\u5f97\u5148\u524d\u7684 prop \u6216 state\u3002</p>\n<p>\u6709\u6642\u5019\uff0c\u4f60\u9700\u8981\u5148\u524d\u7684 prop \u4f86 <strong>\u6e05\u9664\u4e00\u500b effect\u3002</strong>\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u6709\u4e00\u500b\u57fa\u65bc <code class=\"language-javascript\">userId</code> prop \u4f86 subscribe \u4e00\u500b socket \u7684 effect\uff0c\u4f60\u60f3\u8981 unsubscribe <em>\u5148\u524d\u7684</em> \u7684 <code class=\"language-javascript\">userId</code> \u4ee5\u53ca subscribe <em>\u4e0b\u4e00\u500b</em>\u3002\u5c0d\u65bc\u9019\u6a23\u7684\u5de5\u4f5c\u4f60\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4e8b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToSocket</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromSocket</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>userId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c\u5982\u679c <code class=\"language-javascript\">userId</code> \u5f9e <code class=\"language-javascript\">3</code> \u8b8a\u6210 <code class=\"language-javascript\">4</code>\uff0c<code class=\"language-javascript\">ChatAPI.unsubscribeFromSocket(3)</code> \u6703\u56de\u50b3\u7b2c\u4e00\u500b\uff0c\u63a5\u8457\u57f7\u884c <code class=\"language-javascript\">ChatAPI.subscribeToSocket(4)</code>\u3002\u9019\u88e1\u4e0d\u9700\u8981\u53d6\u5f97\u300c\u5148\u524d\u7684\u300d <code class=\"language-javascript\">userId</code>\uff0c\u56e0\u70ba cleanup function \u6703\u5728\u5b83\u7684 closure \u6355\u7372\u5b83\u3002</p>\n<p>\u5176\u4ed6\u6642\u5019\uff0c\u4f60\u53ef\u80fd\u9700\u8981<strong>\u57fa\u65bc prop \u6216 state \u7684\u8b8a\u5316\u4f86\u8abf\u6574 state</strong>\u3002\u9019\u5f88\u5c11\u9700\u8981\uff0c\u800c\u4e14\u9019\u901a\u5e38\u662f\u500b\u8a0a\u865f\u4f60\u6709\u4e00\u4e9b\u91cd\u8907\u6216\u591a\u9918\u7684 state\u3002\u7136\u800c\uff0c\u5728\u6975\u5c11\u6578\u7684\u60c5\u6cc1\u4e0b\u4f60\u9700\u8981\u9019\u500b\u6a21\u5f0f\uff0c\u4f60\u53ef\u4ee5 <a href=\"/react/hooks-faq#how-do-i-implement-getderivedstatefromprops\">\u5132\u5b58\u5148\u524d\u7684 state \u6216 prop \u5728 state \u4e26\u4e14\u5728 rendering \u671f\u9593\u66f4\u65b0\u5b83\u5011</a>\u3002</p>\n<p>\u6211\u5011\u4e4b\u524d\u63d0\u51fa\u4e86\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 hook \u53eb\u505a <code class=\"language-javascript\">usePrevious</code> \u4f86\u5132\u5b58\u524d\u4e00\u500b\u503c\u3002\u7136\u800c\uff0c\u6211\u5011\u767c\u73fe\u5927\u90e8\u5206\u7684\u4f7f\u7528\u6848\u4f8b\u90fd\u662f\u5411\u4e0a\u9762\u6240\u63cf\u8ff0\u7684\u5169\u7a2e\u6a21\u5f0f\u3002\u5982\u679c\u4f60\u7684\u4f7f\u7528\u60c5\u5883\u975e\u5e38\u4e0d\u540c\uff0c\u4f60\u53ef\u4ee5<a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">\u5132\u5b58\u4e00\u500b\u503c\u5728 ref</a> \u4e26\u4e14\u7576\u5b83\u9700\u8981\u7684\u6642\u5019\u624b\u52d5\u66f4\u65b0\u5b83\u3002\u907f\u514d\u5728 rendering \u4e2d\u8b80\u53d6\u548c\u66f4\u65b0 ref\uff0c\u56e0\u70ba\u9019\u8b93\u4f60 component \u7684\u884c\u70ba\u96e3\u4ee5\u9810\u6e2c\u548c\u7406\u89e3\u3002</p>\n<h3 id=\"why-am-i-seeing-stale-props-or-state-inside-my-function\"><a class=\"anchor\" href=\"/react/hooks-faq#why-am-i-seeing-stale-props-or-state-inside-my-function\"></a>\u70ba\u4ec0\u9ebc\u6211\u5728 function \u5167\u770b\u5230\u820a\u7684 prop \u6216 state\uff1f </h3>\n<p>\u4efb\u4f55\u5728 component \u5167\u7684 function\uff0c\u5305\u62ec event handler \u548c effect\uff0c\u5f9e\u88ab\u5efa\u7acb\u7684 render \u4e2d\u300c\u770b\u898b\u300dprops \u548c state\u3002\u4f8b\u5982\uff0c\u601d\u8003\u4e00\u4e0b\u9019\u500b\u7a0b\u5f0f\u78bc\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleAlertClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked on: '</span> <span class=\"token operator\">+</span> count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">You clicked </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Click me\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleAlertClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Show alert\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u7b2c\u4e00\u6b21\u9ede\u64ca\u300cShow alert\u300d\u4e26\u4e14\u905e\u589e counter\uff0c\u90a3\u9ebc alert \u5c07\u6703\u986f\u793a<strong>\u4f60\u7576\u6642\u9ede\u64ca\u300cShow alert\u300d\u6309\u9215</strong>\u6642\u7684 count \u8b8a\u6578\u3002\u5047\u8a2d prop \u548c state \u6c92\u6709\u6539\u8b8a\u7684\u8a71\uff0c\u9019\u53ef\u4ee5\u907f\u514d bug\u3002</p>\n<p>\u5982\u679c\u4f60\u60f3\u8981\u5f9e\u4e00\u4e9b\u975e\u540c\u6b65\u7684 callback \u8b80\u53d6<em>\u6700\u65b0\u7684</em> state\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u4fdd\u7559\u5728 <a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">ref</a>\uff0cmutate \u5b83\uff0c\u4e26\u5f9e\u4e2d\u8b80\u53d6\u3002</p>\n<p>\u6700\u5f8c\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u300cdependency array\u300d\u505a\u6700\u4f73\u5316\uff0c\u4f46\u6c92\u6709\u6b63\u78ba\u7684\u6307\u5b9a\u6240\u6709\u7684\u4f9d\u8cf4\uff0c\u4f60\u53ef\u80fd\u6703\u770b\u5230\u820a\u7684 props \u6216\u662f state\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5728 effect \u6307\u5b9a <code class=\"language-javascript\">[]</code> \u4f5c\u70ba\u7b2c\u4e8c\u500b\u53c3\u6578\uff0c\u4f46\u662f\u5728\u5167\u90e8\u8b80\u53d6 <code class=\"language-javascript\">someProp</code>\uff0c\u5b83\u5c07\u53ea\u6703\u300c\u770b\u5230\u300d<code class=\"language-javascript\">someProp</code> \u7684\u521d\u59cb\u503c\u3002\u89e3\u6c7a\u65b9\u5f0f\u662f\u79fb\u9664 dependency array \u6216\u8005\u662f\u4fee\u6b63\u5b83\u3002\u9019\u88e1\u662f<a href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\">\u4f60\u5982\u4f55\u8655\u7406\u9019\u4e9b function</a>\uff0c\u4ee5\u53ca<a href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\">\u5176\u4ed6\u5e38\u898b\u7684\u7b56\u7565</a>\u5728\u4e0d\u932f\u8aa4\u5730\u8df3\u904e\u4f9d\u8cf4\u9805\u7684\u60c5\u6cc1\u4e0b\u6e1b\u5c11\u57f7\u884c effect\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u6211\u5011\u63d0\u4f9b\u4e86\u4e00\u500b <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> \u7684 ESLint \u898f\u5247\u4f5c\u70ba <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> package \u7684\u4e00\u90e8\u4efd\u3002\u5b83\u6703\u5728\u6307\u5b9a\u932f\u8aa4\u7684\u4f9d\u8cf4\u6642\uff0c\u767c\u51fa\u8b66\u544a\u4e26\u63d0\u4f9b\u5efa\u8b70\u4fee\u5fa9\u3002</p>\n</div>\n<h3 id=\"how-do-i-implement-getderivedstatefromprops\"><a class=\"anchor\" href=\"/react/hooks-faq#how-do-i-implement-getderivedstatefromprops\"></a>\u6211\u8a72\u5982\u4f55\u5be6\u4f5c getDerivedStateFromProps\uff1f </h3>\n<p>\u96d6\u7136\u4f60\u53ef\u80fd<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2018/06/07/you-probably-dont-need-derived-state.html\">\u4e0d\u9700\u8981\u5b83</a>\uff0c\u4f46\u5728\u6975\u5c11\u6578\u60c5\u6cc1\u4e0b\uff08\u4f8b\u5982\u5be6\u4f5c<code class=\"language-javascript\">&lt;Transition&gt;</code> component\uff09\uff0c\u4f60\u53ef\u4ee5\u5728 render \u671f\u9593\u66f4\u65b0 state\u3002React \u5c07\u6703\u5728\u7b2c\u4e00\u6b21\u7684 render \u9000\u51fa\u5f8c\uff0c\u91cd\u65b0\u57f7\u884c component \u4e26\u4e14\u7acb\u5373\u66f4\u65b0 state\uff0c\u9019\u500b\u64cd\u4f5c\u4ee3\u50f9\u4e0d\u6703\u5f88\u6602\u8cb4\u3002</p>\n<p>\u5728\u9019\u88e1\uff0c\u6211\u5011\u5c07 <code class=\"language-javascript\">row</code> prop \u5148\u524d\u7684\u503c\u5b58\u5132\u5728 state \u8b8a\u6578\u4e2d\uff0c\u8b93\u6211\u5011\u53ef\u4ee5\u65b9\u4fbf\u7684\u6bd4\u8f03\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ScrollView</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isScrollingDown<span class=\"token punctuation\">,</span> setIsScrollingDown<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>prevRow<span class=\"token punctuation\">,</span> setPrevRow<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row <span class=\"token operator\">!==</span> prevRow<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Row \u5728\u6700\u5f8c\u4e00\u6b21 render \u88ab\u6539\u8b8a\u3002\u66f4\u65b0 isScrollingDown</span>\n    <span class=\"token function\">setIsScrollingDown</span><span class=\"token punctuation\">(</span>prevRow <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> row <span class=\"token operator\">&gt;</span> prevRow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setPrevRow</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Scrolling down: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>isScrollingDown<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u500b\u7b2c\u4e00\u773c\u770b\u8d77\u4f86\u53ef\u80fd\u5f88\u5947\u602a\uff0c\u4f46\u662f render \u904e\u7a0b\u4e2d\u7684\u66f4\u65b0\u6b63\u662f <code class=\"language-javascript\">getDerivedStateFromProps</code> \u7684\u6982\u5ff5\u3002</p>\n<h3 id=\"is-there-something-like-forceupdate\"><a class=\"anchor\" href=\"/react/hooks-faq#is-there-something-like-forceupdate\"></a>\u6709\u985e\u4f3c forceUpdate \u7684\u6771\u897f\u55ce\uff1f </h3>\n<p>\u5982\u679c\u65b0\u7684\u503c\u8207\u5148\u524d\u76f8\u540c\u7684\u8a71\uff0c<code class=\"language-javascript\">useState</code> \u548c <code class=\"language-javascript\">useReducer</code> Hook \u5169\u8005\u90fd\u53ef\u4ee5\u5f9e<a href=\"/react/hooks-reference#bailing-out-of-a-state-update\">\u66f4\u65b0\u4e2d\u8df3\u812b</a>\u3002</p>\n<p>\u901a\u5e38\u4f86\u8aaa\uff0c\u4f60\u4e0d\u61c9\u8a72\u5728 React \u5167 mutate local state\uff0c\u7136\u800c\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u500b increment couter \u4f86\u4f5c\u70ba\u8df3\u812b\u65b9\u5f0f\uff0c\u5f37\u8feb\u91cd\u65b0 render\uff0c\u5373\u4f7f state \u6c92\u6709\u6539\u8b8a\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>ignored<span class=\"token punctuation\">,</span> forceUpdate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span> <span class=\"token operator\">=&gt;</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u53ef\u4ee5\u7684\u8a71\uff0c\u76e1\u91cf\u907f\u514d\u4f7f\u7528\u9019\u500b\u65b9\u5f0f\u3002</p>\n<h3 id=\"can-i-make-a-ref-to-a-function-component\"><a class=\"anchor\" href=\"/react/hooks-faq#can-i-make-a-ref-to-a-function-component\"></a>\u6211\u53ef\u4ee5\u5c0d function component \u5efa\u7acb\u4e00\u500b ref \u55ce\uff1f </h3>\n<p>\u96d6\u7136\u4f60\u4e0d\u61c9\u8a72\u7d93\u5e38\u9019\u6a23\u505a\uff0c\u4f46\u662f\u4f60\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/hooks-reference#useimperativehandle\"><code class=\"language-javascript\">useImperativeHandle</code></a> Hook expose \u4e00\u4e9b imperative \u65b9\u6cd5\u7d66 parent component\u3002</p>\n<h3 id=\"how-can-i-measure-a-dom-node\"><a class=\"anchor\" href=\"/react/hooks-faq#how-can-i-measure-a-dom-node\"></a>\u6211\u8a72\u5982\u4f55\u6e2c\u91cf\u4e00\u500b DOM node\uff1f </h3>\n<p>\u70ba\u4e86\u6e2c\u91cf DOM node \u7684\u4f4d\u7f6e\u6216\u662f\u5927\u5c0f\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/refs-and-the-dom#callback-refs\">callback ref</a>\u3002\u53ea\u8981 ref \u88ab attach \u5230\u4e0d\u540c\u7684 node\uff0cReact \u5c07\u6703\u547c\u53eb\u9019\u500b callback\u3002\u9019\u88e1\u662f\u4e00\u500b<a class=\"external-link\" href=\"https://codesandbox.io/s/l7m0v5x4v9\">\u7c21\u6613\u7684\u7bc4\u4f8b</a>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">MeasureExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>height<span class=\"token punctuation\">,</span> setHeight<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> measuredRef <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setHeight</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>measuredRef<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The above header is </span><span class=\"token punctuation\">{</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">px tall</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u9019\u500b\u7bc4\u4f8b\u6211\u5011\u4e0d\u9078\u64c7 <code class=\"language-javascript\">useRef</code> \u662f\u56e0\u70ba\u4e00\u500b object \u7684 ref \u4e0d\u6703\u901a\u77e5\u6211\u5011\u76ee\u524d\u7684 ref \u503c\u7684<em>\u6539\u8b8a</em>\u3002\u4f7f\u7528\u4e00\u500b callback ref \u78ba\u4fdd<a class=\"external-link\" href=\"https://codesandbox.io/s/818zzk8m78\">\u5373\u4f7f child component \u5ef6\u9072\u986f\u793a\u6e2c\u91cf\u7684 node</a> \uff08\u4f8b\u5982\uff1a\u5728 response click\uff09\uff0c\u6211\u5011\u4ecd\u7136\u6703\u5728 parent component \u4e2d\u6536\u5230\u6709\u95dc\u5b83\u7684\u901a\u77e5\uff0c\u4e26\u53ef\u4ee5\u66f4\u65b0\u6e2c\u91cf\u7d50\u679c\u3002</p>\n<p>\u9019\u78ba\u4fdd\u6211\u5011\u7684 ref callback \u4e0d\u6703\u5728 re-render \u6642\u6539\u8b8a\uff0c\u56e0\u6b64 React \u4e0d\u9700\u8981\u547c\u53eb\u5b83\u3002</p>\n<p>\u5728\u9019\u500b\u7bc4\u4f8b\uff0ccallback ref \u53ea\u6703\u5728\u7576 component mount \u4ee5\u53ca unmount \u6642\u88ab\u547c\u53eb\uff0c\u7531\u65bc\u88ab render \u7684 <code class=\"language-javascript\">&lt;h1&gt;</code> component \u5728\u6240\u6709 render \u90fd\u4fdd\u6301\u5b58\u5728\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u4efb\u4f55\u6642\u5019\u5728 component resize \u6642\u88ab\u901a\u77e5\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver\"><code class=\"language-javascript\">ResizeObserver</code></a> \u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u7684 Hook\u3002</p>\n<p>\u5982\u679c\u4f60\u5e0c\u671b\u547c\u53eb\u5b83\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5<a class=\"external-link\" href=\"https://codesandbox.io/s/m5o42082xy\">\u62bd\u51fa\u9019\u500b\u908f\u8f2f</a>\u8b8a\u6210\u4e00\u500b\u53ef\u91cd\u8907\u4f7f\u7528\u7684 Hook\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">MeasureExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rect<span class=\"token punctuation\">,</span> ref<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, world</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span>rect <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">The above header is </span><span class=\"token punctuation\">{</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>rect<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">px tall</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rect<span class=\"token punctuation\">,</span> setRect<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setRect</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>rect<span class=\"token punctuation\">,</span> ref<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"what-does-const-thing-setthing--usestate-mean\"><a class=\"anchor\" href=\"/react/hooks-faq#what-does-const-thing-setthing--usestate-mean\"></a><code class=\"language-javascript\">const [thing, setThing] = useState()</code> \u662f\u4ec0\u9ebc\u610f\u601d\uff1f </h3>\n<p>\u5982\u679c\u4f60\u4e0d\u719f\u6089\u9019\u500b\u8a9e\u6cd5\u7684\u8a71\uff0c\u53ef\u4ee5\u53c3\u8003\u5728 State Hook \u6587\u4ef6\u7684<a href=\"/react/hooks-state#tip-what-do-square-brackets-mean\">\u89e3\u91cb</a>\u3002</p>\n<h2 id=\"performance-optimizations\"><a class=\"anchor\" href=\"/react/hooks-faq#performance-optimizations\"></a>\u6548\u80fd\u6700\u4f73\u5316 </h2>\n<h3 id=\"can-i-skip-an-effect-on-updates\"><a class=\"anchor\" href=\"/react/hooks-faq#can-i-skip-an-effect-on-updates\"></a>\u6211\u53ef\u4ee5\u5728\u66f4\u65b0\u6642\u5ffd\u7565 effect \u55ce\uff1f </h3>\n<p>\u53ef\u4ee5\u7684\u3002\u8acb\u53c3\u8003<a href=\"/react/hooks-reference#conditionally-firing-an-effect\">\u689d\u4ef6\u5f0f\u89f8\u767c effect</a>\u3002\u8acb\u6ce8\u610f\uff0c\u5fd8\u8a18\u8655\u7406\u66f4\u65b0\u901a\u5e38<a href=\"/react/hooks-effect#explanation-why-effects-run-on-each-update\">\u5c0e\u81f4 bug</a>\uff0c\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u9019\u4e0d\u662f\u9810\u8a2d\u884c\u70ba\u3002</p>\n<h3 id=\"is-it-safe-to-omit-functions-from-the-list-of-dependencies\"><a class=\"anchor\" href=\"/react/hooks-faq#is-it-safe-to-omit-functions-from-the-list-of-dependencies\"></a>\u5728\u4f9d\u8cf4\u9805\u76ee\u7684\u5217\u8868\u4e2d\u5ffd\u7565 function \u662f\u5b89\u5168\u7684\u55ce\uff1f </h3>\n<p>\u4e00\u822c\u4f86\u8aaa\uff0c\u4e0d\u662f\u3002</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> someProp <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>someProp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \ud83d\udd34 \u9019\u500b\u4e0d\u5b89\u5168\uff08\u547c\u53eb `doSomething` \u7684 function \u4f7f\u7528\u4e86 `someProp`\uff09</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8981\u8a18\u4f4f effect \u4e4b\u5916\u7684 function \u4f7f\u7528\u4e86\u54ea\u4e9b props \u6216 state \u662f\u5f88\u56f0\u96e3\u7684\u3002\u9019\u4e5f\u662f\u70ba\u4ec0\u9ebc<strong>\u901a\u5e38\u4f60\u9700\u8981\u5728 effect <em>\u5167</em>\u5ba3\u544a\u6240\u9700\u8981\u7684 function\u3002</strong>\u7136\u5f8c\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u770b\u51fa effect \u4f9d\u8cf4\u4e86 component \u7bc4\u570d\u5167\u7684\u503c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> someProp <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>someProp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>someProp<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 OK\uff08\u6211\u5011\u7684 effect \u53ea\u4f7f\u7528 `someProp`\uff09</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4e4b\u5f8c\u6211\u5011\u4ecd\u7136\u4e0d\u4f7f\u7528 component \u7bc4\u570d\u5167\u7684\u4efb\u4f55\u503c\uff0c\u5247\u53ef\u4ee5\u5b89\u5168\u7684\u6307\u5b9a\u70ba <code class=\"language-javascript\">[]</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hello'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 OK\uff0c\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u56e0\u70ba\u6211\u5011\u4e0d\u4f7f\u7528 component \u7bc4\u570d\u4e2d\u7684*\u4efb\u4f55*\u503c</span></span></code></pre></div>\n<p>\u6839\u64da\u4f60\u7684\u4f7f\u7528\u60c5\u5883\uff0c\u9084\u6709\u4e00\u4e9b\u9078\u9805\u5982\u4e0b\u6240\u8ff0\u3002</p>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u6211\u5011\u63d0\u4f9b\u4e86 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/14920\"><code class=\"language-javascript\">exhaustive-deps</code></a> ESLint \u898f\u5247\u4f5c\u70ba <a class=\"external-link\" href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation\"><code class=\"language-javascript\">eslint-plugin-react-hooks</code></a> package \u7684\u4e00\u90e8\u4efd\u3002\u5b83\u53ef\u4ee5\u5e6b\u52a9\u4f60\u627e\u5230\u4e0d\u4e00\u81f4\u7684\u8655\u7406\u66f4\u65b0\u7684 component\u3002</p>\n</div>\n<p>\u8b93\u6211\u5011\u770b\u770b\u9019\u500b\u70ba\u4ec0\u9ebc\u5f88\u91cd\u8981\u3002</p>\n<p>\u5982\u679c\u4f60\u5728 <code class=\"language-javascript\">useEffect</code>\u3001<code class=\"language-javascript\">useLayoutEffect</code>\u3001<code class=\"language-javascript\">useMemo</code>\u3001<code class=\"language-javascript\">useCallback</code> \u6216\u662f <code class=\"language-javascript\">useImperativeHandle</code> \u7684\u6700\u5f8c\u6307\u5b9a\u4e86<a href=\"/react/hooks-reference#conditionally-firing-an-effect\">\u4f9d\u8cf4\u9805\u76ee\u7684\u5217\u8868</a>\uff0c\u5b83\u5fc5\u9808\u5305\u542b\u5728 callback \u5167\u4f7f\u7528\u7684\u503c\u4ee5\u53ca\u53c3\u8207 React \u7684\u8cc7\u6599\u6d41\u3002\u5305\u542b\u4e86 props\u3001state \u548c\u5f9e\u5b83\u5011\u53d6\u5f97\u7684\u4efb\u4f55\u503c\u3002</p>\n<p>\u5982\u679c\u6c92\u6709\u4efb\u4f55\u5167\u5bb9\uff08\u6216\u7531\u5b83\u547c\u53eb\u7684 function\uff09reference \u5230 props\u3001state \u6216\u662f\u5f9e\u5b83\u5011\u53d6\u5f97\u7684\u503c\uff0c\u90a3\u9ebc\u5f9e\u4f9d\u8cf4\u9805\u76ee\u4e2d\u7701\u7565\u4e00\u500b function \u662f<em>\u552f\u4e00</em>\u5b89\u5168\u7684\u3002\u9019\u500b\u7bc4\u4f8b\u6709\u4e00\u500b bug\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ProductPage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> productId <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>product<span class=\"token punctuation\">,</span> setProduct<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://myapi/product/'</span> <span class=\"token operator\">+</span> productId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u4f7f\u7528 productId prop</span></span>    <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setProduct</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \ud83d\udd34 \u7121\u6548\uff0c\u56e0\u70ba `fetchProduct` \u4f7f\u7528 `productId`</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>\u63a8\u85a6\u4fee\u6b63\u7684\u65b9\u6cd5\u662f\u5c07 function \u79fb\u52d5\u5230\u4f60\u7684 effect <em>\u5167\u90e8</em>\u3002</strong>\u9019\u6a23\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u770b\u5230\u4f60\u7684 effect \u4f7f\u7528\u4e86\u54ea\u4e9b props \u6216 state\uff0c\u4e26\u78ba\u4fdd\u4ed6\u5011\u90fd\u88ab\u5ba3\u544a\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ProductPage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> productId <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>product<span class=\"token punctuation\">,</span> setProduct<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// \u900f\u904e\u5c07\u9019\u500b function \u79fb\u52d5\u5230 effect \u5167\u90e8\uff0c\u6211\u5011\u53ef\u4ee5\u6e05\u695a\u5730\u770b\u5230\u503c\u7684\u4f7f\u7528\u3002</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://myapi/product/'</span> <span class=\"token operator\">+</span> productId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setProduct</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>\n    <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>productId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 \u6709\u6548\uff0c\u56e0\u70ba\u6211\u5011\u7684 effect \u53ea\u4f7f\u7528 productId</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u4e5f\u53ef\u4ee5\u5141\u8a31\u4f60\u8655\u7406\u5728 effect \u5167\u4f7f\u7528 local \u8b8a\u6578\u8655\u7406\u7121\u5e8f\u7684 response\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">let</span> ignore <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://myapi/product/'</span> <span class=\"token operator\">+</span> productId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>ignore<span class=\"token punctuation\">)</span> <span class=\"token function\">setProduct</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span> ignore <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>productId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u6211\u5011\u642c\u79fb function \u5230 effect \u5167\u90e8\uff0c\u6240\u4ee5\u5b83\u4e0d\u9700\u8981\u88ab\u52a0\u5165\u5728\u4f9d\u8cf4\u5217\u8868\u3002</p>\n<div class=\"blockquote\">\n<strong>Tip</strong>\n<p>\u67e5\u770b<a class=\"external-link\" href=\"https://codesandbox.io/s/jvvkoo8pq3\">\u9019\u500b\u7c21\u6613\u7684\u7bc4\u4f8b</a>\u4ee5\u53ca<a class=\"external-link\" href=\"https://www.robinwieruch.de/react-hooks-fetch-data/\">\u9019\u7bc7\u6587\u7ae0</a>\u4f86\u5b78\u7fd2\u95dc\u65bc\u5982\u4f55\u4f7f\u7528 Hooks \u4f86\u53d6\u5f97\u8cc7\u6599\u3002</p>\n</div>\n<p><strong>\u5982\u679c\u6709\u4e00\u4e9b\u56e0\u7d20\u8b93\u4f60<em>\u4e0d\u80fd</em>\u642c\u79fb function \u5230 effect \u5167\uff0c\u9019\u88e1\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u9078\u9805\uff1a</strong></p>\n<ul>\n<li><strong>\u4f60\u53ef\u4ee5\u5617\u8a66\u5c07 function \u642c\u79fb\u5230 component \u4e4b\u5916</strong>\u3002\u5728\u9019\u500b\u60c5\u6cc1\u4e0b\uff0c function \u53ef\u4ee5\u4fdd\u8b49\u4e0d reference \u5230\u4efb\u4f55\u7684 props \u6216 state\uff0c\u800c\u4e14\u4e5f\u4e0d\u9700\u8981\u5728\u4f9d\u8cf4\u9805\u76ee\u7684\u5217\u8868\u4e2d\u3002</li>\n<li>\u5982\u679c\u4f60\u6b63\u5728\u547c\u53eb\u7684 function \u662f pure \u7684\u8a08\u7b97\uff0c\u800c\u4e14\u53ef\u4ee5\u5728 render \u6642\u88ab\u5b89\u5168\u7684\u547c\u53eb\uff0c<strong>\u4f60\u53ef\u4ee5\u5728 effect \u5916\u547c\u53eb\u5b83\uff0c</strong>\u4e26\u8b93 effect \u53d6\u6c7a\u65bc\u56de\u50b3\u7684\u503c\u3002</li>\n<li>\u4f5c\u70ba\u6700\u5f8c\u7684\u624b\u6bb5\uff0c\u4f60\u53ef\u4ee5<strong>\u52a0\u5165\u4e00\u500b function \u5230 effect \u4f9d\u8cf4\u9805\u76ee\uff0c\u4f46\u662f<em>\u5c01\u88dd\u5b83\u7684\u5b9a\u7fa9</em></strong>\u6210 <a href=\"/react/hooks-reference#usecallback\"><code class=\"language-javascript\">useCallback</code></a> Hook\u3002\u9019\u53ef\u4ee5\u78ba\u4fdd\u5b83\u4e0d\u6703\u5728\u6bcf\u6b21 render \u6642\u6539\u8b8a\uff0c\u9664\u975e<em>\u5b83\u81ea\u5df1</em>\u7684\u4f9d\u8cf4\u9805\u76ee\u4e5f\u6539\u8b8a\uff1a</li>\n</ul>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ProductPage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> productId <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u2705 \u85c9\u7531 useCallback \u5c01\u88dd\u53ef\u4ee5\u907f\u514d\u5728\u6bcf\u6b21 render \u6642\u6539\u8b8a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> fetchProduct <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// ... Does something with productId ...</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>productId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 \u6240\u6709 useCallback \u4f9d\u8cf4\u5df2\u7d93\u88ab\u6307\u5b9a</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ProductDetails</span></span> <span class=\"token attr-name\">fetchProduct</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fetchProduct<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ProductDetails</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> fetchProduct <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchProduct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fetchProduct<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 \u6240\u6709 useEffect \u4f9d\u8cf4\u5df2\u7d93\u88ab\u6307\u5b9a</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\uff0c\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011<em>\u9700\u8981</em>\u4fdd\u6301 function \u5728\u4f9d\u8cf4\u5217\u8868\u5167\u3002\u9019\u53ef\u4ee5\u78ba\u4fdd <code class=\"language-javascript\">ProductPage</code> \u4e2d\u7684 <code class=\"language-javascript\">productId</code> \u6539\u8b8a\u81ea\u52d5\u6703\u89f8\u767c <code class=\"language-javascript\">ProductDetails</code> component \u7684 refetch\u3002</p>\n<h3 id=\"what-can-i-do-if-my-effect-dependencies-change-too-often\"><a class=\"anchor\" href=\"/react/hooks-faq#what-can-i-do-if-my-effect-dependencies-change-too-often\"></a>\u5982\u679c\u6211\u7684 effect \u4f9d\u8cf4\u9805\u76ee\u7d93\u5e38\u8b8a\u5316\u7684\u8a71\u8a72\u600e\u9ebc\u8fa6\uff1f </h3>\n<p>\u6709\u6642\u5019\uff0c\u4f60\u7684 effect \u53ef\u80fd\u4f7f\u7528 state \u800c\u4e14\u5b83\u7d93\u5e38\u6539\u8b8a\u3002\u4f60\u53ef\u80fd\u60f3\u5f9e\u4f9d\u8cf4\u7684\u9805\u76ee\u5217\u8868\u4e2d\u7701\u7565\u8a72 state\uff0c\u4f46\u9019\u901a\u5e38\u6703\u5c0e\u81f4 bug\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u9019\u500b effect \u4f9d\u8cf4\u65bc `count` state</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \ud83d\udd34 Bug\uff1a`count` \u6c92\u6709\u88ab\u6307\u5b9a\u4f5c\u70ba\u4e00\u500b\u4f9d\u8cf4</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u8a2d\u5b9a\u7a7a\u7684\u4f9d\u8cf4 <code class=\"language-javascript\">[]</code>\uff0c\u610f\u5473\u8457 effect \u5c07\u53ea\u6703\u5728 component mount \u7684\u6642\u5019\u53ea\u57f7\u884c\u4e00\u6b21\uff0c\u800c\u4e0d\u662f\u5728\u6bcf\u6b21 re-render\u3002\u554f\u984c\u5728\u65bc\u5167\u90e8\u7684 <code class=\"language-javascript\">setInterval</code> callback\uff0c<code class=\"language-javascript\">count</code> \u503c\u4e26\u4e0d\u6703\u6539\u8b8a\uff0c\u56e0\u70ba\u6211\u5011\u5df2\u7d93\u5efa\u7acb\u4e00\u500b closure \u4e26\u4e14\u8a2d\u5b9a <code class=\"language-javascript\">count</code> \u70ba <code class=\"language-javascript\">0</code>\uff0c\u5c31\u50cf\u57f7\u884c effect callback \u6642\u4e00\u6a23\u3002\u5728\u6bcf\u79d2\u9418\uff0c\u9019\u500b callback  \u547c\u53eb <code class=\"language-javascript\">setCount(0 + 1)</code>\uff0c\u6240\u4ee5 count \u6c38\u9060\u4e0d\u6703\u5927\u65bc 1\u3002</p>\n<p>\u6307\u5b9a <code class=\"language-javascript\">[count]</code> \u4f5c\u70ba\u4f9d\u8cf4\u9805\u76ee\u53ef\u4ee5\u4fee\u6b63\u9019\u500b bug\uff0c\u4f46\u6703\u5c0e\u81f4\u6bcf\u6b21\u66f4\u6539\u6642\u91cd\u7f6e\u9593\u9694\u3002\u5be6\u969b\u4e0a\uff0c\u6bcf\u500b <code class=\"language-javascript\">setInterval</code> \u5728\u88ab\u6e05\u9664\u4e4b\u524d\u90fd\u6709\u4e00\u6b21\u6a5f\u6703\u57f7\u884c\uff08\u985e\u4f3c\u65bc <code class=\"language-javascript\">setTimeout</code>\u3002\uff09\u9019\u53ef\u80fd\u4e26\u4e0d\u7406\u60f3\u3002\u8981\u4fee\u6b63\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/hooks-reference#functional-updates\"><code class=\"language-javascript\">setState</code> \u7684 functional \u66f4\u65b0\u7684\u5f62\u5f0f</a>\u3002\u5b83\u5141\u8a31\u6211\u5011\u6307\u5b9a<em>\u5982\u4f55</em> state \u9700\u8981\u6539\u8b8a\u800c\u4e0d\u5f15\u7528<em>\u76ee\u524d</em>\u7684 state\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=&gt;</span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 \u9019\u4e0d\u6703\u4f9d\u8cf4\u65bc\u5916\u90e8\u7684 `count` \u8b8a\u6578</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u2705 \u6211\u5011\u7684 effect \u4e0d\u4f7f\u7528 component \u7bc4\u570d\u5167\u7684\u4efb\u4f55\u8b8a\u6578</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\uff08<code class=\"language-javascript\">setCount</code> function \u7684 identity \u7684\u4fdd\u8b49\u662f\u7a69\u5b9a\u7684\uff0c\u56e0\u6b64\u7701\u7565\u5b83\u662f\u5b89\u5168\u7684\u3002\uff09</p>\n<p>\u73fe\u5728\uff0c<code class=\"language-javascript\">setInterval</code> callback \u6bcf\u79d2\u57f7\u884c\u4e00\u6b21\uff0c\u4f46\u6bcf\u6b21\u5c0d <code class=\"language-javascript\">setCount</code> \u5167\u90e8\u7684\u547c\u53eb\u90fd\u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">count</code> \u6700\u65b0\u7684\u503c\uff08\u5728 callback \u4e2d\u88ab\u547c\u53eb\u7684 <code class=\"language-javascript\">c</code>\u3002\uff09</p>\n<p>\u5728\u8a31\u591a\u8907\u96dc\u7684\u60c5\u6cc1\u4e0b\uff08\u4f8b\u5982\uff0c\u4e00\u500b state \u4f9d\u8cf4\u53e6\u4e00\u500b state\uff09\uff0c\u5617\u8a66\u4f7f\u7528 <a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code> Hook</a> \u5c07 state \u7684\u66f4\u65b0\u908f\u8f2f\u642c\u79fb\u5230 effect \u5916\u3002<a class=\"external-link\" href=\"https://adamrackis.dev/state-and-use-reducer/\">\u9019\u7bc7\u6587\u7ae0</a>\u63d0\u4f9b\u4e86\u4e00\u500b\u5982\u4f55\u505a\u5230\u7684\u7bc4\u4f8b\u3002<strong><code class=\"language-javascript\">useReducer</code> \u4e2d\u7684 <code class=\"language-javascript\">dispatch</code> function \u7684 identity \u662f\u7a69\u5b9a\u7684</strong> \u2014 \u5373\u4f7f reducer function \u88ab\u5ba3\u544a\u5728 component \u5167\u4e26\u8b80\u53d6\u5b83\u7684 props\u3002</p>\n<p>\u4f5c\u70ba\u6700\u5f8c\u7684\u624b\u6bb5\uff0c\u5982\u679c\u4f60\u9700\u8981\u50cf\u662f class \u5167\u7684 <code class=\"language-javascript\">this</code>\uff0c\u4f60\u53ef\u4ee5<a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">\u4f7f\u7528 ref</a> \u4f86\u6301\u6709\u4e00\u500b mutable \u8b8a\u6578\u3002\u7136\u5f8c\u4f60\u53ef\u4ee5\u5beb\u5165\u548c\u8b80\u53d6\u5b83\u3002\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u4fdd\u6301\u6700\u65b0\u7684 props \u5728 ref\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> latestProps <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    latestProps<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// \u5728\u4efb\u4f55\u6642\u5019\u8b80\u53d6\u6700\u65b0\u7684 props</span></span><span class=\"gatsby-highlight-code-line\">      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>latestProps<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u9019\u500b effect \u6c38\u9060\u4e0d\u6703\u91cd\u65b0\u57f7\u884c</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5982\u679c\u4f60\u771f\u7684\u627e\u4e0d\u5230\u5176\u4ed6\u66f4\u597d\u7684\u65b9\u5f0f\u624d\u9019\u9ebc\u505a\uff0c\u56e0\u70ba\u4f9d\u8cf4 mutation \u6703\u8b93 component \u7684\u53ef\u9810\u6e2c\u6027\u964d\u4f4e\u3002\u5982\u679c\u6709\u4e00\u500b\u7279\u5b9a\u7684\u6a21\u5f0f\u4e0d\u80fd\u5f88\u597d\u5730\u8f49\u63db\uff0c\u8acb<a class=\"external-link\" href=\"https://github.com/facebook/react/issues/new\">\u63d0\u51fa issue</a> \u4e26\u9644\u4e0a\u53ef\u57f7\u884c\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\uff0c\u6211\u5011\u53ef\u4ee5\u5617\u8a66\u63d0\u4f9b\u5e6b\u52a9\u3002</p>\n<h3 id=\"how-do-i-implement-shouldcomponentupdate\"><a class=\"anchor\" href=\"/react/hooks-faq#how-do-i-implement-shouldcomponentupdate\"></a>\u6211\u8a72\u5982\u4f55\u5be6\u4f5c shouldComponentUpdate\uff1f </h3>\n<p>\u4f60\u53ef\u4ee5\u85c9\u7531 <code class=\"language-javascript\">React.memo</code> \u5c01\u88dd function \u4f86\u5c0d\u5b83\u7684 props \u9032\u884c\u6dfa\u6bd4\u8f03\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u4f60\u7684 component</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u5b83\u4e0d\u662f\u4e00\u500b Hook\uff0c\u56e0\u70ba\u5b83\u4e26\u4e0d\u50cf Hooks \u90a3\u6a23\u7684\u7d44\u6210\u3002<code class=\"language-javascript\">React.memo</code> \u76f8\u7b49\u65bc <code class=\"language-javascript\">PureComponent</code>\uff0c\u4f46\u662f\u5b83\u53ea\u6bd4\u8f03 props\u3002\uff08\u4f60\u4e5f\u53ef\u4ee5\u52a0\u5165\u7b2c\u4e8c\u53c3\u6578\uff0c\u6307\u5b9a\u4e00\u500b\u820a props \u548c\u65b0 props \u7684\u6bd4\u8f03 function \u3002\u5982\u679c\u5b83\u56de\u50b3 true\uff0c\u5247\u8df3\u904e\u66f4\u65b0\u3002\uff09</p>\n<p><code class=\"language-javascript\">React.memo</code> \u4e0d\u6bd4\u8f03 state\uff0c\u56e0\u70ba\u6c92\u6709\u55ae\u4e00\u7684 state object \u53ef\u4ee5\u6bd4\u8f03\u3002\u4f46\u4f60\u4e5f\u53ef\u4ee5\u8b93 children \u8b8a\u6210 pure\uff0c\u751a\u81f3\u53ef\u4ee5<a href=\"/react/hooks-faq#how-to-memoize-calculations\">\u900f\u904e <code class=\"language-javascript\">useMemo</code> \u4f86\u6700\u4f73\u5316\u500b\u5225\u7684 children</a>\u3002</p>\n<h3 id=\"how-to-memoize-calculations\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-memoize-calculations\"></a>\u5982\u4f55 memoize \u8a08\u7b97\uff1f </h3>\n<p><a href=\"/react/hooks-reference#usememo\"><code class=\"language-javascript\">useMemo</code></a> Hook \u8b93\u4f60\u53ef\u4ee5\u900f\u904e\u300c\u8a18\u4f4f\u300d\u5148\u524d\u7684\u8a08\u7b97\u4f86\u5feb\u53d6\u591a\u500b render \u4e4b\u9593\u7684\u8a08\u7b97\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> memoizedValue <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">computeExpensiveValue</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\u9019\u500b\u7a0b\u5f0f\u78bc\u547c\u53eb <code class=\"language-javascript\">computeExpensiveValue(a, b)</code>\u3002\u4f46\u662f\u5982\u679c <code class=\"language-javascript\">[a, b]</code> \u4f9d\u8cf4\u81ea\u4e0a\u4e00\u500b\u503c\u6c92\u6709\u6539\u8b8a\uff0c\u90a3\u9ebc <code class=\"language-javascript\">useMemo</code> \u6703\u8df3\u904e\u7b2c\u4e8c\u6b21\u7684\u547c\u53eb\u4e26\u53ea\u91cd\u8907\u4f7f\u7528\u5b83\u56de\u50b3\u7684\u6700\u5f8c\u4e00\u500b\u503c\u3002</p>\n<p>\u8a18\u4f4f\uff0c\u88ab\u50b3\u5230 <code class=\"language-javascript\">useMemo</code> \u7684 function \u6703\u5728 render \u671f\u9593\u57f7\u884c\u3002\u4e0d\u8981\u5728 render \u671f\u9593\u505a\u4e00\u4e9b\u901a\u5e38\u4e0d\u6703\u505a\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\uff0cside effects \u5c6c\u65bc\u5728 <code class=\"language-javascript\">useEffect</code> \u88ab\u8655\u7406\uff0c\u800c\u4e0d\u662f <code class=\"language-javascript\">useMemo</code>\u3002</p>\n<p><strong>\u4f60\u53ef\u4ee5\u4f9d\u8cf4 <code class=\"language-javascript\">useMemo</code> \u4f5c\u70ba\u6548\u80fd\u7684\u6700\u4f73\u5316\uff0c\u800c\u4e0d\u662f\u4f9d\u8cf4\u8a9e\u610f\u7684\u4fdd\u8b49\u3002</strong> \u672a\u4f86 React \u53ef\u80fd\u6703\u9078\u64c7\u300c\u5fd8\u8a18\u300d\u4e00\u4e9b\u5148\u524d memoize \u7684\u503c\uff0c\u4e26\u5728\u4e0b\u4e00\u6b21 render \u91cd\u65b0\u8a08\u7b97\uff0c\u4f8b\u5982\uff0c\u91cb\u653e\u87a2\u5e55\u4ee5\u5916\u7684 component \u8a18\u61b6\u9ad4\u3002\u64b0\u5beb\u4f60\u7684\u7a0b\u5f0f\u78bc\uff0c\u8b93\u5b83\u5728\u6c92\u6709 <code class=\"language-javascript\">useMemo</code> \u7684\u72c0\u6cc1\u4e0b\u4f9d\u7136\u53ef\u4ee5\u57f7\u884c - \u4e26\u4e14\u52a0\u4e0a\u5b83\u4f86\u6700\u4f73\u5316\u6548\u80fd\u3002\uff08\u5c0d\u65bc\u6975\u5c11\u6578\u7684\u60c5\u6cc1\uff0c\u503c<em>\u6c38\u9060</em>\u4e0d\u6703\u88ab\u91cd\u65b0\u8a08\u7b97\uff0c\u4f60\u53ef\u4ee5<a href=\"/react/hooks-faq#how-to-create-expensive-objects-lazily\">\u5ef6\u9072\u521d\u59cb\u5316</a> ref\u3002\uff09</p>\n<p>\u65b9\u4fbf\u7684\u662f\uff0c<code class=\"language-javascript\">useMemo</code> \u4e5f\u53ef\u4ee5\u8b93\u4f60\u8df3\u904e\u4e00\u500b child \u6602\u8cb4\u7684 re-render\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Parent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> a<span class=\"token punctuation\">,</span> b <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u53ea\u6703\u5728 `a` \u6539\u8b8a\u6642 re-render\uff1a</span>\n  <span class=\"token keyword\">const</span> child1 <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Child1</span></span> <span class=\"token attr-name\">a</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>a<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// \u53ea\u6703\u5728 `b` \u6539\u8b8a\u6642 re-render\uff1a</span>\n  <span class=\"token keyword\">const</span> child2 <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Child2</span></span> <span class=\"token attr-name\">b</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>b<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>child1<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>child2<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u6ce8\u610f\uff0c\u9019\u500b\u65b9\u6cd5\u5728\u4e00\u500b\u8ff4\u5708\u4e2d\u7121\u6cd5\u57f7\u884c\uff0c\u56e0\u70ba Hook <a href=\"/react/hooks-rules\">\u4e0d\u80fd</a>\u88ab\u653e\u5728\u8ff4\u5708\u5167\u3002\u4f46\u662f\u4f60\u53ef\u4ee5\u63d0\u53d6\u4e00\u500b\u6e05\u55ae\u5217\u8868\u7684\u7368\u7acb component\uff0c\u4e26\u5728\u9019\u88e1\u547c\u53eb <code class=\"language-javascript\">useMemo</code>\u3002</p>\n<h3 id=\"how-to-create-expensive-objects-lazily\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-create-expensive-objects-lazily\"></a>\u5982\u4f55\u5ef6\u9072\u5efa\u7acb\u6602\u8cb4\u7684 object\uff1f </h3>\n<p>\u5982\u679c\u4f9d\u8cf4\u76f8\u540c\u7684\u8a71\uff0c<code class=\"language-javascript\">useMemo</code> \u8b93\u4f60\u53ef\u4ee5 <a href=\"/react/hooks-faq#how-to-memoize-calculations\">memoize \u4e00\u500b\u6602\u8cb4\u7684\u8a08\u7b97</a>\u3002\u7136\u800c\uff0c\u5b83\u53ea\u662f\u500b\u63d0\u793a\uff0c\u4e26\u4e0d\u80fd<em>\u4fdd\u8b49</em>\u8a08\u7b97\u4e0d\u6703\u91cd\u65b0\u57f7\u884c\u3002\u4f46\u6709\u6642\u5019\u4f60\u9700\u8981\u78ba\u4fdd\u4e00\u500b object \u53ea\u88ab\u5efa\u7acb\u4e00\u6b21\u3002</p>\n<p><strong>\u7b2c\u4e00\u500b\u5e38\u898b\u7684\u60c5\u6cc1\u662f\u5efa\u7acb\u6602\u8cb4\u7684\u521d\u59cb state\uff1a</strong></p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Table</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u26a0\ufe0f createRows() \u5728\u6bcf\u6b21 render \u88ab\u547c\u53eb</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rows<span class=\"token punctuation\">,</span> setRows<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">createRows</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u70ba\u4e86\u907f\u514d\u91cd\u65b0\u5efa\u7acb\u521d\u59cb state\uff0c\u6211\u5011\u53ef\u4ee5\u50b3\u905e\u4e00\u500b <strong>function</strong> \u7d66 <code class=\"language-javascript\">useState</code>\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Table</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u2705 createRows() \u53ea\u6703\u88ab\u547c\u53eb\u4e00\u6b21</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rows<span class=\"token punctuation\">,</span> setRows<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">createRows</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React \u53ea\u6703\u5728\u7b2c\u4e00\u6b21 render \u6642\u547c\u53eb\u9019\u500b function\u3002\u53c3\u8003 <a href=\"/react/hooks-reference#usestate\"><code class=\"language-javascript\">useState</code> API</a>\u3002</p>\n<p><strong>\u4f60\u5076\u723e\u53ef\u80fd\u4e5f\u60f3\u8981\u907f\u514d\u91cd\u65b0\u5efa\u7acb <code class=\"language-javascript\">useRef()</code> \u521d\u59cb\u503c\u3002</strong>\u4f8b\u5982\uff0c\u6216\u8a31\u4f60\u60f3\u8981\u78ba\u4fdd\u67d0\u4e9b imperative class \u53ea\u88ab\u5efa\u7acb\u4e00\u6b21\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Image</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// \u26a0\ufe0f IntersectionObserver \u5728\u6bcf\u6b21 render \u6642\u88ab\u5efa\u7acb</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span>onIntersect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-javascript\">useRef</code> <strong>\u4e0d</strong>\u63a5\u53d7\u50cf <code class=\"language-javascript\">useState</code> \u9019\u6a23\u7279\u6b8a\u7684\u91cd\u8f09 function\u3002\u4f60\u53ef\u4ee5\u64b0\u5beb\u4f60\u81ea\u5df1\u7684 function \u4f86\u5efa\u7acb\u4e26\u5ef6\u9072\u8a2d\u5b9a\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Image</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// \u2705 IntersectionObserver \u6703\u5ef6\u9072\u88ab\u5efa\u7acb\u4e00\u6b21</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">.</span>current <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      ref<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span>onIntersect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// \u7576\u4f60\u9700\u8981\u5b83\u7684\u6642\u5019\uff0c\u547c\u53eb getObserver()</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u662f\u907f\u514d\u4e86\u5728\u7b2c\u4e00\u6b21\u771f\u6b63\u9700\u8981\u4e4b\u524d\u5efa\u7acb\u6602\u8cb4\u7684 object\u3002\u5982\u679c\u4f60\u4f7f\u7528 Flow \u6216\u8005\u662f TypeScript\uff0c\u70ba\u4e86\u65b9\u4fbf\u4f60\u4e5f\u53ef\u4ee5\u7d66\u5b9a <code class=\"language-javascript\">getObserver()</code> \u4e00\u500b non-nullable \u7684\u578b\u5225\u3002</p>\n<h3 id=\"are-hooks-slow-because-of-creating-functions-in-render\"><a class=\"anchor\" href=\"/react/hooks-faq#are-hooks-slow-because-of-creating-functions-in-render\"></a>\u5728 render \u6642\u5efa\u7acb function\uff0cHooks \u6703\u8b8a\u6162\u55ce\uff1f </h3>\n<p>\u4e0d\u6703\uff0c\u5728\u73fe\u4ee3\u700f\u89bd\u5668\u4e2d\uff0c\u9664\u4e86\u5728\u6975\u7aef\u60c5\u6cc1\u4e0b\uff0cclosure \u7684\u539f\u751f\u6548\u80fd\u8207 class \u76f8\u8f03\u4e4b\u4e0b\u6c92\u6709\u660e\u986f\u7684\u5dee\u7570\u3002</p>\n<p>\u6b64\u5916\uff0c\u8003\u616e\u5230 Hooks \u7684\u8a2d\u8a08\u5728\u4ee5\u4e0b\u5e7e\u500b\u65b9\u9762\u5f88\u6709\u6548\uff1a</p>\n<ul>\n<li>Hook \u53ef\u4ee5\u907f\u514d class \u7684\u5927\u91cf\u958b\u92b7\uff0c\u50cf\u662f\u5efa\u7acb class instance \u4e26\u5728 constructor \u7d81\u5b9a event handler\u3002</li>\n<li><strong>\u7fd2\u6163\u4f7f\u7528 Hooks \u7684\u7a0b\u5f0f\u78bc\u5f8c\uff0c\u5c31\u4e0d\u9700\u8981\u6df1\u5c64\u7684\u5de2\u72c0 component</strong>\uff0c\u9019\u5728 higher-order component\u3001render props \u548c context \u7b49\u5176\u4ed6\u6d41\u884c\u51fd\u5f0f\u5eab\u4e2d\u666e\u904d\u5b58\u5728\uff0c\u4f7f\u7528\u8f03\u5c0f\u7684 component tree\uff0cReact \u53ef\u4ee5\u6e1b\u5c11\u66f4\u591a\u7684\u5de5\u4f5c\u91cf\u3002</li>\n</ul>\n<p>\u50b3\u7d71\u4e0a\uff0c\u5728 React inline function \u7684\u6548\u80fd\u554f\u984c\u8207\u5982\u4f55\u5728 child component \u4e2d\uff0c\u5728\u6bcf\u500b render \u6253\u7834 <code class=\"language-javascript\">shouldComponentUpdate</code> \u6700\u4f73\u5316\u50b3\u905e\u65b0\u7684 callback \u6709\u95dc\u3002Hooks \u5f9e\u4e09\u500b\u65b9\u9762\u4f86\u8655\u7406\u9019\u500b\u554f\u984c\u3002</p>\n<ul>\n<li>\n<p>The <a href=\"/react/hooks-reference#usecallback\"><code class=\"language-javascript\">useCallback</code></a> Hook \u8b93\u4f60\u53ef\u4ee5\u5728\u91cd\u65b0 render \u4e4b\u9593\u4fdd\u6301\u76f8\u540c\u7684 callback\uff0c\u6240\u4ee5 <code class=\"language-javascript\">shouldComponentUpdate</code> \u4f9d\u7136\u53ef\u4ee5\u904b\u4f5c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// \u9664\u975e `a` \u6216 `b` \u6539\u8b8a\uff0c\u5426\u5247\u4e0d\u6539\u8b8a</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> memoizedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li><a href=\"/react/hooks-faq#how-to-memoize-calculations\"><code class=\"language-javascript\">useMemo</code></a> Hook \u8b93\u7368\u7acb\u7684 children \u66f4\u65b0\u6642\uff0c\u53ef\u4ee5\u66f4\u5bb9\u6613\u7684\u88ab\u63a7\u5236\uff0c\u6e1b\u5c11\u5c0d pure component \u7684\u9700\u6c42\u3002</li>\n<li>\u6700\u5f8c\uff0c<a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a> Hook \u6e1b\u5c11\u50b3\u905e\u6df1\u5c64\u7684 callback \u9700\u8981\uff0c\u6211\u5011\u5c07\u6703\u5728\u4e0b\u9762\u89e3\u91cb\u3002</li>\n</ul>\n<h3 id=\"how-to-avoid-passing-callbacks-down\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-avoid-passing-callbacks-down\"></a>\u5982\u4f55\u907f\u514d\u5411\u4e0b\u50b3\u905e callback\uff1f </h3>\n<p>\u6211\u5011\u767c\u73fe\u5927\u90e8\u5206\u7684\u4eba\u4e0d\u559c\u6b61\u900f\u904e component tree \u7684\u6bcf\u4e00\u5c64\u624b\u52d5\u50b3\u905e callback\u3002\u5373\u4f7f\u5b83\u662f\u66f4\u660e\u78ba\uff0c\u5b83\u53ef\u4ee5\u611f\u89ba\u50cf\u662f\u6709\u8a31\u591a\u300c\u7ba1\u9053\u300d\u3002</p>\n<p>\u5728\u5927\u578b\u7684 component tree \u4e2d\uff0c\u6211\u5011\u63a8\u85a6\u53e6\u4e00\u500b\u65b9\u6cd5\u662f\u900f\u904e context \u5f9e <a href=\"/react/hooks-reference#usereducer\"><code class=\"language-javascript\">useReducer</code></a> \u50b3\u905e\u4e00\u500b <code class=\"language-javascript\">dispatch</code> function\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> TodosDispatch <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">TodosApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u6ce8\u610f\uff1a`dispatch` \u5728 re-render \u4e4b\u9593\u4e0d\u6703\u6539\u8b8a</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>todosReducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodosDispatch.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>dispatch<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DeepTree</span></span> <span class=\"token attr-name\">todos</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todos<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">TodosDispatch.Provider</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u4efb\u4f55\u5728 <code class=\"language-javascript\">TodosApps</code> \u5167\u7684 child component \u53ef\u4ee5\u4f7f\u7528 <code class=\"language-javascript\">dispatch</code> function \u4f86\u50b3\u905e action \u5230 <code class=\"language-javascript\">TodosApp</code>\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">DeepChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// \u5982\u679c\u6211\u5011\u60f3\u8981\u57f7\u884c\u4e00\u500b action\uff0c\u6211\u5011\u53ef\u4ee5\u5f9e context \u53d6\u5f97 dispatch\u3002</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> dispatch <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>TodosDispatch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'add'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'hello'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Add todo</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5f9e\u7dad\u8b77\u7684\u89d2\u5ea6\u4f86\u770b\u66f4\u65b9\u4fbf\uff08\u4e0d\u9700\u8981\u6301\u6709\u8f49\u767c callback\uff09\uff0c\u4e26\u4e14\u5b8c\u5168\u907f\u514d\u4e86 callback \u554f\u984c\u3002\u50cf\u9019\u6a23\u50b3\u905e <code class=\"language-javascript\">dispatch</code> \u662f\u6df1\u5ea6\u66f4\u65b0\u7684\u63a8\u85a6\u6a21\u5f0f\u3002</p>\n<p>\u8acb\u6ce8\u610f\uff0c\u4f60\u4ecd\u7136\u53ef\u4ee5\u9078\u64c7\u662f\u5426\u5c07\u61c9\u7528\u7a0b\u5f0f\u7684 <em>state</em> \u5411\u4e0b\u50b3\u905e\u70ba props\uff08\u66f4\u660e\u78ba\uff09\u9084\u662f\u4f5c\u70ba context\uff08\u5c0d\u65bc\u975e\u5e38\u6df1\u7684\u66f4\u65b0\u66f4\u65b9\u4fbf\uff09\u3002\u5982\u679c\u4f60\u4e5f\u4f7f\u7528 context \u50b3\u905e state\uff0c\u4f7f\u7528\u5169\u500b\u4e0d\u540c\u7684 context type \u2014 <code class=\"language-javascript\">dispatch</code> context \u6c38\u9060\u4e0d\u6703\u6539\u8b8a\uff0c\u56e0\u6b64\u8b80\u53d6\u5b83\u7684 component \u4e0d\u9700\u8981\u91cd\u65b0 render\uff0c\u9664\u975e\u5b83\u5011\u4e5f\u9700\u8981\u61c9\u7528\u7a0b\u5f0f\u7684 state\u3002</p>\n<h3 id=\"how-to-read-an-often-changing-value-from-usecallback\"><a class=\"anchor\" href=\"/react/hooks-faq#how-to-read-an-often-changing-value-from-usecallback\"></a>\u5982\u4f55\u5f9e <code class=\"language-javascript\">useCallback</code> \u8b80\u53d6\u4e00\u500b\u7d93\u5e38\u8b8a\u5316\u7684\u503c\uff1f </h3>\n<div class=\"blockquote\">\n<strong>\u6ce8\u610f</strong>\n<p>\u6211\u5011\u5efa\u8b70<a href=\"/react/hooks-faq#how-to-avoid-passing-callbacks-down\">\u5728 context \u4e2d\u50b3\u905e <code class=\"language-javascript\">dispatch</code></a>\uff0c\u800c\u4e0d\u662f\u5728 props \u4e2d\u50b3\u905e\u55ae\u7368\u7684 callback\u3002\u4e0b\u9762\u7684\u65b9\u6cd5\u50c5\u5728\u6b64\u8655\u63d0\u53ca\u5b8c\u6574\u6027\u548c\u8df3\u812b\u65b9\u6cd5\u3002</p>\n</div>\n<p>\u5728\u6975\u5c11\u6578\u7684\u60c5\u6cc1\u4e0b\u4f60\u53ef\u80fd\u6703\u900f\u904e <a href=\"/react/hooks-reference#usecallback\"><code class=\"language-javascript\">useCallback</code></a> memoize \u4e00\u500b callback\uff0c\u4f46\u662f\u56e0\u70ba\u5167\u90e8 function \u5fc5\u9808\u5e38\u5e38\u88ab\u91cd\u65b0\u5efa\u7acb\uff0c\u6240\u4ee5 memoize \u6c92\u6709\u8fa6\u6cd5\u5f88\u597d\u500b\u904b\u4f5c\u3002\u5982\u679c\u4f60\u8981 memoize \u7684 function \u662f\u4e00\u500b event handler\uff0c\u800c\u4e14\u5b83\u4e0d\u6703\u88ab\u5728 render \u6642\u88ab\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/hooks-faq#is-there-something-like-instance-variables\">ref \u4f5c\u70ba\u4e00\u500b instance \u8b8a\u6578</a>\uff0c\u4e26\u624b\u52d5\u5132\u5b58\u6700\u5f8c\u88ab commit \u7684\u503c\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>text<span class=\"token punctuation\">,</span> updateText<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> textRef <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    textRef<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> text<span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u5c07\u5b83\u5beb\u5230 ref</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> handleSubmit <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> currentText <span class=\"token operator\">=</span> textRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u5f9e ref \u8b80\u53d6\u5b83</span></span>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>currentText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>textRef<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \u4e0d\u8981\u50cf [text] \u90a3\u6a23\u91cd\u65b0\u5efa\u7acb handleSubmit</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">updateText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ExpensiveTree</span></span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSubmit<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u9019\u662f\u4e00\u500b\u76f8\u7576\u8907\u96dc\u7684\u6a21\u5f0f\uff0c\u4f46\u5982\u679c\u4f60\u9700\u8981\uff0c\u53ef\u4ee5\u57f7\u884c\u9019\u500b\u8df3\u812b\u6700\u4f73\u5316\u3002\u5982\u679c\u4f60\u63d0\u53d6\u5b83\u5230\u81ea\u8a02\u7684 Hook\uff1a</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>text<span class=\"token punctuation\">,</span> updateText<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// \u5982\u679c `text` \u6539\u8b8a\uff0c\u5c07\u6703\u88ab memoize\uff1a</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> handleSubmit <span class=\"token operator\">=</span> <span class=\"token function\">useEventCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>text<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">updateText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ExpensiveTree</span></span> <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSubmit<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useEventCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn<span class=\"token punctuation\">,</span> dependencies</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Cannot call an event handler while rendering.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    ref<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> fn<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fn<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>dependencies<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> fn <span class=\"token operator\">=</span> ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>ref<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u5728\u4efb\u4f55\u4e00\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011<strong>\u90fd\u4e0d\u63a8\u85a6\u9019\u7a2e\u6a21\u5f0f</strong>\uff0c\u50c5\u5728\u6b64\u5448\u73fe\u5b8c\u6574\u6027\u3002\u76f8\u53cd\u7684\uff0c\u6700\u597d<a href=\"/react/hooks-faq#how-to-avoid-passing-callbacks-down\">\u907f\u514d\u5728\u6df1\u8655\u50b3\u905e callback</a>\u3002</p>\n<h2 id=\"under-the-hood\"><a class=\"anchor\" href=\"/react/hooks-faq#under-the-hood\"></a>\u6df1\u5165\u7406\u89e3 </h2>\n<h3 id=\"how-does-react-associate-hook-calls-with-components\"><a class=\"anchor\" href=\"/react/hooks-faq#how-does-react-associate-hook-calls-with-components\"></a>React \u5982\u4f55\u5c07 Hook \u547c\u53eb\u8207 component \u95dc\u806f\uff1f </h3>\n<p>React \u6703\u6301\u7e8c\u8ffd\u8e64\u76ee\u524d render \u7684 component\u3002\u611f\u8b1d <a href=\"/react/hooks-rules\">Hooks \u7684\u898f\u5247</a>\uff0c\u6211\u5011\u77e5\u9053 Hook \u53ea\u80fd\u5f9e React component\uff08\u6216\u81ea\u8a02\u7684 Hook \u2014 \u5b83\u5011\u4e5f\u53ea\u80fd\u5f9e React component \u4e2d\u88ab\u547c\u53eb\uff09\u88ab\u547c\u53eb\u3002</p>\n<p>\u6bcf\u4e00\u500b component \u6709\u4e00\u500b\u300cmemory cell\u300d\u7684\u5167\u90e8\u5217\u8868\u3002\u5b83\u5011\u53ea\u662f\u6211\u5011\u53ef\u4ee5\u653e\u5165\u4e00\u4e9b\u8cc7\u6599\u7684 JavaScript object\u3002\u7576\u4f60\u547c\u53eb\u50cf\u662f  <code class=\"language-javascript\">useState()</code> \u7684 Hook\uff0c\u5b83\u6703\u8b80\u53d6\u76ee\u524d\u7684 cell\uff08\u6216\u5728\u7b2c\u4e00\u6b21 render \u6642\u521d\u59cb\u5316\u5b83\uff09\uff0c\u4e26\u5c07\u6307\u6a19\u79fb\u52d5\u5230\u4e0b\u4e00\u500b\u3002\u9019\u5c31\u662f\u591a\u500b <code class=\"language-javascript\">useState()</code> \u7684\u547c\u53eb\uff0c\u53d6\u5f97\u6bcf\u500b\u7368\u7acb\u7684 local state\u3002</p>\n<h3 id=\"what-is-the-prior-art-for-hooks\"><a class=\"anchor\" href=\"/react/hooks-faq#what-is-the-prior-art-for-hooks\"></a>Hook \u73fe\u6709\u7684\u6280\u8853\u662f\u4ec0\u9ebc\uff1f </h3>\n<p>Hooks \u7d9c\u5408\u4e86\u5e7e\u500b\u4e0d\u540c\u4f86\u6e90\u7684\u60f3\u6cd5\uff1a</p>\n<ul>\n<li>\u5728 <a class=\"external-link\" href=\"https://github.com/reactjs/react-future/tree/master/07%20-%20Returning%20State\">react-future</a> repository \u4e2d\uff0c\u6211\u5011\u4f7f\u7528 functional APIs \u7684\u820a\u5be6\u9a57\u3002</li>\n<li>React \u793e\u7fa4\u4f7f\u7528 render props APIs \u7684\u5be6\u9a57\uff0c\u5305\u62ec <a class=\"external-link\" href=\"https://github.com/ryanflorence\">Ryan Florence</a> \u7684 <a class=\"external-link\" href=\"https://github.com/reactions/component\">Reactions Component</a>\u3002</li>\n<li><a class=\"external-link\" href=\"https://github.com/trueadm\">Dominic Gannaway</a> \u7684 <a class=\"external-link\" href=\"https://gist.github.com/trueadm/17beb64288e30192f3aa29cad0218067\"><code class=\"language-javascript\">adopt</code> keyword</a> \u63d0\u6848\u4f5c\u70ba render props \u7684\u8a9e\u6cd5\u7cd6\u3002</li>\n<li><a class=\"external-link\" href=\"http://displayscript.org/introduction.html\">DisplayScript</a> \u4e2d\u7684 state \u8b8a\u6578\u4ee5\u53ca state \u55ae\u5143\u3002</li>\n<li>ReasonReact \u4e2d\u7684 <a class=\"external-link\" href=\"https://reasonml.github.io/reason-react/docs/en/state-actions-reducer.html\">Reducer components</a>\u3002</li>\n<li>Rx \u4e2d\u7684 <a class=\"external-link\" href=\"http://reactivex.io/rxjs/class/es6/Subscription.js~Subscription.html\">Subscriptions</a>\u3002</li>\n<li>Multicore OCaml \u4e2d\u7684 <a class=\"external-link\" href=\"https://github.com/ocamllabs/ocaml-effects-tutorial#2-effectful-computations-in-a-pure-setting\">Algebraic effects</a>\u3002</li>\n</ul>\n<p><a class=\"external-link\" href=\"https://github.com/sebmarkbage\">Sebastian Markb\u00e5ge</a> \u60f3\u51fa\u4e86 Hook \u7684\u539f\u59cb\u8a2d\u8a08\uff0c\u4e4b\u5f8c\u7531 <a class=\"external-link\" href=\"https://github.com/acdlite\">Andrew Clark</a>\u3001<a class=\"external-link\" href=\"https://github.com/sophiebits\">Sophie Alpert</a>\u3001<a class=\"external-link\" href=\"https://github.com/trueadm\">Dominic Gannaway</a> \u4ee5\u53ca\u5176\u4ed6 React \u5718\u968a\u7684\u6210\u54e1\u52a0\u4ee5\u5b8c\u5584\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/hooks-faq.md\">Edit this page</a></p></div></article>", "path": "/react/hooks-faq", "nav": ["/react/hooks-reference", "/react/testing"]}]}, {"key": "\u6e2c\u8a66", "values": [{"key": "\u6e2c\u8a66\u6982\u89c0", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>\u4f60\u53ef\u4ee5\u50cf\u6e2c\u8a66\u5176\u4ed6 JavaScript \u7a0b\u5f0f\u78bc\u4e00\u6a23\u4f86\u6e2c\u8a66 React component\u3002</p>\n<p>\u6709\u5e7e\u7a2e\u65b9\u5f0f\u53ef\u4ee5\u4f86\u6e2c\u8a66 React component\u3002\u5927\u81f4\u4e0a\u4f86\u8aaa\uff0c\u5b83\u5011\u53ef\u4ee5\u5206\u70ba\u5169\u7a2e\u985e\u578b\uff1a</p>\n<ul>\n<li>\u5728\u7c21\u5316\u7684\u6e2c\u8a66\u74b0\u5883\u4e2d <strong>render component tree</strong> \u4e26\u4e14 assert \u5b83\u5011\u7684\u8f38\u51fa\u3002</li>\n<li>\u5728\u771f\u5be6\u700f\u89bd\u5668\u74b0\u5883\u4e2d<strong>\u57f7\u884c\u4e00\u500b\u5b8c\u6574\u7684\u61c9\u7528\u7a0b\u5f0f</strong>\uff08\u4e5f\u7a31\u70ba\u300cend-to-end\u300d\u6e2c\u8a66\uff09\u3002</li>\n</ul>\n<p>\u672c\u6587\u4ef6\u7ae0\u7bc0\u5c08\u6ce8\u65bc\u7b2c\u4e00\u7a2e\u60c5\u6cc1\u7684\u6e2c\u8a66\u7b56\u7565\u3002\u800c\u5b8c\u6574\u7684 end-to-end \u6e2c\u8a66\u5c0d\u65bc\u9810\u9632\u91cd\u8981\u7684 workflow \u4e0d\u53d7\u5f71\u97ff\u975e\u5e38\u6709\u7528\uff0c\u4f46\u6b64\u985e\u6e2c\u8a66\u4e0d\u6d89\u65bc React component\uff0c\u56e0\u6b64\u4e0d\u5728\u672c\u6587\u4ef6\u7bc4\u570d\u5167\u3002</p>\n<h3 id=\"tradeoffs\"><a class=\"anchor\" href=\"/react/testing#tradeoffs\"></a>\u6b0a\u8861 </h3>\n<p>\u7576\u9078\u64c7\u6e2c\u8a66\u5de5\u5177\u6642\uff0c\u503c\u5f97\u8003\u616e\u4e00\u4e9b\u6b0a\u8861\uff1a</p>\n<ul>\n<li><strong>\u8fed\u4ee3\u901f\u5ea6 vs \u5be6\u969b\u74b0\u5883\uff1a</strong> \u6709\u4e00\u4e9b\u5de5\u5177\u5728\u505a\u51fa\u66f4\u6539\u548c\u67e5\u770b\u7d50\u679c\u4e4b\u9593\u63d0\u4f9b\u4e86\u975e\u5e38\u5feb\u901f\u7684\u56de\u994b\uff0c\u4f46\u6c92\u6709\u7cbe\u78ba\u7684\u6a21\u64ec\u700f\u89bd\u5668\u7684\u884c\u70ba\u3002\u5176\u4ed6\u5de5\u5177\u53ef\u80fd\u4f7f\u7528\u771f\u5be6\u7684\u700f\u89bd\u5668\u74b0\u5883\uff0c\u4f46\u964d\u4f4e\u4e86\u8fed\u4ee3\u901f\u5ea6\u800c\u4e14\u5728\u6301\u7e8c\u96c6\u6210\u4f3a\u670d\u5668\u4e0a\u8f03\u8106\u5f31\u3002</li>\n<li><strong>\u9700\u8981\u591a\u5c11 Mock\uff1a</strong>\u5c0d\u65bc component \u7684\u300c\u55ae\u5143\u300d\u6e2c\u8a66\u548c\u300c\u6574\u5408\u300d\u6e2c\u8a66\u4e4b\u9593\u7684\u5340\u5225\u53ef\u80fd\u5f88\u6a21\u7cca\u3002\u5982\u679c\u4f60\u8981\u6e2c\u8a66\u4e00\u500b\u8868\u55ae\uff0c\u61c9\u8a72\u8981\u6e2c\u8a66\u8868\u55ae\u5167\u7684\u6309\u9215\u55ce\uff1f\u6216\u662f button component \u61c9\u8a72\u6709\u5b83\u81ea\u5df1\u7684\u6e2c\u8a66\uff1f\u91cd\u69cb\u6309\u9215\u6703\u7834\u58de\u8868\u55ae\u7684\u6e2c\u8a66\u55ce\uff1f</li>\n</ul>\n<p>\u5c0d\u65bc\u4e0d\u540c\u7684\u5718\u968a\u548c\u7522\u54c1\u6703\u6709\u4e0d\u540c\u7684\u7b54\u6848\u3002</p>\n<h3 id=\"tools\"><a class=\"anchor\" href=\"/react/testing#tools\"></a>\u63a8\u85a6\u5de5\u5177 </h3>\n<p><strong><a class=\"external-link\" href=\"https://facebook.github.io/jest/\">Jest</a></strong> \u662f\u4e00\u500b JavaScript test runner \u8b93\u4f60\u53ef\u4ee5\u900f\u904e <a href=\"/react/testing-environments#mocking-a-rendering-surface\"><code class=\"language-javascript\">jsdom</code></a> \u5b58\u53d6 DOM\u3002jsdom \u53ea\u662f\u4e00\u500b\u5f88\u63a5\u8fd1\u700f\u89bd\u5668\u5de5\u4f5c\u7684\u65b9\u5f0f\uff0c\u4e0d\u904e\u5b83\u5df2\u7d93\u8db3\u4ee5\u6e2c\u8a66 React component\u3002Jest \u6709\u51fa\u8272\u7684\u8fed\u4ee3\u901f\u5ea6\u8207\u50cf\u662f mock <a href=\"/react/testing-environments#mocking-modules\">module</a> \u548c <a href=\"/react/testing-environments#mocking-timers\">timer</a> \u7684\u5f37\u5927\u529f\u80fd\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u6709\u66f4\u591a\u7684\u65b9\u5f0f\u4f86\u63a7\u5236\u4f60\u7684\u7a0b\u5f0f\u78bc\u57f7\u884c\u3002</p>\n<p><strong><a class=\"external-link\" href=\"https://testing-library.com/react\">React Testing Library</a></strong> \u662f\u4e00\u7cfb\u5217\u7684 helper \u8b93\u4f60\u53ef\u4ee5\u6e2c\u8a66 React component \u800c\u4e0d\u9700\u8981\u4f9d\u8cf4\u5b83\u5011\u7684\u5be6\u4f5c\u7d30\u7bc0\u3002\u9019\u500b\u65b9\u6cd5\u8b93\u91cd\u69cb\u8b8a\u7684\u8f15\u800c\u6613\u8209\uff0c\u4e5f\u8b93\u4f60\u671d\u8457\u53ef\u8a2a\u554f\u6027\u7684\u6700\u4f73\u5be6\u8e10\u7684\u65b9\u5411\u800c\u524d\u9032\u3002\u96d6\u7136\u5b83\u6c92\u6709\u63d0\u4f9b\u4e00\u7a2e\u300cshallow\u300drender \u5b83\u7684 child component \u7684\u65b9\u5f0f\uff0c\u900f\u904e\u50cf\u662f Jest test runner \u7684 <a href=\"/react/testing-recipes#mocking-modules\">mock</a> \u53ef\u4ee5\u8b93\u4f60\u9054\u5230\u9019\u500b\u76ee\u7684\u3002</p>\n<h3 id=\"learn-more\"><a class=\"anchor\" href=\"/react/testing#learn-more\"></a>\u5b78\u7fd2\u66f4\u591a </h3>\n<p>\u672c\u7ae0\u7bc0\u5206\u6210\u4ee5\u4e0b\u5169\u9801\uff1a</p>\n<ul>\n<li><a href=\"/react/testing-recipes\">\u65b9\u6cd5</a>\uff1a\u70ba React component \u64b0\u5beb\u6e2c\u8a66\u6642\u7684\u5e38\u7528\u6a21\u5f0f\u3002</li>\n<li><a href=\"/react/testing-environments\">\u74b0\u5883</a>\uff1a\u70ba React component \u8a2d\u5b9a\u6e2c\u8a66\u74b0\u5883\u6642\u61c9\u8a72\u8003\u616e\u7684\u4e8b\u9805\u3002</li>\n</ul></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/testing.md\">Edit this page</a></p></div></article>", "path": "/react/testing", "nav": ["/react/hooks-faq", "/react/testing-recipes"]}, {"key": "\u6e2c\u8a66\u65b9\u6cd5", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>Common testing patterns for React components.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This page assumes you\u2019re using <a class=\"external-link\" href=\"https://jestjs.io/\">Jest</a> as a test runner. If you use a different test runner, you may need to adjust the API, but the overall shape of the solution will likely be the same. Read more details on setting up a testing environment on the <a href=\"/react/testing-environments\">Testing Environments</a> page.</p>\n</div>\n<p>On this page, we will primarily use function components. However, these testing strategies don\u2019t depend on implementation details, and work just as well for class components too.</p>\n<ul>\n<li><a href=\"/react/testing-recipes#setup--teardown\">Setup/Teardown</a></li>\n<li><a href=\"/react/testing-recipes#act\"><code class=\"language-javascript\">act()</code></a></li>\n<li><a href=\"/react/testing-recipes#rendering\">Rendering</a></li>\n<li><a href=\"/react/testing-recipes#data-fetching\">Data Fetching</a></li>\n<li><a href=\"/react/testing-recipes#mocking-modules\">Mocking Modules</a></li>\n<li><a href=\"/react/testing-recipes#events\">Events</a></li>\n<li><a href=\"/react/testing-recipes#timers\">Timers</a></li>\n<li><a href=\"/react/testing-recipes#snapshot-testing\">Snapshot Testing</a></li>\n<li><a href=\"/react/testing-recipes#multiple-renderers\">Multiple Renderers</a></li>\n<li><a href=\"/react/testing-recipes#something-missing\">Something Missing?</a></li>\n</ul>\n\n<h3 id=\"setup--teardown\"><a class=\"anchor\" href=\"/react/testing-recipes#setup--teardown\"></a>Setup/Teardown </h3>\n<p>For each test, we usually want to render our React tree to a DOM element that\u2019s attached to <code class=\"language-javascript\">document</code>. This is important so that it can receive DOM events. When the test ends, we want to \u201cclean up\u201d and unmount the tree from the <code class=\"language-javascript\">document</code>.</p>\n<p>A common way to do it is to use a pair of <code class=\"language-javascript\">beforeEach</code> and <code class=\"language-javascript\">afterEach</code> blocks so that they\u2019ll always run and isolate the effects of a test to itself:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You may use a different pattern, but keep in mind that we want to execute the cleanup <em>even if a test fails</em>. Otherwise, tests can become \u201cleaky\u201d, and one test can change the behavior of another test. That makes them difficult to debug.</p>\n\n<h3 id=\"act\"><a class=\"anchor\" href=\"/react/testing-recipes#act\"></a><code class=\"language-javascript\">act()</code> </h3>\n<p>When writing UI tests, tasks like rendering, user events, or data fetching can be considered as \u201cunits\u201d of interaction with a user interface. <code class=\"language-javascript\">react-dom/test-utils</code> provides a helper called <a href=\"/react/test-utils#act\"><code class=\"language-javascript\">act()</code></a> that makes sure all updates related to these \u201cunits\u201d have been processed and applied to the DOM before you make any assertions:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// render components</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// make assertions</span></code></pre></div>\n<p>This helps make your tests run closer to what real users would experience when using your application. The rest of these examples use <code class=\"language-javascript\">act()</code> to make these guarantees.</p>\n<p>You might find using <code class=\"language-javascript\">act()</code> directly a bit too verbose. To avoid some of the boilerplate, you could use a library like <a class=\"external-link\" href=\"https://testing-library.com/react\">React Testing Library</a>, whose helpers are wrapped with <code class=\"language-javascript\">act()</code>.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>The name <code class=\"language-javascript\">act</code> comes from the <a class=\"external-link\" href=\"http://wiki.c2.com/?ArrangeActAssert\">Arrange-Act-Assert</a> pattern.</p>\n</div>\n\n<h3 id=\"rendering\"><a class=\"anchor\" href=\"/react/testing-recipes#rendering\"></a>Rendering </h3>\n<p>Commonly, you might want to test whether a component renders correctly for given props. Consider a simple component that renders a message based on a prop:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// hello.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Hello</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\">!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Hey, stranger</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We can write a test for this component:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// hello.test.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Hello <span class=\"token keyword\">from</span> <span class=\"token string\">\"./hello\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"renders with or without a name\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hey, stranger\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Jenny<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello, Jenny!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Margaret<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello, Margaret!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<h3 id=\"data-fetching\"><a class=\"anchor\" href=\"/react/testing-recipes#data-fetching\"></a>Data Fetching </h3>\n<p>Instead of calling real APIs in all your tests, you can mock requests with dummy data. Mocking data fetching with \u201cfake\u201d data prevents flaky tests due to an unavailable backend, and makes them run faster. Note: you may still want to run a subset of tests using an <a href=\"/react/testing-environments#end-to-end-tests-aka-e2e-tests\">\u201cend-to-end\u201d</a> framework that tells whether the whole app is working together.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// user.js</span>\n\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">User</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">,</span> setUser<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchUserData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setUser</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchUserData</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"loading...\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>details</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>summary</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>summary</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"> years old\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      lives in </span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>details</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We can write tests for it:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// user.test.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> User <span class=\"token keyword\">from</span> <span class=\"token string\">\"./user\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"renders user data\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> fakeUser <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Joni Baez\"</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token string\">\"32\"</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token literal-property property\">address</span><span class=\"token operator\">:</span> <span class=\"token string\">\"123, Charming Avenue\"</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  jest<span class=\"token punctuation\">.</span><span class=\"token function\">spyOn</span><span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">,</span> <span class=\"token string\">\"fetch\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mockImplementation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span></span><span class=\"gatsby-highlight-code-line\">    Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function-variable function\">json</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>fakeUser<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token comment\">// Use the asynchronous version of act to apply resolved promises</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>123<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"summary\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span>fakeUser<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"strong\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span>fakeUser<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toContain</span><span class=\"token punctuation\">(</span>fakeUser<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// remove the mock to ensure tests are completely isolated</span></span><span class=\"gatsby-highlight-code-line\">  global<span class=\"token punctuation\">.</span>fetch<span class=\"token punctuation\">.</span><span class=\"token function\">mockRestore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<h3 id=\"mocking-modules\"><a class=\"anchor\" href=\"/react/testing-recipes#mocking-modules\"></a>Mocking Modules </h3>\n<p>Some modules might not work well inside a testing environment, or may not be as essential to the test itself. Mocking out these modules with dummy replacements can make it easier to write tests for your own code.</p>\n<p>Consider a <code class=\"language-javascript\">Contact</code> component that embeds a third-party <code class=\"language-javascript\">GoogleMap</code> component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// map.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> LoadScript<span class=\"token punctuation\">,</span> GoogleMap <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-google-maps\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoadScript</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script-loader<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">googleMapsApiKey</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>YOUR_API_KEY<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">GoogleMap</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>example-map<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">center</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">LoadScript</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// contact.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Map <span class=\"token keyword\">from</span> <span class=\"token string\">\"./map\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Contact</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Contact </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> via</span><span class=\"token punctuation\">{</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">data-testid</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"mailto:\"</span> <span class=\"token operator\">+</span> props<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          email\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        or on their </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">data-testid</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>site<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>site<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          website\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">.\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>address</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span></span> <span class=\"token attr-name\">center</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If we don\u2019t want to load this component in our tests, we can mock out the dependency itself to a dummy component, and run our tests:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// contact.test.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Contact <span class=\"token keyword\">from</span> <span class=\"token string\">\"./contact\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> MockedMap <span class=\"token keyword\">from</span> <span class=\"token string\">\"./map\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">jest<span class=\"token punctuation\">.</span><span class=\"token function\">mock</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./map\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">DummyMap</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">data-testid</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>map<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">.</span>lat<span class=\"token punctuation\">}</span><span class=\"token plain-text\">:</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">.</span>long<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should render contact information\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> center <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">lat</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">long</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Contact</span></span>\n        <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Joni Baez<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">email</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test@example.com<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">site</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://test.com<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">center</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>center<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n      container\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[data-testid='email']\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"href\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mailto:test@example.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[data-testid=\"site\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"href\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://test.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[data-testid=\"map\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"0:0\"</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<h3 id=\"events\"><a class=\"anchor\" href=\"/react/testing-recipes#events\"></a>Events </h3>\n<p>We recommend dispatching real DOM events on DOM elements, and then asserting on the result. Consider a <code class=\"language-javascript\">Toggle</code> component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// toggle.js</span>\n\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Toggle</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n      <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">previousState</span> <span class=\"token operator\">=&gt;</span> <span class=\"token operator\">!</span>previousState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        props<span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">data-testid</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>state <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"Turn off\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Turn on\"</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We could write tests for it:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// toggle.test.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Toggle <span class=\"token keyword\">from</span> <span class=\"token string\">\"./toggle\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"changes value when clicked\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> onChange <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toggle</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// get a hold of the button element, and trigger some clicks on it</span>\n  <span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[data-testid=toggle]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Turn on\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    button<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MouseEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">bubbles</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalledTimes</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Turn off\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      button<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MouseEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">bubbles</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalledTimes</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Turn on\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Different DOM events and their properties are described in <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\">MDN</a>. Note that you need to pass <code class=\"language-javascript\">{ bubbles: true }</code> in each event you create for it to reach the React listener because React automatically delegates events to the root.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>React Testing Library offers a <a class=\"external-link\" href=\"https://testing-library.com/docs/dom-testing-library/api-events\">more concise helper</a> for firing events.</p>\n</div>\n\n<h3 id=\"timers\"><a class=\"anchor\" href=\"/react/testing-recipes#timers\"></a>Timers </h3>\n<p>Your code might use timer-based functions like <code class=\"language-javascript\">setTimeout</code> to schedule more work in the future. In this example, a multiple choice panel waits for a selection and advances, timing out if a selection isn\u2019t made in 5 seconds:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// card.js</span>\n\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Card</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> timeoutID <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      props<span class=\"token punctuation\">.</span><span class=\"token function\">onSelect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeoutID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>onSelect<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">choice</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n      <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>choice<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">data-testid</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>choice<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> props<span class=\"token punctuation\">.</span><span class=\"token function\">onSelect</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n    <span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>choice<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We can write tests for this component by leveraging <a class=\"external-link\" href=\"https://jestjs.io/docs/en/timer-mocks\">Jest\u2019s timer mocks</a>, and testing the different states it can be in.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// card.test.js</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> Card <span class=\"token keyword\">from</span> <span class=\"token string\">\"./card\"</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  jest<span class=\"token punctuation\">.</span><span class=\"token function\">useFakeTimers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  jest<span class=\"token punctuation\">.</span><span class=\"token function\">useRealTimers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should select null after timing out\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> onSelect <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Card</span></span> <span class=\"token attr-name\">onSelect</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onSelect<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// move ahead in time by 100ms</span></span>  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    jest<span class=\"token punctuation\">.</span><span class=\"token function\">advanceTimersByTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onSelect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>not<span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// and then move ahead by 5 seconds</span></span>  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    jest<span class=\"token punctuation\">.</span><span class=\"token function\">advanceTimersByTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onSelect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should cleanup on being removed\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> onSelect <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Card</span></span> <span class=\"token attr-name\">onSelect</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onSelect<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"></span>  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    jest<span class=\"token punctuation\">.</span><span class=\"token function\">advanceTimersByTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onSelect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>not<span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// unmount the app</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"></span>  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    jest<span class=\"token punctuation\">.</span><span class=\"token function\">advanceTimersByTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onSelect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>not<span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should accept selections\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> onSelect <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Card</span></span> <span class=\"token attr-name\">onSelect</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onSelect<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    container\n      <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[data-testid='2']\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MouseEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">bubbles</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>onSelect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can use fake timers only in some tests. Above, we enabled them by calling <code class=\"language-javascript\">jest.useFakeTimers()</code>. The main advantage they provide is that your test doesn\u2019t actually have to wait five seconds to execute, and you also didn\u2019t need to make the component code more convoluted just for testing.</p>\n\n<h3 id=\"snapshot-testing\"><a class=\"anchor\" href=\"/react/testing-recipes#snapshot-testing\"></a>Snapshot Testing </h3>\n<p>Frameworks like Jest also let you save \u201csnapshots\u201d of data with <a class=\"external-link\" href=\"https://jestjs.io/docs/en/snapshot-testing\"><code class=\"language-javascript\">toMatchSnapshot</code> / <code class=\"language-javascript\">toMatchInlineSnapshot</code></a>. With these, we can \u201csave\u201d the rendered component output and ensure that a change to it has to be explicitly committed as a change to the snapshot.</p>\n<p>In this example, we render a component and format the rendered HTML with the <a class=\"external-link\" href=\"https://www.npmjs.com/package/pretty\"><code class=\"language-javascript\">pretty</code></a> package, before saving it as an inline snapshot:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token comment\">// hello.test.js, again</span>\n\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> unmountComponentAtNode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> pretty <span class=\"token keyword\">from</span> <span class=\"token string\">\"pretty\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Hello <span class=\"token keyword\">from</span> <span class=\"token string\">\"./hello\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// setup a DOM element as a render target</span>\n  container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// cleanup on exiting</span>\n  <span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  container <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should render a greeting\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">pretty</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchInlineSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* ... gets filled automatically by jest ... */</span></span>\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Jenny<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">pretty</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchInlineSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* ... gets filled automatically by jest ... */</span>\n\n  <span class=\"token function\">act</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hello</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Margaret<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">pretty</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchInlineSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* ... gets filled automatically by jest ... */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>It\u2019s typically better to make more specific assertions than to use snapshots. These kinds of tests include implementation details so they break easily, and teams can get desensitized to snapshot breakages. Selectively <a href=\"/react/testing-recipes#mocking-modules\">mocking some child components</a> can help reduce the size of snapshots and keep them readable for the code review.</p>\n\n<h3 id=\"multiple-renderers\"><a class=\"anchor\" href=\"/react/testing-recipes#multiple-renderers\"></a>Multiple Renderers </h3>\n<p>In rare cases, you may be running a test on a component that uses multiple renderers. For example, you may be running snapshot tests on a component with <code class=\"language-javascript\">react-test-renderer</code>, that internally uses <code class=\"language-javascript\">render</code> from <code class=\"language-javascript\">react-dom</code> inside a child component to render some content. In this scenario, you can wrap updates with <code class=\"language-javascript\">act()</code>s corresponding to their renderers.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token keyword\">as</span> domAct <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/test-utils\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> act <span class=\"token keyword\">as</span> testAct<span class=\"token punctuation\">,</span> create <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-test-renderer\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">let</span> root<span class=\"token punctuation\">;</span>\n<span class=\"token function\">domAct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">testAct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    root <span class=\"token operator\">=</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<h3 id=\"something-missing\"><a class=\"anchor\" href=\"/react/testing-recipes#something-missing\"></a>Something Missing? </h3>\n<p>If some common scenario is not covered, please let us know on the <a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/issues\">issue tracker</a> for the documentation website.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/testing-recipes.md\">Edit this page</a></p></div></article>", "path": "/react/testing-recipes", "nav": ["/react/testing", "/react/testing-environments"]}, {"key": "\u6e2c\u8a66\u74b0\u5883", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><!-- This document is intended for folks who are comfortable with JavaScript, and have probably written tests with it. It acts as a reference for the differences in testing environments for React components, and how those differences affect the tests that they write. This document also assumes a slant towards web-based react-dom components, but has notes for other renderers. -->\n<p>\u672c\u4efd\u6587\u4ef6\u4ecb\u7d39\u4e86\u53ef\u80fd\u5f71\u97ff\u74b0\u5883\u7684\u56e0\u7d20\u4ee5\u53ca\u67d0\u4e9b\u5834\u666f\u4e0b\u7684\u5efa\u8b70\u3002</p>\n<h3 id=\"test-runners\"><a class=\"anchor\" href=\"/react/testing-environments#test-runners\"></a>Test runner </h3>\n<p>\u50cf\u662f <a class=\"external-link\" href=\"https://jestjs.io/\">Jest</a>\u3001<a class=\"external-link\" href=\"https://mochajs.org/\">mocha</a>\u3001<a class=\"external-link\" href=\"https://github.com/avajs/ava\">ava</a> \u7684 Test runner \u8b93\u4f60\u4ee5\u5e38\u898f\u7684 JavaScript \u4f86\u64b0\u5beb\u6e2c\u8a66\uff0c\u4e26\u5728\u958b\u767c\u904e\u7a0b\u4e2d\u57f7\u884c\u5b83\u5011\u3002\u6b64\u5916\uff0ctest suite \u4e5f\u6703\u4f5c\u70ba\u6301\u7e8c\u6574\u5408\u4e2d\u57f7\u884c\u7684\u4e00\u90e8\u4efd\u3002</p>\n<ul>\n<li>Jest \b\u5ee3\u6cdb\u7684\u517c\u5bb9 React \u5c08\u6848\uff0c\u652f\u63f4\u50cf\u662f <a href=\"/react/testing-environments#mocking-modules\">module</a> \u548c <a href=\"/react/testing-environments#mocking-timers\">timer</a>\uff0c\u4ee5\u53ca <a href=\"/react/testing-environments#mocking-a-rendering-surface\"><code class=\"language-javascript\">jsdom</code></a> \u7684 mock \u529f\u80fd\u3002<strong>\u5982\u679c\u4f60\u4f7f\u7528 Create React App\uff0c<a class=\"external-link\" href=\"https://facebook.github.io/create-react-app/docs/running-tests\">\u5167\u5efa\u5df2\u7d93\u5305\u542b\u4e86 Jest </a> \u8207\u6709\u7528\u7684\u9810\u8a2d\u8a2d\u5b9a\u3002</strong></li>\n<li>\u50cf\u662f <a class=\"external-link\" href=\"https://mochajs.org/#running-mocha-in-the-browser\">mocha</a> \u4e4b\u985e\u7684\u51fd\u5f0f\u5eab\uff0c\u5728\u5be6\u969b\u7684\u700f\u89bd\u5668\u74b0\u5883\u4e2d\u53ef\u4ee5\u5f88\u597d\u5730\u5de5\u4f5c\uff0c\u4e26\u4e14\u53ef\u4ee5\u5e6b\u52a9\u660e\u78ba\u9700\u8981\u5b83\u7684\u6e2c\u8a66\u5728\u5be6\u969b\u7684\u700f\u89bd\u5668\u74b0\u5883\u4e2d\u53ef\u4ee5\u5f88\u597d\u7684\u904b\u4f5c\uff0c\u4e26\u4e14\u53ef\u4ee5\u5e6b\u52a9\u660e\u78ba\u9700\u8981\u5b83\u7684\u6e2c\u8a66\u3002</li>\n<li>End-to-end \u6e2c\u8a66\u88ab\u7528\u5728\u8f03\u9577\u9700\u8981\u6a6b\u8de8\u591a\u500b\u9801\u9762\u7684\u6d41\u7a0b\uff0c\u4e26\u4e14\u9700\u8981\u4e00\u500b<a href=\"/react/testing-environments#end-to-end-tests-aka-e2e-tests\">\u4e0d\u540c\u7684\u8a2d\u5b9a</a>\u3002</li>\n</ul>\n<h3 id=\"mocking-a-rendering-surface\"><a class=\"anchor\" href=\"/react/testing-environments#mocking-a-rendering-surface\"></a>Mock \u4e00\u500b render \u7684 surface </h3>\n<p>\u6e2c\u8a66\u901a\u5e38\u4e0d\u6703\u5728\u5b58\u53d6\u50cf\u662f\u700f\u89bd\u5668\u771f\u5be6\u7684 surface \u7684\u74b0\u5883\u4e2d\u57f7\u884c\u3002\u5c0d\u65bc\u9019\u4e9b\u74b0\u5883\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <a class=\"external-link\" href=\"https://github.com/jsdom/jsdom\"><code class=\"language-javascript\">jsdom</code></a> \u6a21\u64ec\u4e00\u500b\u700f\u89bd\u5668\uff0c\u5b83\u662f\u4e00\u500b\u53ef\u4ee5\u5728 Node.js \u4e2d\u57f7\u884c\u7684\u8f15\u91cf\u700f\u89bd\u5668\u5be6\u4f5c\u3002</p>\n<p>\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0cjsdom \u7684\u884c\u70ba\u50cf\u662f\u4e00\u500b\u6b63\u5e38\u7684\u700f\u89bd\u5668\uff0c\u4f46\u662f\u6c92\u6709\u50cf\u662f <a class=\"external-link\" href=\"https://github.com/jsdom/jsdom#unimplemented-parts-of-the-web-platform\">layout \u548c navigation</a> \u7684\u529f\u80fd\u3002\u9019\u5c0d\u65bc\u5927\u90e8\u5206\u57fa\u65bc web component \u7684\u6e2c\u8a66\u4ecd\u7136\u6709\u7528\uff0c\u56e0\u70ba\u5b83\u57f7\u884c\u7684\u901f\u5ea6\u6bd4\u6bcf\u6b21\u6e2c\u8a66\u90fd\u555f\u52d5\u700f\u89bd\u5668\u9084\u8981\u4f86\u5f97\u5feb\u3002\u5b83\u4e5f\u5728\u76f8\u540c\u7684 process \u57f7\u884c\u4f60\u7684\u6e2c\u8a66\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u64b0\u5beb\u7a0b\u5f0f\u4f86\u6aa2\u67e5\u548c assert \u88ab render \u7684 DOM\u3002</p>\n<p>\u5c31\u50cf\u5728\u4e00\u500b\u771f\u5be6\u7684\u700f\u89bd\u5668\u4e00\u6a23\uff0cjsdom \u8b93\u6211\u5011\u6a21\u64ec\u4f7f\u7528\u8005\u7684\u4e92\u52d5\uff1b\u6e2c\u8a66\u53ef\u4ee5\u5728 DOM node \u4e0a dispatch event\uff0c\u4e26\u4e14\u89c0\u5bdf\u548c assert \u9019\u4e9b\u64cd\u4f5c<a href=\"/react/testing-recipes#events\"><small>\uff08\u7bc4\u4f8b\uff09</small></a>\u7684 side effect\u3002</p>\n<p>\u4e0a\u8ff0\u7684\u8a2d\u5b9a\u53ef\u4ee5\u64b0\u5beb\u5927\u90e8\u5206\u7684 UI \u6e2c\u8a66\uff1a\u4f7f\u7528 Jest \u4f5c\u70ba test runner\uff0crender \u5230 jsdom\uff0c\u900f\u904e <code class=\"language-javascript\">act()</code> helper <a href=\"/react/testing-recipes\"><small>\uff08\u7bc4\u4f8b\uff09</small></a> \u5c07\u4f7f\u7528\u8005\u4e92\u52d5\u6307\u5b9a\u70ba\u700f\u89bd\u5668 event \u7684\u5e8f\u5217\u3002\u4f8b\u5982\uff0cReact \u672c\u8eab\u8a31\u591a\u7684\u6e2c\u8a66\u90fd\u662f\u7531\u6b64\u7d44\u5408\u6240\u64b0\u5beb\u7684\u3002</p>\n<p>\u5982\u679c\u4f60\u6b63\u5728\u64b0\u5beb\u4e00\u500b\u51fd\u5f0f\u5eab\uff0c\u5b83\u4e3b\u8981\u6e2c\u8a66\u65bc\u7279\u5b9a\u7684\u700f\u89bd\u5668\u884c\u70ba\uff0c\u4e26\u8981\u6c42\u539f\u751f\u7684\u700f\u89bd\u5668\u884c\u70ba\u50cf\u662f layout \u6216\u662f\u771f\u5be6\u7684\u8f38\u5165\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u50cf\u662f <a class=\"external-link\" href=\"https://mochajs.org/\">mocha</a> \u7684\u6e2c\u8a66\u6846\u67b6\u3002</p>\n<p>\u5728<em>\u7121\u6cd5</em>\u6a21\u64ec DOM \u7684\u74b0\u5883\u4e2d\uff08\u4f8b\u5982\uff1a\u5728 Node.js \u4e0a\u6e2c\u8a66 React Native \u7684 component\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a href=\"/react/test-utils#simulate\">event simulation helper</a> \u4f86\u6a21\u64ec\u4e92\u52d5\u7684 element\u3002\u6216\u8005\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <a class=\"external-link\" href=\"https://testing-library.com/docs/react-native-testing-library/intro\"><code class=\"language-javascript\">@testing-library/react-native</code></a> \u7684 <code class=\"language-javascript\">fireEvent</code> helper\u3002</p>\n<p>\u50cf\u662f <a class=\"external-link\" href=\"https://www.cypress.io/\">Cypress</a>\u3001<a class=\"external-link\" href=\"https://github.com/GoogleChrome/puppeteer\">puppeteer</a> \u548c <a class=\"external-link\" href=\"https://www.seleniumhq.org/projects/webdriver/\">webdriver</a> \u7684\u6846\u67b6\u5c0d\u65bc\u57f7\u884c <a href=\"/react/testing-environments#end-to-end-tests-aka-e2e-tests\">end-to-end tests</a> \u975e\u5e38\u6709\u7528\u3002</p>\n<h3 id=\"mocking-functions\"><a class=\"anchor\" href=\"/react/testing-environments#mocking-functions\"></a>Mock \u51fd\u5f0f </h3>\n<p>\u7576\u64b0\u5beb\u6e2c\u8a66\u6642\uff0c\u6211\u5011\u6703\u60f3\u8981 mock \u5728\u6211\u5011\u6e2c\u8a66\u74b0\u5883\u4e2d\u6c92\u6709\u7b49\u6548\u7684\u7a0b\u5f0f\u78bc\u90e8\u5206\uff08\u4f8b\u5982\uff1a\u5728 Node.js \u5167\u5224\u65b7 <code class=\"language-javascript\">navigator.onLine</code> \u72c0\u614b\uff09\u3002\u6e2c\u8a66\u4e5f\u53ef\u4ee5\u76e3\u8996\uff08spy\uff09\u67d0\u4e9b\u51fd\u5f0f\uff0c\u4e26\u89c0\u5bdf\u5176\u4ed6\u90e8\u5206\u7684\u6e2c\u8a66\u5982\u4f55\u8207\u5b83\u4ea4\u4e92\u3002\u53ef\u4ee5\u4f7f\u7528\u6613\u65bc\u6e2c\u8a66\u7684\u7248\u672c\uff0c\u5c0d\u65bc\u9078\u64c7\u6027\u5730\u4f86 mock \u9019\u4e9b\u51fd\u5f0f\u5f88\u6709\u7528\u3002</p>\n<p>\u9019\u7279\u5225\u662f\u5c0d\u65bc\u8cc7\u6599\u7684 fetch \u975e\u5e38\u6709\u7528\u3002\u901a\u5e38\u6700\u597d\u662f\u4f7f\u7528\u300c\u5047\u300d\u8cc7\u6599\u4f86\u6e2c\u8a66\uff0c\u907f\u514d\u5f9e\u771f\u5be6 API endpoint \u53d6\u5f97\u8cc7\u6599\uff0c\u9020\u6210\u7de9\u6162\u548c\u8106\u5f31\u7684\u6e2c\u8a66<a href=\"/react/testing-recipes#data-fetching\"><small>\uff08\u7bc4\u4f8b\uff09</small></a>\u3002\u9019\u589e\u9032\u4e86\u6e2c\u8a66\u7684\u53ef\u9810\u671f\u6027\u3002\u50cf\u662f <a class=\"external-link\" href=\"https://jestjs.io/\">Jest</a> \u548c <a class=\"external-link\" href=\"https://sinonjs.org/\">sinon</a> \u7684\u51fd\u5f0f\u5eab\uff0c\u90fd\u652f\u63f4 mock \u51fd\u5f0f\u3002\u5c0d\u65bc end-to-end \u6e2c\u8a66\u4f86\u8aaa\uff0cmock network \u53ef\u80fd\u6703\u66f4\u56f0\u96e3\uff0c\u4f46\u4f60\u4ecd\u7136\u53ef\u80fd\u4e5f\u60f3\u8981\u5728\u6e2c\u8a66\u4e2d\u6e2c\u8a66\u771f\u5be6\u7684 API endpoint\u3002</p>\n<h3 id=\"mocking-modules\"><a class=\"anchor\" href=\"/react/testing-environments#mocking-modules\"></a>Mocking module </h3>\n<p>\u6709\u4e9b component \u8207\u5176\u4ed6 module \u53ef\u80fd\u6709\u4f9d\u8cf4\u95dc\u4fc2\uff0c\u5728\u6e2c\u8a66\u74b0\u5883\u4e2d\u53ef\u80fd\u6703\u7121\u6cd5\u904b\u4f5c\uff0c\u6216\u8005\u662f\u5c0d\u65bc\u6e2c\u8a66\u4e0d\u53ef\u7f3a\u5c11\u7684\u3002\u9078\u64c7\u6027\u7684 mock \u9019\u4e9b module \u4e26\u9032\u884c\u9069\u7576\u7684\u66ff\u63db\u6703\u5f88\u6709\u7528<a href=\"/react/testing-recipes#mocking-modules\"><small>\uff08\u7bc4\u4f8b\uff09</small></a>\u3002</p>\n<p>\u5728 Node.js \u4e2d\uff0c\u50cf\u662f Jest \u7684 runner <a class=\"external-link\" href=\"https://jestjs.io/docs/en/manual-mocks\">\u652f\u63f4 mock module</a>\u3002\u4f60\u4e5f\u53ef\u4ee5\u9078\u64c7\u50cf\u662f <a class=\"external-link\" href=\"https://www.npmjs.com/package/mock-require\"><code class=\"language-javascript\">mock-require</code></a> \u7684\u51fd\u5f0f\u5eab\u3002</p>\n<h3 id=\"mocking-timers\"><a class=\"anchor\" href=\"/react/testing-environments#mocking-timers\"></a>Mocking timer </h3>\n<p>Component \u53ef\u80fd\u4f7f\u7528\u57fa\u65bc\u50cf\u662f <code class=\"language-javascript\">setTimeout</code>\u3001<code class=\"language-javascript\">setInterval</code> \u6216\u662f <code class=\"language-javascript\">Date.now</code> \u7684\u6642\u9593\u51fd\u5f0f\u3002\u5728\u6e2c\u8a66\u74b0\u5883\u4e2d\uff0c\u53ef\u4ee5\u900f\u904e mock \u9019\u4e9b\u51fd\u5f0f\u4f86\u505a\u66ff\u63db\uff0c\u5c0d\u65bc\u4f60\u60f3\u8981\u624b\u52d5\u300c\u63d0\u524d\u300d\u6642\u9593\u975e\u5e38\u6709\u7528\u3002\u9019\u53ef\u4ee5\u78ba\u4fdd\u4f60\u7684\u6e2c\u8a66\u5f88\u5feb\u5730\u57f7\u884c\uff01\u4f9d\u8cf4\u65bc timer \u7684\u6e2c\u8a66\u4ecd\u7136\u53ef\u4ee5\u6309\u9806\u5e8f resolve\uff0c\u4f46\u901f\u5ea6\u66f4\u5feb<a href=\"/react/testing-recipes#timers\"><small>\uff08\u7bc4\u4f8b\uff09</small></a>\u3002\u5927\u90e8\u5206\u7684\u6e2c\u8a66\u6846\u67b6\uff0c\u5305\u542b <a class=\"external-link\" href=\"https://jestjs.io/docs/en/timer-mocks\">Jest</a>\u3001<a class=\"external-link\" href=\"https://sinonjs.org/releases/latest/fake-timers\">sinon</a> \u4ee5\u53ca <a class=\"external-link\" href=\"https://github.com/sinonjs/lolex\">lolex</a> \u8b93\u4f60\u53ef\u4ee5\u5728\u6e2c\u8a66\u4e2d mock timer\u3002</p>\n<p>\u6709\u6642\u5019\u4f60\u53ef\u80fd\u4e0d\u60f3\u8981 mock timer\u3002\u4f8b\u5982\uff0c\u6216\u8a31\u4f60\u60f3\u8981\u6e2c\u8a66\u4e00\u500b animation\uff0c\u6216\u662f\u8207\u4e00\u500b\u5c0d\u6642\u9593\u8f03\u654f\u611f\u7684 endpoint \u4ea4\u4e92\uff08\u50cf\u662f API \u7684 rate limiter\uff09\u3002\u51fd\u5f0f\u5eab\u7684 timer mock \u8b93\u4f60\u5728\u6bcf\u500b\u6e2c\u8a66\u7684\u57fa\u790e\u4e0a\u555f\u7528\u548c\u95dc\u9589\u5b83\u5011\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u660e\u78ba\u7684\u9078\u64c7\u9019\u4e9b\u6e2c\u8a66\u7684\u57f7\u884c\u65b9\u5f0f\u3002</p>\n<h3 id=\"end-to-end-tests-aka-e2e-tests\"><a class=\"anchor\" href=\"/react/testing-environments#end-to-end-tests-aka-e2e-tests\"></a>End-to-end \u6e2c\u8a66 </h3>\n<p>End-to-end \u6e2c\u8a66\u5c0d\u65bc\u6e2c\u8a66\u66f4\u9577\u7684 workflow \u975e\u5e38\u6709\u7528\uff0c\u7279\u5225\u662f\u7576\u5b83\u5011\u5c0d\u65bc\u4f60\u7684\u5546\u696d\u908f\u8f2f\u81f3\u95dc\u91cd\u8981\u6642\uff08\u50cf\u662f\u4ed8\u6b3e\u6216\u662f\u8a3b\u518a\uff09\u3002\u5c0d\u65bc\u9019\u4e9b\u6e2c\u8a66\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u6e2c\u8a66\u771f\u5be6\u700f\u89bd\u5668\u662f\u5982\u4f55 render \u6574\u500b\u61c9\u7528\u7a0b\u5f0f\uff0c\u5f9e\u771f\u5be6 API endpoint \u4f86 fetch \u8cc7\u6599\uff0c\u4f7f\u7528 session \u548c cookie\uff0c\u5728\u4e0d\u540c\u7684\u9023\u7d50\u4e4b\u9593\u5c0e\u822a\u3002\u4f60\u53ef\u80fd\u4e0d\u53ea\u60f3\u8981 assert \u5728 DOM \u4e0a\u7684 state\uff0c\u800c\u4e14\u9084\u8981\u5099\u4efd\u8cc7\u6599\u7684 assert\uff08\u4f8b\u5982\uff1a\u9a57\u8b49\u66f4\u65b0\u662f\u5426\u5df2\u7d93\u88ab\u5132\u5b58\u5230\u8cc7\u6599\u5eab\uff09\u3002</p>\n<p>\u5728\u9019\u500b\u5834\u666f\u4e0b\uff0c\u4f60\u6703\u4f7f\u7528\u50cf\u662f <a class=\"external-link\" href=\"https://www.cypress.io/\">Cypress</a>\u3001<a class=\"external-link\" href=\"https://playwright.dev\">Playwright</a>\uff0c\u6216\u662f\u50cf\u662f <a class=\"external-link\" href=\"https://pptr.dev/\">Puppeteer</a> \u7684\u51fd\u5f0f\u5eab\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5728\u4e0d\u540c\u7684 route \u4e4b\u9593\u5207\u63db\uff0c\u4e26 assert side effect\uff0c\u800c\u4e0d\u662f\u53ea\u6709\u5728\u700f\u89bd\u5668\u5167\uff0c\u4e5f\u6709\u53ef\u80fd\u5728\u5f8c\u7aef\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/testing-environments.md\">Edit this page</a></p></div></article>", "path": "/react/testing-environments", "nav": ["/react/testing-recipes", "/react/how-to-contribute"]}]}, {"key": "\u8ca2\u737b", "values": [{"key": "\u5982\u4f55\u8ca2\u737b", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React is one of Facebook\u2019s first open source projects that is both under very active development and is also being used to ship code to everybody on <a class=\"external-link\" href=\"https://www.facebook.com\">facebook.com</a>. We\u2019re still working out the kinks to make contributing to this project as easy and transparent as possible, but we\u2019re not quite there yet. Hopefully this document makes the process for contributing clear and answers some questions that you may have.</p>\n<h3 id=\"code-of-conduct\"><a class=\"anchor\" href=\"/react/how-to-contribute#code-of-conduct\"></a><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/main/CODE_OF_CONDUCT.md\">Code of Conduct</a> </h3>\n<p>Facebook has adopted the <a class=\"external-link\" href=\"https://www.contributor-covenant.org/\">Contributor Covenant</a> as its Code of Conduct, and we expect project participants to adhere to it. Please read <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/main/CODE_OF_CONDUCT.md\">the full text</a> so that you can understand what actions will and will not be tolerated.</p>\n<h3 id=\"open-development\"><a class=\"anchor\" href=\"/react/how-to-contribute#open-development\"></a>Open Development </h3>\n<p>All work on React happens directly on <a class=\"external-link\" href=\"https://github.com/facebook/react\">GitHub</a>. Both core team members and external contributors send pull requests which go through the same review process.</p>\n<h3 id=\"semantic-versioning\"><a class=\"anchor\" href=\"/react/how-to-contribute#semantic-versioning\"></a>Semantic Versioning </h3>\n<p>React follows <a class=\"external-link\" href=\"https://semver.org/\">semantic versioning</a>. We release patch versions for critical bugfixes, minor versions for new features or non-essential changes, and major versions for any breaking changes. When we make breaking changes, we also introduce deprecation warnings in a minor version so that our users learn about the upcoming changes and migrate their code in advance. Learn more about our commitment to stability and incremental migration in <a href=\"/react/faq-versioning\">our versioning policy</a>.</p>\n<p>Every significant change is documented in the <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/main/CHANGELOG.md\">changelog file</a>.</p>\n<h3 id=\"branch-organization\"><a class=\"anchor\" href=\"/react/how-to-contribute#branch-organization\"></a>Branch Organization </h3>\n<p>Submit all changes directly to the <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main\"><code class=\"language-javascript\">main branch</code></a>. We don\u2019t use separate branches for development or for upcoming releases. We do our best to keep <code class=\"language-javascript\">main</code> in good shape, with all tests passing.</p>\n<p>Code that lands in <code class=\"language-javascript\">main</code> must be compatible with the latest stable release. It may contain additional features, but no breaking changes. We should be able to release a new minor version from the tip of <code class=\"language-javascript\">main</code> at any time.</p>\n<h3 id=\"feature-flags\"><a class=\"anchor\" href=\"/react/how-to-contribute#feature-flags\"></a>Feature Flags </h3>\n<p>To keep the <code class=\"language-javascript\">main</code> branch in a releasable state, breaking changes and experimental features must be gated behind a feature flag.</p>\n<p>Feature flags are defined in <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/main/packages/shared/ReactFeatureFlags.js\"><code class=\"language-javascript\">packages/shared/ReactFeatureFlags.js</code></a>. Some builds of React may enable different sets of feature flags; for example, the React Native build may be configured differently than React DOM. These flags are found in <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/shared/forks\"><code class=\"language-javascript\">packages/shared/forks</code></a>. Feature flags are statically typed by Flow, so you can run <code class=\"language-javascript\">yarn flow</code> to confirm that you\u2019ve updated all the necessary files.</p>\n<p>React\u2019s build system will strip out disabled feature branches before publishing. A continuous integration job runs on every commit to check for changes in bundle size. You can use the change in size as a signal that a feature was gated correctly.</p>\n<h3 id=\"bugs\"><a class=\"anchor\" href=\"/react/how-to-contribute#bugs\"></a>Bugs </h3>\n<h4 id=\"where-to-find-known-issues\"><a class=\"anchor\" href=\"/react/how-to-contribute#where-to-find-known-issues\"></a>Where to Find Known Issues </h4>\n<p>We are using <a class=\"external-link\" href=\"https://github.com/facebook/react/issues\">GitHub Issues</a> for our public bugs. We keep a close eye on this and try to make it clear when we have an internal fix in progress. Before filing a new task, try to make sure your problem doesn\u2019t already exist.</p>\n<h4 id=\"reporting-new-issues\"><a class=\"anchor\" href=\"/react/how-to-contribute#reporting-new-issues\"></a>Reporting New Issues </h4>\n<p>The best way to get your bug fixed is to provide a reduced test case. This <a class=\"external-link\" href=\"https://jsfiddle.net/Luktwrdm/\">JSFiddle template</a> is a great starting point.</p>\n<h4 id=\"security-bugs\"><a class=\"anchor\" href=\"/react/how-to-contribute#security-bugs\"></a>Security Bugs </h4>\n<p>Facebook has a <a class=\"external-link\" href=\"https://www.facebook.com/whitehat/\">bounty program</a> for the safe disclosure of security bugs. With that in mind, please do not file public issues; go through the process outlined on that page.</p>\n<h3 id=\"how-to-get-in-touch\"><a class=\"anchor\" href=\"/react/how-to-contribute#how-to-get-in-touch\"></a>How to Get in Touch </h3>\n<ul>\n<li>IRC: <a class=\"external-link\" href=\"https://webchat.freenode.net/?channels=reactjs\">#reactjs on freenode</a></li>\n<li><a class=\"external-link\" href=\"https://zh-hant.reactjs.org//community/support.html#popular-discussion-forums\">Discussion forums</a></li>\n</ul>\n<p>There is also <a class=\"external-link\" href=\"https://www.reactiflux.com/\">an active community of React users on the Discord chat platform</a> in case you need help with React.</p>\n<h3 id=\"proposing-a-change\"><a class=\"anchor\" href=\"/react/how-to-contribute#proposing-a-change\"></a>Proposing a Change </h3>\n<p>If you intend to change the public API, or make any non-trivial changes to the implementation, we recommend <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/new\">filing an issue</a>. This lets us reach an agreement on your proposal before you put significant effort into it.</p>\n<p>If you\u2019re only fixing a bug, it\u2019s fine to submit a pull request right away but we still recommend to file an issue detailing what you\u2019re fixing. This is helpful in case we don\u2019t accept that specific fix but want to keep track of the issue.</p>\n<h3 id=\"your-first-pull-request\"><a class=\"anchor\" href=\"/react/how-to-contribute#your-first-pull-request\"></a>Your First Pull Request </h3>\n<p>Working on your first Pull Request? You can learn how from this free video series:</p>\n<p><strong><a class=\"external-link\" href=\"https://egghead.io/courses/how-to-contribute-to-an-open-source-project-on-github\">How to Contribute to an Open Source Project on GitHub</a></strong></p>\n<p>To help you get your feet wet and get you familiar with our contribution process, we have a list of <strong><a class=\"external-link\" href=\"https://github.com/facebook/react/issues?q=is:open+is:issue+label:%22good+first+issue%22\">good first issues</a></strong> that contain bugs that have a relatively limited scope. This is a great place to get started.</p>\n<p>If you decide to fix an issue, please be sure to check the comment thread in case somebody is already working on a fix. If nobody is working on it at the moment, please leave a comment stating that you intend to work on it so other people don\u2019t accidentally duplicate your effort.</p>\n<p>If somebody claims an issue but doesn\u2019t follow up for more than two weeks, it\u2019s fine to take it over but you should still leave a comment.</p>\n<h3 id=\"sending-a-pull-request\"><a class=\"anchor\" href=\"/react/how-to-contribute#sending-a-pull-request\"></a>Sending a Pull Request </h3>\n<p>The core team is monitoring for pull requests. We will review your pull request and either merge it, request changes to it, or close it with an explanation. For API changes we may need to fix our internal uses at Facebook.com, which could cause some delay. We\u2019ll do our best to provide updates and feedback throughout the process.</p>\n<p><strong>Before submitting a pull request,</strong> please make sure the following is done:</p>\n<ol>\n<li>Fork <a class=\"external-link\" href=\"https://github.com/facebook/react\">the repository</a> and create your branch from <code class=\"language-javascript\">main</code>.</li>\n<li>Run <code class=\"language-javascript\">yarn</code> in the repository root.</li>\n<li>If you\u2019ve fixed a bug or added code that should be tested, add tests!</li>\n<li>Ensure the test suite passes (<code class=\"language-javascript\">yarn test</code>). Tip: <code class=\"language-javascript\">yarn test --watch TestName</code> is helpful in development.</li>\n<li>Run <code class=\"language-javascript\">yarn test --prod</code> to test in the production environment.</li>\n<li>If you need a debugger, run <code class=\"language-javascript\">yarn debug-test --watch TestName</code>, open <code class=\"language-javascript\">chrome://inspect</code>, and press \u201cInspect\u201d.</li>\n<li>Format your code with <a class=\"external-link\" href=\"https://github.com/prettier/prettier\">prettier</a> (<code class=\"language-javascript\">yarn prettier</code>).</li>\n<li>Make sure your code lints (<code class=\"language-javascript\">yarn lint</code>). Tip: <code class=\"language-javascript\">yarn linc</code> to only check changed files.</li>\n<li>Run the <a class=\"external-link\" href=\"https://flowtype.org/\">Flow</a> typechecks (<code class=\"language-javascript\">yarn flow</code>).</li>\n<li>If you haven\u2019t already, complete the CLA.</li>\n</ol>\n<h3 id=\"contributor-license-agreement-cla\"><a class=\"anchor\" href=\"/react/how-to-contribute#contributor-license-agreement-cla\"></a>Contributor License Agreement (CLA) </h3>\n<p>In order to accept your pull request, we need you to submit a CLA. You only need to do this once, so if you\u2019ve done this for another Facebook open source project, you\u2019re good to go. If you are submitting a pull request for the first time, just let us know that you have completed the CLA and we can cross-check with your GitHub username.</p>\n<p><strong><a class=\"external-link\" href=\"https://code.facebook.com/cla\">Complete your CLA here.</a></strong></p>\n<h3 id=\"contribution-prerequisites\"><a class=\"anchor\" href=\"/react/how-to-contribute#contribution-prerequisites\"></a>Contribution Prerequisites </h3>\n<ul>\n<li>You have <a class=\"external-link\" href=\"https://nodejs.org\">Node</a> installed at LTS and <a class=\"external-link\" href=\"https://yarnpkg.com/en/\">Yarn</a> at v1.2.0+.</li>\n<li>You have <a class=\"external-link\" href=\"https://www.oracle.com/technetwork/java/javase/downloads/index.html\">JDK</a> installed.</li>\n<li>You have <code class=\"language-javascript\">gcc</code> installed or are comfortable installing a compiler if needed. Some of our dependencies may require a compilation step. On OS X, the Xcode Command Line Tools will cover this. On Ubuntu, <code class=\"language-javascript\">apt-get install build-essential</code> will install the required packages. Similar commands should work on other Linux distros. Windows will require some additional steps, see the <a class=\"external-link\" href=\"https://github.com/nodejs/node-gyp#installation\"><code class=\"language-javascript\">node-gyp</code> installation instructions</a> for details.</li>\n<li>You are familiar with Git.</li>\n</ul>\n<h3 id=\"development-workflow\"><a class=\"anchor\" href=\"/react/how-to-contribute#development-workflow\"></a>Development Workflow </h3>\n<p>After cloning React, run <code class=\"language-javascript\">yarn</code> to fetch its dependencies.\nThen, you can run several commands:</p>\n<ul>\n<li><code class=\"language-javascript\">yarn lint</code> checks the code style.</li>\n<li><code class=\"language-javascript\">yarn linc</code> is like <code class=\"language-javascript\">yarn lint</code> but faster because it only checks files that differ in your branch.</li>\n<li><code class=\"language-javascript\">yarn test</code> runs the complete test suite.</li>\n<li><code class=\"language-javascript\">yarn test --watch</code> runs an interactive test watcher.</li>\n<li><code class=\"language-javascript\">yarn test --prod</code> runs tests in the production environment.</li>\n<li><code class=\"language-javascript\">yarn test &lt;pattern&gt;</code> runs tests with matching filenames.</li>\n<li><code class=\"language-javascript\">yarn debug-test</code> is just like <code class=\"language-javascript\">yarn test</code> but with a debugger. Open <code class=\"language-javascript\">chrome://inspect</code> and press \u201cInspect\u201d.</li>\n<li><code class=\"language-javascript\">yarn flow</code> runs the <a class=\"external-link\" href=\"https://flowtype.org/\">Flow</a> typechecks.</li>\n<li><code class=\"language-javascript\">yarn build</code> creates a <code class=\"language-javascript\">build</code> folder with all the packages.</li>\n<li><code class=\"language-javascript\">yarn build react/index,react-dom/index --type=UMD</code> creates UMD builds of just React and ReactDOM.</li>\n</ul>\n<p>We recommend running <code class=\"language-javascript\">yarn test</code> (or its variations above) to make sure you don\u2019t introduce any regressions as you work on your change. However, it can be handy to try your build of React in a real project.</p>\n<p>First, run <code class=\"language-javascript\">yarn build</code>. This will produce pre-built bundles in <code class=\"language-javascript\">build</code> folder, as well as prepare npm packages inside <code class=\"language-javascript\">build/packages</code>.</p>\n<p>The easiest way to try your changes is to run <code class=\"language-javascript\">yarn build react/index,react-dom/index --type=UMD</code> and then open <code class=\"language-javascript\">fixtures/packaging/babel-standalone/dev.html</code>. This file already uses <code class=\"language-javascript\">react.development.js</code> from the <code class=\"language-javascript\">build</code> folder so it will pick up your changes.</p>\n<p>If you want to try your changes in your existing React project, you may copy <code class=\"language-javascript\">build/node_modules/react/umd/react.development.js</code>, <code class=\"language-javascript\">build/node_modules/react-dom/umd/react-dom.development.js</code>, or any other build products into your app and use them instead of the stable version. </p>\n<p>If your project uses React from npm, you may delete <code class=\"language-javascript\">react</code> and <code class=\"language-javascript\">react-dom</code> in its dependencies and use <code class=\"language-javascript\">yarn link</code> to point them to your local <code class=\"language-javascript\">build</code> folder. Note that <strong>instead of <code class=\"language-javascript\">--type=UMD</code> you\u2019ll want to pass <code class=\"language-javascript\">--type=NODE</code> when building</strong>. You\u2019ll also need to build the <code class=\"language-javascript\">scheduler</code> package:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-sh\"><code class=\"language-javascript\">cd ~/path_to_your_react_clone/\nyarn build react/index,react/jsx,react-dom/index,scheduler --type=NODE\n\ncd build/node_modules/react\nyarn link\ncd build/node_modules/react-dom\nyarn link\n\ncd ~/path/to/your/project\nyarn link react react-dom</code></pre></div>\n<p>Every time you run <code class=\"language-javascript\">yarn build</code> in the React folder, the updated versions will appear in your project\u2019s <code class=\"language-javascript\">node_modules</code>. You can then rebuild your project to try your changes.</p>\n<p>If some package is still missing (e.g. maybe you use <code class=\"language-javascript\">react-dom/server</code> in your project), you can always do a full build with <code class=\"language-javascript\">yarn build</code>. Note that running <code class=\"language-javascript\">yarn build</code> without options takes a long time.</p>\n<p>We still require that your pull request contains unit tests for any new functionality. This way we can ensure that we don\u2019t break your code in the future.</p>\n<h3 id=\"style-guide\"><a class=\"anchor\" href=\"/react/how-to-contribute#style-guide\"></a>Style Guide </h3>\n<p>We use an automatic code formatter called <a class=\"external-link\" href=\"https://prettier.io/\">Prettier</a>.\nRun <code class=\"language-javascript\">yarn prettier</code> after making any changes to the code.</p>\n<p>Then, our linter will catch most issues that may exist in your code.\nYou can check the status of your code styling by simply running <code class=\"language-javascript\">yarn linc</code>.</p>\n<p>However, there are still some styles that the linter cannot pick up. If you are unsure about something, looking at <a class=\"external-link\" href=\"https://github.com/airbnb/javascript\">Airbnb\u2019s Style Guide</a> will guide you in the right direction.</p>\n<h3 id=\"request-for-comments-rfc\"><a class=\"anchor\" href=\"/react/how-to-contribute#request-for-comments-rfc\"></a>Request for Comments (RFC) </h3>\n<p>Many changes, including bug fixes and documentation improvements can be implemented and reviewed via the normal GitHub pull request workflow.</p>\n<p>Some changes though are \u201csubstantial\u201d, and we ask that these be put through a bit of a design process and produce a consensus among the React core team.</p>\n<p>The \u201cRFC\u201d (request for comments) process is intended to provide a consistent and controlled path for new features to enter the project. You can contribute by visiting the <a class=\"external-link\" href=\"https://github.com/reactjs/rfcs\">rfcs repository</a>.</p>\n<h3 id=\"license\"><a class=\"anchor\" href=\"/react/how-to-contribute#license\"></a>License </h3>\n<p>By contributing to React, you agree that your contributions will be licensed under its MIT license.</p>\n<h3 id=\"what-next\"><a class=\"anchor\" href=\"/react/how-to-contribute#what-next\"></a>What Next? </h3>\n<p>Read the <a href=\"/react/codebase-overview\">next section</a> to learn how the codebase is organized.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/how-to-contribute.md\">Edit this page</a></p></div></article>", "path": "/react/how-to-contribute", "nav": ["/react/testing-environments", "/react/codebase-overview"]}, {"key": "Codebase \u6982\u89c0", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>This section will give you an overview of the React codebase organization, its conventions, and the implementation.</p>\n<p>If you want to <a href=\"/react/how-to-contribute\">contribute to React</a> we hope that this guide will help you feel more comfortable making changes.</p>\n<p>We don\u2019t necessarily recommend any of these conventions in React apps. Many of them exist for historical reasons and might change with time.</p>\n<h3 id=\"top-level-folders\"><a class=\"anchor\" href=\"/react/codebase-overview#top-level-folders\"></a>Top-Level Folders </h3>\n<p>After cloning the <a class=\"external-link\" href=\"https://github.com/facebook/react\">React repository</a>, you will see a few top-level folders in it:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages\"><code class=\"language-javascript\">packages</code></a> contains metadata (such as <code class=\"language-javascript\">package.json</code>) and the source code (<code class=\"language-javascript\">src</code> subdirectory) for all packages in the React repository. <strong>If your change is related to the code, the <code class=\"language-javascript\">src</code> subdirectory of each package is where you\u2019ll spend most of your time.</strong></li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/fixtures\"><code class=\"language-javascript\">fixtures</code></a> contains a few small React test applications for contributors.</li>\n<li><code class=\"language-javascript\">build</code> is the build output of React. It is not in the repository but it will appear in your React clone after you <a href=\"/react/how-to-contribute#development-workflow\">build it</a> for the first time.</li>\n</ul>\n<p>The documentation is hosted <a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org\">in a separate repository from React</a>.</p>\n<p>There are a few other top-level folders but they are mostly used for the tooling and you likely won\u2019t ever encounter them when contributing.</p>\n<h3 id=\"colocated-tests\"><a class=\"anchor\" href=\"/react/codebase-overview#colocated-tests\"></a>Colocated Tests </h3>\n<p>We don\u2019t have a top-level directory for unit tests. Instead, we put them into a directory called <code class=\"language-javascript\">__tests__</code> relative to the files that they test.</p>\n<p>For example, a test for <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/87724bd87506325fcaf2648c70fc1f43411a87be/src/renderers/dom/client/utils/setInnerHTML.js\"><code class=\"language-javascript\">setInnerHTML.js</code></a> is located in <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/87724bd87506325fcaf2648c70fc1f43411a87be/src/renderers/dom/client/utils/__tests__/setInnerHTML-test.js\"><code class=\"language-javascript\">__tests__/setInnerHTML-test.js</code></a> right next to it.</p>\n<h3 id=\"warnings-and-invariants\"><a class=\"anchor\" href=\"/react/codebase-overview#warnings-and-invariants\"></a>Warnings and Invariants </h3>\n<p>The React codebase uses <code class=\"language-javascript\">console.error</code> to display warnings:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something is wrong.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Warnings are only enabled in development. In production, they are completely stripped out. If you need to forbid some code path from executing, use <code class=\"language-javascript\">invariant</code> module instead:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> invariant <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'invariant'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">invariant</span><span class=\"token punctuation\">(</span>\n  <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'You shall not pass!'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>The invariant is thrown when the <code class=\"language-javascript\">invariant</code> condition is <code class=\"language-javascript\">false</code>.</strong></p>\n<p>\u201cInvariant\u201d is just a way of saying \u201cthis condition always holds true\u201d. You can think about it as making an assertion.</p>\n<p>It is important to keep development and production behavior similar, so <code class=\"language-javascript\">invariant</code> throws both in development and in production. The error messages are automatically replaced with error codes in production to avoid negatively affecting the byte size.</p>\n<h3 id=\"development-and-production\"><a class=\"anchor\" href=\"/react/codebase-overview#development-and-production\"></a>Development and Production </h3>\n<p>You can use <code class=\"language-javascript\">__DEV__</code> pseudo-global variable in the codebase to guard development-only blocks of code.</p>\n<p>It is inlined during the compile step, and turns into <code class=\"language-javascript\">process.env.NODE_ENV !== 'production'</code> checks in the CommonJS builds.</p>\n<p>For standalone builds, it becomes <code class=\"language-javascript\">true</code> in the unminified build, and gets completely stripped out with the <code class=\"language-javascript\">if</code> blocks it guards in the minified build.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// This code will only run in development.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"flow\"><a class=\"anchor\" href=\"/react/codebase-overview#flow\"></a>Flow </h3>\n<p>We recently started introducing <a class=\"external-link\" href=\"https://flow.org/\">Flow</a> checks to the codebase. Files marked with the <code class=\"language-javascript\">@flow</code> annotation in the license header comment are being typechecked.</p>\n<p>We accept pull requests <a class=\"external-link\" href=\"https://github.com/facebook/react/pull/7600/files\">adding Flow annotations to existing code</a>. Flow annotations look like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">ReactRef<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">detachRefs</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\"><span class=\"token literal-property property\">instance</span><span class=\"token operator\">:</span> ReactInstance<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">element</span><span class=\"token operator\">:</span> ReactElement <span class=\"token operator\">|</span> string <span class=\"token operator\">|</span> number <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">|</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>When possible, new code should use Flow annotations.\nYou can run <code class=\"language-javascript\">yarn flow</code> locally to check your code with Flow.</p>\n<h3 id=\"multiple-packages\"><a class=\"anchor\" href=\"/react/codebase-overview#multiple-packages\"></a>Multiple Packages </h3>\n<p>React is a <a class=\"external-link\" href=\"https://danluu.com/monorepo/\">monorepo</a>. Its repository contains multiple separate packages so that their changes can be coordinated together, and issues live in one place.</p>\n<h3 id=\"react-core\"><a class=\"anchor\" href=\"/react/codebase-overview#react-core\"></a>React Core </h3>\n<p>The \u201ccore\u201d of React includes all the <a href=\"/react/react-api#react\">top-level <code class=\"language-javascript\">React</code> APIs</a>, for example:</p>\n<ul>\n<li><code class=\"language-javascript\">React.createElement()</code></li>\n<li><code class=\"language-javascript\">React.Component</code></li>\n<li><code class=\"language-javascript\">React.Children</code></li>\n</ul>\n<p><strong>React core only includes the APIs necessary to define components.</strong> It does not include the <a href=\"/react/reconciliation\">reconciliation</a> algorithm or any platform-specific code. It is used both by React DOM and React Native components.</p>\n<p>The code for React core is located in <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react\"><code class=\"language-javascript\">packages/react</code></a> in the source tree. It is available on npm as the <a class=\"external-link\" href=\"https://www.npmjs.com/package/react\"><code class=\"language-javascript\">react</code></a> package. The corresponding standalone browser build is called <code class=\"language-javascript\">react.js</code>, and it exports a global called <code class=\"language-javascript\">React</code>.</p>\n<h3 id=\"renderers\"><a class=\"anchor\" href=\"/react/codebase-overview#renderers\"></a>Renderers </h3>\n<p>React was originally created for the DOM but it was later adapted to also support native platforms with <a class=\"external-link\" href=\"https://reactnative.dev/\">React Native</a>. This introduced the concept of \u201crenderers\u201d to React internals.</p>\n<p><strong>Renderers manage how a React tree turns into the underlying platform calls.</strong></p>\n<p>Renderers are also located in <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/\"><code class=\"language-javascript\">packages/</code></a>:</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-dom\">React DOM Renderer</a> renders React components to the DOM. It implements <a href=\"/react/react-dom\">top-level <code class=\"language-javascript\">ReactDOM</code> APIs</a> and is available as <a class=\"external-link\" href=\"https://www.npmjs.com/package/react-dom\"><code class=\"language-javascript\">react-dom</code></a> npm package. It can also be used as standalone browser bundle called <code class=\"language-javascript\">react-dom.js</code> that exports a <code class=\"language-javascript\">ReactDOM</code> global.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-native-renderer\">React Native Renderer</a> renders React components to native views. It is used internally by React Native.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-test-renderer\">React Test Renderer</a> renders React components to JSON trees. It is used by the <a class=\"external-link\" href=\"https://facebook.github.io/jest/blog/2016/07/27/jest-14.html\">Snapshot Testing</a> feature of <a class=\"external-link\" href=\"https://facebook.github.io/jest\">Jest</a> and is available as <a class=\"external-link\" href=\"https://www.npmjs.com/package/react-test-renderer\">react-test-renderer</a> npm package.</li>\n</ul>\n<p>The only other officially supported renderer is <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-art\"><code class=\"language-javascript\">react-art</code></a>. It used to be in a separate <a class=\"external-link\" href=\"https://github.com/reactjs/react-art\">GitHub repository</a> but we moved it into the main source tree for now.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Technically the <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-native-renderer\"><code class=\"language-javascript\">react-native-renderer</code></a> is a very thin layer that teaches React to interact with React Native implementation. The real platform-specific code managing the native views lives in the <a class=\"external-link\" href=\"https://github.com/facebook/react-native\">React Native repository</a> together with its components.</p>\n</div>\n<h3 id=\"reconcilers\"><a class=\"anchor\" href=\"/react/codebase-overview#reconcilers\"></a>Reconcilers </h3>\n<p>Even vastly different renderers like React DOM and React Native need to share a lot of logic. In particular, the <a href=\"/react/reconciliation\">reconciliation</a> algorithm should be as similar as possible so that declarative rendering, custom components, state, lifecycle methods, and refs work consistently across platforms.</p>\n<p>To solve this, different renderers share some code between them. We call this part of React a \u201creconciler\u201d. When an update such as <code class=\"language-javascript\">setState()</code> is scheduled, the reconciler calls <code class=\"language-javascript\">render()</code> on components in the tree and mounts, updates, or unmounts them.</p>\n<p>Reconcilers are not packaged separately because they currently have no public API. Instead, they are exclusively used by renderers such as React DOM and React Native.</p>\n<h3 id=\"stack-reconciler\"><a class=\"anchor\" href=\"/react/codebase-overview#stack-reconciler\"></a>Stack Reconciler </h3>\n<p>The \u201cstack\u201d reconciler is the implementation powering React 15 and earlier. We have since stopped using it, but it is documented in detail in the <a href=\"/react/implementation-notes\">next section</a>.</p>\n<h3 id=\"fiber-reconciler\"><a class=\"anchor\" href=\"/react/codebase-overview#fiber-reconciler\"></a>Fiber Reconciler </h3>\n<p>The \u201cfiber\u201d reconciler is a new effort aiming to resolve the problems inherent in the stack reconciler and fix a few long-standing issues. It has been the default reconciler since React 16.</p>\n<p>Its main goals are:</p>\n<ul>\n<li>Ability to split interruptible work in chunks.</li>\n<li>Ability to prioritize, rebase and reuse work in progress.</li>\n<li>Ability to yield back and forth between parents and children to support layout in React.</li>\n<li>Ability to return multiple elements from <code class=\"language-javascript\">render()</code>.</li>\n<li>Better support for error boundaries.</li>\n</ul>\n<p>You can read more about React Fiber Architecture <a class=\"external-link\" href=\"https://github.com/acdlite/react-fiber-architecture\">here</a> and <a class=\"external-link\" href=\"https://blog.ag-grid.com/inside-fiber-an-in-depth-overview-of-the-new-reconciliation-algorithm-in-react\">here</a>. While it has shipped with React 16, the async features are not enabled by default yet.</p>\n<p>Its source code is located in <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-reconciler\"><code class=\"language-javascript\">packages/react-reconciler</code></a>.</p>\n<h3 id=\"event-system\"><a class=\"anchor\" href=\"/react/codebase-overview#event-system\"></a>Event System </h3>\n<p>React implements a layer over native events to smooth out cross-browser differences. Its source code is located in <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-dom/src/events\"><code class=\"language-javascript\">packages/react-dom/src/events</code></a>.</p>\n<h3 id=\"what-next\"><a class=\"anchor\" href=\"/react/codebase-overview#what-next\"></a>What Next? </h3>\n<p>Read the <a href=\"/react/implementation-notes\">next section</a> to learn about the pre-React 16 implementation of reconciler in more detail. We haven\u2019t documented the internals of the new reconciler yet.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/codebase-overview.md\">Edit this page</a></p></div></article>", "path": "/react/codebase-overview", "nav": ["/react/how-to-contribute", "/react/implementation-notes"]}, {"key": "\u5be6\u73fe\u8aaa\u660e", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>This section is a collection of implementation notes for the <a href=\"/react/codebase-overview#stack-reconciler\">stack reconciler</a>.</p>\n<p>It is very technical and assumes a strong understanding of React public API as well as how it\u2019s divided into core, renderers, and the reconciler. If you\u2019re not very familiar with the React codebase, read <a href=\"/react/codebase-overview\">the codebase overview</a> first.</p>\n<p>It also assumes an understanding of the <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2015/12/18/react-components-elements-and-instances.html\">differences between React components, their instances, and elements</a>.</p>\n<p>The stack reconciler was used in React 15 and earlier. It is located at <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/15-stable/src/renderers/shared/stack/reconciler\">src/renderers/shared/stack/reconciler</a>.</p>\n<h3 id=\"video-building-react-from-scratch\"><a class=\"anchor\" href=\"/react/implementation-notes#video-building-react-from-scratch\"></a>Video: Building React from Scratch </h3>\n<p><a class=\"external-link\" href=\"https://twitter.com/zpao\">Paul O\u2019Shannessy</a> gave a talk about <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=_MAD4Oly9yg\">building React from scratch</a> that largely inspired this document.</p>\n<p>Both this document and his talk are simplifications of the real codebase so you might get a better understanding by getting familiar with both of them.</p>\n<h3 id=\"overview\"><a class=\"anchor\" href=\"/react/implementation-notes#overview\"></a>Overview </h3>\n<p>The reconciler itself doesn\u2019t have a public API. <a href=\"/react/codebase-overview#renderers\">Renderers</a> like React DOM and React Native use it to efficiently update the user interface according to the React components written by the user.</p>\n<h3 id=\"mounting-as-a-recursive-process\"><a class=\"anchor\" href=\"/react/implementation-notes#mounting-as-a-recursive-process\"></a>Mounting as a Recursive Process </h3>\n<p>Let\u2019s consider the first time you mount a component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-javascript\">root.render</code> will pass <code class=\"language-javascript\">&lt;App /&gt;</code> along to the reconciler. Remember that <code class=\"language-javascript\">&lt;App /&gt;</code> is a React element, that is, a description of <em>what</em> to render. You can think about it as a plain object:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { type: App, props: {} }</span></code></pre></div>\n<p>The reconciler will check if <code class=\"language-javascript\">App</code> is a class or a function.</p>\n<p>If <code class=\"language-javascript\">App</code> is a function, the reconciler will call <code class=\"language-javascript\">App(props)</code> to get the rendered element.</p>\n<p>If <code class=\"language-javascript\">App</code> is a class, the reconciler will instantiate an <code class=\"language-javascript\">App</code> with <code class=\"language-javascript\">new App(props)</code>, call the <code class=\"language-javascript\">componentWillMount()</code> lifecycle method, and then will call the <code class=\"language-javascript\">render()</code> method to get the rendered element.</p>\n<p>Either way, the reconciler will learn the element <code class=\"language-javascript\">App</code> \u201crendered to\u201d.</p>\n<p>This process is recursive. <code class=\"language-javascript\">App</code> may render to a <code class=\"language-javascript\">&lt;Greeting /&gt;</code>, <code class=\"language-javascript\">Greeting</code> may render to a <code class=\"language-javascript\">&lt;Button /&gt;</code>, and so on. The reconciler will \u201cdrill down\u201d through user-defined components recursively as it learns what each component renders to.</p>\n<p>You can imagine this process as a pseudocode:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// React.Component subclasses have this flag</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n    <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>isReactComponent<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// This function takes a React element (e.g. &lt;App /&gt;)</span>\n<span class=\"token comment\">// and returns a DOM or Native node representing the mounted tree.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// We will determine the rendered element</span>\n  <span class=\"token comment\">// by either running the type as function</span>\n  <span class=\"token comment\">// or creating an instance and calling render().</span>\n  <span class=\"token keyword\">var</span> renderedElement<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Component class</span>\n    <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Set the props</span>\n    publicInstance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Call the lifecycle if necessary</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">.</span>componentWillMount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// Get the rendered element by calling render()</span>\n    renderedElement <span class=\"token operator\">=</span> publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Component function</span>\n    renderedElement <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// This process is recursive because a component may</span>\n  <span class=\"token comment\">// return an element with a type of another component.</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span>renderedElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Note: this implementation is incomplete and recurses infinitely!</span>\n  <span class=\"token comment\">// It only handles elements like &lt;App /&gt; or &lt;Button /&gt;.</span>\n  <span class=\"token comment\">// It doesn't handle elements like &lt;div /&gt; or &lt;p /&gt; yet.</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrootEl<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This really <em>is</em> a pseudo-code. It isn\u2019t similar to the real implementation. It will also cause a stack overflow because we haven\u2019t discussed when to stop the recursion.</p>\n</div>\n<p>Let\u2019s recap a few key ideas in the example above:</p>\n<ul>\n<li>React elements are plain objects representing the component type (e.g. <code class=\"language-javascript\">App</code>) and the props.</li>\n<li>User-defined components (e.g. <code class=\"language-javascript\">App</code>) can be classes or functions but they all \u201crender to\u201d elements.</li>\n<li>\u201cMounting\u201d is a recursive process that creates a DOM or Native tree given the top-level React element (e.g. <code class=\"language-javascript\">&lt;App /&gt;</code>).</li>\n</ul>\n<h3 id=\"mounting-host-elements\"><a class=\"anchor\" href=\"/react/implementation-notes#mounting-host-elements\"></a>Mounting Host Elements </h3>\n<p>This process would be useless if we didn\u2019t render something to the screen as a result.</p>\n<p>In addition to user-defined (\u201ccomposite\u201d) components, React elements may also represent platform-specific (\u201chost\u201d) components. For example, <code class=\"language-javascript\">Button</code> might return a <code class=\"language-javascript\">&lt;div /&gt;</code> from its render method.</p>\n<p>If element\u2019s <code class=\"language-javascript\">type</code> property is a string, we are dealing with a host element:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { type: 'div', props: {} }</span></code></pre></div>\n<p>There is no user-defined code associated with host elements.</p>\n<p>When the reconciler encounters a host element, it lets the renderer take care of mounting it. For example, React DOM would create a DOM node.</p>\n<p>If the host element has children, the reconciler recursively mounts them following the same algorithm as above. It doesn\u2019t matter whether children are host (like <code class=\"language-javascript\">&lt;div&gt;&lt;hr /&gt;&lt;/div&gt;</code>), composite (like <code class=\"language-javascript\">&lt;div&gt;&lt;Button /&gt;&lt;/div&gt;</code>), or both.</p>\n<p>The DOM nodes produced by the child components will be appended to the parent DOM node, and recursively, the complete DOM structure will be assembled.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>The reconciler itself is not tied to the DOM. The exact result of mounting (sometimes called \u201cmount image\u201d in the source code) depends on the renderer, and can be a DOM node (React DOM), a string (React DOM Server), or a number representing a native view (React Native).</p>\n</div>\n<p>If we were to extend the code to handle host elements, it would look like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// React.Component subclasses have this flag</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n    <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>isReactComponent<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// This function only handles elements with a composite type.</span>\n<span class=\"token comment\">// For example, it handles &lt;App /&gt; and &lt;Button /&gt;, but not a &lt;div /&gt;.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">mountComposite</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> renderedElement<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Component class</span>\n    <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Set the props</span>\n    publicInstance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Call the lifecycle if necessary</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">.</span>componentWillMount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    renderedElement <span class=\"token operator\">=</span> publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Component function</span>\n    renderedElement <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// This is recursive but we'll eventually reach the bottom of recursion when</span>\n  <span class=\"token comment\">// the element is host (e.g. &lt;div /&gt;) rather than composite (e.g. &lt;App /&gt;):</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span>renderedElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// This function only handles elements with a host type.</span>\n<span class=\"token comment\">// For example, it handles &lt;div /&gt; and &lt;p /&gt; but not an &lt;App /&gt;.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">mountHost</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> children <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>children<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  children <span class=\"token operator\">=</span> children<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>Boolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// This block of code shouldn't be in the reconciler.</span>\n  <span class=\"token comment\">// Different renderers might initialize nodes differently.</span>\n  <span class=\"token comment\">// For example, React Native would create iOS or Android views.</span>\n  <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">propName</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propName <span class=\"token operator\">!==</span> <span class=\"token string\">'children'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Mount the children</span>\n  children<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">childElement</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Children may be host (e.g. &lt;div /&gt;) or composite (e.g. &lt;Button /&gt;).</span>\n    <span class=\"token comment\">// We will also mount them recursively:</span>\n    <span class=\"token keyword\">var</span> childNode <span class=\"token operator\">=</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span>childElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// This line of code is also renderer-specific.</span>\n    <span class=\"token comment\">// It would be different depending on the renderer:</span>\n    node<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Return the DOM node as mount result.</span>\n  <span class=\"token comment\">// This is where the recursion ends.</span>\n  <span class=\"token keyword\">return</span> node<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// User-defined components</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">mountComposite</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Platform-specific components</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">mountHost</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrootEl<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This is working but still far from how the reconciler is really implemented. The key missing ingredient is support for updates.</p>\n<h3 id=\"introducing-internal-instances\"><a class=\"anchor\" href=\"/react/implementation-notes#introducing-internal-instances\"></a>Introducing Internal Instances </h3>\n<p>The key feature of React is that you can re-render everything, and it won\u2019t recreate the DOM or reset the state:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">root<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Should reuse the existing DOM:</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>However, our implementation above only knows how to mount the initial tree. It can\u2019t perform updates on it because it doesn\u2019t store all the necessary information, such as all the <code class=\"language-javascript\">publicInstance</code>s, or which DOM <code class=\"language-javascript\">node</code>s correspond to which components.</p>\n<p>The stack reconciler codebase solves this by making the <code class=\"language-javascript\">mount()</code> function a method and putting it on a class. There are drawbacks to this approach, and we are going in the opposite direction in the <a href=\"/react/codebase-overview#fiber-reconciler\">ongoing rewrite of the reconciler</a>. Nevertheless this is how it works now.</p>\n<p>Instead of separate <code class=\"language-javascript\">mountHost</code> and <code class=\"language-javascript\">mountComposite</code> functions, we will create two classes: <code class=\"language-javascript\">DOMComponent</code> and <code class=\"language-javascript\">CompositeComponent</code>.</p>\n<p>Both classes have a constructor accepting the <code class=\"language-javascript\">element</code>, as well as a <code class=\"language-javascript\">mount()</code> method returning the mounted node. We will replace a top-level <code class=\"language-javascript\">mount()</code> function with a factory that instantiates the correct class:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// User-defined components</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CompositeComponent</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Platform-specific components</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMComponent</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>First, let\u2019s consider the implementation of <code class=\"language-javascript\">CompositeComponent</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CompositeComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement <span class=\"token operator\">=</span> element<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// For composite components, expose the class instance.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicInstance<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> publicInstance<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> renderedElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Component class</span>\n      publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// Set the props</span>\n      publicInstance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// Call the lifecycle if necessary</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">.</span>componentWillMount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      renderedElement <span class=\"token operator\">=</span> publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Component function</span>\n      publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      renderedElement <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Save the public instance</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicInstance <span class=\"token operator\">=</span> publicInstance<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Instantiate the child internal instance according to the element.</span>\n    <span class=\"token comment\">// It would be a DOMComponent for &lt;div /&gt; or &lt;p /&gt;,</span>\n    <span class=\"token comment\">// and a CompositeComponent for &lt;App /&gt; or &lt;Button /&gt;:</span>\n    <span class=\"token keyword\">var</span> renderedComponent <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>renderedElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent <span class=\"token operator\">=</span> renderedComponent<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Mount the rendered output</span>\n    <span class=\"token keyword\">return</span> renderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This is not much different from our previous <code class=\"language-javascript\">mountComposite()</code> implementation, but now we can save some information, such as <code class=\"language-javascript\">this.currentElement</code>, <code class=\"language-javascript\">this.renderedComponent</code>, and <code class=\"language-javascript\">this.publicInstance</code>, for use during updates.</p>\n<p>Note that an instance of <code class=\"language-javascript\">CompositeComponent</code> is not the same thing as an instance of the user-supplied <code class=\"language-javascript\">element.type</code>. <code class=\"language-javascript\">CompositeComponent</code> is an implementation detail of our reconciler, and is never exposed to the user. The user-defined class is the one we read from <code class=\"language-javascript\">element.type</code>, and <code class=\"language-javascript\">CompositeComponent</code> creates an instance of it.</p>\n<p>To avoid the confusion, we will call instances of <code class=\"language-javascript\">CompositeComponent</code> and <code class=\"language-javascript\">DOMComponent</code> \u201cinternal instances\u201d. They exist so we can associate some long-lived data with them. Only the renderer and the reconciler are aware that they exist.</p>\n<p>In contrast, we call an instance of the user-defined class a \u201cpublic instance\u201d. The public instance is what you see as <code class=\"language-javascript\">this</code> in the <code class=\"language-javascript\">render()</code> and other methods of your custom components.</p>\n<p>The <code class=\"language-javascript\">mountHost()</code> function, refactored to be a <code class=\"language-javascript\">mount()</code> method on <code class=\"language-javascript\">DOMComponent</code> class, also looks familiar:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DOMComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement <span class=\"token operator\">=</span> element<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedChildren <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// For DOM components, only expose the DOM node.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> children <span class=\"token operator\">=</span> props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>children<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Create and save the node</span>\n    <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Set the attributes</span>\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">propName</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propName <span class=\"token operator\">!==</span> <span class=\"token string\">'children'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Create and save the contained children.</span>\n    <span class=\"token comment\">// Each of them can be a DOMComponent or a CompositeComponent,</span>\n    <span class=\"token comment\">// depending on whether the element type is a string or a function.</span>\n    <span class=\"token keyword\">var</span> renderedChildren <span class=\"token operator\">=</span> children<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>instantiateComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedChildren <span class=\"token operator\">=</span> renderedChildren<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Collect DOM nodes they return on mount</span>\n    <span class=\"token keyword\">var</span> childNodes <span class=\"token operator\">=</span> renderedChildren<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span> <span class=\"token operator\">=&gt;</span> child<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    childNodes<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">childNode</span> <span class=\"token operator\">=&gt;</span> node<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Return the DOM node as mount result</span>\n    <span class=\"token keyword\">return</span> node<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The main difference after refactoring from <code class=\"language-javascript\">mountHost()</code> is that we now keep <code class=\"language-javascript\">this.node</code> and <code class=\"language-javascript\">this.renderedChildren</code> associated with the internal DOM component instance. We will also use them for applying non-destructive updates in the future.</p>\n<p>As a result, each internal instance, composite or host, now points to its child internal instances. To help visualize this, if a function <code class=\"language-javascript\">&lt;App&gt;</code> component renders a <code class=\"language-javascript\">&lt;Button&gt;</code> class component, and <code class=\"language-javascript\">Button</code> class renders a <code class=\"language-javascript\">&lt;div&gt;</code>, the internal instance tree would look like this:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>object CompositeComponent<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">currentElement</span><span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">publicInstance</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">renderedComponent</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>object CompositeComponent<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">currentElement</span><span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">publicInstance</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>object Button<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">renderedComponent</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>object DOMComponent<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">currentElement</span><span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">node</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>object HTMLDivElement<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">renderedChildren</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In the DOM you would only see the <code class=\"language-javascript\">&lt;div&gt;</code>. However the internal instance tree contains both composite and host internal instances.</p>\n<p>The composite internal instances need to store:</p>\n<ul>\n<li>The current element.</li>\n<li>The public instance if element type is a class.</li>\n<li>The single rendered internal instance. It can be either a <code class=\"language-javascript\">DOMComponent</code> or a <code class=\"language-javascript\">CompositeComponent</code>.</li>\n</ul>\n<p>The host internal instances need to store:</p>\n<ul>\n<li>The current element.</li>\n<li>The DOM node.</li>\n<li>All the child internal instances. Each of them can be either a <code class=\"language-javascript\">DOMComponent</code> or a <code class=\"language-javascript\">CompositeComponent</code>.</li>\n</ul>\n<p>If you\u2019re struggling to imagine how an internal instance tree is structured in more complex applications, <a class=\"external-link\" href=\"https://github.com/facebook/react-devtools\">React DevTools</a> can give you a close approximation, as it highlights host instances with grey, and composite instances with purple:</p>\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/d96fec10d250eace9756f09543bf5d58/00d43/implementation-notes-tree.png\">\n<span class=\"gatsby-resp-image-wrapper\">\n<span class=\"gatsby-resp-image-background-image\">\n<a class=\"external-link\" href=\"https://zh-hant.reactjs.org//static/d96fec10d250eace9756f09543bf5d58/1e088/implementation-notes-tree.png\">Image link</a>\n</span>\n</span>\n</a>\n<p>To complete this refactoring, we will introduce a function that mounts a complete tree into a container node and a public instance:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> containerNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Create the top-level internal instance</span>\n  <span class=\"token keyword\">var</span> rootComponent <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Mount the top-level component into the container</span>\n  <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> rootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  containerNode<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Return the public instance it provides</span>\n  <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> rootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> publicInstance<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"unmounting\"><a class=\"anchor\" href=\"/react/implementation-notes#unmounting\"></a>Unmounting </h3>\n<p>Now that we have internal instances that hold onto their children and the DOM nodes, we can implement unmounting. For a composite component, unmounting calls a lifecycle method and recurses.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CompositeComponent</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Call the lifecycle method if necessary</span>\n    <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicInstance<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">.</span>componentWillUnmount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Unmount the single rendered component</span>\n    <span class=\"token keyword\">var</span> renderedComponent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent<span class=\"token punctuation\">;</span>\n    renderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For <code class=\"language-javascript\">DOMComponent</code>, unmounting tells each child to unmount:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DOMComponent</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Unmount all the children</span>\n    <span class=\"token keyword\">var</span> renderedChildren <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedChildren<span class=\"token punctuation\">;</span>\n    renderedChildren<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span> <span class=\"token operator\">=&gt;</span> child<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In practice, unmounting DOM components also removes the event listeners and clears some caches, but we will skip those details.</p>\n<p>We can now add a new top-level function called <code class=\"language-javascript\">unmountTree(containerNode)</code> that is similar to <code class=\"language-javascript\">ReactDOM.unmountComponentAtNode()</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">unmountTree</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">containerNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Read the internal instance from a DOM node:</span>\n  <span class=\"token comment\">// (This doesn't work yet, we will need to change mountTree() to store it.)</span>\n  <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> containerNode<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> rootComponent <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>_internalInstance<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Unmount the tree and clear the container</span>\n  rootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  containerNode<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In order for this to work, we need to read an internal root instance from a DOM node. We will modify <code class=\"language-javascript\">mountTree()</code> to add the <code class=\"language-javascript\">_internalInstance</code> property to the root DOM node. We will also teach <code class=\"language-javascript\">mountTree()</code> to destroy any existing tree so it can be called multiple times:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> containerNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Destroy any existing tree</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>containerNode<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">unmountTree</span><span class=\"token punctuation\">(</span>containerNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Create the top-level internal instance</span>\n  <span class=\"token keyword\">var</span> rootComponent <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Mount the top-level component into the container</span>\n  <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> rootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  containerNode<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Save a reference to the internal instance</span>\n  node<span class=\"token punctuation\">.</span>_internalInstance <span class=\"token operator\">=</span> rootComponent<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Return the public instance it provides</span>\n  <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> rootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> publicInstance<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now, running <code class=\"language-javascript\">unmountTree()</code>, or running <code class=\"language-javascript\">mountTree()</code> repeatedly, removes the old tree and runs the <code class=\"language-javascript\">componentWillUnmount()</code> lifecycle method on components.</p>\n<h3 id=\"updating\"><a class=\"anchor\" href=\"/react/implementation-notes#updating\"></a>Updating </h3>\n<p>In the previous section, we implemented unmounting. However React wouldn\u2019t be very useful if each prop change unmounted and mounted the whole tree. The goal of the reconciler is to reuse existing instances where possible to preserve the DOM and the state:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Should reuse the existing DOM:</span>\n<span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We will extend our internal instance contract with one more method. In addition to <code class=\"language-javascript\">mount()</code> and <code class=\"language-javascript\">unmount()</code>, both <code class=\"language-javascript\">DOMComponent</code> and <code class=\"language-javascript\">CompositeComponent</code> will implement a new method called <code class=\"language-javascript\">receive(nextElement)</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CompositeComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">DOMComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Its job is to do whatever is necessary to bring the component (and any of its children) up to date with the description provided by the <code class=\"language-javascript\">nextElement</code>.</p>\n<p>This is the part that is often described as \u201cvirtual DOM diffing\u201d although what really happens is that we walk the internal tree recursively and let each internal instance receive an update.</p>\n<h3 id=\"updating-composite-components\"><a class=\"anchor\" href=\"/react/implementation-notes#updating-composite-components\"></a>Updating Composite Components </h3>\n<p>When a composite component receives a new element, we run the <code class=\"language-javascript\">componentWillUpdate()</code> lifecycle method.</p>\n<p>Then we re-render the component with the new props, and get the next rendered element:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CompositeComponent</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> prevProps <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> publicInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicInstance<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevRenderedComponent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevRenderedElement <span class=\"token operator\">=</span> prevRenderedComponent<span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Update *own* element</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement <span class=\"token operator\">=</span> nextElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> nextElement<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> nextProps <span class=\"token operator\">=</span> nextElement<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Figure out what the next render() output is</span>\n    <span class=\"token keyword\">var</span> nextRenderedElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isClass</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Component class</span>\n      <span class=\"token comment\">// Call the lifecycle if necessary</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publicInstance<span class=\"token punctuation\">.</span>componentWillUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">componentWillUpdate</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\">// Update the props</span>\n      publicInstance<span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> nextProps<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// Re-render</span>\n      nextRenderedElement <span class=\"token operator\">=</span> publicInstance<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Component function</span>\n      nextRenderedElement <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>Next, we can look at the rendered element\u2019s <code class=\"language-javascript\">type</code>. If the <code class=\"language-javascript\">type</code> has not changed since the last render, the component below can also be updated in place.</p>\n<p>For example, if it returned <code class=\"language-javascript\">&lt;Button color=\"red\" /&gt;</code> the first time, and <code class=\"language-javascript\">&lt;Button color=\"blue\" /&gt;</code> the second time, we can just tell the corresponding internal instance to <code class=\"language-javascript\">receive()</code> the next element:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// If the rendered element type has not changed,</span>\n    <span class=\"token comment\">// reuse the existing component instance and exit.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevRenderedElement<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> nextRenderedElement<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      prevRenderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span>nextRenderedElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>However, if the next rendered element has a different <code class=\"language-javascript\">type</code> than the previously rendered element, we can\u2019t update the internal instance. A <code class=\"language-javascript\">&lt;button&gt;</code> can\u2019t \u201cbecome\u201d an <code class=\"language-javascript\">&lt;input&gt;</code>.</p>\n<p>Instead, we have to unmount the existing internal instance and mount the new one corresponding to the rendered element type. For example, this is what happens when a component that previously rendered a <code class=\"language-javascript\">&lt;button /&gt;</code> renders an <code class=\"language-javascript\">&lt;input /&gt;</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// If we reached this point, we need to unmount the previously</span>\n    <span class=\"token comment\">// mounted component, mount the new one, and swap their nodes.</span>\n\n    <span class=\"token comment\">// Find the old node because it will need to be replaced</span>\n    <span class=\"token keyword\">var</span> prevNode <span class=\"token operator\">=</span> prevRenderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Unmount the old child and mount a new child</span>\n    prevRenderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> nextRenderedComponent <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>nextRenderedElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> nextNode <span class=\"token operator\">=</span> nextRenderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Replace the reference to the child</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent <span class=\"token operator\">=</span> nextRenderedComponent<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Replace the old node with the new one</span>\n    <span class=\"token comment\">// Note: this is renderer-specific code and</span>\n    <span class=\"token comment\">// ideally should live outside of CompositeComponent:</span>\n    prevNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">replaceChild</span><span class=\"token punctuation\">(</span>nextNode<span class=\"token punctuation\">,</span> prevNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To sum this up, when a composite component receives a new element, it may either delegate the update to its rendered internal instance, or unmount it and mount a new one in its place.</p>\n<p>There is another condition under which a component will re-mount rather than receive an element, and that is when the element\u2019s <code class=\"language-javascript\">key</code> has changed. We don\u2019t discuss <code class=\"language-javascript\">key</code> handling in this document because it adds more complexity to an already complex tutorial.</p>\n<p>Note that we needed to add a method called <code class=\"language-javascript\">getHostNode()</code> to the internal instance contract so that it\u2019s possible to locate the platform-specific node and replace it during the update. Its implementation is straightforward for both classes:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CompositeComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Ask the rendered component to provide it.</span>\n    <span class=\"token comment\">// This will recursively drill down any composites.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedComponent<span class=\"token punctuation\">.</span><span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">DOMComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"updating-host-components\"><a class=\"anchor\" href=\"/react/implementation-notes#updating-host-components\"></a>Updating Host Components </h3>\n<p>Host component implementations, such as <code class=\"language-javascript\">DOMComponent</code>, update differently. When they receive an element, they need to update the underlying platform-specific view. In case of React DOM, this means updating the DOM attributes:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DOMComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextElement</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevElement <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevProps <span class=\"token operator\">=</span> prevElement<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> nextProps <span class=\"token operator\">=</span> nextElement<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>    \n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentElement <span class=\"token operator\">=</span> nextElement<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Remove old attributes.</span>\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">propName</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propName <span class=\"token operator\">!==</span> <span class=\"token string\">'children'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>nextProps<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span><span class=\"token function\">removeAttribute</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Set next attributes.</span>\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">propName</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propName <span class=\"token operator\">!==</span> <span class=\"token string\">'children'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span>propName<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>Then, host components need to update their children. Unlike composite components, they might contain more than a single child.</p>\n<p>In this simplified example, we use an array of internal instances and iterate over it, either updating or replacing the internal instances depending on whether the received <code class=\"language-javascript\">type</code> matches their previous <code class=\"language-javascript\">type</code>. The real reconciler also takes element\u2019s <code class=\"language-javascript\">key</code> in the account and track moves in addition to insertions and deletions, but we will omit this logic.</p>\n<p>We collect DOM operations on children in a list so we can execute them in batch:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// These are arrays of React elements:</span>\n    <span class=\"token keyword\">var</span> prevChildren <span class=\"token operator\">=</span> prevProps<span class=\"token punctuation\">.</span>children <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>prevChildren<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      prevChildren <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>prevChildren<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">var</span> nextChildren <span class=\"token operator\">=</span> nextProps<span class=\"token punctuation\">.</span>children <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>nextChildren<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      nextChildren <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>nextChildren<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// These are arrays of internal instances:</span>\n    <span class=\"token keyword\">var</span> prevRenderedChildren <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedChildren<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> nextRenderedChildren <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// As we iterate over children, we will add operations to the array.</span>\n    <span class=\"token keyword\">var</span> operationQueue <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Note: the section below is extremely simplified!</span>\n    <span class=\"token comment\">// It doesn't handle reorders, children with holes, or keys.</span>\n    <span class=\"token comment\">// It only exists to illustrate the overall flow, not the specifics.</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> nextChildren<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Try to get an existing internal instance for this child</span>\n      <span class=\"token keyword\">var</span> prevChild <span class=\"token operator\">=</span> prevRenderedChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// If there is no internal instance under this index,</span>\n      <span class=\"token comment\">// a child has been appended to the end. Create a new</span>\n      <span class=\"token comment\">// internal instance, mount it, and use its node.</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>prevChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> nextChild <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>nextChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> nextChild<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Record that we need to append a node</span>\n        operationQueue<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        nextRenderedChildren<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>nextChild<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// We can only update the instance if its element's type matches.</span>\n      <span class=\"token comment\">// For example, &lt;Button size=\"small\" /&gt; can be updated to</span>\n      <span class=\"token comment\">// &lt;Button size=\"large\" /&gt; but not to an &lt;App /&gt;.</span>\n      <span class=\"token keyword\">var</span> canUpdate <span class=\"token operator\">=</span> prevChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> nextChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// If we can't update an existing instance, we have to unmount it</span>\n      <span class=\"token comment\">// and mount a new one instead of it.</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>canUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> prevNode <span class=\"token operator\">=</span> prevChild<span class=\"token punctuation\">.</span><span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        prevChild<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">var</span> nextChild <span class=\"token operator\">=</span> <span class=\"token function\">instantiateComponent</span><span class=\"token punctuation\">(</span>nextChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> nextNode <span class=\"token operator\">=</span> nextChild<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Record that we need to swap the nodes</span>\n        operationQueue<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'REPLACE'</span><span class=\"token punctuation\">,</span> prevNode<span class=\"token punctuation\">,</span> nextNode<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        nextRenderedChildren<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>nextChild<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// If we can update an existing internal instance,</span>\n      <span class=\"token comment\">// just let it receive the next element and handle its own update.</span>\n      prevChild<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span>nextChildren<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      nextRenderedChildren<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>prevChild<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Finally, unmount any children that don't exist:</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> j <span class=\"token operator\">=</span> nextChildren<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> prevChildren<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> prevChild <span class=\"token operator\">=</span> prevRenderedChildren<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> prevChild<span class=\"token punctuation\">.</span><span class=\"token function\">getHostNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      prevChild<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Record that we need to remove the node</span>\n      operationQueue<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'REMOVE'</span><span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Point the list of rendered children to the updated version.</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderedChildren <span class=\"token operator\">=</span> nextRenderedChildren<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// ...</span></code></pre></div>\n<p>As the last step, we execute the DOM operations. Again, the real reconciler code is more complex because it also handles moves:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// Process the operation queue.</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>operationQueue<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> operation <span class=\"token operator\">=</span> operationQueue<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>operation<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'ADD'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>operation<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'REPLACE'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">replaceChild</span><span class=\"token punctuation\">(</span>operation<span class=\"token punctuation\">.</span>nextNode<span class=\"token punctuation\">,</span> operation<span class=\"token punctuation\">.</span>prevNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'REMOVE'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>operation<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And that is it for updating host components.</p>\n<h3 id=\"top-level-updates\"><a class=\"anchor\" href=\"/react/implementation-notes#top-level-updates\"></a>Top-Level Updates </h3>\n<p>Now that both <code class=\"language-javascript\">CompositeComponent</code> and <code class=\"language-javascript\">DOMComponent</code> implement the <code class=\"language-javascript\">receive(nextElement)</code> method, we can change the top-level <code class=\"language-javascript\">mountTree()</code> function to use it when the element <code class=\"language-javascript\">type</code> is the same as it was the last time:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> containerNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Check for an existing tree</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>containerNode<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> prevNode <span class=\"token operator\">=</span> containerNode<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevRootComponent <span class=\"token operator\">=</span> prevNode<span class=\"token punctuation\">.</span>_internalInstance<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> prevElement <span class=\"token operator\">=</span> prevRootComponent<span class=\"token punctuation\">.</span>currentElement<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// If we can, reuse the existing root component</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevElement<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> element<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      prevRootComponent<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Otherwise, unmount the existing tree</span>\n    <span class=\"token function\">unmountTree</span><span class=\"token punctuation\">(</span>containerNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now calling <code class=\"language-javascript\">mountTree()</code> two times with the same type isn\u2019t destructive:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Reuses the existing DOM:</span>\n<span class=\"token function\">mountTree</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token punctuation\">,</span> rootEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>These are the basics of how React works internally.</p>\n<h3 id=\"what-we-left-out\"><a class=\"anchor\" href=\"/react/implementation-notes#what-we-left-out\"></a>What We Left Out </h3>\n<p>This document is simplified compared to the real codebase. There are a few important aspects we didn\u2019t address:</p>\n<ul>\n<li>Components can render <code class=\"language-javascript\">null</code>, and the reconciler can handle \u201cempty slots\u201d in arrays and rendered output.</li>\n<li>The reconciler also reads <code class=\"language-javascript\">key</code> from the elements, and uses it to establish which internal instance corresponds to which element in an array. A bulk of complexity in the actual React implementation is related to that.</li>\n<li>In addition to composite and host internal instance classes, there are also classes for \u201ctext\u201d and \u201cempty\u201d components. They represent text nodes and the \u201cempty slots\u201d you get by rendering <code class=\"language-javascript\">null</code>.</li>\n<li>Renderers use <a href=\"/react/codebase-overview#dynamic-injection\">injection</a> to pass the host internal class to the reconciler. For example, React DOM tells the reconciler to use <code class=\"language-javascript\">ReactDOMComponent</code> as the host internal instance implementation.</li>\n<li>The logic for updating the list of children is extracted into a mixin called <code class=\"language-javascript\">ReactMultiChild</code> which is used by the host internal instance class implementations both in React DOM and React Native.</li>\n<li>The reconciler also implements support for <code class=\"language-javascript\">setState()</code> in composite components. Multiple updates inside event handlers get batched into a single update.</li>\n<li>The reconciler also takes care of attaching and detaching refs to composite components and host nodes.</li>\n<li>Lifecycle methods that are called after the DOM is ready, such as <code class=\"language-javascript\">componentDidMount()</code> and <code class=\"language-javascript\">componentDidUpdate()</code>, get collected into \u201ccallback queues\u201d and are executed in a single batch.</li>\n<li>React puts information about the current update into an internal object called \u201ctransaction\u201d. Transactions are useful for keeping track of the queue of pending lifecycle methods, the current DOM nesting for the warnings, and anything else that is \u201cglobal\u201d to a specific update. Transactions also ensure React \u201ccleans everything up\u201d after updates. For example, the transaction class provided by React DOM restores the input selection after any update.</li>\n</ul>\n<h3 id=\"jumping-into-the-code\"><a class=\"anchor\" href=\"/react/implementation-notes#jumping-into-the-code\"></a>Jumping into the Code </h3>\n<ul>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/dom/client/ReactMount.js\"><code class=\"language-javascript\">ReactMount</code></a> is where the code like <code class=\"language-javascript\">mountTree()</code> and <code class=\"language-javascript\">unmountTree()</code> from this tutorial lives. It takes care of mounting and unmounting top-level components. <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/native/ReactNativeMount.js\"><code class=\"language-javascript\">ReactNativeMount</code></a> is its React Native analog.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/dom/shared/ReactDOMComponent.js\"><code class=\"language-javascript\">ReactDOMComponent</code></a> is the equivalent of <code class=\"language-javascript\">DOMComponent</code> in this tutorial. It implements the host component class for React DOM renderer. <a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/native/ReactNativeBaseComponent.js\"><code class=\"language-javascript\">ReactNativeBaseComponent</code></a> is its React Native analog.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/shared/stack/reconciler/ReactCompositeComponent.js\"><code class=\"language-javascript\">ReactCompositeComponent</code></a> is the equivalent of <code class=\"language-javascript\">CompositeComponent</code> in this tutorial. It handles calling user-defined components and maintaining their state.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/shared/stack/reconciler/instantiateReactComponent.js\"><code class=\"language-javascript\">instantiateReactComponent</code></a> contains the switch that picks the right internal instance class to construct for an element. It is equivalent to <code class=\"language-javascript\">instantiateComponent()</code> in this tutorial.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/shared/stack/reconciler/ReactReconciler.js\"><code class=\"language-javascript\">ReactReconciler</code></a> is a wrapper with <code class=\"language-javascript\">mountComponent()</code>, <code class=\"language-javascript\">receiveComponent()</code>, and <code class=\"language-javascript\">unmountComponent()</code> methods. It calls the underlying implementations on the internal instances, but also includes some code around them that is shared by all internal instance implementations.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/shared/stack/reconciler/ReactChildReconciler.js\"><code class=\"language-javascript\">ReactChildReconciler</code></a> implements the logic for mounting, updating, and unmounting children according to the <code class=\"language-javascript\">key</code> of their elements.</li>\n<li><a class=\"external-link\" href=\"https://github.com/facebook/react/blob/83381c1673d14cd16cf747e34c945291e5518a86/src/renderers/shared/stack/reconciler/ReactMultiChild.js\"><code class=\"language-javascript\">ReactMultiChild</code></a> implements processing the operation queue for child insertions, deletions, and moves independently of the renderer.</li>\n<li><code class=\"language-javascript\">mount()</code>, <code class=\"language-javascript\">receive()</code>, and <code class=\"language-javascript\">unmount()</code> are really called <code class=\"language-javascript\">mountComponent()</code>, <code class=\"language-javascript\">receiveComponent()</code>, and <code class=\"language-javascript\">unmountComponent()</code> in React codebase for legacy reasons, but they receive elements.</li>\n<li>Properties on the internal instances start with an underscore, e.g. <code class=\"language-javascript\">_currentElement</code>. They are considered to be read-only public fields throughout the codebase.</li>\n</ul>\n<h3 id=\"future-directions\"><a class=\"anchor\" href=\"/react/implementation-notes#future-directions\"></a>Future Directions </h3>\n<p>Stack reconciler has inherent limitations such as being synchronous and unable to interrupt the work or split it in chunks. There is a work in progress on the <a href=\"/react/codebase-overview#fiber-reconciler\">new Fiber reconciler</a> with a <a class=\"external-link\" href=\"https://github.com/acdlite/react-fiber-architecture\">completely different architecture</a>. In the future, we intend to replace stack reconciler with it, but at the moment it is far from feature parity.</p>\n<h3 id=\"next-steps\"><a class=\"anchor\" href=\"/react/implementation-notes#next-steps\"></a>Next Steps </h3>\n<p>Read the <a href=\"/react/design-principles\">next section</a> to learn about the guiding principles we use for React development.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/implementation-notes.md\">Edit this page</a></p></div></article>", "path": "/react/implementation-notes", "nav": ["/react/codebase-overview", "/react/design-principles"]}, {"key": "\u8a2d\u8a08\u539f\u5247", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>We wrote this document so that you have a better idea of how we decide what React does and what React doesn\u2019t do, and what our development philosophy is like. While we are excited to see community contributions, we are not likely to choose a path that violates one or more of these principles.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>This document assumes a strong understanding of React. It describes the design principles of <em>React itself</em>, not React components or applications.</p>\n<p>For an introduction to React, check out <a href=\"/react/thinking-in-react\">Thinking in React</a> instead.</p>\n</div>\n<h3 id=\"composition\"><a class=\"anchor\" href=\"/react/design-principles#composition\"></a>Composition </h3>\n<p>The key feature of React is composition of components. Components written by different people should work well together. It is important to us that you can add functionality to a component without causing rippling changes throughout the codebase.</p>\n<p>For example, it should be possible to introduce some local state into a component without changing any of the components using it. Similarly, it should be possible to add some initialization and teardown code to any component when necessary.</p>\n<p>There is nothing \u201cbad\u201d about using state or lifecycle methods in components. Like any powerful feature, they should be used in moderation, but we have no intention to remove them. On the contrary, we think they are integral parts of what makes React useful. We might enable <a class=\"external-link\" href=\"https://github.com/reactjs/react-future/tree/master/07%20-%20Returning%20State\">more functional patterns</a> in the future, but both local state and lifecycle methods will be a part of that model.</p>\n<p>Components are often described as \u201cjust functions\u201d but in our view they need to be more than that to be useful. In React, components describe any composable behavior, and this includes rendering, lifecycle, and state. Some external libraries like <a class=\"external-link\" href=\"https://facebook.github.io/relay/\">Relay</a> augment components with other responsibilities such as describing data dependencies. It is possible that those ideas might make it back into React too in some form.</p>\n<h3 id=\"common-abstraction\"><a class=\"anchor\" href=\"/react/design-principles#common-abstraction\"></a>Common Abstraction </h3>\n<p>In general we <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=4anAwXYqLG8\">resist adding features</a> that can be implemented in userland. We don\u2019t want to bloat your apps with useless library code. However, there are exceptions to this.</p>\n<p>For example, if React didn\u2019t provide support for local state or lifecycle methods, people would create custom abstractions for them. When there are multiple abstractions competing, React can\u2019t enforce or take advantage of the properties of either of them. It has to work with the lowest common denominator.</p>\n<p>This is why sometimes we add features to React itself. If we notice that many components implement a certain feature in incompatible or inefficient ways, we might prefer to bake it into React. We don\u2019t do it lightly. When we do it, it\u2019s because we are confident that raising the abstraction level benefits the whole ecosystem. State, lifecycle methods, cross-browser event normalization are good examples of this.</p>\n<p>We always discuss such improvement proposals with the community. You can find some of those discussions by the <a class=\"external-link\" href=\"https://github.com/facebook/react/issues?q=is:open+is:issue+label:%22Type:+Big+Picture%22\">\u201cbig picture\u201d</a> label on the React issue tracker.</p>\n<h3 id=\"escape-hatches\"><a class=\"anchor\" href=\"/react/design-principles#escape-hatches\"></a>Escape Hatches </h3>\n<p>React is pragmatic. It is driven by the needs of the products written at Facebook. While it is influenced by some paradigms that are not yet fully mainstream such as functional programming, staying accessible to a wide range of developers with different skills and experience levels is an explicit goal of the project.</p>\n<p>If we want to deprecate a pattern that we don\u2019t like, it is our responsibility to consider all existing use cases for it and <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/07/13/mixins-considered-harmful.html\">educate the community about the alternatives</a> before we deprecate it. If some pattern that is useful for building apps is hard to express in a declarative way, we will <a href=\"/react/more-about-refs\">provide an imperative API</a> for it. If we can\u2019t figure out a perfect API for something that we found necessary in many apps, we will <a href=\"/react/legacy-context\">provide a temporary subpar working API</a> as long as it is possible to get rid of it later and it leaves the door open for future improvements.</p>\n<h3 id=\"stability\"><a class=\"anchor\" href=\"/react/design-principles#stability\"></a>Stability </h3>\n<p>We value API stability. At Facebook, we have more than 50 thousand components using React. Many other companies, including <a class=\"external-link\" href=\"https://twitter.com/\">Twitter</a> and <a class=\"external-link\" href=\"https://www.airbnb.com/\">Airbnb</a>, are also heavy users of React. This is why we are usually reluctant to change public APIs or behavior.</p>\n<p>However we think stability in the sense of \u201cnothing changes\u201d is overrated. It quickly turns into stagnation. Instead, we prefer the stability in the sense of \u201cIt is heavily used in production, and when something changes, there is a clear (and preferably automated) migration path.\u201d</p>\n<p>When we deprecate a pattern, we study its internal usage at Facebook and add deprecation warnings. They let us assess the impact of the change. Sometimes we back out if we see that it is too early, and we need to think more strategically about getting the codebases to the point where they are ready for this change.</p>\n<p>If we are confident that the change is not too disruptive and the migration strategy is viable for all use cases, we release the deprecation warning to the open source community. We are closely in touch with many users of React outside of Facebook, and we monitor popular open source projects and guide them in fixing those deprecations.</p>\n<p>Given the sheer size of the Facebook React codebase, successful internal migration is often a good indicator that other companies won\u2019t have problems either. Nevertheless sometimes people point out additional use cases we haven\u2019t thought of, and we add escape hatches for them or rethink our approach.</p>\n<p>We don\u2019t deprecate anything without a good reason. We recognize that sometimes deprecations warnings cause frustration but we add them because deprecations clean up the road for the improvements and new features that we and many people in the community consider valuable.</p>\n<p>For example, we added a <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//warnings/unknown-prop.html\">warning about unknown DOM props</a> in React 15.2.0. Many projects were affected by this. However fixing this warning is important so that we can introduce the support for <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/140\">custom attributes</a> to React. There is a reason like this behind every deprecation that we add.</p>\n<p>When we add a deprecation warning, we keep it for the rest of the current major version, and <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/02/19/new-versioning-scheme.html\">change the behavior in the next major version</a>. If there is a lot of repetitive manual work involved, we release a <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=d0pOgY8__JM\">codemod</a> script that automates most of the change. Codemods enable us to move forward without stagnation in a massive codebase, and we encourage you to use them as well.</p>\n<p>You can find the codemods that we released in the <a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod\">react-codemod</a> repository.</p>\n<h3 id=\"interoperability\"><a class=\"anchor\" href=\"/react/design-principles#interoperability\"></a>Interoperability </h3>\n<p>We place high value in interoperability with existing systems and gradual adoption. Facebook has a massive non-React codebase. Its website uses a mix of a server-side component system called XHP, internal UI libraries that came before React, and React itself. It is important to us that any product team can <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=BF58ZJ1ZQxY\">start using React for a small feature</a> rather than rewrite their code to bet on it.</p>\n<p>This is why React provides escape hatches to work with mutable models, and tries to work well together with other UI libraries. You can wrap an existing imperative UI into a declarative component, and vice versa. This is crucial for gradual adoption.</p>\n<h3 id=\"scheduling\"><a class=\"anchor\" href=\"/react/design-principles#scheduling\"></a>Scheduling </h3>\n<p>Even when your components are described as functions, when you use React you don\u2019t call them directly. Every component returns a <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2015/12/18/react-components-elements-and-instances.html#elements-describe-the-tree\">description of what needs to be rendered</a>, and that description may include both user-written components like <code class=\"language-javascript\">&lt;LikeButton&gt;</code> and platform-specific components like <code class=\"language-javascript\">&lt;div&gt;</code>. It is up to React to \u201cunroll\u201d <code class=\"language-javascript\">&lt;LikeButton&gt;</code> at some point in the future and actually apply changes to the UI tree according to the render results of the components recursively.</p>\n<p>This is a subtle distinction but a powerful one. Since you don\u2019t call that component function but let React call it, it means React has the power to delay calling it if necessary. In its current implementation React walks the tree recursively and calls render functions of the whole updated tree during a single tick. However in the future it might start <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/6170\">delaying some updates to avoid dropping frames</a>.</p>\n<p>This is a common theme in React design. Some popular libraries implement the \u201cpush\u201d approach where computations are performed when the new data is available. React, however, sticks to the \u201cpull\u201d approach where computations can be delayed until necessary.</p>\n<p>React is not a generic data processing library. It is a library for building user interfaces. We think that it is uniquely positioned in an app to know which computations are relevant right now and which are not.</p>\n<p>If something is offscreen, we can delay any logic related to it. If data is arriving faster than the frame rate, we can coalesce and batch updates. We can prioritize work coming from user interactions (such as an animation caused by a button click) over less important background work (such as rendering new content just loaded from the network) to avoid dropping frames.</p>\n<p>To be clear, we are not taking advantage of this right now. However the freedom to do something like this is why we prefer to have control over scheduling, and why <code class=\"language-javascript\">setState()</code> is asynchronous. Conceptually, we think of it as \u201cscheduling an update\u201d.</p>\n<p>The control over scheduling would be harder for us to gain if we let the user directly compose views with a \u201cpush\u201d based paradigm common in some variations of <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Functional_reactive_programming\">Functional Reactive Programming</a>. We want to own the \u201cglue\u201d code.</p>\n<p>It is a key goal for React that the amount of the user code that executes before yielding back into React is minimal. This ensures that React retains the capability to schedule and split work in chunks according to what it knows about the UI.</p>\n<p>There is an internal joke in the team that React should have been called \u201cSchedule\u201d because React does not want to be fully \u201creactive\u201d.</p>\n<h3 id=\"developer-experience\"><a class=\"anchor\" href=\"/react/design-principles#developer-experience\"></a>Developer Experience </h3>\n<p>Providing a good developer experience is important to us.</p>\n<p>For example, we maintain <a class=\"external-link\" href=\"https://github.com/facebook/react/tree/main/packages/react-devtools\">React DevTools</a> which let you inspect the React component tree in Chrome and Firefox. We have heard that it brings a big productivity boost both to the Facebook engineers and to the community.</p>\n<p>We also try to go an extra mile to provide helpful developer warnings. For example, React warns you in development if you nest tags in a way that the browser doesn\u2019t understand, or if you make a common typo in the API. Developer warnings and the related checks are the main reason why the development version of React is slower than the production version.</p>\n<p>The usage patterns that we see internally at Facebook help us understand what the common mistakes are, and how to prevent them early. When we add new features, we try to anticipate the common mistakes and warn about them.</p>\n<p>We are always looking out for ways to improve the developer experience. We love to hear your suggestions and accept your contributions to make it even better.</p>\n<h3 id=\"debugging\"><a class=\"anchor\" href=\"/react/design-principles#debugging\"></a>Debugging </h3>\n<p>When something goes wrong, it is important that you have breadcrumbs to trace the mistake to its source in the codebase. In React, props and state are those breadcrumbs.</p>\n<p>If you see something wrong on the screen, you can open React DevTools, find the component responsible for rendering, and then see if the props and state are correct. If they are, you know that the problem is in the component\u2019s <code class=\"language-javascript\">render()</code> function, or some function that is called by <code class=\"language-javascript\">render()</code>. The problem is isolated.</p>\n<p>If the state is wrong, you know that the problem is caused by one of the <code class=\"language-javascript\">setState()</code> calls in this file. This, too, is relatively simple to locate and fix because usually there are only a few <code class=\"language-javascript\">setState()</code> calls in a single file.</p>\n<p>If the props are wrong, you can traverse the tree up in the inspector, looking for the component that first \u201cpoisoned the well\u201d by passing bad props down.</p>\n<p>This ability to trace any UI to the data that produced it in the form of current props and state is very important to React. It is an explicit design goal that state is not \u201ctrapped\u201d in closures and combinators, and is available to React directly.</p>\n<p>While the UI is dynamic, we believe that synchronous <code class=\"language-javascript\">render()</code> functions of props and state turn debugging from guesswork into a boring but finite procedure. We would like to preserve this constraint in React even though it makes some use cases, like complex animations, harder.</p>\n<h3 id=\"configuration\"><a class=\"anchor\" href=\"/react/design-principles#configuration\"></a>Configuration </h3>\n<p>We find global runtime configuration options to be problematic.</p>\n<p>For example, it is occasionally requested that we implement a function like <code class=\"language-javascript\">React.configure(options)</code> or <code class=\"language-javascript\">React.register(component)</code>. However this poses multiple problems, and we are not aware of good solutions to them.</p>\n<p>What if somebody calls such a function from a third-party component library? What if one React app embeds another React app, and their desired configurations are incompatible? How can a third-party component specify that it requires a particular configuration? We think that global configuration doesn\u2019t work well with composition. Since composition is central to React, we don\u2019t provide global configuration in code.</p>\n<p>We do, however, provide some global configuration on the build level. For example, we provide separate development and production builds. We may also <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/6627\">add a profiling build</a> in the future, and we are open to considering other build flags.</p>\n<h3 id=\"beyond-the-dom\"><a class=\"anchor\" href=\"/react/design-principles#beyond-the-dom\"></a>Beyond the DOM </h3>\n<p>We see the value of React in the way it allows us to write components that have fewer bugs and compose together well. DOM is the original rendering target for React but <a class=\"external-link\" href=\"https://reactnative.dev/\">React Native</a> is just as important both to Facebook and the community.</p>\n<p>Being renderer-agnostic is an important design constraint of React. It adds some overhead in the internal representations. On the other hand, any improvements to the core translate across platforms.</p>\n<p>Having a single programming model lets us form engineering teams around products instead of platforms. So far the tradeoff has been worth it for us.</p>\n<h3 id=\"implementation\"><a class=\"anchor\" href=\"/react/design-principles#implementation\"></a>Implementation </h3>\n<p>We try to provide elegant APIs where possible. We are much less concerned with the implementation being elegant. The real world is far from perfect, and to a reasonable extent we prefer to put the ugly code into the library if it means the user does not have to write it. When we evaluate new code, we are looking for an implementation that is correct, performant and affords a good developer experience. Elegance is secondary.</p>\n<p>We prefer boring code to clever code. Code is disposable and often changes. So it is important that it <a class=\"external-link\" href=\"https://youtu.be/4anAwXYqLG8?t=13m9s\">doesn\u2019t introduce new internal abstractions unless absolutely necessary</a>. Verbose code that is easy to move around, change and remove is preferred to elegant code that is prematurely abstracted and hard to change.</p>\n<h3 id=\"optimized-for-tooling\"><a class=\"anchor\" href=\"/react/design-principles#optimized-for-tooling\"></a>Optimized for Tooling </h3>\n<p>Some commonly used APIs have verbose names. For example, we use <code class=\"language-javascript\">componentDidMount()</code> instead of <code class=\"language-javascript\">didMount()</code> or <code class=\"language-javascript\">onMount()</code>. This is <a class=\"external-link\" href=\"https://github.com/reactjs/react-future/issues/40#issuecomment-142442124\">intentional</a>. The goal is to make the points of interaction with the library highly visible.</p>\n<p>In a massive codebase like Facebook, being able to search for uses of specific APIs is very important. We value distinct verbose names, and especially for the features that should be used sparingly. For example, <code class=\"language-javascript\">dangerouslySetInnerHTML</code> is hard to miss in a code review.</p>\n<p>Optimizing for search is also important because of our reliance on <a class=\"external-link\" href=\"https://www.youtube.com/watch?v=d0pOgY8__JM\">codemods</a> to make breaking changes. We want it to be easy and safe to apply vast automated changes across the codebase, and unique verbose names help us achieve this. Similarly, distinctive names make it easy to write custom <a class=\"external-link\" href=\"https://github.com/yannickcr/eslint-plugin-react\">lint rules</a> about using React without worrying about potential false positives.</p>\n<p><a href=\"/react/introducing-jsx\">JSX</a> plays a similar role. While it is not required with React, we use it extensively at Facebook both for aesthetic and pragmatic reasons.</p>\n<p>In our codebase, JSX provides an unambiguous hint to the tools that they are dealing with a React element tree. This makes it possible to add build-time optimizations such as <a class=\"external-link\" href=\"https://babeljs.io/docs/en/babel-plugin-transform-react-constant-elements/\">hoisting constant elements</a>, safely lint and codemod internal component usage, and <a class=\"external-link\" href=\"https://github.com/facebook/react/pull/6771\">include JSX source location</a> into the warnings.</p>\n<h3 id=\"dogfooding\"><a class=\"anchor\" href=\"/react/design-principles#dogfooding\"></a>Dogfooding </h3>\n<p>We try our best to address the problems raised by the community. However we are likely to prioritize the issues that people are <em>also</em> experiencing internally at Facebook. Perhaps counter-intuitively, we think this is the main reason why the community can bet on React.</p>\n<p>Heavy internal usage gives us the confidence that React won\u2019t disappear tomorrow. React was created at Facebook to solve its problems. It brings tangible business value to the company and is used in many of its products. <a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Eating_your_own_dog_food\">Dogfooding</a> it means that our vision stays sharp and we have a focused direction going forward.</p>\n<p>This doesn\u2019t mean that we ignore the issues raised by the community. For example, we added support for <a href=\"/react/webcomponents\">web components</a> and <a class=\"external-link\" href=\"https://github.com/facebook/react/pull/6243\">SVG</a> to React even though we don\u2019t rely on either of them internally. We are actively <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/2686\">listening to your pain points</a> and <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/07/11/introducing-reacts-error-code-system.html\">address them</a> to the best of our ability. The community is what makes React special to us, and we are honored to contribute back.</p>\n<p>After releasing many open source projects at Facebook, we have learned that trying to make everyone happy at the same time produced projects with poor focus that didn\u2019t grow well. Instead, we found that picking a small audience and focusing on making them happy brings a positive net effect. That\u2019s exactly what we did with React, and so far solving the problems encountered by Facebook product teams has translated well to the open source community.</p>\n<p>The downside of this approach is that sometimes we fail to give enough focus to the things that Facebook teams don\u2019t have to deal with, such as the \u201cgetting started\u201d experience. We are acutely aware of this, and we are thinking of how to improve in a way that would benefit everyone in the community without making the same mistakes we did with open source projects before.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/design-principles.md\">Edit this page</a></p></div></article>", "path": "/react/design-principles", "nav": ["/react/implementation-notes", "/react/faq-ajax"]}]}, {"key": "FAQ", "values": [{"key": "AJAX \u548c API", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"how-can-i-make-an-ajax-call\"><a class=\"anchor\" href=\"/react/faq-ajax#how-can-i-make-an-ajax-call\"></a>AJAX \u600e\u9ebc\u7528\uff1f </h3>\n<p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u4f60\u559c\u6b61\u7684 AJAX \u51fd\u5f0f\u5eab\u4f86\u8207 React \u642d\u914d\u3002\u4e00\u4e9b\u6d41\u884c\u7684\u51fd\u5f0f\u5eab\u6709\uff1a<a class=\"external-link\" href=\"https://github.com/axios/axios\">Axios</a>\u3001<a class=\"external-link\" href=\"https://api.jquery.com/jQuery.ajax/\">jQuery AJAX</a> \u4ee5\u53ca\u700f\u89bd\u5668\u5167\u5efa\u7684 <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\">window.fetch</a>\u3002</p>\n<h3 id=\"where-in-the-component-lifecycle-should-i-make-an-ajax-call\"><a class=\"anchor\" href=\"/react/faq-ajax#where-in-the-component-lifecycle-should-i-make-an-ajax-call\"></a>\u61c9\u8a72\u5728 Component \u7684\u54ea\u500b\u751f\u547d\u9031\u671f\u4e2d\u4f7f\u7528 AJAX\uff1f </h3>\n<p>\u4f60\u61c9\u8a72\u5728 <a href=\"/react/react-component#mounting\"><code class=\"language-javascript\">componentDidMount</code></a> \u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5167\uff0c\u4f7f\u7528 AJAX \u547c\u53eb\u4f86\u586b\u5145\u8cc7\u6599\u3002\u5982\u6b64\u4e00\u4f86\uff0c\u4f60\u53ef\u4ee5\u5728\u6536\u5230\u8cc7\u6599\u6642\uff0c\u4f7f\u7528 <code class=\"language-javascript\">setState</code> \u4f86\u66f4\u65b0 Component\u3002</p>\n<h3 id=\"example-using-ajax-results-to-set-local-state\"><a class=\"anchor\" href=\"/react/faq-ajax#example-using-ajax-results-to-set-local-state\"></a>\u7bc4\u4f8b\uff1a\u5229\u7528 AJAX \u7684\u56de\u50b3\u503c\u4f86\u8a2d\u5b9a\u72c0\u614b </h3>\n<p>\u4f60\u61c9\u8a72\u5728 <code class=\"language-javascript\">componentDidMount</code> \u7684\u751f\u547d\u9031\u671f\u65b9\u6cd5\u5167\uff0c\u4f7f\u7528 AJAX \u547c\u53eb\u4f86\u586b\u5145\u8cc7\u6599\u3002\u5982\u6b64\u4e00\u4f86\uff0c\u4f60\u53ef\u4ee5\u5728\u6536\u5230\u8cc7\u6599\u6642\uff0c\u4f7f\u7528 <code class=\"language-javascript\">setState</code> \u4f86\u66f4\u65b0 Component\u3002</p>\n<p>\u5047\u8a2d API \u56de\u50b3\u7684 JSON \u7269\u4ef6\u5982\u4e0b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">{\n  \"items\": [\n    { \"id\": 1, \"name\": \"Apples\",  \"price\": \"$2\" },\n    { \"id\": 2, \"name\": \"Peaches\", \"price\": \"$5\" }\n  ]\n}</code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">isLoaded</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">items</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://api.example.com/items\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=&gt;</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">isLoaded</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">items</span><span class=\"token operator\">:</span> result<span class=\"token punctuation\">.</span>items\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// Note: it's important to handle errors here</span>\n        <span class=\"token comment\">// instead of a catch() block so that we don't swallow</span>\n        <span class=\"token comment\">// exceptions from actual bugs in components.</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">isLoaded</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            error\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> error<span class=\"token punctuation\">,</span> isLoaded<span class=\"token punctuation\">,</span> items <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Error: </span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isLoaded<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n              </span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here is the equivalent with <a class=\"external-link\" href=\"https://reactjs.org/docs/hooks-intro.html\">Hooks</a>: </p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">MyComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>error<span class=\"token punctuation\">,</span> setError<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isLoaded<span class=\"token punctuation\">,</span> setIsLoaded<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>items<span class=\"token punctuation\">,</span> setItems<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Note: the empty deps array [] means</span>\n  <span class=\"token comment\">// this useEffect will run once</span>\n  <span class=\"token comment\">// similar to componentDidMount()</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://api.example.com/items\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=&gt;</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setIsLoaded</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setItems</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// Note: it's important to handle errors here</span>\n        <span class=\"token comment\">// instead of a catch() block so that we don't swallow</span>\n        <span class=\"token comment\">// exceptions from actual bugs in components.</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setIsLoaded</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setError</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Error: </span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isLoaded<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-ajax.md\">Edit this page</a></p></div></article>", "path": "/react/faq-ajax", "nav": ["/react/design-principles", "/react/faq-build"]}, {"key": "Babel\u3001JSX \u548c\u69cb\u5efa\u6b65\u9a5f", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"do-i-need-to-use-jsx-with-react\"><a class=\"anchor\" href=\"/react/faq-build#do-i-need-to-use-jsx-with-react\"></a>\u6211\u9700\u8981\u5728 React \u4e2d\u4f7f\u7528 JSX \u55ce\uff1f </h3>\n<p>\u4e0d\u9700\u8981\uff01\u8acb\u53c3\u8003<a href=\"/react/react-without-jsx\">\u6c92\u6709 JSX \u7684 React</a> \u4f86\u4e86\u89e3\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"do-i-need-to-use-es6--with-react\"><a class=\"anchor\" href=\"/react/faq-build#do-i-need-to-use-es6--with-react\"></a>\u6211\u9700\u8981\u5728 React \u88e1\u4f7f\u7528 ES6 (+) \u55ce\uff1f </h3>\n<p>\u4e0d\u9700\u8981\uff01\u8acb\u53c3\u8003<a href=\"/react/react-without-es6\">\u6c92\u6709 ES6 \u7684 React</a> \u4f86\u4e86\u89e3\u66f4\u591a\u8cc7\u8a0a\u3002</p>\n<h3 id=\"how-can-i-write-comments-in-jsx\"><a class=\"anchor\" href=\"/react/faq-build#how-can-i-write-comments-in-jsx\"></a>\u5982\u4f55\u5728 JSX \u4e2d\u7de8\u5beb\u8a3b\u89e3\uff1f </h3>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Comment goes here */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\">!\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* It also works \n  for multi-line comments. */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\">! \n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre></div></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-build.md\">Edit this page</a></p></div></article>", "path": "/react/faq-build", "nav": ["/react/faq-ajax", "/react/faq-functions"]}, {"key": "\u50b3\u905e Function \u5230 Component", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"how-do-i-pass-an-event-handler-like-onclick-to-a-component\"><a class=\"anchor\" href=\"/react/faq-functions#how-do-i-pass-an-event-handler-like-onclick-to-a-component\"></a>How do I pass an event handler (like onClick) to a component? </h3>\n<p>Pass event handlers and other functions as props to child components:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre></div>\n<p>If you need to have access to the parent component in the handler, you also need to bind the function to the component instance (see below).</p>\n<h3 id=\"how-do-i-bind-a-function-to-a-component-instance\"><a class=\"anchor\" href=\"/react/faq-functions#how-do-i-bind-a-function-to-a-component-instance\"></a>How do I bind a function to a component instance? </h3>\n<p>There are several ways to make sure functions have access to component attributes like <code class=\"language-javascript\">this.props</code> and <code class=\"language-javascript\">this.state</code>, depending on which syntax and build steps you are using.</p>\n<h4 id=\"bind-in-constructor-es2015\"><a class=\"anchor\" href=\"/react/faq-functions#bind-in-constructor-es2015\"></a>Bind in Constructor (ES2015) </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Click happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"class-properties-es2022\"><a class=\"anchor\" href=\"/react/faq-functions#class-properties-es2022\"></a>Class Properties (ES2022) </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Click happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"bind-in-render\"><a class=\"anchor\" href=\"/react/faq-functions#bind-in-render\"></a>Bind in Render </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Click happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Using <code class=\"language-javascript\">Function.prototype.bind</code> in render creates a new function each time the component renders, which may have performance implications (see below).</p>\n</div>\n<h4 id=\"arrow-function-in-render\"><a class=\"anchor\" href=\"/react/faq-functions#arrow-function-in-render\"></a>Arrow Function in Render </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Click happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Using an arrow function in render creates a new function each time the component renders, which may break optimizations based on strict identity comparison.</p>\n</div>\n<h3 id=\"is-it-ok-to-use-arrow-functions-in-render-methods\"><a class=\"anchor\" href=\"/react/faq-functions#is-it-ok-to-use-arrow-functions-in-render-methods\"></a>Is it OK to use arrow functions in render methods? </h3>\n<p>Generally speaking, yes, it is OK, and it is often the easiest way to pass parameters to callback functions.</p>\n<p>If you do have performance issues, by all means, optimize!</p>\n<h3 id=\"why-is-binding-necessary-at-all\"><a class=\"anchor\" href=\"/react/faq-functions#why-is-binding-necessary-at-all\"></a>Why is binding necessary at all? </h3>\n<p>In JavaScript, these two code snippets are <strong>not</strong> equivalent:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\">obj<span class=\"token punctuation\">.</span><span class=\"token function\">method</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> method <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span>method<span class=\"token punctuation\">;</span>\n<span class=\"token function\">method</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Binding methods helps ensure that the second snippet works the same way as the first one.</p>\n<p>With React, typically you only need to bind the methods you <em>pass</em> to other components. For example, <code class=\"language-javascript\">&lt;button onClick={this.handleClick}&gt;</code> passes <code class=\"language-javascript\">this.handleClick</code> so you want to bind it. However, it is unnecessary to bind the <code class=\"language-javascript\">render</code> method or the lifecycle methods: we don\u2019t pass them to other components.</p>\n<p><a class=\"external-link\" href=\"https://yehudakatz.com/2011/08/11/understanding-javascript-function-invocation-and-this/\">This post by Yehuda Katz</a> explains what binding is, and how functions work in JavaScript, in detail.</p>\n<h3 id=\"why-is-my-function-being-called-every-time-the-component-renders\"><a class=\"anchor\" href=\"/react/faq-functions#why-is-my-function-being-called-every-time-the-component-renders\"></a>Why is my function being called every time the component renders? </h3>\n<p>Make sure you aren\u2019t <em>calling the function</em> when you pass it to the component:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Wrong: handleClick is called instead of passed as a reference!</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Instead, <em>pass the function itself</em> (without parens):</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Correct: handleClick is passed as a reference!</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Click Me</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"how-do-i-pass-a-parameter-to-an-event-handler-or-callback\"><a class=\"anchor\" href=\"/react/faq-functions#how-do-i-pass-a-parameter-to-an-event-handler-or-callback\"></a>How do I pass a parameter to an event handler or callback? </h3>\n<p>You can use an arrow function to wrap around an event handler and pass parameters:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<p>This is equivalent to calling <code class=\"language-javascript\">.bind</code>:</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/&gt;</span></span></code></pre></div>\n<h4 id=\"example-passing-params-using-arrow-functions\"><a class=\"anchor\" href=\"/react/faq-functions#example-passing-params-using-arrow-functions\"></a>Example: Passing params using arrow functions </h4>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> <span class=\"token number\">65</span> <span class=\"token comment\">// ASCII character code</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Alphabet</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">justClicked</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">letters</span><span class=\"token operator\">:</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">A</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">letter</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">justClicked</span><span class=\"token operator\">:</span> letter <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Just clicked: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>justClicked<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>letters<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">letter</span> <span class=\"token operator\">=&gt;</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>letter<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span>letter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n              </span><span class=\"token punctuation\">{</span>letter<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"example-passing-params-using-data-attributes\"><a class=\"anchor\" href=\"/react/faq-functions#example-passing-params-using-data-attributes\"></a>Example: Passing params using data-attributes </h4>\n<p>Alternately, you can use DOM APIs to store data needed for event handlers. Consider this approach if you need to optimize a large number of elements or have a render tree that relies on React.PureComponent equality checks.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> <span class=\"token number\">65</span> <span class=\"token comment\">// ASCII character code</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Alphabet</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">justClicked</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">letters</span><span class=\"token operator\">:</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">A</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">justClicked</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>letter\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        Just clicked: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>justClicked<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>letters<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">letter</span> <span class=\"token operator\">=&gt;</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>letter<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">data-letter</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>letter<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n              </span><span class=\"token punctuation\">{</span>letter<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"how-can-i-prevent-a-function-from-being-called-too-quickly-or-too-many-times-in-a-row\"><a class=\"anchor\" href=\"/react/faq-functions#how-can-i-prevent-a-function-from-being-called-too-quickly-or-too-many-times-in-a-row\"></a>How can I prevent a function from being called too quickly or too many times in a row? </h3>\n<p>If you have an event handler such as <code class=\"language-javascript\">onClick</code> or <code class=\"language-javascript\">onScroll</code> and want to prevent the callback from being fired too quickly, then you can limit the rate at which callback is executed. This can be done by using:</p>\n<ul>\n<li><strong>throttling</strong>: sample changes based on a time based frequency (eg <a class=\"external-link\" href=\"https://lodash.com/docs#throttle\"><code class=\"language-javascript\">_.throttle</code></a>)</li>\n<li><strong>debouncing</strong>: publish changes after a period of inactivity (eg <a class=\"external-link\" href=\"https://lodash.com/docs#debounce\"><code class=\"language-javascript\">_.debounce</code></a>)</li>\n<li><strong><code class=\"language-javascript\">requestAnimationFrame</code> throttling</strong>: sample changes based on <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\"><code class=\"language-javascript\">requestAnimationFrame</code></a> (eg <a class=\"external-link\" href=\"https://github.com/alexreardon/raf-schd\"><code class=\"language-javascript\">raf-schd</code></a>)</li>\n</ul>\n<p>See <a class=\"external-link\" href=\"http://demo.nimius.net/debounce_throttle/\">this visualization</a> for a comparison of <code class=\"language-javascript\">throttle</code> and <code class=\"language-javascript\">debounce</code> functions.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p><code class=\"language-javascript\">_.debounce</code>, <code class=\"language-javascript\">_.throttle</code> and <code class=\"language-javascript\">raf-schd</code> provide a <code class=\"language-javascript\">cancel</code> method to cancel delayed callbacks. You should either call this method from <code class=\"language-javascript\">componentWillUnmount</code> <em>or</em> check to ensure that the component is still mounted within the delayed function.</p>\n</div>\n<h4 id=\"throttle\"><a class=\"anchor\" href=\"/react/faq-functions#throttle\"></a>Throttle </h4>\n<p>Throttling prevents a function from being called more than once in a given window of time. The example below throttles a \u201cclick\u201d handler to prevent calling it more than once per second.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> throttle <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash.throttle'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LoadMoreButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickThrottled <span class=\"token operator\">=</span> <span class=\"token function\">throttle</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickThrottled<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickThrottled<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Load More</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">loadMore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"debounce\"><a class=\"anchor\" href=\"/react/faq-functions#debounce\"></a>Debounce </h4>\n<p>Debouncing ensures that a function will not be executed until after a certain amount of time has passed since it was last called. This can be useful when you have to perform some expensive calculation in response to an event that might dispatch rapidly (eg scroll or keyboard events). The example below debounces text input with a 250ms delay.</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> debounce <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash.debounce'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Searchbox</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>emitChangeDebounced <span class=\"token operator\">=</span> <span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>emitChange<span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>emitChangeDebounced<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Search...<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">defaultValue</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">emitChangeDebounced</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">emitChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"requestanimationframe-throttling\"><a class=\"anchor\" href=\"/react/faq-functions#requestanimationframe-throttling\"></a><code class=\"language-javascript\">requestAnimationFrame</code> throttling </h4>\n<p><a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\"><code class=\"language-javascript\">requestAnimationFrame</code></a> is a way of queuing a function to be executed in the browser at the optimal time for rendering performance. A function that is queued with <code class=\"language-javascript\">requestAnimationFrame</code> will fire in the next frame. The browser will work hard to ensure that there are 60 frames per second (60 fps). However, if the browser is unable to it will naturally <em>limit</em> the amount of frames in a second. For example, a device might only be able to handle 30 fps and so you will only get 30 frames in that second. Using <code class=\"language-javascript\">requestAnimationFrame</code> for throttling is a useful technique in that it prevents you from doing more than 60 updates in a second. If you are doing 100 updates in a second this creates additional work for the browser that the user will not see anyway.</p>\n<div class=\"blockquote\">\n<strong>Note:</strong>\n<p>Using this technique will only capture the last published value in a frame. You can see an example of how this optimization works on <a class=\"external-link\" href=\"https://developer.mozilla.org/en-US/docs/Web/Events/scroll\"><code class=\"language-javascript\">MDN</code></a></p>\n</div>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> rafSchedule <span class=\"token keyword\">from</span> <span class=\"token string\">'raf-schd'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ScrollListener</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleScroll <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleScroll</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Create a new function to schedule updates.</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scheduleUpdate <span class=\"token operator\">=</span> <span class=\"token function\">rafSchedule</span><span class=\"token punctuation\">(</span>\n      <span class=\"token parameter\">point</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onScroll</span><span class=\"token punctuation\">(</span>point<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleScroll</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// When we receive a scroll event, schedule an update.</span>\n    <span class=\"token comment\">// If we receive many updates within a frame, we'll only publish the latest value.</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">scheduleUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>clientY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Cancel any pending updates since we're unmounting.</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scheduleUpdate<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n        <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">overflow</span><span class=\"token operator\">:</span> <span class=\"token string\">'scroll'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onScroll</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleScroll<span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/my-huge-image.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"testing-your-rate-limiting\"><a class=\"anchor\" href=\"/react/faq-functions#testing-your-rate-limiting\"></a>Testing your rate limiting </h4>\n<p>When testing your rate limiting code works correctly it is helpful to have the ability to fast forward time. If you are using <a class=\"external-link\" href=\"https://facebook.github.io/jest/\"><code class=\"language-javascript\">jest</code></a> then you can use <a class=\"external-link\" href=\"https://facebook.github.io/jest/docs/en/timer-mocks.html\"><code class=\"language-javascript\">mock timers</code></a> to fast forward time. If you are using <code class=\"language-javascript\">requestAnimationFrame</code> throttling then you may find <a class=\"external-link\" href=\"https://github.com/alexreardon/raf-stub\"><code class=\"language-javascript\">raf-stub</code></a> to be a useful tool to control the ticking of animation frames.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-functions.md\">Edit this page</a></p></div></article>", "path": "/react/faq-functions", "nav": ["/react/faq-build", "/react/faq-state"]}, {"key": "Component State", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"what-does-setstate-do\"><a class=\"anchor\" href=\"/react/faq-state#what-does-setstate-do\"></a><code class=\"language-javascript\">setState</code> \u7684\u4f5c\u7528\uff1f </h3>\n<p><code class=\"language-javascript\">setState()</code> \u5b89\u6392\u5c0d component <code class=\"language-javascript\">state</code> object \u7684\u66f4\u65b0\u3002\u7576 state \u6539\u8b8a\u6642\uff0ccomponent \u6703\u85c9\u7531\u91cd\u65b0 render \u4f86\u56de\u61c9\u3002</p>\n<h3 id=\"what-is-the-difference-between-state-and-props\"><a class=\"anchor\" href=\"/react/faq-state#what-is-the-difference-between-state-and-props\"></a><code class=\"language-javascript\">state</code> \u548c <code class=\"language-javascript\">props</code> \u6709\u4ec0\u9ebc\u4e0d\u540c\uff1f </h3>\n<p><a href=\"/react/components-and-props\"><code class=\"language-javascript\">props</code></a>\uff08\u300cproperties\u300d\u7684\u7c21\u5beb\uff09\u548c <a href=\"/react/state-and-lifecycle\"><code class=\"language-javascript\">state</code></a> \u90fd\u662f\u7d14 JavaScript object\u3002\u96d6\u7136\u5169\u8005\u90fd\u64c1\u6709\u6703\u5f71\u97ff render \u8f38\u51fa\u7684\u8cc7\u8a0a\uff0c\u4f46\u5728\u4e00\u500b\u91cd\u8981\u65b9\u5411\u4e0a\u6709\u6240\u4e0d\u540c\uff1a<code class=\"language-javascript\">props</code> \u662f\u88ab\u50b3\u905e<em>\u9032</em> component\uff08\u985e\u4f3c\u65bc function \u7684\u53c3\u6578\uff09\uff0c\u800c <code class=\"language-javascript\">state</code> \u662f\u5728 component <em>\u5167\u90e8</em>\u88ab\u7ba1\u7406\uff08\u985e\u4f3c\u65bc\u5728 function \u4e2d\u5ba3\u544a\u4e2d\u7684\u8b8a\u6578\uff09\u3002</p>\n<p>\u9019\u88e1\u6709\u4e00\u4e9b\u5f88\u68d2\u7684\u8cc7\u6e90\uff0c\u53ef\u4ee5\u9032\u4e00\u6b65\u95b1\u8b80\u4f86\u4e86\u89e3\u4f7f\u7528 <code class=\"language-javascript\">props</code> \u548c <code class=\"language-javascript\">state</code> \u7684\u6642\u6a5f\uff1a</p>\n<ul>\n<li><a class=\"external-link\" href=\"https://github.com/uberVU/react-guide/blob/master/props-vs-state.md\">Props vs State</a></li>\n<li><a class=\"external-link\" href=\"https://lucybain.com/blog/2016/react-state-vs-pros/\">ReactJS: Props vs. State</a></li>\n</ul>\n<h3 id=\"why-is-setstate-giving-me-the-wrong-value\"><a class=\"anchor\" href=\"/react/faq-state#why-is-setstate-giving-me-the-wrong-value\"></a>\u70ba\u4ec0\u9ebc <code class=\"language-javascript\">setState</code> \u6703\u51fa\u73fe\u932f\u8aa4\u7684\u503c\uff1f </h3>\n<p>\u5728 React\uff0c<code class=\"language-javascript\">this.props</code> \u548c <code class=\"language-javascript\">this.state</code> \u90fd\u4ee3\u8868\u8a72 <em>render</em> \u7684\u503c\u3002\u4e5f\u5c31\u662f\u76ee\u524d\u87a2\u5e55\u4e0a\u7684\u5167\u5bb9\u3002</p>\n<p>\u547c\u53eb <code class=\"language-javascript\">setState</code> \u662f\u975e\u540c\u6b65\u7684 \u2014 \u4e0d\u8981\u5728\u547c\u53eb <code class=\"language-javascript\">setState</code> \u5f8c\u7acb\u5373\u4f9d\u8cf4 <code class=\"language-javascript\">this.state</code> \u53bb\u53cd\u6620\u65b0\u7684\u503c\u3002\u5982\u679c\u9700\u8981\u57fa\u65bc\u76ee\u524d state \u4f86\u8a08\u7b97\u503c\uff0c\u8acb\u50b3\u905e\u4e00\u500b\u66f4\u65b0\u7528\u7684 function \u800c\u4e0d\u662f object\uff08\u7d30\u7bc0\u8acb\u770b\u4e0b\u65b9\uff09\u3002</p>\n<p><em>\u4e0d\u6703</em>\u7b26\u5408\u9810\u671f\u7d50\u679c\u7684\u7a0b\u5f0f\u78bc\u7bc4\u4f8b\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Note: this will *not* work as intended.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">handleSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Let's say `this.state.count` starts at 0.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// When React re-renders the component, `this.state.count` will be 1, but you expected 3.</span>\n\n  <span class=\"token comment\">// This is because `incrementCount()` function above reads from `this.state.count`,</span>\n  <span class=\"token comment\">// but React doesn't update `this.state.count` until the component is re-rendered.</span>\n  <span class=\"token comment\">// So `incrementCount()` ends up reading `this.state.count` as 0 every time, and sets it to 1.</span>\n\n  <span class=\"token comment\">// The fix is described below!</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u95dc\u65bc\u5982\u4f55\u4fee\u6b63\u6b64\u554f\u984c\u7684\u8cc7\u8a0a\u8acb\u53c3\u8003\u4e0b\u65b9\u3002</p>\n<h3 id=\"how-do-i-update-state-with-values-that-depend-on-the-current-state\"><a class=\"anchor\" href=\"/react/faq-state#how-do-i-update-state-with-values-that-depend-on-the-current-state\"></a>\u5982\u4f55\u4f7f\u7528\u76ee\u524d state \u7684\u503c\u4f86\u66f4\u65b0 state\uff1f </h3>\n<p>\u5c07\u4e00\u500b function \u800c\u975e object \u50b3\u905e\u7d66 <code class=\"language-javascript\">setState</code>\uff0c\u4f86\u78ba\u4fdd\u547c\u53eb\u6642\u59cb\u7d42\u662f\u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 state\uff08\u8acb\u770b\u4e0b\u65b9\uff09\u3002</p>\n<h3 id=\"what-is-the-difference-between-passing-an-object-or-a-function-in-setstate\"><a class=\"anchor\" href=\"/react/faq-state#what-is-the-difference-between-passing-an-object-or-a-function-in-setstate\"></a>\u5728 <code class=\"language-javascript\">setState</code> \u4e2d\u50b3\u905e object \u6216 function \u6709\u4f55\u4e0d\u540c\uff1f </h3>\n<p>\u50b3\u905e\u4e00\u500b\u66f4\u65b0\u7528\u7684 function \u5141\u8a31\u4f60\u5728 updater \u5167\u5b58\u53d6\u76ee\u524d state \u7684\u503c\u3002\u7531\u65bc <code class=\"language-javascript\">setState</code> \u662f\u6279\u6b21\u8655\u7406\u547c\u53eb\u7684\uff0c\u9019\u8b93\u4f60\u80fd\u5920\u93c8\u7d50\u66f4\u65b0\u4e26\u78ba\u4fdd\u5b83\u5011\u4f9d\u5e8f\u5efa\u7acb\u800c\u4e0d\u6703\u7522\u751f\u885d\u7a81\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Important: read `state` instead of `this.state` when updating.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">handleSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Let's say `this.state.count` starts at 0.</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">incrementCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// If you read `this.state.count` now, it would still be 0.</span>\n  <span class=\"token comment\">// But when React re-renders the component, it will be 3.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"/react/react-component#setstate\">\u5b78\u7fd2\u66f4\u591a\u95dc\u65bc setState</a></p>\n<h3 id=\"when-is-setstate-asynchronous\"><a class=\"anchor\" href=\"/react/faq-state#when-is-setstate-asynchronous\"></a><code class=\"language-javascript\">setState</code> \u4f55\u6642\u662f\u975e\u540c\u6b65\uff1f </h3>\n<p>\u76ee\u524d <code class=\"language-javascript\">setState</code> \u5728 event handler \u4e2d\u662f\u975e\u540c\u6b65\u3002</p>\n<p>\u9019\u6703\u78ba\u4fdd <code class=\"language-javascript\">Child</code> \u4e0d\u6703\u91cd\u65b0 render \u5169\u6b21\uff0c\u50cf\u662f <code class=\"language-javascript\">Parent</code> \u548c <code class=\"language-javascript\">Child</code> \u5728\u4e00\u500b\u55ae\u6b21 click \u4e8b\u4ef6\u4e2d\u540c\u6642\u547c\u53eb <code class=\"language-javascript\">setState</code> \u7684\u4f8b\u5b50\u3002\u53d6\u800c\u4ee3\u4e4b\uff0cReact \u6703\u5728\u700f\u89bd\u5668\u4e8b\u4ef6\u7d50\u675f\u6642\u300c\u5237\u65b0\u300dstate \u7684\u66f4\u65b0\u3002\u9019\u5728\u5927\u578b\u61c9\u7528\u7a0b\u5f0f\u4e2d\u80fd\u7522\u751f\u986f\u8457\u7684\u6548\u80fd\u63d0\u5347\u3002</p>\n<p>\u9019\u662f\u4e00\u500b\u5be6\u4f5c\u7d30\u7bc0\u6240\u4ee5\u8acb\u907f\u514d\u76f4\u63a5\u4f9d\u61f6\u5b83\u3002\u672a\u4f86\u7684\u7248\u672c\u4e2d\uff0cReact \u5c07\u5728\u66f4\u591a\u60c5\u6cc1\u4e0b\u9810\u8a2d\u6279\u6b21\u8655\u7406\u66f4\u65b0\u3002</p>\n<h3 id=\"why-doesnt-react-update-thisstate-synchronously\"><a class=\"anchor\" href=\"/react/faq-state#why-doesnt-react-update-thisstate-synchronously\"></a>\u70ba\u4ec0\u9ebc React \u4e0d\u540c\u6b65\u5730\u66f4\u65b0 <code class=\"language-javascript\">this.state</code>\uff1f </h3>\n<p>\u5982\u540c\u5728\u524d\u9762\u7bc7\u5e45\u89e3\u91cb\u7684\uff0c\u5728\u958b\u59cb\u91cd\u65b0 render \u524d\uff0cReact \u610f\u5716\u300c\u7b49\u5f85\u300d\u76f4\u5230\u6240\u6709\u7684 component \u90fd\u5728\u5176 event handler \u4e2d\u547c\u53eb <code class=\"language-javascript\">setState()</code>\u3002\u85c9\u7531\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u91cd\u65b0 render \u4f86\u589e\u52a0\u6548\u80fd\u3002</p>\n<p>\u4e0d\u904e\uff0c\u4f60\u4e5f\u8a31\u4ecd\u60f3\u77e5\u9053\uff0c\u70ba\u4ec0\u9ebc React \u4e0d\u5728\u4e0d\u91cd\u65b0 render \u7684\u60c5\u6cc1\u4e0b\u7acb\u5373\u66f4\u65b0 <code class=\"language-javascript\">this.state</code> \u5c31\u597d\u3002</p>\n<p>\u6709 2 \u500b\u4e3b\u8981\u539f\u56e0\uff1a</p>\n<ul>\n<li>\u9019\u6703\u7834\u58de <code class=\"language-javascript\">props</code> \u548c <code class=\"language-javascript\">state</code> \u9593\u7684\u4e00\u81f4\u6027\uff0c\u9020\u6210\u96e3\u4ee5\u9664\u932f\u7684\u554f\u984c\u3002</li>\n<li>\u9019\u6703\u9020\u6210\u6211\u5011\u6b63\u5728\u7814\u7a76\u7684\u4e00\u4e9b\u65b0\u529f\u80fd\u96e3\u4ee5\u5be6\u73fe\u3002</li>\n</ul>\n<p>\u9019\u5247 <a class=\"external-link\" href=\"https://github.com/facebook/react/issues/11527#issuecomment-360199710\">GitHub \u8a55\u8ad6</a>\u4ee5\u5177\u9ad4\u7bc4\u4f8b\u4f86\u6df1\u5165\u63a2\u8a0e\u3002</p>\n<h3 id=\"should-i-use-a-state-management-library-like-redux-or-mobx\"><a class=\"anchor\" href=\"/react/faq-state#should-i-use-a-state-management-library-like-redux-or-mobx\"></a>\u6211\u61c9\u8a72\u4f7f\u7528 Redux \u6216 MobX \u4e4b\u985e\u7684\u72c0\u614b\u7ba1\u7406\u51fd\u5f0f\u5eab\u55ce\uff1f </h3>\n<p><a class=\"external-link\" href=\"https://redux.js.org/faq/general#when-should-i-use-redux\">\u770b\u60c5\u6cc1\u3002</a></p>\n<p>\u5728\u52a0\u5165\u984d\u5916\u7684\u51fd\u5f0f\u5eab\u524d\u5148\u4f86\u4e86\u89e3 React \u662f\u500b\u597d\u4e3b\u610f\u3002\u56e0\u70ba\u4f60\u53ef\u4ee5\u53ea\u7528 React \u5c31\u5efa\u7acb\u4e00\u500b\u5920\u8907\u96dc\u7684\u61c9\u7528\u7a0b\u5f0f\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-state.md\">Edit this page</a></p></div></article>", "path": "/react/faq-state", "nav": ["/react/faq-functions", "/react/faq-styling"]}, {"key": "\u6a23\u5f0f\u548c CSS", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"how-do-i-add-css-classes-to-components\"><a class=\"anchor\" href=\"/react/faq-styling#how-do-i-add-css-classes-to-components\"></a>\u5982\u4f55\u5728 Component \u4e2d\u52a0\u5165 CSS Class\uff1f </h3>\n<p>\u50b3\u905e\u4e00\u500b string \u4f5c\u70ba <code class=\"language-javascript\">className</code> \u7684 prop\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>menu navigation-menu<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Menu</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>\u901a\u5e38 CSS class \u6703\u4f9d\u8cf4 component \u7684 prop \u6216 state\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-jsx\"><code class=\"language-javascript\"><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> className <span class=\"token operator\">=</span> <span class=\"token string\">'menu'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    className <span class=\"token operator\">+=</span> <span class=\"token string\">' menu-active'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">Menu</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"blockquote\">\n<strong>\u5c0f\u6280\u5de7</strong>\n<p>\u5982\u679c\u4f60\u767c\u73fe\u4f60\u5e38\u5beb\u985e\u4f3c\u7684\u7a0b\u5f0f\u78bc\uff0c\u53ef\u4f7f\u7528 <a class=\"external-link\" href=\"https://www.npmjs.com/package/classnames#usage-with-reactjs\">classnames</a> \u51fd\u5f0f\u5eab\u7c21\u5316\u3002</p>\n</div>\n<h3 id=\"can-i-use-inline-styles\"><a class=\"anchor\" href=\"/react/faq-styling#can-i-use-inline-styles\"></a>\u53ef\u4ee5\u4f7f\u7528 Inline Style \u55ce\uff1f </h3>\n<p>\u53ef\u4ee5\uff0c\u8acb\u898b<a href=\"/react/dom-elements#style\">\u6b64\u8655</a> \u6587\u4ef6\u95dc\u65bc styling \u90e8\u5206\u3002</p>\n<h3 id=\"are-inline-styles-bad\"><a class=\"anchor\" href=\"/react/faq-styling#are-inline-styles-bad\"></a>Inline Style \u4e0d\u597d\u55ce\uff1f </h3>\n<p>CSS class \u901a\u5e38\u6bd4 inline style \u6548\u80fd\u66f4\u597d\u3002</p>\n<h3 id=\"what-is-css-in-js\"><a class=\"anchor\" href=\"/react/faq-styling#what-is-css-in-js\"></a>CSS-in-JS \u662f\u4ec0\u9ebc\uff1f </h3>\n<p>\u300cCSS-in-JS\u300d\u6307\u7684\u662f\u4f7f\u7528 JavaScript \u7d44\u6210 CSS \u800c\u975e\u5c07\u5176\u5b9a\u7fa9\u65bc\u5916\u90e8\u6a94\u6848\u7684\u4e00\u7a2e\u6a21\u5f0f\u3002</p>\n<p><em>\u8acb\u6ce8\u610f\u6b64\u529f\u80fd\u70ba\u7b2c\u4e09\u65b9\u51fd\u5f0f\u5eab\u6240\u63d0\u4f9b\uff0c\u4e26\u975e React \u7684\u4e00\u90e8\u4efd\u3002</em> React \u5c0d style \u662f\u5982\u4f55\u5b9a\u7fa9\u4e26\u7121\u610f\u898b\u3002\u82e5\u6709\u7591\u554f\uff0c\u7167\u5e38\u5730\u5c07\u4f60\u7684 style \u5b9a\u7fa9\u65bc\u53e6\u4e00\u500b <code class=\"language-javascript\">*.css</code> \u6a94\u6848\u4e2d\u7136\u5f8c\u4f7f\u7528 <a href=\"/react/dom-elements#classname\"><code class=\"language-javascript\">className</code></a> \u53bb\u5f15\u7528\u6703\u662f\u500b\u597d\u7684\u958b\u59cb\u3002</p>\n<h3 id=\"can-i-do-animations-in-react\"><a class=\"anchor\" href=\"/react/faq-styling#can-i-do-animations-in-react\"></a>\u6211\u53ef\u4ee5\u5728 React \u4e2d\u505a\u52d5\u756b\u55ce\uff1f </h3>\n<p>React \u53ef\u4ee5\u652f\u63f4\u52d5\u756b\u3002\u7bc4\u4f8b\u8acb\u898b <a class=\"external-link\" href=\"https://reactcommunity.org/react-transition-group/\">React Transition Group</a> \u548c <a class=\"external-link\" href=\"https://github.com/chenglou/react-motion\">React Motion</a> \u3001 <a class=\"external-link\" href=\"https://github.com/react-spring/react-spring\">React Spring</a> \u6216\u662f <a class=\"external-link\" href=\"https://framer.com/motion\">Framer Motion</a>\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-styling.md\">Edit this page</a></p></div></article>", "path": "/react/faq-styling", "nav": ["/react/faq-state", "/react/faq-structure"]}, {"key": "\u6a94\u6848\u7d50\u69cb", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"is-there-a-recommended-way-to-structure-react-projects\"><a class=\"anchor\" href=\"/react/faq-structure#is-there-a-recommended-way-to-structure-react-projects\"></a>\u6709\u4efb\u4f55\u5efa\u69cb React \u5c08\u6848\u7684\u63a8\u85a6\u65b9\u5f0f\u55ce\uff1f </h3>\n<p>React \u5c0d\u4f60\u5982\u4f55\u5c07\u6a94\u6848\u653e\u5165\u8cc7\u6599\u593e\u4e2d\u4e26\u7121\u610f\u898b\u3002\u4e0d\u904e\u4f60\u53ef\u4ee5\u8003\u616e\u5e7e\u7a2e\u5728\u751f\u614b\u7cfb\u4e2d\u5e38\u898b\u7684\u65b9\u6cd5\u3002</p>\n<h4 id=\"grouping-by-features-or-routes\"><a class=\"anchor\" href=\"/react/faq-structure#grouping-by-features-or-routes\"></a>\u4ee5\u529f\u80fd\u6216\u8def\u5f91\u5206\u985e </h4>\n<p>\u4e00\u7a2e\u5efa\u69cb\u5c08\u6848\u7684\u5e38\u898b\u65b9\u5f0f\u662f\u5c07 CSS\uff0cJS\uff0c\u548c\u6e2c\u8a66\u6a94\u6848\u653e\u5728\u4ee5\u529f\u80fd\u6216\u8def\u5f91\u5206\u985e\u7684\u8cc7\u6599\u593e\u4e2d\u3002</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">common/\n  Avatar.js\n  Avatar.css\n  APIUtils.js\n  APIUtils.test.js\nfeed/\n  index.js\n  Feed.js\n  Feed.css\n  FeedStory.js\n  FeedStory.test.js\n  FeedAPI.js\nprofile/\n  index.js\n  Profile.js\n  ProfileHeader.js\n  ProfileHeader.css\n  ProfileAPI.js</code></pre></div>\n<p>\u300c\u529f\u80fd\u300d\u7684\u5b9a\u7fa9\u4e26\u4e0d\u662f\u7d71\u4e00\u7684\uff0c\u4e14\u5176\u7c92\u5ea6\u7531\u4f60\u6c7a\u5b9a\u3002\u5982\u679c\u4f60\u7121\u6cd5\u5217\u51fa\u6700\u9ad8\u968e\u5c64\u7684\u8cc7\u6599\u593e\uff0c\u4f60\u53ef\u4ee5\u8a62\u554f\u4f60\u7684\u7522\u54c1\u4f7f\u7528\u8005\uff0c\u7522\u54c1\u5305\u542b\u54ea\u4e9b\u4e3b\u8981\u90e8\u5206\uff0c\u7136\u5f8c\u4ee5\u4ed6\u5011\u7684\u5fc3\u667a\u6a21\u578b\u4f5c\u70ba\u85cd\u5716\u3002</p>\n<h4 id=\"grouping-by-file-type\"><a class=\"anchor\" href=\"/react/faq-structure#grouping-by-file-type\"></a>\u4ee5\u6a94\u6848\u985e\u578b\u5206\u985e </h4>\n<p>\u53e6\u4e00\u500b\u53d7\u6b61\u8fce\u7684\u5efa\u69cb\u5c08\u6848\u65b9\u5f0f\u662f\u5c07\u76f8\u4f3c\u7684\u6a94\u6848\u7d44\u5728\u4e00\u8d77\uff0c\u4f8b\u5982\uff1a</p>\n<div class=\"gatsby-highlight\"><pre class=\"gatsby-code-text\"><code class=\"language-javascript\">api/\n  APIUtils.js\n  APIUtils.test.js\n  ProfileAPI.js\n  UserAPI.js\ncomponents/\n  Avatar.js\n  Avatar.css\n  Feed.js\n  Feed.css\n  FeedStory.js\n  FeedStory.test.js\n  Profile.js\n  ProfileHeader.js\n  ProfileHeader.css</code></pre></div>\n<p>\u6709\u4e9b\u4eba\u4e5f\u559c\u6b61\u9032\u4e00\u6b65\u5c07 component \u6309\u7167\u5176\u5728\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u89d2\u8272\u5206\u9032\u4e0d\u540c\u7684\u8cc7\u6599\u593e\u88e1\u3002\u4f8b\u5982\uff0c<a class=\"external-link\" href=\"http://bradfrost.com/blog/post/atomic-web-design/\">Atomic Design</a> \u4fbf\u662f\u4e00\u500b\u57fa\u65bc\u6b64\u539f\u5247\u7684\u8a2d\u8a08\u65b9\u6cd5\u3002\u8a18\u5f97\uff0c\u628a\u985e\u4f3c\u7684\u65b9\u6cd5\u8996\u70ba\u6709\u5e6b\u52a9\u7684\u4f8b\u5b50\u800c\u975e\u5fc5\u9808\u9075\u5b88\u7684\u56b4\u683c\u898f\u5b9a\uff0c\u901a\u5e38\u6703\u66f4\u6709\u6210\u6548\u3002</p>\n<h4 id=\"avoid-too-much-nesting\"><a class=\"anchor\" href=\"/react/faq-structure#avoid-too-much-nesting\"></a>\u907f\u514d\u592a\u591a\u5de2\u72c0 </h4>\n<p>JavaScript \u5c08\u6848\u4e2d\u6709\u5f88\u591a\u548c\u6df1\u5ea6\u5de2\u72c0\u76ee\u9304\u6709\u95dc\u7684\u75db\u9ede\u3002\u64b0\u5beb\u5176\u4e2d\u7684\u76f8\u5c0d\u5c0e\u5165\u6216\u662f\u5728\u6a94\u6848\u79fb\u52d5\u5f8c\u66f4\u65b0\u9019\u4e9b\u5c0e\u5165\u8b8a\u5f97\u8d8a\u4f86\u8d8a\u96e3\u3002\u9664\u975e\u4f60\u6709\u975e\u5e38\u4ee4\u4eba\u4fe1\u670d\u7684\u539f\u56e0\u5fc5\u9808\u4f7f\u7528\u6df1\u5ea6\u5de2\u72c0\u8cc7\u6599\u593e\uff0c\u4e0d\u7136\u8acb\u8003\u616e\u9650\u5236\u4f60\u81ea\u5df1\u5728\u4e00\u500b\u5c08\u6848\u4e2d\u4f7f\u7528\u6700\u591a\u4e09\u5c64\u6216\u56db\u5c64\u8cc7\u6599\u593e\u3002\u7576\u7136\uff0c\u9019\u53ea\u662f\u4e00\u500b\u5efa\u8b70\uff0c\u4e14\u4e5f\u4e0d\u4e00\u5b9a\u6703\u548c\u4f60\u7684\u5c08\u6848\u6709\u95dc\u3002</p>\n<h4 id=\"dont-overthink-it\"><a class=\"anchor\" href=\"/react/faq-structure#dont-overthink-it\"></a>\u4e0d\u8981\u60f3\u5f97\u592a\u591a </h4>\n<p>\u5982\u679c\u4f60\u624d\u525b\u958b\u59cb\u4e00\u500b\u5c08\u6848\uff0c<a class=\"external-link\" href=\"https://en.wikipedia.org/wiki/Analysis_paralysis\">\u8acb\u4e0d\u8981\u82b1\u8d85\u904e\u4e94\u5206\u9418</a>\u5728\u9078\u64c7\u6a94\u6848\u7d50\u69cb\u3002\u9078\u64c7\u4ee5\u4e0a\u4efb\u4f55\u65b9\u6cd5\uff08\u6216\u60f3\u4e00\u500b\u4f60\u81ea\u5df1\u7684\uff09\u7136\u5f8c\u958b\u59cb\u5beb\u7a0b\u5f0f\u78bc\uff01\u7562\u7adf\u5728\u4f60\u5beb\u4e86\u4e00\u4e9b\u771f\u6b63\u7684\u7a0b\u5f0f\u78bc\u5f8c\u4f60\u5f88\u53ef\u80fd\u6703\u60f3\u91cd\u65b0\u601d\u8003\u3002</p>\n<p>\u5982\u679c\u4f60\u611f\u5230\u5b8c\u5168\u5361\u4f4f\uff0c\u5f9e\u628a\u6240\u6709\u6a94\u6848\u653e\u5728\u4e00\u500b\u8cc7\u6599\u593e\u958b\u59cb\u3002\u6700\u7d42\u5b83\u6703\u8b8a\u5927\u5230\u4f60\u6703\u60f3\u5c07\u67d0\u4e9b\u6a94\u6848\u548c\u5269\u4e0b\u7684\u5206\u958b\u3002\u5728\u90a3\u6642\u4f60\u5c31\u6703\u6709\u8db3\u5920\u7684\u8a8d\u77e5\u53bb\u5206\u8fa8\u54ea\u4e9b\u6a94\u6848\u4f60\u6700\u5e38\u4e00\u8d77\u66f4\u6539\u3002\u4e00\u822c\u4f86\u8aaa\uff0c\u628a\u7d93\u5e38\u4e00\u8d77\u66f4\u6539\u7684\u6a94\u6848\u653e\u5f97\u548c\u5f7c\u6b64\u8fd1\u4e00\u4e9b\u662f\u500b\u597d\u4e3b\u610f\u3002\u9019\u500b\u539f\u5247\u7a31\u70ba\u300ccolocation\u300d\u3002</p>\n<p>\u7576\u5c08\u6848\u8b8a\u5f97\u66f4\u5927\u6642\uff0c\u5be6\u52d9\u4e0a\u4ed6\u5011\u901a\u5e38\u6703\u4f7f\u7528\u4e0a\u8ff0\u5169\u7a2e\u65b9\u6cd5\u7684\u6df7\u5408\u3002\u6240\u4ee5\u5728\u4e00\u958b\u59cb\u9078\u64c7\u300c\u6b63\u78ba\u7684\u300d\u90a3\u4e00\u500b\u4e26\u4e0d\u662f\u975e\u5e38\u91cd\u8981\u3002</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-structure.md\">Edit this page</a></p></div></article>", "path": "/react/faq-structure", "nav": ["/react/faq-styling", "/react/faq-versioning"]}, {"key": "\u7248\u672c\u63a7\u5236\u653f\u7b56", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><p>React follows <a class=\"external-link\" href=\"https://semver.org/\">semantic versioning (semver)</a> principles.</p>\n<p>That means that with a version number <strong>x.y.z</strong>:</p>\n<ul>\n<li>When releasing <strong>critical bug fixes</strong>, we make a <strong>patch release</strong> by changing the <strong>z</strong> number (ex: 15.6.2 to 15.6.3).</li>\n<li>When releasing <strong>new features</strong> or <strong>non-critical fixes</strong>, we make a <strong>minor release</strong> by changing the <strong>y</strong> number (ex: 15.6.2 to 15.7.0).</li>\n<li>When releasing <strong>breaking changes</strong>, we make a <strong>major release</strong> by changing the <strong>x</strong> number (ex: 15.6.2 to 16.0.0).</li>\n</ul>\n<p>Major releases can also contain new features, and any release can include bug fixes.</p>\n<p>Minor releases are the most common type of release.</p>\n<div class=\"blockquote\">\n<strong>This versioning policy does not apply to prerelease builds in the Next or Experimental channels. Learn more about prereleases.</strong>\n</div>\n<h3 id=\"breaking-changes\"><a class=\"anchor\" href=\"/react/faq-versioning#breaking-changes\"></a>Breaking Changes </h3>\n<p>Breaking changes are inconvenient for everyone, so we try to minimize the number of major releases \u2013 for example, React 15 was released in April 2016 and React 16 was released in September 2017, and React 17 was released in October 2020.</p>\n<p>Instead, we release new features in minor versions. That means that minor releases are often more interesting and compelling than majors, despite their unassuming name.</p>\n<h3 id=\"commitment-to-stability\"><a class=\"anchor\" href=\"/react/faq-versioning#commitment-to-stability\"></a>Commitment to Stability </h3>\n<p>As we change React over time, we try to minimize the effort required to take advantage of new features. When possible, we\u2019ll keep an older API working, even if that means putting it in a separate package. For example, <a class=\"external-link\" href=\"https://zh-hant.reactjs.org//blog/2016/07/13/mixins-considered-harmful.html\">mixins have been discouraged for years</a> but they\u2019re supported to this day <a href=\"/react/react-without-es6#mixins\">via create-react-class</a> and many codebases continue to use them in stable, legacy code.</p>\n<p>Over a million developers use React, collectively maintaining millions of components. The Facebook codebase alone has over 50,000 React components. That means we need to make it as easy as possible to upgrade to new versions of React; if we make large changes without a migration path, people will be stuck on old versions. We test these upgrade paths on Facebook itself \u2013 if our team of less than 10 people can update 50,000+ components alone, we hope the upgrade will be manageable for anyone using React. In many cases, we write <a class=\"external-link\" href=\"https://github.com/reactjs/react-codemod\">automated scripts</a> to upgrade component syntax, which we then include in the open-source release for everyone to use.</p>\n<h3 id=\"gradual-upgrades-via-warnings\"><a class=\"anchor\" href=\"/react/faq-versioning#gradual-upgrades-via-warnings\"></a>Gradual Upgrades via Warnings </h3>\n<p>Development builds of React include many helpful warnings. Whenever possible, we add warnings in preparation for future breaking changes. That way, if your app has no warnings on the latest release, it will be compatible with the next major release. This allows you to upgrade your apps one component at a time.</p>\n<p>Development warnings won\u2019t affect the runtime behavior of your app. That way, you can feel confident that your app will behave the same way between the development and production builds \u2014 the only differences are that the production build won\u2019t log the warnings and that it is more efficient. (If you ever notice otherwise, please file an issue.)</p>\n<h3 id=\"what-counts-as-a-breaking-change\"><a class=\"anchor\" href=\"/react/faq-versioning#what-counts-as-a-breaking-change\"></a>What Counts as a Breaking Change? </h3>\n<p>In general, we <em>don\u2019t</em> bump the major version number for changes to:</p>\n<ul>\n<li><strong>Development warnings.</strong> Since these don\u2019t affect production behavior, we may add new warnings or modify existing warnings in between major versions. In fact, this is what allows us to reliably warn about upcoming breaking changes.</li>\n<li><strong>APIs starting with <code class=\"language-javascript\">unstable_</code>.</strong> These are provided as experimental features whose APIs we are not yet confident in. By releasing these with an <code class=\"language-javascript\">unstable_</code> prefix, we can iterate faster and get to a stable API sooner.</li>\n<li><strong>Alpha and canary versions of React.</strong> We provide alpha versions of React as a way to test new features early, but we need the flexibility to make changes based on what we learn in the alpha period. If you use these versions, note that APIs may change before the stable release.</li>\n<li><strong>Undocumented APIs and internal data structures.</strong> If you access internal property names like <code class=\"language-javascript\">__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED</code> or <code class=\"language-javascript\">__reactInternalInstance$uk43rzhitjg</code>, there is no warranty.  You are on your own.</li>\n</ul>\n<p>This policy is designed to be pragmatic: certainly, we don\u2019t want to cause headaches for you. If we bumped the major version for all of these changes, we would end up releasing more major versions and ultimately causing more versioning pain for the community. It would also mean that we can\u2019t make progress in improving React as fast as we\u2019d like.</p>\n<p>That said, if we expect that a change on this list will cause broad problems in the community, we will still do our best to provide a gradual migration path.</p>\n<h3 id=\"minors-versus-patches\"><a class=\"anchor\" href=\"/react/faq-versioning#minors-versus-patches\"></a>If a Minor Release Includes No New Features, Why Isn\u2019t It a Patch? </h3>\n<p>It\u2019s possible that a minor release will not include new features. <a class=\"external-link\" href=\"https://semver.org/#spec-item-7\">This is allowed by semver</a>, which states <strong>\u201d[a minor version] MAY be incremented if substantial new functionality or improvements are introduced within the private code. It MAY include patch level changes.\u201d</strong></p>\n<p>However, it does raise the question of why these releases aren\u2019t versioned as patches instead.</p>\n<p>The answer is that any change to React (or other software) carries some risk of breaking in unexpected ways. Imagine a scenario where a patch release that fixes one bug accidentally introduces a different bug. This would not only be disruptive to developers, but also harm their confidence in future patch releases. It\u2019s especially regrettable if the original fix is for a bug that is rarely encountered in practice.</p>\n<p>We have a pretty good track record for keeping React releases free of bugs, but patch releases have an even higher bar for reliability because most developers assume they can be adopted without adverse consequences.</p>\n<p>For these reasons, we reserve patch releases only for the most critical bugs and security vulnerabilities.</p>\n<p>If a release includes non-essential changes \u2014 such as internal refactors, changes to implementation details, performance improvements, or minor bugfixes \u2014 we will bump the minor version even when there are no new features.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-versioning.md\">Edit this page</a></p></div></article>", "path": "/react/faq-versioning", "nav": ["/react/faq-structure", "/react/faq-internals"]}, {"key": "Virtual DOM \u548c Internals", "value": "<article class=\"css-174qq1k\"><div class=\"css-124oy3v\"><div class=\"css-6nf64v\"><h3 id=\"what-is-the-virtual-dom\"><a class=\"anchor\" href=\"/react/faq-internals#what-is-the-virtual-dom\"></a>What is the Virtual DOM? </h3>\n<p>The virtual DOM (VDOM) is a programming concept where an ideal, or \u201cvirtual\u201d, representation of a UI is kept in memory and synced with the \u201creal\u201d DOM by a library such as ReactDOM. This process is called <a href=\"/react/reconciliation\">reconciliation</a>.</p>\n<p>This approach enables the declarative API of React: You tell React what state you want the UI to be in, and it makes sure the DOM matches that state. This abstracts out the attribute manipulation, event handling, and manual DOM updating that you would otherwise have to use to build your app.</p>\n<p>Since \u201cvirtual DOM\u201d is more of a pattern than a specific technology, people sometimes say it to mean different things. In React world, the term \u201cvirtual DOM\u201d is usually associated with <a href=\"/react/rendering-elements\">React elements</a> since they are the objects representing the user interface. React, however, also uses internal objects called \u201cfibers\u201d to hold additional information about the component tree. They may also be considered a part of \u201cvirtual DOM\u201d implementation in React.</p>\n<h3 id=\"is-the-shadow-dom-the-same-as-the-virtual-dom\"><a class=\"anchor\" href=\"/react/faq-internals#is-the-shadow-dom-the-same-as-the-virtual-dom\"></a>Is the Shadow DOM the same as the Virtual DOM? </h3>\n<p>No, they are different. The Shadow DOM is a browser technology designed primarily for scoping variables and CSS in web components. The virtual DOM is a concept implemented by libraries in JavaScript on top of browser APIs.</p>\n<h3 id=\"what-is-react-fiber\"><a class=\"anchor\" href=\"/react/faq-internals#what-is-react-fiber\"></a>What is \u201cReact Fiber\u201d? </h3>\n<p>Fiber is the new reconciliation engine in React 16. Its main goal is to enable incremental rendering of the virtual DOM. <a class=\"external-link\" href=\"https://github.com/acdlite/react-fiber-architecture\">Read more</a>.</p></div><p><a class=\"external-link\" href=\"https://github.com/reactjs/reactjs.org/tree/main/content/docs/faq-internals.md\">Edit this page</a></p></div></article>", "path": "/react/faq-internals", "nav": ["/react/faq-versioning"]}]}]